<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hang&#39;s Blog">
<meta property="og:url" content="https://example.com/page/70/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/page/70/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Implementing-Storage-for-Azure-Virtual-Desktop-8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Implementing-Storage-for-Azure-Virtual-Desktop-8/" class="post-title-link" itemprop="url">AZ-140-Implementing-Storage-for-Azure-Virtual-Desktop-8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 18:32:49" itemprop="dateCreated datePublished" datetime="2022-11-13T18:32:49-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:33:16" itemprop="dateModified" datetime="2022-11-14T06:33:16-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Implementing-Storage-for-Azure-Virtual-Desktop-8/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Implementing-Storage-for-Azure-Virtual-Desktop-8/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Azure-Virtual-Desktop-Storage-Solutions-Introduction"><a href="#Azure-Virtual-Desktop-Storage-Solutions-Introduction" class="headerlink" title="Azure Virtual Desktop Storage Solutions - Introduction"></a>Azure Virtual Desktop Storage Solutions - Introduction</h1><p>Thanks for joining this course on Azure Virtual Desktops Storage Solutions. No matter if you’re prepping for the AVD certification or just want to brush up on your skills, you’ll learn how to select the optimal storage solutions for your AVD environments, control your costs, and protect your AVD environments with Backups, HA, and DR. My name is Dean Cefola and I’ve been in the IT industry for over 20 years. Today I’m an Azure Principal Engineer at Microsoft and I’ve been working with Azure Virtual Desktop since before the beginning. I hope that you’ll find this course entertaining and educational, so please rate this course when you’re done and let me know how I did.</p>
<p>Who should attend this course? Well, it’s anybody who’s interested in learning how Azure Virtual Desktop works and those studying for the AVD Specialty exam. Through this course, I’ll help you to understand Azure Virtual Desktop Storage requirements and then we’ll talk through those storage solutions so you can select the right one for your environment. We’ll talk through Azure Virtual Machine disk performance and capacity, we’ll touch on high availability and disaster recovery, and then we’ll configure a storage solution for FSLogix. And we’ll finish up by creating, configuring, protecting, and authorizing your FSLogix file shares.</p>
<p>Now, you’ll get the most out of this course if you already have an administrator-level understanding of Azure Cloud Storage Services, an understanding of storage capacity and performance, Azure Protection Services for Backup, High Availability, Disaster Recovery, PowerShell and automation skills, and, of course, Azure Virtual Desktop and FSLogix.</p>
<p>Feedback is how we can all improve and if you have any feedback regarding this course, please contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. One last thing before we get started, everything I’m taking you through and showing you at the time of filming, this course is up to date, but the cloud changes over time. So if you find anything becomes out of date, please let us know at <a href="mailto:&#115;&#117;&#112;&#112;&#x6f;&#x72;&#116;&#64;&#x63;&#108;&#x6f;&#x75;&#100;&#97;&#x63;&#97;&#100;&#x65;&#109;&#x79;&#46;&#x63;&#111;&#109;">&#115;&#117;&#112;&#112;&#x6f;&#x72;&#116;&#64;&#x63;&#108;&#x6f;&#x75;&#100;&#97;&#x63;&#97;&#100;&#x65;&#109;&#x79;&#46;&#x63;&#111;&#109;</a> so we can fix it. All right, let’s dive into AVD Storage Solutions.</p>
<h1 id="AVD-Storage-Requirements"><a href="#AVD-Storage-Requirements" class="headerlink" title="AVD Storage Requirements"></a>AVD Storage Requirements</h1><p>The storage side of Azure Virtual Desktop comes in two main forms, Virtual Machine Disk resources, and FSLogix profile storage. FSLogix is a profile management solution that enhances and enables user profiles in Windows remote computing environments. For this discussion, FSLogix has two solutions that we need to discuss, user profiles and Office profiles. These profiles are stored on an SMB file share and mounted on demand to the AVD session hosts when a user logs in.</p>
<p>Inside Windows, a virtual hard drive file containing the user profile gets mounted without getting a drive letter, and the user’s folder appears in the C:\ user’s location, like all the other profiles, so it appears to windows as if the profile is local. The main benefit of this is that the user profile doesn’t have to do any gymnastics like you would have to with roaming profiles or streaming profiles, so performance is not impacted at all. The profile will also be able to travel from machine to machine with the user, which means that the session host does not retain any of the user’s data and no longer needs to be backed up and protected. However, the file share that contains the data must be backed up and thought about in your disaster recovery solutions, which will be discussed in another course.</p>
<p>User profiles contain all of your data. It’s the things that are on your desktop or your wallpaper, documents, pictures, music, et cetera. It also contains those things that are in your user’s app data folder and some other systems stuff. Think of it as all the data that you would cry over if you lost it. This means that the user profile should be backed up and protected during disaster recovery.</p>
<p>Now, to understand the Office profile, we need to step back out of the cloud and back to the on-premises days. Back in the day we all had other solutions like Exchange and SharePoint and things like that on-prem, latency, generally, wasn’t a big issue ‘cause you were on the same network as those servers. As mobile computing became a thing caching was introduced to offset the latency users in the field would experience. Then Microsoft started building out their Office 365 online services like Exchange Online and SharePoint Online. And this took those bulky multi-server infrastructure solutions that you had to manage yourself and centralized those into cloud services that you can just consume. But since latency is the enemy of good performance in those latency-sensitive environments, this caused the on-premise VDI users some performance issues.</p>
<p>Then along came FSLogix. They set up an Office profile to function as a cache for those Office Online services to give VDI users better performance. Since the Office profile only contains cached data, it doesn’t need to be backed up or protected in a DR. If all of it was lost the profile would just re-cache it from the Office 365 services. Now I know that sounds great but in Azure Virtual Desktop it’s recommended to only use the User profile. This is because AVD is sitting in the cloud right next to the Office 365 services, so latency is not an issue and caching is not needed. Another reason is that the Office profile cache data is contained in the user profile already. You can of course still use the Office profile if your situation specifically calls for it, however, just going with the user profile will minimize your complexity and simplify your storage solution, which is always a good thing.</p>
<h1 id="Azure-Disk-Requirements"><a href="#Azure-Disk-Requirements" class="headerlink" title="Azure Disk Requirements"></a>Azure Disk Requirements</h1><p>When it comes to disks, things may seem straightforward, but there are a few things that can trip you up. First, we need to understand how Azure Virtual Desktop works. The last part of the AVD sign-in process is a Windows login. This is the same function that happens when you log onto your desktop or laptop. Your user is authenticated, and your Windows profile is loaded, and you’re dropped onto your desktop. You also need to understand that we have two different kinds of host pools in AVD, Personal and Pooled.</p>
<p>In a Personal Host Pool, you will have a mapping of one user to one Session Host VM. In a Pooled Host Pool, you will have many users logging onto each Session Host VM. In Personal Host Pools, it’s generally not recommended to use FSLogix. However, FSLogix is almost always needed in a Pooled Host Pool. We’ll cover more about this in a minute. Let’s think about these two host pool scenarios with Virtual Machine Disks.</p>
<p>In both cases, the systems performance will be limited by the characteristics of your disks. The main disk characteristics are: capacity, throughput, and input&#x2F;output operations per second, or IOPS, for short. There are several disk types in Azure to choose from, ranging from Hard Disk Drives to Standard SSDs, Premium SSDs, and Ultra SSDs, with Hard Disk Drives being the lowest cost per gigabyte storage, but also having the lowest performance. In a Personal Host Pool, you have one user logging onto one VM Session Host. That doesn’t automatically mean that you should give them a Hard Drive.</p>
<p>All performance in AVD comes down to what the users are doing and the requirements for them to do it. If you don’t know the storage throughput and IOPS requirements for your users to run their applications, I generally start with a Standard SSD for Personal Host Pools and a Premium SSD for Pooled Host Pools. Do some real world testing with different users running their applications and see how they feel about it. If everything looks good, you’ve hit the sweet spot. If it isn’t just right, we have some options.</p>
<p>In Azure, the SSD IOPS are based on the size of the disk. The larger the disk, the more IOPS. If your disk performance is slow, the first thing you should think to try is to make your disk larger. This is generally preferred instead of adding more disks to the system because multiple disks will generally have higher cost than a single larger disk. This would also mean that you have more things to manage and protect.</p>
<p>As for Pooled Host Pools, your User Profiles will be using FSLogix, but Disks are important to think through. FSLogix user and office profiles can be configured in one or two ways, and that is to use VHD Locations, which write data directly to your File Share or Cloud Cache. This is where data writes will take place locally on the C:\ drive.</p>
<p>We will go into depth more in a follow-up course so we won’t deal with it further here. But since pooled host pools have multiple users logging onto them at the same time, we must have enough disk performance and capacity for all of them simultaneously, as well as in that Cloud Cache configuration, there will be more intense writes happening on the C:\ drive so you may need a larger disk. This is why I also always recommend starting with a Premium SSD for your Pooled OS Disks.</p>
<h1 id="FSLogix-Storage-Solutions"><a href="#FSLogix-Storage-Solutions" class="headerlink" title="FSLogix Storage Solutions"></a>FSLogix Storage Solutions</h1><p>There are three supported storage solutions for FSLogix in Azure Virtual Desktop, Azure Files, Azure NetApp Files, and a Windows Storage Spaces Direct File Server Cluster. There are many reasons for choosing one particular solution over another, but I could best sum it up this way. Storage Spaces Direct is a self-managed storage solution built on top of a Windows File Server Cluster. It needs a minimum of two Azure virtual machines to function. Each Server in the cluster will also need to have multiple high-performance disks and to make the cluster work, you will need Azure blob storage as a cloud witness.</p>
<p>Now managing your own server for this kind of thing means that you will have more control over the VM size, disk configuration, security, and cost, however, it’s not as scalable as the other solutions and troubleshooting is all on you. So, if you’ve never managed a storage spaces direct cluster before, I would not suggest that you start now. Especially because you can get more scale with less management out of the other cloud platform services.</p>
<p>Azure NetApp Files is a true first-party service in Azure. Its NetApp storage technology that is operated and supported by internal Microsoft personnel who are NetApp experts. Azure NetApp files is the highest performing storage solution in the cloud today. You can have 12.5 petabytes of storage per subscription with speeds up to 400,000 IOPS. ANF is also a special service in Azure that you must sign up to enable so we will not be using it as part of this course.</p>
<p>Azure files are built on top of Azure storage accounts and there are two performance tiers, standard and premium, both of which can support up to 100 terabytes per share. Standard File shares by default can have 1,000 IOPS per share but there’s a switch that you can enable called large file shares which will enable up to 10,000 IOPS. And notice I said, up to 10,000 IOPS.</p>
<p>Standard does not have guaranteed performance and performance is more volatile because standard storage is built on hard disk drives. Premium File Shares have a maximum of 100,000 IOPS. Premium does have guaranteed performance because it is built on SSDs. Premium also has a benefit that’s called SMB multi-channel. This is where you can increase the number of network connections between the File Share and your Session Hosts, and you can get more threads, which means more processing and more performance. Since Azure premium files is the recommended solution for production workloads that’s what we’ll be using today.</p>
<h1 id="FSLogix-Best-Practices"><a href="#FSLogix-Best-Practices" class="headerlink" title="FSLogix Best Practices"></a>FSLogix Best Practices</h1><p>Before we start building our storage solution, there are a few best practices to keep in mind. The first is that an Azure virtual desktop host pool is a collection of identical session hosts that are meant to contain a single workload. So, the best way to map your FSLogix file shares are in a one-to-one relationship, meaning each host pool should have their own FSLogix file share. This would isolate each workload from the others in your environment, so you won’t have to deal with the “noisy neighbor” syndrome. But another protection to think about is antivirus scanning.</p>
<p>Now, this might seem counter-intuitive, but the best practice here is to exclude all FSLogix file shares and virtual hard drives from your session host antivirus. The reason for this is that when a new disk or file share is mounted onto a system, Windows would attempt to scan those resources by default. If this happens then the session host processor will be bogged down hindering user performance and experience.</p>
<p>Now, the file share that contains user profiles should be scanned for viruses, but this should be done on a regular basis from another system like a management server, so you don’t impact the AVD environment. The way to implement this is to set antivirus exclusions on your session host. The details are in the Azure Docs, as shown here. </p>
<p>Now, how exactly you would implement this in your environment is going to depend on which antivirus solution you are using. If you’re using Microsoft Defender, this can be configured in your Group Policy settings. There’s another best practice to keep in mind when talking about your FSLogix file shares around capacity and performance. User profiles grow over time. One of the tricky things is that even if you delete files inside your profile, the profile disk itself never shrinks on its own.</p>
<p>In Azure Premium Files, the cost and performance of your file share is based on the size of the file share. The specific size of your file share should be determined based on how many users you have and the approximate size of all those users’ profiles. As I said before, Azure virtual desktop host pools are a collection of identical session hosts whose purpose is to be consumed by the users of a specific workload, for example, users in the accounting department or developers. Each one of those workloads is unique and therefore they should be on separate host pools and each of their host pools should be aligned with their own FSLogix file share for the same reason.</p>
<p>Here’s a quick example. There are 200 users in the accounting department. Each user needs a 10-gigabyte user profile. Just multiply 10 gigabytes by 200 users in that group and you should use a two-terabyte File Share. But wait, there’s more: each user profile will grow over time, which means we need to add some extra size for overhead while keeping in mind-controlling cost. I generally add an additional 20% to account for growth, so in this case I’d create a 2.5-terabyte file share and then would set up alerting through Azure monitor to keep an eye on capacity.</p>
<p>The last thing to think about in this section is performance. When a user profile is mounted to the system, this will consume approximately 50 IOPS of storage performance per user on your file share. After the user logon is complete, which takes about a minute or so depending on what startup sequences you have, you’ll have reached what we call steady state. In steady state, the user profile will consume roughly 10 IOPS of storage performance.</p>
<p>So, if we break out our slide rule once again, 200 users at 50 IOPS would equal 10,000 IOPS of storage performance if they all logged in at the same time. This is what we would call a logon storm, and it usually happens first thing in the morning. After the logon process is complete, your storage performance load will come down to roughly 2,000 IOPS</p>
<p>Even though this was an easy scenario, at larger scales you may need to increase the file share size well beyond your capacity needs to get the performance you require. But be aware, the larger the file share you create, the more expensive it will be. This is another reason why each host pool can have its own file share; it helps to control cost. </p>
<p>There’s another way to reduce cost of your FSLogix file share that I’ll just touch on, because it’s more well-suited to an in-depth course on FSLogix User Profiles. You can use this PowerShell script from the official FSLogix GitHub repo to delete the whitespace within your user profiles, which will shrink the virtual hard drives sizes and decrease the amount of total space you need on your file shares, which is where you can save cost.</p>
<p>So, let’s recap. We know in this example that we need at least a 2.5-terabyte capacity file share, and we also need a file share that can get up to 10,000 IOPS of burst performance and 2,000 IOPS of steady state performance. When we create our 2.5-terabyte Azure premium file share, this will give us the burst IO of 10,000 IOPS and the normal maximum IO of 5,500 IOPS. So, in this case, we know that a 2.5-terabyte share is the correct size. Then over time, when our profiles grow, we can use the FSLogix PowerShell script to shrink them, which will reduce the overall size requirements for our file share and could reduce our cost.</p>
<h1 id="FSLogix-Storage-Permissions"><a href="#FSLogix-Storage-Permissions" class="headerlink" title="FSLogix Storage Permissions"></a>FSLogix Storage Permissions</h1><p>Since the FSLogix user profiles are stored centrally on a SMB file share, we need to have the correct user permissions on that share so that users can access their own folders but not anyone else’s. Implementing this is slightly different based on which storage solution you’re working with. But the same thing may not be said of the windows NTFS file permissions. All users would need to be granted modify permissions at the share level. The creator owner permission would need to be set to modify for subfolders and files only. And optionally, the administrator would have full control over this folder, subfolders and files. This configuration allows users to create their own folders or their profiles on a file share and gives them the modify access over their own folders while not being able to access anyone else’s.</p>
<h1 id="Implementing-Storage-Demo"><a href="#Implementing-Storage-Demo" class="headerlink" title="Implementing Storage Demo"></a>Implementing Storage Demo</h1><p>Let’s provision a premium Azure storage account and create your FsLogix file share. In the Azure portal, I’ve already created a resource group called RG-AVD-Storage, to hold our storage account. Click the Create button at the top, and in the search box type, “storage account,” then click on the first item to create it. Like all resources in Azure, each storage account needs to reside in a subscription and a resource group, and those have already been selected here for us. I’ll call my storage account AVDstorage01, but be aware that this name won’t work for you, because all storage accounts must have globally unique names. As for the region, to keep latency as low as possible, the storage account should be located in the same region as your session host virtual machines.</p>
<p>Now, we haven’t created any VMs as part of this course, so I’ll locate the storage account in the East US, because that’s the one that nearest where I am. In the Performance section, we want to select Premium, and for our premium account type, select File Shares. The next section is on redundancy. Here we have two options today, LRS, which is locally redundant storage, and ZRS, which is zone redundant storage. To know which one is right for you, you need to understand how storage is protected in Azure. Every byte of data in the cloud is written three times on the backend of Azure, no matter if it’s a disk or a storage account, every scrap of data is written to three separate drives. This allows Microsoft to protect your data in the case of any one of those discs failing.</p>
<p>This is LRS. In the ZRS, we do the same concept as LRS, but those disks are in multiple Azure availability zones within the region. This is not really a disaster recovery solution per se, but a high availability solution. So the question for you to answer, is how much high availability do you need. In LRS, if something happened to the zone where your storage accounts have landed, the data may be unrecoverable, and you’d have to go to your disaster recovery solution. ZRS gives you a little more protection by spreading the load across the different availability zones within the region that you selected. In the case of premium files for FsLogix file share, I’m going to choose LRS, because we have some different options to protect the share, that we’ll get into in another course. Click, Next.</p>
<p>On the advanced screen, we can accept all of the default options and click Next. On the Networking screen, we have some choices. All Azure storage accounts, just like any other Azure PaaS solution, have multiple end points for you to communicate with. There are public end points, which are accessible from the internet, assuming you had a security token. Public end points for selected networks, is where we isolate access to the storage account to a virtual network in Azure. And finally, private end points. This is where a unique IP address within your virtual network is created, and assigned to the file share, so we can create network security rules to allow or deny traffic to it.</p>
<p>For today, we’ll use the selected network, public endpoint and isolate our storage account to our virtual network in Azure. But if your requirements call for least privilege access, then I would recommend the private end point option, which will use the Azure private link service. Now that we’ve selected that option, we have to pick the virtual network and sub-net that we want to grant access to. Let’s click Next, and look at our data protection.</p>
<p>Notice here that soft delete for seven days is recommended by default for your file shares. Soft delete allows any files that are deleted, to be retained in the storage account for direct recovery, without having to go to your backups. That’s definitely a convenient option, so we’ll leave that enabled, and click Next. Here’s where you can add your tags. Tags in Azure are metadata that you can assign to your resources that help you not only with organization, but you can also automate against them.</p>
<p>Your tagging strategy should be well thought out in advance, in a way that is most meaningful to your organization, so you don’t end up with random tags that nobody knows what to do with. These are the standard tags that I like to use: application, cost center, environment, owner, and support contact. These tags let me know, what application the storage account is related to, who’s going to be billed for it, whether this is for production or a lab environment, who is the owner of this resource, and how I can get in touch with them in case of a support issue. Click the Review and Create button to build your storage account.</p>
<h1 id="Configuring-FSLogix-File-Share-Demo"><a href="#Configuring-FSLogix-File-Share-Demo" class="headerlink" title="Configuring FSLogix File Share Demo"></a>Configuring FSLogix File Share Demo</h1><p>Now that our storage account is created, we need to do some configuring. First, we need to create a file share. In the data storage section of the blade on the left, select file shares. At the top click to create a file share. We need to name our file share and I’ll call mine F S Logics. Now we have to set our capacity. Notice that there is a table showing the maximum IO and burst IO and throughput rate. And as I change the provision capacity from one terabyte to 2.5 terabytes, our IO numbers change with it. This share can be as small as 100 gigabytes and as large as 100 terabytes and the performance characteristics change accordingly. So even if you only need 500 gigabytes of capacity, you may have to provision a one terabyte final share to get the performance you need.</p>
<p>The other thing to think about is that premium file shares bill based on the size of the share you provision, no matter how much data you store in it. So here’s a quick tip to save some money. Change your provision to capacity to 100 gigabytes so you can build the solution at the lowest cost. And then when you’re ready to start bringing users into the environment, you can change the size to what you need to meet demand.</p>
<p>One last thing before we create the file share, notice at the bottom that there is a note that says to use the SMB protocol with the file share, check if you can communicate over port 445. This is because most ISPs and some companies block port 445 because it has been a vector of attack across networks. However, in this case, our storage account and our network are both inside Azure and we made this storage account accessible from only our virtual network. So this will not be an issue as long as your firewall or network security group isn’t blocking port 445. Click the create button and don’t forget to increase the size of your file share when you’re ready to start onboarding your users.</p>
<p>The last step in this section is enabling our premium file share to have more network connections, increased throughput, increased IOPS, and network fault tolerance. Notice at the top of the screen, SMB multi-channel is currently disabled. Let’s enable it so we can get those benefits. Click on the word disabled. And the only thing to do is toggle SMB multi-channel to on and click the save button at the bottom.</p>
<h1 id="Protecting-FSLogix-File-Share-Demo"><a href="#Protecting-FSLogix-File-Share-Demo" class="headerlink" title="Protecting FSLogix File Share Demo"></a>Protecting FSLogix File Share Demo</h1><p>Now that we have a file share, we need to protect it. Click on the share. In the blade on the left, click backup. This is going to create a new Azure backup vault to protect your file share. The vault name resource group and policy have been selected for you showing that the file share will take a full backup at 7:30 p.m. and retain that data for 30 days. Those settings are just fine with me, but if you need the backup to be more frequent or retain the data for longer, you can edit the policy accordingly. When you’re ready, select the enable backup button at the bottom and that’s all that’s necessary. The file share will now be backed up according to your schedule. No muss, no fuss.</p>
<h1 id="Authenticating-FSLogix-File-Share"><a href="#Authenticating-FSLogix-File-Share" class="headerlink" title="Authenticating FSLogix File Share"></a>Authenticating FSLogix File Share</h1><p>Now that we’ve created our file share and are protecting it from those unintentional deletes, as well as standard backup protection, and we’ve enabled our best performance, it’s time to set up authentication. At the top, notice Active Directory is not configured. Let’s click on that. There are two options here. On the left is a traditional Active Directory. AD would be either on-prem or in a VM in the cloud. And on the right is Azure Active Directory Domain Services. This is a Microsoft-managed Active Directory, and that may sound appealing, however, there are a lot of caveats with that approach. So if you’re not currently using it, I would stick with Active Directory. Click the Setup.</p>
<p>As you can see, this is a four-step process to get the file share to use Active Directory authentication. Let’s click on the first step, and this will open the Azure docs. On the right, click the link for option one in the download AZFilesHybrid module section. The second bullet is a link to download the PowerShell module. Click on the .zip file and save it to a local location on a domain-joined machine and extract the files.</p>
<p>Open PowerShell as an administrator. In your terminal, navigate to the same file location you extracted the files to. In my script on the right, I’ve set some variables at the top for our resource group name, storage account name, and domain name, and that one’s just using a PowerShell environment variable. These will help you to execute the same script below each time this runs. Just change the variables for your next storage account, and you’re good to go.</p>
<p>In the next section, we’ll run one of the files we just extracted. This will copy the PowerShell module you downloaded to the appropriate place on your system, and the next command will import it. Now we can run the command to join our storage account to Active Directory. As you can see, this is going to use the variables that we listed above. In the command, there are also parameters for your domain account type, which I’ll use a ComputerAccount for this, and optionally, you can specify which organizational unit you want your computer account to reside in. If you don’t specify an OU, the default behavior is just a pick the same OU where your computer object exists that you’re running the script on. I’ve already got an organizational unit set up for this, so I’ll use that one.</p>
<p>In the terminal, we see everything ran successfully, and in Active Directory, we have a new computer object that’s named for our storage account. Before we can access this file share, we need to add permissions to either a file share or the storage account. If you select the storage account, this will apply the same permissions to all of the file shares, and that’s just what I’ll do today. Back in our storage account in the Azure Portal, on the left, we can go to Access Control, at the top, click to add a role assignment. In the search box, type SMB. The role we need is called Storage File Data SMB Share Elevated Contributor. Select that and click Next. Click Select Members and search for your virtual desktop administrator user or group. Click Select at the bottom, and Review &amp; Assign.</p>
<p>Now we want to add another permission, and this one will be for our FSLogix users. Click Add at the top. In the search box, type SMB. This time the role we need is called Storage File Data SMB Share Contributor. Click Next. Click Select Members and search for your virtual desktop users group. Select that. At the bottom, click Review &amp; Assign. Now before we can mount the file share, we should verify that we can connect to it in case port 445 is blocked. Back in PowerShell, I have added a new command to our script, and this will test connectivity to the share. We have two parameters here. ComputerName is the fully qualified name of the storage account, which in this case is avdstorage01.file.core.windows.net. And we have the common TCP port, which is SMB, also known as port 445.</p>
<p>In our terminal, we see the public IP address of the storage account and the last line shows our test was successful. Now we can map our file share in the Windows File Explorer. Click the button at the top to map the drive. Select the drive letter you want, and I’ll take the X drive. For the path, use the fully qualified name to the storage account, slash the share name. Click Okay. And you should now see your mapped drive. We now need to set the NTFS permissions. To do this, you will need to use the same user who you granted the elevated permissions right to. Right-click on the white space and select Properties. Notice that the size of the share properly shows 100 gigabytes. This is just another reminder to properly set the size of the share before you start bringing users into your environment. Click the Security tab at the top.</p>
<p>At the bottom, click the Advanced button. Notice that our WVD admin already has the permissions of full control, which is the elevated contributor role. Let’s add our FSLogix users, and click Add. At the top, click to select a member, and notice that in the box of our location is our Active Directory domain. Type the name of your group, which for me, is WVD users, and click Check Name. It looks good, so click Okay. Their permissions here should have Modify, and it should be for this folder only. Click Okay.</p>
<p>Now above that, we have our creator owner permission. Click that, and select the Edit button. Change this permission from Full Control to Modify, and click Okay. Now we’ve configured our FSLogix file share to be Active Directory authenticated, giving our AVD admin full control over the file share as well as our AVD users being able to create their own subfolders and files, which is required for their user profile creations when they first log in.</p>
<h1 id="Azure-Virtual-Desktop-Storage-Solutions-Conclusion"><a href="#Azure-Virtual-Desktop-Storage-Solutions-Conclusion" class="headerlink" title="Azure Virtual Desktop Storage Solutions - Conclusion"></a>Azure Virtual Desktop Storage Solutions - Conclusion</h1><p>In this course, we’ve covered Azure Virtual Desktop session host disk options as well as the requirements for FSLogix capacity and performance. And we’ve set up your FSLogix file shares with Active Directory authentication and the proper permissions. We’ve also protected that file share from local deletes with our soft delete function, and then further protected it with Azure Backup taking daily snapshots.</p>
<p>Thanks for joining me to learn about Azure Virtual Desktop storage solutions. Don’t forget to provide feedback in the survey in this course, so I can keep improving. And please direct message me on social media and let me know that you are now ABD certified. Happy learning.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Knowledge-Check-Implementing-Networking-for-Azure-Virtual-Desktop-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Knowledge-Check-Implementing-Networking-for-Azure-Virtual-Desktop-7/" class="post-title-link" itemprop="url">AZ-140-Knowledge-Check-Implementing-Networking-for-Azure-Virtual-Desktop-7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-13 18:31:55 / Modified: 19:59:32" itemprop="dateCreated datePublished" datetime="2022-11-13T18:31:55-04:00">2022-11-13</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Knowledge-Check-Implementing-Networking-for-Azure-Virtual-Desktop-7/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Knowledge-Check-Implementing-Networking-for-Azure-Virtual-Desktop-7/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="3.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Implementing-Networking-for-Azure-Virtual-Desktop-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Implementing-Networking-for-Azure-Virtual-Desktop-6/" class="post-title-link" itemprop="url">AZ-140-Implementing-Networking-for-Azure-Virtual-Desktop-6</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 18:20:18" itemprop="dateCreated datePublished" datetime="2022-11-13T18:20:18-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:32:18" itemprop="dateModified" datetime="2022-11-14T06:32:18-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Implementing-Networking-for-Azure-Virtual-Desktop-6/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Implementing-Networking-for-Azure-Virtual-Desktop-6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Azure-Virtual-Desktop-Networking-Planning-amp-Implementation-Introduction"><a href="#Azure-Virtual-Desktop-Networking-Planning-amp-Implementation-Introduction" class="headerlink" title="Azure Virtual Desktop Networking Planning &amp; Implementation - Introduction"></a>Azure Virtual Desktop Networking Planning &amp; Implementation - Introduction</h1><p>Thanks for joining this course on Azure Virtual Desktops Network Architecture. As you’re prepping for the Azure Virtual Desktop Certification or just brushing up on your skills, you will learn how to craft the best network solution for your environment. My name is Dean Cefola, and I’ve been in the IT industry for over 20 years. Today, I’m an Azure Principal Engineer at Microsoft and I’ve been working with Azure Virtual Desktop since before the beginning. I hope that you’ll find this course entertaining and educational so please rate this course when you’re done and let me know how I did.</p>
<p>Who should attend this course? Well, anyone who’s planning on taking the Azure Virtual Desktop Specialty exam and anyone who’s interested in learning more on how to properly deploy an AVD environment. Speaking of this course, we’ll cover the AVD Networking Requirements, implementing your Azure virtual network solutions. We’ll talk about your Hybrid connectivity options to the internet and your on-premises networks. We will implement and manage network security, which will also cover the Azure Bastion service so you can manage your AVD session hosts, and we’ll talk about monitoring and troubleshooting your network connectivity.</p>
<p>To get the most out of this course, you should have an administrator-level understanding of Azure Cloud Services of Networking, Network Security, and Network Monitoring. Feedback is how we can all continue to improve. So if you have any feedback, positive or negative, you can let me know by rating this course at the end, as well as contacting us directly at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>One last thing before we get started. Everything I’ll be showing in this course is up to date at the time of filming. However, the cloud does change over time. So if you find this material becomes out of date, please let us know at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a> so we can keep things updated. With all that out of the way, let’s get started.</p>
<h1 id="Network-Connectivity"><a href="#Network-Connectivity" class="headerlink" title="Network Connectivity"></a>Network Connectivity</h1><p>There’s a lot that goes into a network for any application, but with a virtual desktop there’s a lot of details to think through, so let’s take this one step at a time. The key to setting up the best network solution for a service like Azure Virtual Desktop is to remember that the laws of physics don’t change. You should always keep all of your resources as close to each other as possible. This keeps latency as low as possible. Also, the shortest distance between any two points is a straight line. So the fewest number of hops in your connections will be the most performant ones.</p>
<p>In Azure Virtual Desktop, connectivity is established using something called reverse connect. This allows your AVD clients to connect over the public internet to the AVD service securely using TCP port 443, without the need of public IP addresses. This starts with your client authenticating to Azure Active Directory, which means you get to use all of the benefits of Azure AD Authentication, like named locations, conditional access, and multifactor authentication.</p>
<p>Once your sign-in is complete, you’ll receive an Azure AD authentication token. Now that you’re authenticated, the token will pass to the AVD service web access role, which will then present to you with a list of remote applications and desktops that you’ve been allowed to use. When you click on one of those icons to open that app or desktop, your token will be presented to the AVD gateway, which will make a certificate for you. And this’ll be installed onto your client. The gateway service will also contact your AVD host pool and find a session host that is currently available. The gateway will then start a new outbound session from the session host back through the gateway to your client. With the connectivity finally established, you will log onto your Windows session, launching your remote application or desktop and you can get to work. So that’s how Azure Virtual Desktop works. What about the clients?</p>
<h1 id="AVD-Client-Connectivity"><a href="#AVD-Client-Connectivity" class="headerlink" title="AVD Client Connectivity"></a>AVD Client Connectivity</h1><p>Clients connect to AVD in two basic ways. First, is from the public internet. The second is from a Hybrid network. Now, if you’re okay with your users connecting over the public internet, and all of your supported services are in Azure, then you may not need Hybrid connectivity at all. The Hybrid Option is where you can connect to your existing corporate resources on-prem or over a private connection to Azure. To implement this, you need an Azure Virtual Network Gateway.</p>
<p>This gateway can only be deployed into your virtual networks Gateway Subnet, which I’ll show you how to set up in a moment. Now, the Hybrid Option breaks down further into these following options. First is an Azure ExpressRoute. This is a private direct connection between your company, the provider of your choice, and Microsoft. This is the highest bandwidth and best performance solution you can have, but it is also the highest cost.</p>
<p>Next is a Site-to-Site VPN. If you have your domain controllers or other resources on-site that your AVD users will still need access to, then you will need a Site-to-Site VPN. As the name implies, this VPN connects multiple corporate locations together so they can share resources. This VPN comes in many levels of performance, so check the Azure documentation so you can have all the information to make the right decisions.</p>
<p>Finally, there is a client VPN, also known as a Point-to-Site VPN. If you want to require your AVD clients to connect to a VPN before they can get to AVD, then you will want to have a Point-to-Site VPN. If this is the case for you, you will also need to leverage Azure Active Directory Conditional Access rules to deny connectivity from IP address ranges that are not in your corporate networks connecting to Azure Virtual Desktop.</p>
<p>There is one more way to get connected to Azure Virtual Desktop, and that’s using something called RDP Shortpath. If you remember back to the Reverse Connect model, once you connected to the AVD Gateway service, the Gateway would have a session host make an outbound connection to you over the public internet. RDP Shortpath changes how that connection is made.</p>
<p>As you can see in the picture on the right, there is a new connection line at the top. The client is allowed to connect directly to the session host over the Hybrid network connection. There’s also a change in protocol. Reverse Connect uses TCP port 443, but RDP Shortpath uses the UDP protocol on port 3390. The reason for this? UDP as a protocol is much more efficient than TCP. There are less handshakes, less retries, and it is specifically more efficient for this kind of traffic that we use in Azure Virtual Desktop.</p>
<h1 id="Network-Guidelines"><a href="#Network-Guidelines" class="headerlink" title="Network Guidelines"></a>Network Guidelines</h1><p>Since latency is the enemy of good performance, we want to keep our latency as low as possible. The way that you can check your latency from your clients to AVD is with the Azure virtual desktop experience estimator. This web page will show you the roundtrip time in milliseconds from where your client is located to all the different Azure regions. The recommended guidance is to keep your latency under 120 milliseconds.</p>
<p>The second thing that will impact your performance is what your users are doing. Here’s an Azure doc that give bandwidth estimates for different AVD workloads of light, medium, heavy, and power user. Now, what exactly do those workload types mean? Well, you see here, there’s a link here that will take you to a different section of the docs which explains what those are.</p>
<p>A medium workload will use database entry applications, Word, static web pages, whereas a power user would be doing all of that plus things like Adobe Photoshop, Illustrator or CAD design. Notice as well that each workload type has a recommended bandwidth and that’s really the key, even more so than the individual applications.</p>
<p>Finally, there’s a great doc for RDP bandwidth requirements showing the estimated bandwidth used by remote graphics. In this table at the bottom you see a idle full desktop uses about 0.3 kilobits per second. Down at the bottom of the list, we can see playing back a full screen video at 3.1 megabits per second using an H.264 encoder. And if you really need to establish some tight levels of controls, here at the bottom of the page there’s a way to use quality of service, or QoS, to shape your traffic and set up throttle rate limits using PowerShell.</p>
<h1 id="AVD-Network-Implementation"><a href="#AVD-Network-Implementation" class="headerlink" title="AVD Network Implementation"></a>AVD Network Implementation</h1><p>Now that you’ve got the basic concepts, let’s build our network in Azure. Then we’ll set up our supporting services like our gateway and DNS. And then we’ll set up security to allow connectivity to Azure Virtual Desktop. In the Azure portal, click the plus to create a resource and in the search box type network. Select the first option of virtual network and click create.</p>
<p>Every resource in Azure needs to be in a subscription and a resource group. So, select your subscription and let’s click to create a new resource group. Now, there are several strategies for how to name and locate your resources in Azure, but to keep things simple today, we’re going to build one resource group for our networks and we’ll call it RG-AVD-Network. This way, when you’re looking at your resources, you’ll know that this is a resource group for Azure Virtual Desktop that contains network resources.</p>
<p>Now we need a name for our virtual network. So, sticking with our naming convention, we’ll call this VNET-AVD. Azure resources need to reside in an Azure region and since we need to keep all of our resources as close together as possible, I suggest that you build this network in a region located closest to you, and I’ll pick the East US. Click next. This is where you set up your address space. This is the number of total IP addresses in your network. By default, you’ve been given a &#x2F;16 network, which means that you have over 65,000 IP addresses.</p>
<p>Now, one of the beauties of how Azure does this, is called software defined networking. You and I can both create a 10.0&#x2F;16 network. Even though we have the exact same address spaces we don’t overlap and the networks can’t communicate together because we’re two different users in two different environments of Azure. Things are different when connecting this virtual network to another virtual network in your subscription or to your on-premise networks.</p>
<p>Once this virtual network is connected to any other network, they must all have unique addresses. So, if we have a 10.0&#x2F;16 network in Azure, you cannot have a 10.0&#x2F;16 network on-premise that connects to Azure. All of these 65,000 IP addresses become usable in the bottom section where you create subnets. A subnet is where we divide those 65,000 addresses into different blocks and we will need a few of those.</p>
<p>Now, there are three special subnets in Azure that need specific names. The GatewaySubnet, this will contain the Azure Virtual Network gateway resources, which are required for setting up a VPN or express route connection. AzureFirewallSubnet, this is required for you to set up an Azure firewall for security. AzureBastionSubnet, this service will allow you to connect to your Azure virtual machine resources and manage them.</p>
<p>The first subnet has been created for you with a 10.0&#x2F;24 which makes up 256 addresses. Select it by clicking the word default. Rename this subnet to GatewaySubnet and you can leave the other settings alone and click save at the bottom. Click to add a new subnet and we’ll call this one AzureFirewallSubnet. For the subnet address range, we’ll use the next available range, which is 10.0.1.0&#x2F;24. Click add at the bottom.</p>
<p>Just two more. This one will be called Identity, and it’s going to be for your active directory domain controllers that you’ll build later. This address range will be 10.0.3.0&#x2F;24. Of course, if you’re planning on using only Azure AD Join you won’t be needing domain controllers so you might skip the Identity subnet in the future. However, you will need this next subnet for your Azure Virtual Desktop session hosts. So let’s call it AVD. If you said the address range should be 10.0.4.0&#x2F;24 you get the gold star.</p>
<p>Now, why didn’t we use the 2.0 address range? Click next and I’ll explain. In the security tab, we have three options. BastionHost, DDoS protection, and the Azure firewall. Bastion turns the Azure portal into a jump host where you can literally open a RDP or shell session to your virtual machines inside your browser and this is a requirement for the AVD exam. DDos Basic is included in Azure by default. The standard version of the service enables DDoS specifically on your virtual network.</p>
<p>In the case of virtual desktop, I generally would not use this. The reason why is, we’re going to secure our networks in such a way, that the only way in, is through either Bastion or Azure Virtual Desktop. Then we have the Azure firewall. This is a great service to secure your virtual network and is something worth knowing. However, since it’s not specifically required for the Azure Virtual Desktop certification, and it’s a resource that runs all the time, so it will burn through any of your Azure credits, we’re going to skip it for now and use network security groups instead, which are free resources. Click to enable BastionHost. We need to provide a name and a subnet range as well as a public IP address for Bastion to use. We’ll call it Bastion-AVD and the subnet range we’ll use, you guessed it, 10.0.2.0&#x2F;24. If we had set up the subnet in our last step with the 2.0 range, in here we would have gotten an error saying that the subnet range was already in use.</p>
<p>Click to create a new public IP address. Let’s call it Bastion-AVD-PIP. As you see, the naming of all of our resources like this, helps you to keep track of what services are as well as what they’re related to. Click next. Here’s where you can add your tags. Tags are metadata that you can attach to your resources. And the purpose of tags is not only to keep track of things like owners and cost centers, but you can also use them for automation. For example, find all of my virtual machines that have a tag of AVD and another tag of January, so I can decommission them when I deploy my updated session hosts from my updated image.</p>
<p>Now, a tag has a name and a value. These can literally be anything. So, you should work within your organization to come up with the set of tags and values that have meaning for you so you can get the most out of them. The tags I generally use are, application, cost center, environment, maintenance window, owner, and support contact. Click the review and create button to provision your resources.</p>
<h1 id="Configuring-Your-Virtual-Network-Demo"><a href="#Configuring-Your-Virtual-Network-Demo" class="headerlink" title="Configuring Your Virtual Network Demo"></a>Configuring Your Virtual Network Demo</h1><p>Now that we’ve created our virtual network, we need to do some configuration. Select VNET-AVD, on the left blade, select DNS Servers. The default option is to use Azure provided DNS. This is referring to the default DNS IP for Azure of 168.63.129.16. For many workloads this would be just fine, and if you’re planning on only using Azure AD Join VMs, you can stick with the default. However, since AVD relies on Active Directory DNS today, you will need to change this to custom and enter the IP addresses of your Active Directory DNS servers. I will have two of these located in Azure in the identity sub-net that we created earlier. So their IP addresses would be 10.0.3.4 and 10.0.3.5 respectively. I will also add the Azure default as my last DNS address. This way if my DNS servers can’t resolve something, it’ll be forwarded to Azure DNS. If your DNS servers are on premise, you can add those here as well. But before there’ll be able to work, you’ll need hybrid connectivity.</p>
<h1 id="AVD-Network-Security"><a href="#AVD-Network-Security" class="headerlink" title="AVD Network Security"></a>AVD Network Security</h1><p>Security can take the form of permissions as well as controlling ingress and egress of your traffic. In Azure, this requires either network security groups or some kind of firewall. If you want to use the Azure firewall, then it must be deployed into your virtual network’s subnet. If you are using a third-party firewall, there is no such requirement; I would still deploy it there to keep things isolated and identifiable unless the vendor specifically says to do otherwise.</p>
<p>In this deployment, we’ll only deal with network security groups or NSGs. The NSG works on a five-tuple rule set; this means that it will be looking at the source IP, destination IP, source port, destination port and protocol. For example, your AVD users will log onto their session host and need to load their FSLogix profile. The session host, which has a source IP address of 10.0.4.10 will need to connect to your Azure file’s storage that has a destination IP of 10.0.5.50. This connection will have a source and destination port of 445, which is the SMB port and the protocol is TCP.</p>
<p>Now you’ll have to make a rule in the NSG to allow this traffic to flow. In the same resource group you just deployed your virtual network, click to add a new resource at the top, in the search box type, “network security group”. The subscription and resource group should already be selected for you; if not, select the same ones that you used to deploy your virtual network.</p>
<p>Our NSG needs a name and a region, so I will use “NSG-AVD” and select the East US. Click next, add your tags, and I’ll just use the same tags we used for our virtual network earlier so we can identify all of our resources together, and then click the review and create button to complete the build.</p>
<p>Now that the NSG is built, we need to make some rules. It’s the rules that will control the flow of traffic into or out of your subnets. So the rules should be subnet specific, which means that the rules for your AVD subnet will look different than your identity subnet; for example, you’ll have active directory rules that need to be allowed between them.</p>
<p>Your identity inbound rules should have whatever the outbound rules from your AVD subnet are so that the rules can match. On the left, start with outbound rules. There are five rules that we need to allow Azure virtual desktop to work, and you can find those in the AVD documentation. We need to allow port 443 outbound to the Azure virtual desktop service, as well as to the Azure cloud service. Then we will need port 1688, to Azure KMS, which is required for the multi-session activation. Then we will need two specific source IPs on port 80 for health monitoring.</p>
<p>Back in our NSG outbound rules, click add at the top, set your source as virtual network; the source port range should be asterisk, destination should be a service tag, destination service tag should be windows virtual desktop, and note that this may be changed to Azure virtual desktop in the future. The service can stay as custom, destination port range should be 443 and the protocol should be TCP, your action should be to allow and now we have the priority. You can start as low as 100 and as high as 4,096; the lower the number, the higher the priority.</p>
<p>Since there might be other rules in the future that may need a higher priority than this rule, I always like to start at 1,000. Then I will create the rules in the increments of 10, just in case I need to squeeze rules in between later on. Give your rule a name and click add, repeat this for the Azure cloud service exactly like we just did, and then these last three rules will be slightly different.</p>
<p>First, let’s deal with the Azure KMS rule; if you do a quick internet search for Azure KMS, you will find this doc showing the different instances of the Azure KMS or different Azure clouds. The one that we want for this course is the Azure global address. Copy the IP address and let’s start a new NSG rule. The destination will be IP address, paste in the KMS IP that you got, the port will be 1688 and the protocol is TCP. The rule should be allowed, give your rule a name and click add. Repeat this for the last two rules using port 80, and it should all look like this. Those are the only rules needed for Azure virtual desktop to work, you will need other rules in the future for active directory communication, as well as rules to Azure storage and whatever other services you need in your environment.</p>
<p>Let’s take a look now at the inbound security rules, click to add a new rule at the top. On the right, your source will be an IP address; use your bastion subnet of 10.0.2.0&#x2F;24. Source port range will be asterisk, destination is virtual network. For the service you’ll want to use RDP, this will automatically select port 3390 and the TCP protocol for you. The action should be allowed, and since this is the first rule on the inbound side, we’ll use 1,000. We’ll name this “the bastion rule” and click add. Once you have finished adding all of your rules, click the subnets on the left, click associate at the top, select the VNET-AVD network. In the subnets box, select AVD, and that’s it. Your rules are now associated with the AVD subnet, and these will apply to all of the VMs you put in that subnet.</p>
<h1 id="Monitoring-amp-Troubleshooting-Demo"><a href="#Monitoring-amp-Troubleshooting-Demo" class="headerlink" title="Monitoring &amp; Troubleshooting Demo"></a>Monitoring &amp; Troubleshooting Demo</h1><p>The final section in this course on AVD networking, we’ll talk about monitoring and troubleshooting connectivity. When it comes to network monitoring, there are two services that you need to set up. In the search bar at the top of the screen, type monitor. Select the first match, and this is the Azure Monitor Service. Scroll down on the blade on the left, and you’ll want to click on Diagnostic settings. Use the filters at the top to select the appropriate subscription and resource group where all of our networking assets are located and then it should look something like this. It currently says disabled for all of these diagnostic settings, and that means that nothing is actively being monitored.</p>
<p>Before we can fix this, we need a place to store all of these diagnostic logs. On the top left click the + button, and on the left near the bottom select Monitoring and Diagnostics. Select the 2nd item from the top, Log Analytics Workspace. Select the same subscription and resource group that we’ve used throughout this course, and I will name the workspace Logs-Networking-AVD, and located in the East US region. Click Next, and add all of your tags, and then click Review and Create.</p>
<p>Once that’s complete, go back to the Azure Monitor, select Diagnostic settings on the bottom left again, and click on your first item. Then in the middle of the screen, click to add Diagnostic settings. The experience is the same here, no matter what the resource type is. Give the diagnostic a name. So in this case, it would be Log-AVD-Bastion. For the categories, these will be resource-specific. But I always recommend selecting all of the categories and metrics.</p>
<p>Now we need a destination for our logs. I’ll select the first box for a Log Analytics Workspace, then select the workspace we just created. Click Save at the top, and logging on Bastion is now enabled. Repeat these steps on all of the other resources and it should look like this.</p>
<p>The second component of network monitoring uses the Azure Network Watcher. In the search box at the top of the screen, type network watcher. Azure Network Watcher is not a virtual desktop-specific tool, but focuses on the infrastructure side of your resources, like your network cards of your AVD session hosts as well as the virtual networks, gateways, and firewalls. Most tools inside Network Watcher require you to have VMs that are online for it to examine. And since we haven’t deployed any VMs in this course, we will be somewhat limited in what I can show you, but there’s still enough here to talk through everything you need.</p>
<p>So the first thing on the left is your topology and this will show the layout of your network resources. Just filter down to the correct subscription and resource group, where your network assets are located, and you should see something like this, showing your virtual networks, subnets, NSGs, and route tables. This’ll definitely help you know that you’ve got all the right connectivity in place.</p>
<p>The next tool we’ll look at is IP Flow Verify. This is an on-demand tool that will verify if traffic would be allowed to flow inbound or outbound from a VM in Azure. Again, we haven’t specifically set up any VMs in this course, so I’ll show an example from another project I’ve been working on. You select your subscription resource group and the name of a VM, and then select the network interface of that VM.</p>
<p>Next, we select the protocol and direction that you want to test. This will populate the local IP address for you, and now select the local port you want to test, and I’ll choose 3389, then a remote IP. This IP can be in Azure or a public IP anywhere in the world. Select a port for this as well, and you would click the Check button at the bottom. In a few seconds, Azure will check which security rule will allow or deny this traffic. The other tools on the left have a different spin on connectivity troubleshooting like NSG diagnostics, Next Hop, which is helpful, if you have a hub and spoke topology or a firewall will let you know that everything is going the way that it should. The VPN troubleshooter, which will verify your gateway and connections are functioning properly to your on-prem and along with that, the NSG flow logs, which will give you even greater details than the diagnostic laws we set up earlier.</p>
<h1 id="Azure-Virtual-Desktop-Networking-Planning-amp-Implementation-Conclusion"><a href="#Azure-Virtual-Desktop-Networking-Planning-amp-Implementation-Conclusion" class="headerlink" title="Azure Virtual Desktop Networking Planning &amp; Implementation - Conclusion"></a>Azure Virtual Desktop Networking Planning &amp; Implementation - Conclusion</h1><p>We’ve covered all of the AVD network requirements, built a virtual network in Azure with the proper subnets to support AVD. We’ve talked about our network security with our NSG rules, and then we covered your connectivity options, like Reverse Connect and RDPShortpath, along with your Hybrid options. Finally, we went through the monitoring and troubleshooting of your network solution. Please respond to the survey at the end and let me know how I did in this course, and your feedback is definitely welcomed, so I can improve. And please direct message me on social media, and let me know that you are now AVD certified. Thanks for joining me for this course and happy learning.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Knowledge-Check-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Knowledge-Check-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-5/" class="post-title-link" itemprop="url">Knowledge-Check-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-13 18:16:57 / Modified: 19:57:56" itemprop="dateCreated datePublished" datetime="2022-11-13T18:16:57-04:00">2022-11-13</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Knowledge-Check-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Knowledge-Check-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="2.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-4/" class="post-title-link" itemprop="url">AZ140-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 15:03:57" itemprop="dateCreated datePublished" datetime="2022-11-13T15:03:57-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:33:20" itemprop="dateModified" datetime="2022-11-14T06:33:20-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-4/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Designing-for-Azure-Virtual-Desktop-User-Identities-and-Profiles-4/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course on Designing User Identity and Profiles. My name is Shabaz Darr, and I’ll be your instructor for this course. I am an Azure Virtual Desktop specialist and I’ve been working with Microsoft cloud technologies for several years, specifically with Azure Virtual Desktop since its inception, and have multiple Azure-focused certifications. My contact information is available on screen. Please feel free to reach out to me with any questions, comments, or concerns and I will be happy to discuss these with you. For any other issues you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a> and one of our cloud experts will follow up with you.</p>
<p>This course is intended for people that are planning on taking the Azure Virtual Desktop Specialty exam and anyone who is interested in learning how to deploy an Azure Virtual Desktop environment. By the end of this course, you will have knowledge on, selecting an appropriate licensing model for Azure virtual desktop based on requirements, recommending an appropriate storage solution, including understanding the differences between Azure NetApp Files and Azure Files, planning for Azure Virtual Desktop Client Deployment, planning for user profiles, recommending a solution for network connectivity, planning for Azure AD Connect for user identities.</p>
<p>To get the most from this course you should have an Administrator level understanding of Azure Cloud services.</p>
<p>Feedback on course content hosted by Cloud Academy is always appreciated and encouraged, as it helps us as trainers to improve which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>Please note, that at the time of writing this content, all course information was accurate. To accommodate new features and services, Microsoft regularly updates exam guidelines and measured skills. This may result in certain elements of discrepancy appearing in the content over time. Please contact us if you find any outdated content at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. This will allow us to update the course during the next release cycle. Thank you.</p>
<h1 id="Selecting-an-Appropriate-Licensing-Model"><a href="#Selecting-an-Appropriate-Licensing-Model" class="headerlink" title="Selecting an Appropriate Licensing Model"></a>Selecting an Appropriate Licensing Model</h1><p>Welcome to this module on selecting an appropriate licensing model for Azure Virtual Desktop based on requirements. In this module, we will cover the following topics: An Azure Virtual Desktop licensing overview. We will then look at bring your own license, or BYOL which includes: virtual desktop licensing for BYOL, remote app licensing for BYOL. Let’s take a look at an overview of Azure Virtual Desktop licensing.</p>
<p>There are two aspects of AVD licensing. The first is license entitlement. If you have an eligible Windows, Microsoft 365, or Microsoft Remote Desktop Client Access License, better known as an RDS CAL, there is no additional cost. The second part of Azure Virtual Desktop licensing is per user pricing. A recent addition to this has been introduced which supports Azure Virtual Desktop for external users only, meaning it supports users outside of your organization. We’ll explore this in more detail in the next part of this module.</p>
<p>There are different licensing models, the first one being virtual desktops. Virtual Desktop licensing for BYOL allows users outside of your organization to use their own license and access either Windows 10 or Windows 7 or Windows Server desktop session hosts. Additionally, they can utilize per user access licenses which will grant them access to Windows 10 and Windows 7 desktop for a fixed monthly price.</p>
<p>The second BYOL licensing model is for application streaming. This model follows the almost identical features and licenses as the virtual desktop model, however there is an exception. Rather than give access to a full virtual desktop, it will give the external users access to stream compatible applications.</p>
<h1 id="Recommending-an-Appropriate-Storage-Solution"><a href="#Recommending-an-Appropriate-Storage-Solution" class="headerlink" title="Recommending an Appropriate Storage Solution"></a>Recommending an Appropriate Storage Solution</h1><p>Welcome to this module on recommending an appropriate storage solution including Azure NetApp Files vs Azure Files. It is important to understand the different storage solutions that are available and their features before you can recommend one. In this module, we will cover the following topics: What is Azure Files including its main features? What is Azure NetApp Files including its main features? Azure Files vs Azure NetApp Files where we will compare the features from both.</p>
<p>Let’s start with looking at Azure Files. Azure Files is Microsoft Cloud’s native file share as a service. You can compare it to an on-premises file server but hosted at an Azure data center. It supports both server message block, or SMB and network file system, or NFS protocols so you can utilize this service for different workloads and scenarios. From an Azure Virtual Desktop perspective, Azure Files is utilized to facilitate user profiles, and integrates with FSLogix to give a smooth roaming profile experience to the end user.</p>
<p>Let’s now take a look at Azure NetApp Files and some of its features. Like Azure Files, this is also a cloud-hosted file share as a service, however, it is NetApp technology rather than Azure native. It is an enterprise-grade file share as a service and supports multiple protocols, much like its on-premises NetApp equivalent. There are also more tier options available with NetApp files as well as the existing premium and standard that are available with Azure Files. Azure NetApp Files also integrates with FSLogix to give a seamless roaming profile experience but with much better performance, which we will discuss shortly.</p>
<p>Now we understand what both storage types are and some of their key features, let’s see how they compare. Whereas Azure Files is more optimized for random access workloads, NetApp Files is more suited to high performance and low latency workloads. From a protocol aspect, we know Azure Files supports SMB and NFS but it also supports REST protocols, whereas NetApp Files also has SMB, NFS and dual-protocol access. Availability of both services is similar, where Azure NetApp Files has its premium tier available in 30 plus regions and its standard tier available in all regions.</p>
<p>Azure NetApp Files has all its tiers available in 28 plus regions. When we look at network access differences, both are accessible from VPN Gateway and Express Route. However, only Azure Files can be potentially accessed from the Internet. With regards to identity-based authentication and authorization, both support Active Directory Domain Services and Azure AD DS. However, for Azure Files, identity-based authorization is only supported when utilizing the SMB protocol.</p>
<p>When we look at encryption, Azure Files allows for customer-managed or Microsoft-managed keys, whereas Azure NetApp files only allows for Microsoft-managed keys for all protocols. Finally, from a performance perspective, NetApp files supports Ultra and Premium disks and have much more higher IOPS and throughput, therefore offer a much better performance experience compared to Azure Files.</p>
<h1 id="Planning-for-Azure-Virtual-Desktop-Client-Deployment"><a href="#Planning-for-Azure-Virtual-Desktop-Client-Deployment" class="headerlink" title="Planning for Azure Virtual Desktop Client Deployment"></a>Planning for Azure Virtual Desktop Client Deployment</h1><p>Welcome to this module on planning for Azure Virtual Desktop Client Deployment. We’ll cover the following topics in this module. We’ll look at an overview of the connection methods for Azure Virtual Desktop. Finally, we’ll look at the web browsers that support the web client. We’re going to start by looking at an overview of the different connection methods and clients for Azure Virtual Desktop.</p>
<p>The first is a Windows client, which can be downloaded from the internet and comes in both 32-bit and 64-bit form. This allows for user to either login with their Microsoft 365 email address, or use the remote access resource feed to subscribe to the workspace. We then have a web client which can be accessed from several supported web browsers. However, we will go into more detail on this shortly. Azure Virtual Desktop can also be accessed from Android devices by downloading a client from the Google Play store. This works in the same way the Windows client does in that you can subscribe to the remote access resource feed. There is an Azure Virtual Desktop client for the Apple macOS which is downloaded via web browser. Once installed, you add the workspace and enter your credentials to authenticate to the workspace. Finally, there is a client available to the Apple iOS device, which can be downloaded from the Apple store. This is similar to the Android client in that you subscribe to the remote access resource feed to access the workspace.</p>
<p>Now we understand the different types of clients and operating systems that support access into the Azure Virtual Desktop environment, let’s discuss which web browser clients are supported. You can access Azure Virtual Desktop via the web client using our Microsoft Edge internet browser. This is available on Windows operating system devices. Apple Safari supports access to Azure Virtual Desktop via the web client and this browser is available on macOS.</p>
<p>We then have a Mozilla Firefox web browser. However, please note that version 55 or later supports the Azure Virtual Desktop web client. This is also available on multiple operating systems, including Windows, macOS, and Linux. Finally, we have Google Chrome web browser, which supports web client access to Azure Virtual Desktop. Much like Mozilla Firefox, this is available on multiple operating systems, including Windows, macOS, Linux and Chrome OS.</p>
<h1 id="Planning-for-User-Profiles"><a href="#Planning-for-User-Profiles" class="headerlink" title="Planning for User Profiles"></a>Planning for User Profiles</h1><p>Welcome to this module on planning for user profiles in Azure Virtual Desktop. We will cover the following topics in this module. Storage options for user profiles in Azure Virtual Desktop. We will then discuss FSLogix Profile Containers. Finally, we will have a look at what FSLogix Office Containers are. Let’s start off by looking at storage options for user profiles.</p>
<p>Azure Virtual Desktop integrates with both Azure Files and Azure NetApp Files to facilitate user profiles. We discussed both of these services in a previous module in this course. As we discussed in the Recommending an appropriate storage solution module, Azure Files offers a general purpose use case, whereas Azure NetApp Files is more suited to higher performance user cases. You also need to be aware of the location you are storing your user profiles, as both Azure Files and NetApp files have different availability options. We are now going to discuss FSLogix profile containers. This is a remote profile solution which is installed on the Azure Virtual Desktop sessions hosts.</p>
<p>The FSLogix profile containers offer profile redirection and are similar to traditional on-premises roaming profiles. FSLogix profile containers fully integrate with Azure Files and Azure NetApp Files. You can also domain join the storage accounts associated with FSLogix which will enable you to control access using Active Directory Domain Services. In the final part of this module, we are going to discuss FSLogix Office Containers. This is also a form of profile redirection, however it is specific to Microsoft Office related data only. Office Containers allow the user to have an enhanced experience when using Office apps, but best practice recommendation is to implement it with another profile solution.</p>
<h1 id="Recommending-a-Solution-for-Network-Connectivity"><a href="#Recommending-a-Solution-for-Network-Connectivity" class="headerlink" title="Recommending a Solution for Network Connectivity"></a>Recommending a Solution for Network Connectivity</h1><p>Welcome to this module on recommending a solution for network connectivity. We’ll cover the following topics in this module. We’ll first look at virtual network recommendations for Azure Virtual Desktop. We’ll then move on to talking about the differences between VPN Gateway and Express Route, including use cases. Finally, we’ll look at some of the networking best practices for Azure virtual desktop.</p>
<p>First, let’s take a look at virtual network recommendations. In an Azure virtual desktop environment, it’s important to pick a sensible naming convention, largely to identify who the network belongs to. Naming convention is even more important if the environment is being deployed for a global organization, as it may have different regions. It’s always recommended to provision virtual networks to the closest region where the user will be situated. Make sure to revision multiple subnets. For example, if you have different host pools for different departments, you can separate these into different subnets and have more control over access. Finally, utilizing Azure services, like Network Security Groups to increase the network security posture of the Azure Virtual Desktop environment, is always recommended.</p>
<p>Let’s now discuss the difference between VPN Gateways and Express Routes. First, VPN Gateways. This is a shared VPN connection into Azure. This can be point-to-site, which is an individual VPN user connecting into Azure, or a site-to-site VPN connection, which is an on-premise office network or some location with a VPN device like a router connecting into Azure. Let’s now compare a VPN Gateway to an Express Route. This is a private connection between your organization’s on-premises location and the Azure data center.</p>
<p>There are two types of Express Route connection. The first is where you establish a connection to Azure at an Express Route location, known as an exchange provider facility. The second is where you directly connect to Azure from an existing Wide Area Network or WAN, which is provided by your network service provider. In the final part of this module, we are going to discuss some general networking best practices for Azure Virtual Desktop.</p>
<p>It is the best practice recommendation to have strong network controls in place. By this, we mean centralizing management and governance of the core network functions like the virtual network and any virtual network appliances. Next, it is recommended to logically segment virtual subnets, especially if you have used a large network address space for your VNet.</p>
<p>We touched on security earlier in this module, and as part of that is adopting a zero-trust approach to network access. Use Azure AD features like conditional access and just-in-time access to mitigate any security risks. The final best practice recommendation is to utilize virtual network appliances where possible. This includes virtual firewalls, which add an extra layer of security to your Azure Virtual Desktop environment.</p>
<h1 id="Planning-for-Azure-AD-Connect-for-User-Identities"><a href="#Planning-for-Azure-AD-Connect-for-User-Identities" class="headerlink" title="Planning for Azure AD Connect for User Identities"></a>Planning for Azure AD Connect for User Identities</h1><p>Welcome to this module on planning for Azure AD Connect for User Identities. We will cover the following topics in this module: I will explain what Azure AD Connect is. We will then discuss some the synchronization features available with Azure AD Connect. Finally, we will have a look at some of the use cases that fit each of these features.</p>
<p>Let’s start by looking at what Azure AD Connect is. Azure AD Connect is an application that is installed on a server within your on-premises environment, and it allows you to create a hybrid identity and access management solution between Active Directory Domain Services and Azure AD. It has a built-in health monitoring feature called Azure AD Connect Health which provides robust monitoring of your on-premises identity environment.</p>
<p>Although Azure AD Connect is a free tool and included as part of your Azure subscription, to get the best out of this tool, including the health capability, you need at least an Azure AD P1 license. Let’s look a bit deeper now at some of the main Azure AD Connect features, specifically the synchronization options. The first synchronization feature is called password hash synchronization. This feature enables a user to have the same password for Microsoft 365 and on-premises, and it synchronizes a hash, of the hash, of the user’s password from on-premises AD to Azure AD.</p>
<p>The second synchronization option is called pass-through authentication, or PTA. This has the same features as password hash, but in addition it allows organizations to enforce their on-premises AD security and password policies without the need for extra infrastructure. The final synchronization option is Active Directory Federation Services, or ADFS. With ADFS you get all the same features as pass-through, but much more integration with 3rd party MFA providers and ADFS claims. Also requires much more additional on-premises infrastructure than password hash and pass-through authentication.</p>
<p>In the final part of this module, we are going to look at the different use cases that would fit each of the synchronization options we have discussed. If you have a lot of existing on-premises infrastructure, including applications and services that need to be accessed with your Microsoft 365 accounts, then ADFS would be a sensible choice for your organization. If you want your users to have the same login credentials, both on-premises and in the cloud, then pass-through authentication, or PTA, is the most sensible choice for your organization. Finally, if you are just looking to improve user productivity, then password hash synchronization is the most relevant choice for your organization.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We have covered several important topics in this course. First, we covered selecting an appropriate licensing model for Azure Virtual Desktop where we looked at an overview of AVD licensing, then introduced the concept of ‘Bring Your Own License’, or BYOL. This had two variants, the first being Virtual Desktop BYOL and the second being Application Streaming BYOL.</p>
<p>Next, we discussed recommending an appropriate storage solution, where we covered an overview of Azure Files and its features. We then discussed Azure NetApp Files and its features, and finally did a comparison of both where we compared the features and looked at the use cases that could fit both services. The third module in this course looked at planning for Azure Virtual Desktop Client Deployment. Here we discussed an overview of the required clients to be able to connect from various operating systems. Finally, we looked at the supported browsers for the web client.</p>
<p>We then moved on to looking at planning for user profiles. In this module, we looked at storage options for user profiles in Azure Virtual Desktop, FSLogix for Profile Containers, and FSLogix for Office Containers. In the next module for this course we looked at recommending a solution for network connectivity. We started off by looking at some recommendations for virtual networks, then discussed Azure VPN Gateway and ExpressRoute where we compared their features.</p>
<p>Finally, we talked about some best practice recommendations for network connectivity. In the final module of this course we talked about planning for Azure AD Connect for user identities. Here we started off by discussing what Azure AD Connect is, then looked at some of the different synchronization features, including password hash, pass-through authentication and AD FS. Finally we looked at the use cases that fit each of these synchronization options.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Lab-Introduction-to-Azure-Virtual-Desktop-AVD-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Lab-Introduction-to-Azure-Virtual-Desktop-AVD-3/" class="post-title-link" itemprop="url">AZ140-Lab-Introduction-to-Azure-Virtual-Desktop-AVD</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 15:02:41" itemprop="dateCreated datePublished" datetime="2022-11-13T15:02:41-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:33:32" itemprop="dateModified" datetime="2022-11-14T06:33:32-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Lab-Introduction-to-Azure-Virtual-Desktop-AVD-3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Lab-Introduction-to-Azure-Virtual-Desktop-AVD-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Knowledge-Check-Designing-an-Azure-Virtual-Desktop-Architecture-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Knowledge-Check-Designing-an-Azure-Virtual-Desktop-Architecture-2/" class="post-title-link" itemprop="url">AZ140-Knowledge-Check:Designing-an-Azure-Virtual-Desktop-Architecture-2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-13 15:01:08 / Modified: 19:57:34" itemprop="dateCreated datePublished" datetime="2022-11-13T15:01:08-04:00">2022-11-13</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Knowledge-Check-Designing-an-Azure-Virtual-Desktop-Architecture-2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Knowledge-Check-Designing-an-Azure-Virtual-Desktop-Architecture-2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="1.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Designing-an-Azure-Virtual-Desktop-Architecture-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Designing-an-Azure-Virtual-Desktop-Architecture-1/" class="post-title-link" itemprop="url">AZ140-Designing-an-Azure-Virtual-Desktop-Architecture-1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 14:59:38" itemprop="dateCreated datePublished" datetime="2022-11-13T14:59:38-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:32:12" itemprop="dateModified" datetime="2022-11-14T06:32:12-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Designing-an-Azure-Virtual-Desktop-Architecture-1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Designing-an-Azure-Virtual-Desktop-Architecture-1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Designing-an-Azure-Virtual-Desktop-Architecture-Introduction"><a href="#Designing-an-Azure-Virtual-Desktop-Architecture-Introduction" class="headerlink" title="Designing an Azure Virtual Desktop Architecture - Introduction"></a>Designing an Azure Virtual Desktop Architecture - Introduction</h1><p>Hello, and welcome to this course on Designing an Azure Virtual Desktop Architecture. My name is Shabaz Darr and I’ll be your instructor for this course. I am an Azure Virtual Desktop Specialist and have been working with Microsoft Cloud and Azure for several years, specifically with Azure Virtual Desktop since its inception, and have multiple Azure-focused certifications. My contact information is available on the screen. Please feel free to reach out to me with any questions, comments, or concerns, and I will be happy to discuss these with you. For any other issues you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>, and one of our cloud experts will follow up with you.</p>
<p>This course is intended for people that are planning on taking the Azure Virtual Desktop Specialty exam, and anyone who is interested in learning how to deploy an Azure Virtual Desktop environment. By the end of this course, you will have knowledge on: Assessing existing physical and virtual environments, assessing network requirements for AVD, recommending an OS for an AVD implementation, planning and configuring name resolution, planning host pool architecture, recommending resource groups, subscriptions, and management groups, configuring location for AVD metadata, and calculating and recommending a configuration for performance requirements.</p>
<p>To get the most from this course, you should have an administrator-level understanding of Azure cloud services.</p>
<p>Feedback on course content hosted by Cloud Academy is always appreciated and encouraged, as it allows us as trainers to improve which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>Please note, that at the time of writing this content, all course information was accurate. To accommodate new features and services, Microsoft regularly updates exam guidelines and measured skills. This may result in certain elements of discrepancy appearing in the content over time. Please contact us if you find any outdated content at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. This will allow us to update the course during the next release cycle. Thank you.</p>
<h1 id="Azure-Virtual-Desktop-Overview"><a href="#Azure-Virtual-Desktop-Overview" class="headerlink" title="Azure Virtual Desktop Overview"></a>Azure Virtual Desktop Overview</h1><p>Welcome to this module on Azure Virtual Desktop overview. In this module, we will cover the following topics. What is the Azure Virtual Desktop? Where we’ll discuss some of the high-level features of this service. How does it work? Well, we’ll look at how organizations can utilize this service and Azure Virtual Desktop use cases. This is where we’ll talk about some of the different workloads and use cases that can take advantage of this cloud service.</p>
<p>We are first going to look at what Azure Virtual Desktop is. It is Microsoft’s cloud hosted virtual desktop infrastructure, better known as BDI solution, which allows you to move your end-user compute workloads into the cloud. It is only VDI solution that supports a Windows 10 Enterprise multi-session operating system, which means this particular OS can only be provisioned within Azure. Azure Virtual Desktop is secure by design as the backbone of this infrastructure is hosted within the Microsoft cloud ecosystem. However, we’ll talk about that in more detail later in this module.</p>
<p>It simplifies everyday management tasks by allowing you to utilize Azure’s automation services and tasks like Azure automate and auto-scale. These two integrations are outside of the scope of this course. However, they are discussed in later courses for this certification. Azure Virtual Desktop allows organizations to lower compute costs by allowing them to utilize auto shut down features and auto scaling to scale virtual machines in and out, depending on peak usage times or core business hours.</p>
<p>We are now going to discuss how it works. Azure Virtual Desktop allows users to remotely connect from anywhere and from multiple device types to a host cloud environment. This environment consists of host pools with virtual machine session hosts and application groups that consist of full Windows 10 desktop or remote published applications. You can integrate Azure Virtual Desktop with other services, as well as your on premises infrastructure if you have resources hosted within your physical offices, that need to be accessed.</p>
<p>I mentioned earlier in this module that Azure Virtual Desktop is secure by design. And this is because the backbone infrastructure is hosted by Microsoft. The Microsoft-managed components include web access. This component enables the end user to gain access to Azure Virtual Desktop and the virtual applications via HTML5-compatible internet browser. Connection broker, user connections to the remote desktop and remote applications are managed by this component of Azure Virtual Desktop.</p>
<p>Gateway access, this component allows remote users to connect to Azure Virtual Desktop resources from any device that is connected to the internet. Extensibility components, Azure Virtual Desktop can be managed by utilizing Windows PowerShell or the rest APIs that are provided. It also allows for support of third-party tools. Diagnostics, this event-based aggregator marks each action which is made by either a user or an administrator on the Azure Virtual Desktop deployment as a failure or a success. There are also specific components that are managed by the consumer, i.e. the organization. </p>
<p>The consumer-managed components include Azure Active Directory, Azure Virtual Desktop uses Azure Active Directory better known as Azure AD to manage identity and access better known as IAM. Azure Virtual Network, Azure Virtual Desktop compute resources use the Azure Virtual Network, better known as a vNet to communicate privately with over compute resources and between virtual machines. We will discuss network topology in more detail later in this course.</p>
<p>Session hosts, session hosts are virtual machines, better known as VMs that roam within your host pool. We will look at host pools and session hosts in more detail later in this course. Azure Virtual Desktop Workspace, this component manages session hosts and publishes the host pool resources. There are two types of Azure Virtual Desktop deployments which have very similar requirements. However, they both offer different benefits. We first have hybrid deployments, which is integration services that requires some type of additional infrastructure, whether hosted on premises or in the cloud. </p>
<p>In a hybrid Azure Virtual Desktop environment an Azure AD tenant is a requirement, which is the base of the identity and access management solutions. You also need to have a domain controller, which can be a physical or virtual service hosted on premises or a virtual machine hosted with Azure. An Azure subscription is required, which enables you to provision all the Azure Virtual Desktop services within your own tenant.</p>
<p>The second type of the deployment is a cloud-only deployment. The main difference with this type of deployment is instead of a domain controller, you utilize an Azure Active Directory Domain Services tenant, which is Microsoft domain controller as a service. You still need an Azure AD tenant and a subscription. Azure Virtual Desktop is accessed via an application called the Remote Desktop Client, which is supported on the following operating systems, Windows client, which can be downloaded via a web browser, Apple iOS client, which can be downloaded via the Apple store, Android client, which can be downloaded via the Play Store and macOS client, which can be downloaded via web browser.</p>
<p>In the final part of this module, we’re going to take a look at the different use cases of what Azure Virtual Desktop can be used for. The first use case is probably the one that has been utilized for the most and that is to facilitate remote working. You can have users working from locations outside your corporate offices network and access all the company resources they need via Azure Virtual Desktop. We then have organizations who are using Azure Virtual Desktop to replace their physical end user devices and move those workloads into Azure Virtual Desktop by utilizing the Windows 10 multi-session OS and published applications.</p>
<p>Another common use case has been development teams implementing development environments to test systems and applications outside their production environments in a sandbox Azure Virtual Desktop tenant. Organizations have also started to use Azure Virtual Desktop in their disaster recovery and business continuity plans. So in the event of a disaster, they can implement remote working quickly and effectively if required.</p>
<h1 id="Assessing-Existing-Physical-and-Virtual-Environments"><a href="#Assessing-Existing-Physical-and-Virtual-Environments" class="headerlink" title="Assessing Existing Physical and Virtual Environments"></a>Assessing Existing Physical and Virtual Environments</h1><p>Welcome to this module on assessing existing physical and virtual environments. In this module, we’ll cover the following topics. Proof of concept and how these can help you assess various elements of your existing infrastructure and how they will perform in the cloud. Assess Azure Virtual Desktop deployments where we’ll go into detail on those various elements you should assess and why. The different type of user personas and why they are important to understand. And understanding your application groups and how they function in a cloud environment.</p>
<p>A proof of concept is when you deploy services outside your production environment to allow you to understand what application, network and performance requirements will be before it moves into production. There are traditionally three stages in a proof of concept. The first stage is assess. The data you obtain from assessing the different applications and workloads will allow you to understand the number of simultaneous user sessions and the number of virtual machines you would need to facilitate those sessions.</p>
<p>Stage two is to migrate. You use the data obtained from the assess stage to provision new host pools and integrate the additional services, including FSLogix profile containers and RemoteApp application groups. The third stage is release. It is at this stage that you start to run performance testing to better understand network and application latency and start to allow users onto the environment to gain better feedback.</p>
<p>In this next part of the module, we’ll take a more in depth look at the assessment element of Azure Virtual Desktop. There are multiple components that are evaluated during the assessment stage, including: User personas, which we’ll talk about in further detail shortly. Virtual Machines to understand size requirements as well as user session capacity. Applications to understand which ones need to be part of the Windows image, and which ones can be deployed outside of the Windows image. </p>
<p>Data, which we’ll discuss in more detail shortly. User profiles, which are grouping users into different categories based on their workloads. One of the most important components to assess is data. When we talk about data, we do not just mean files and folders, but more information on various elements. The first of those elements is obtaining data on desktops. What applications do users have installed on their desktop and what are their requirements? We then have data on users. Which department are they in? Where do they access shares from? What applications do they individually use? </p>
<p>Finally, we have data on workloads where we can have light, medium, heavy or power user workloads. We need to understand these users that are classed under each of these type of categories. We mentioned user personas earlier. Specifying personas will happen by categorizing user based on the following criteria: Personal pools. We need to understand if users require their own personal virtual machine, or if they’re able to use pooled compute resources. There could be various reasons for requiring a personal VM, for example, compliance reasons. Density. Do certain users need greater performance density? An example of this would be having less users per CPU. We need to understand density information to ensure we size host pools correctly. Performance. Do certain users need to have higher performing virtual machines? For example, because they use an app that requires higher memory usage? Graphical processing. Better known as GPU, do specific users need to have graphics-intensive virtual machines due to their job role? Business function. Are you able to group a set of users under a single business area to allow easier cost management? Azure region. If you have a global user base, do they need to operate within that specific geographic location? Or for latency reasons is it better provisioning specific resources in closer locations for certain users? User count. We need to understand how many users will fit under each persona. Maximum session count. We’ll need to understand how many users will be connecting concurrently and from which region The final part of the assessment, but just as important as the other parts is the application groups. We need to understand which applications need to be part of a golden image that will be deployed to the session hosts. Which users will need to use Office applications? Or will they only need access to specific Office apps? Will applications be compatible with the virtual desktop environment? Which business critical apps will need to be part of the image or which ones can be published outside the image?</p>
<h1 id="Assessing-Network-Capacity-and-Speed-Requirements-for-Azure-Virtual-Desktop"><a href="#Assessing-Network-Capacity-and-Speed-Requirements-for-Azure-Virtual-Desktop" class="headerlink" title="Assessing Network Capacity and Speed Requirements for Azure Virtual Desktop"></a>Assessing Network Capacity and Speed Requirements for Azure Virtual Desktop</h1><p>Welcome to this module on Assessing Network Capacity and Speed Requirement for Azure Virtual Desktop. In this module we will cover the following topics:</p>
<ul>
<li>We will be taking a closer look at an Azure Virtual Desktop network architecture and the various ports and traffic flows</li>
<li>Next, we will look at the different types of network connectivity for Azure Virtual Desktop</li>
<li>Finally, we will look to understand some of the causes of connection latency in Azure Virtual Desktop</li>
</ul>
<p>Let’s start by looking at the network architecture for Azure Virtual Desktop</p>
<p>First, we can see all the connection sources which include the client device from which they are making the connection to Azure Virtual Desktop, the session host virtual machine, the internet, Active Directory Domain Services and Azure AD.</p>
<p>If we look closer at the Client connection, this flows via the Internet before it hits the Azure Virtual Desktop infrastructure. As we can see it makes three types of connection but all using the https port, which is 443. The purple line shows it making the Azure AD authentication, the red line signifies the feed subscription connection, and the dashed line signifies the Reverse Connection Transport connection. We will discuss this connection type in more detail shortly</p>
<p>We now see the additional authentication type connections that are made, initially from the session host to the Active Directory Domain Services on port 443 using Reverse Connect Transport, and then the Azure AD Connect traffic also using port 443.</p>
<p>The session hosts are also making connections to both the RD Gateway and RD Broker services. As we can see with this thick blue line, the connection to the RD Gateway is done on port 443 using Reverse Connect Transport. The connection to the RD Broker uses the RD Agent communication connection type, also on port 443</p>
<p>We now move on to looking at the different connection types. There are four main connectivity types that are utilized in Azure Virtual Desktop:</p>
<ul>
<li>First, we have Session Connectivity. As we saw in the architecture diagram earlier, session connectivity uses the remote desktop protocol, better known as RDP port to deliver remote display and input capabilities.</li>
<li>We then have Reverse Connect Transport, which is utilized to create the connection to the remote session on Azure Virtual Desktop</li>
<li>With the Session Host Communication Channel, when the Azure Virtual Desktop session initially starts there is a service called Remote Desktop Agent Loader service which creates a constant channel with Azure Virtual Desktop</li>
<li>Finally, the Connection Security. All connections that are made from clients and sessions hosts to the Azure Virtual Desktop infrastructure use TLS 1.2</li>
</ul>
<p>Let’s now move on to understanding connection latency in Azure Virtual Desktop. </p>
<p>There are a number of different things that can cause network latency when using Azure Virtual Desktop. As a service, Azure Virtual Desktop is globally available so as long as you have an internet connection and a supported device to use, you can connect to it.</p>
<p>It is not available in every region, so it is location dependent, however the list of supported regions is always growing. </p>
<p>Network latency can be difficult to predict or control, however Microsoft have and Azure Virtual Desktop Experience Estimator tool that assists organizations on deciding the best region which will allow them to improve latency of their session hosts. It is recommended that organizations should use this tool every 3 months to help manage network latency issues.</p>
<h1 id="Recommending-an-OS-for-Azure-Virtual-Desktop"><a href="#Recommending-an-OS-for-Azure-Virtual-Desktop" class="headerlink" title="Recommending an OS for Azure Virtual Desktop"></a>Recommending an OS for Azure Virtual Desktop</h1><p>Welcome to this module on Recommending an OS for Azure Virtual Desktop. In this module, we’ll cover the following topics: We’ll look at the virtual machine OS images that are supported in Azure Virtual Desktop that you need to consider when making recommendations. Lastly, we will discuss the various deployment options which support the different operating systems and why this is important to think about when making recommendations. Let’s start by looking at supported virtual machine OS images.</p>
<p>Azure Virtual Desktop only supports Windows operating systems for its session host virtual machines. The following Windows OS are supported: Windows 10 Enterprise multi-session. This OS is only support in Azure and enables multiple concurrent user sessions. Windows 10 Enterprise, which has the same features as Windows 10 Enterprise multi-session but without allowing concurrent user sessions. Windows 7 Enterprise. This OS is still available for businesses and in Azure Virtual Desktop for more legacy workloads.</p>
<p>Windows Server 2022 has recently become available for Azure Virtual desktop. Windows Server 2019, 2016, and 2012 R2 are additionally supported with Azure Virtual Desktop session host VMs. Now you understand the supported operating system for Azure Virtual Desktop, you also need to look at the different deployment options for these operating systems support. The first deployment option we have is from the Azure Image Gallery. All operating systems we have discussed support this method of deployment. We then have Manual virtual machine deployment which is again supported by all the operating system types we have discussed so far.</p>
<p>Azure Resource Manager, better know as ARM template deployment is only supported with Windows 10 Enterprise multi-session, version 1909 and later, Windows 10 Enterprise version 1909 and later and Windows Server 2016. ARM templates allow us to automate virtual machine deployment. The final deployment method available for Azure Virtual Desktop is provisioning host pools on the Azure Marketplace. This has the same OS support as ARM templates, Windows 10 Enterprise multi-session, version 1909 and later, Windows 10 Enterprise, version 1909 and later, and Windows Server 2016.</p>
<h1 id="Planning-and-Configuring-Name-Resolution-for-Active-Directory-and-Azure-AD-Domain-Services"><a href="#Planning-and-Configuring-Name-Resolution-for-Active-Directory-and-Azure-AD-Domain-Services" class="headerlink" title="Planning and Configuring Name Resolution for Active Directory and Azure AD Domain Services"></a>Planning and Configuring Name Resolution for Active Directory and Azure AD Domain Services</h1><p>Welcome to this module on Planning and Configuring Name Resolution for Active Directory and Azure AD Domain Services. In this module, we’ll cover the following topics. We’ll discuss Identity and Access Management options, which include: Azure Active Directory, Active Directory topology with Azure Virtual Desktop. Finally, we’ll discuss Azure AD Domain Services, better known Azure AD DS, with Azure Virtual Desktop. Let’s jump straight into Identity and Access Management options.</p>
<p>First, we have Azure Active Directory, which is Microsoft Cloud’s default identity service and it’s with this service that we can integrate features, such as conditional access and multi-factor authentication. We then have Active Directory Domain Services. This is your traditional on-premises identity and access management services where you install the Active Directory role onto a physical or virtual server. The third identity option for Azure Virtual Desktop is Azure Active Directory Domain Services. This is Microsoft’s domain controller as a service. Rather than provisioning a Windows Server to deploy the Active Directory role, you deploy this service and Microsoft manage the domain controller element. At the time of this course, all three options integrate with Azure Virtual Desktop. We will now look at each option in further detail.</p>
<p>First, let’s discuss Azure AD. Azure AD join has only recently been added as an integration feature. This enables administrators to manage the users and devices in a single pane of glass, regardless of the country the user or device reside in. Azure Active Directory can synchronize with Active Directory domain services via the Azure AD Connect sync tool, which in turn allows Azure Virtual Desktop to potentially integrate with applications that are hosted on-premises.</p>
<p>One of the most important features of Azure Active Directory integration enables for Azure Virtual Desktop are the security enhancements, including conditional access policies and multi-factor authentication. Active Directory Domain Services is traditionally a service you deploy on-premises on a virtual machine or a physical server, and allows you to domain join Windows clients. Domain joining your Azure Virtual Desktop session hosts will allow you to integrate the group policy to enhance the management experience. If you want the best of both on-premises and cloud integration, you can apply Hybrid AD join to your session host virtual machines to make use of Azure Active Directory’s enhanced security features but also Endpoint Manager integration.</p>
<p>The final deployment method we’ll discuss is Azure Active Directory Domain services. As I mentioned before, this is a domain controller as a service, so you do not have the headache of managing the Windows operating system, but get almost identical features as Active Directory Domain Services You can domain join your Azure Virtual Desktop session hosts. You even have the LDAP and NTLM support. However, what you do not get is the ability to do a hybrid AD join.</p>
<h1 id="Planning-Host-Pool-Architecture"><a href="#Planning-Host-Pool-Architecture" class="headerlink" title="Planning Host Pool Architecture"></a>Planning Host Pool Architecture</h1><p>Welcome to this module on Planning Host Pool Architecture. In this module, we’ll cover the following topics. I will explain what a pooled host pool is and its benefits. I’ll explain how breadth-first load balancing works. I’ll explain how depth-first load balancing works. We’ll finish this module off by talking about personal host pools and their benefits. A pooled host pool is also known as a non-persistent desktop and shares the session host resources or multiple users at any given time. Non-persistent state means about the settings are not saved unless you use FSLogix for user profile containerization. </p>
<p>There are two types of load balancing algorithms, which we’ll discuss in more detail now. The first load balancing algorithm we have is breadth-first load balancing, which enables you to evenly spread login sessions over all the session host virtual machines in your host pool. As you can see in this graphic, the session logins are spread even across a session host, and the next user it is connected to the session host on the right, indicated by the red circle.</p>
<p>Next, we have depth-first load balancing, which enables you to put all login sessions onto a single host. And only when usage of that session host hits a specific threshold, does it send login connections to another session host, as shown in the graphic. If we look at personal host pools, these are also known as persistent desktops, where settings are saved. You can either directly assign users to session hosts or allow Azure Virtual Desktop to automatically assign users. Whereas pooled host pools are shared resources, personal host pools are one-to-one ratio, so one user to one session host virtual machine.</p>
<h1 id="Recommending-Resource-Groups-Subscriptions-and-Management-Groups"><a href="#Recommending-Resource-Groups-Subscriptions-and-Management-Groups" class="headerlink" title="Recommending Resource Groups, Subscriptions, and Management Groups"></a>Recommending Resource Groups, Subscriptions, and Management Groups</h1><p>Welcome to this module on recommending resource groups, subscriptions and management groups. In this module, we’ll cover the following topics. We’ll discuss what a resource group is. We’ll talk about what a subscription is. I’ll explain what a management group is. Finally, we’ll take a closer look at an example of a typical hierarchical view of all three. A resource group is a logical container that allows you to manage your Azure resources that have been provisioned.</p>
<p>You can create multiple resource groups within your tenant and the number you have is very much dependent on your organization’s use case The resource group is the first logical management layer at which your Azure resources are stored. For example, if you have a number of departments, you might separate those departments’ provisioned resources into their own resource group. A resource group also stores metadata on the services you have placed in it. This is why it is essential that you choose the location of where you want your resource group to be situated carefully, as it needs to be in a country and region your organization’s policies allow.</p>
<p>The next level up in the Azure management hierarchy is a subscription. This is another logical container that stores metadata, and you can have multiple subscriptions within a tenant. You can also have multiple resource groups within a single subscription within multiple regions. You must have at least one subscription within your Azure tenant before you can start provisioning any cloud services, regardless of whether it is infrastructure as a servive, IaaS, software as a service, SaaS, or platform as a services, PaaS. The top level of management within Azure is a management group and much like the levels below it, this too is a logical container.</p>
<p>Management groups enable administrators to manage policies, access and compliance for multiple subscriptions and allow you to propagate settings down the management structure. As mentioned in the last point, you can manage multiple subscriptions within a management group regardless of the locations. In the final part of this module, we’re going to take a look at a typical management hierarchy, which includes management groups and subscriptions.</p>
<p>At the top layer, you have your root management group where you can apply policies and access rights you want to propagate down to the other resources. If we look at the next level down in the hierarchy, we have another layer of management groups that have been separated into departments, but also an enterprise subscription. At this level, an administrator could implement policies and access that are specific to each department.</p>
<p>Another level down, we have branched off into our separate, department-specific management groups where we have a mixture of subscriptions for testing and trials and a management group for production. It is this management group that is linked to the next level down where we have two region-specific management groups, which leads down to the lowest level in this hierarchy that consists of multiple enterprise subscriptions. This type of management hierarchy is typical of what you may find in an enterprise level organization, so it is recommended you take time to think about how this fits your Azure Virtual Desktop environment.</p>
<h1 id="Configuring-a-Location-for-Azure-Virtual-Desktop-Metadata"><a href="#Configuring-a-Location-for-Azure-Virtual-Desktop-Metadata" class="headerlink" title="Configuring a Location for Azure Virtual Desktop Metadata"></a>Configuring a Location for Azure Virtual Desktop Metadata</h1><p>Welcome to this module on configuring a location for Azure Virtual Desktop Metadata. In this module, we’ll cover the following topics. We’ll discuss the different types of information stored by Azure Virtual Desktop. Including customer data and the type of information that is stored as well as its locations. Diagnostic data and the type of information that is stored as well as this locations. Service generated data and the type of information that is stored as well as its locations. Let’s start by looking at customer data that is stored as part of the Azure Virtual Desktop environment.</p>
<p>Azure Virtual Desktop does not store actual user application related data. It does, however, store both, application names and use the principal names. The customer information that is stored is located in the location that is associated with the region the consumer has created that specific resource or object. If we now look at diagnostic metadata that is stored within Azure Virtual Desktop environment, is actually service generated data, which we’ll discuss in further detail shortly.</p>
<p>The diagnostic data that is stored is utilized for troubleshooting, support purposes and to check the health of the Azure Virtual Desktop environment. Diagnostic data is actually sent to two different locations. The first location is the one that is closest to the user in which the infrastructure is present. The second location is where the region where the host pool is located. Service generated data allows Microsoft to keep Azure Virtual Desktop reliable and scalable.</p>
<p>Specifically, traffic patterns, and region specific usage allow Microsoft to keep checks on health and performance of the backend control plan. Once the data is collated, it is sent to all the locations where the service infrastructure is held and then it is sent on to the US region. This includes scrub data, not any customer data. Service generated data is currently supported at limited locations, including the United States, Europe, the UK and Canada. Where is all generally available.</p>
<h1 id="Calculating-and-Recommending-a-Configuration-for-Performance-Requirements"><a href="#Calculating-and-Recommending-a-Configuration-for-Performance-Requirements" class="headerlink" title="Calculating and Recommending a Configuration for Performance Requirements"></a>Calculating and Recommending a Configuration for Performance Requirements</h1><p>Welcome to this module on calculating and recommending a configuration for performance requirements. In this module, we’ll cover the following topics: we will look at understanding the different workloads in Azure Virtual Desktop; we will then take a closer look at virtual machine size guidelines, including: multi-session recommendations for virtual machine sizing, single-session recommendations for virtual machine sizing, general recommendations for virtual machine sizing. Let’s start by looking at the different workloads available with Azure Virtual Desktop.</p>
<p>First, we have light workloads. When we say light workloads, we are talking about users who do basic data entry and use applications such as database apps and command-line apps. Next, we have medium workloads. With this type of workload, we are thinking more in the line of marketing people who use data entry applications, like Microsoft Word. We then move into heavy workloads. And these type of workloads are ideal for content creators who utilize broader Microsoft apps, such as PowerPoint and Outlook. The final workload we need to consider is power workloads. This type of workload suits 3D model makers who use applications such as Adobe products or CAD applications.</p>
<p>Now we understand the different types of Azure Virtual Desktop workloads, let’s take a look at some of the sizing recommendations. We start with some multi-session recommendations you need to be aware of for the exam. Microsoft recommends between 4 and 24 vCPUs for the standard or large environments. All virtual machines should have a minimum of at least two cores when dealing with standard or large environments.</p>
<p>Finally, it is recommended not to exceed 32 cores for any single virtual machine in an Azure Virtual Desktop environment. If we look at single-session recommendations, Microsoft recommends a minimum of 4 vCPUs per session host. For more accurate sizing however, they recommend you reach out to the app-specific vendor and liaise with them to understand more detailed recommendations.</p>
<p>In the final part of this module, we are going to discuss some general recommendations for virtual machine sizing with Azure Virtual Desktop. Microsoft recommends using Premium SSDs for any managed disks for better performance. If you are using the more power workload type, which is suited to graphics-intensive applications, then virtual machines with GPUs are the best fit. The last recommendation is to use the B-series burstable virtual machines for users who do not always utilize the maximum amount of CPU they are provisioned.</p>
<h1 id="Azure-Virtual-Desktop-Summary"><a href="#Azure-Virtual-Desktop-Summary" class="headerlink" title="Azure Virtual Desktop Summary"></a>Azure Virtual Desktop Summary</h1><p>We have covered several important topics in this course. First, we covered an overview of Azure Virtual Desktop, where we talked about what it is, how it works, and some use cases. We then moved on to looking at assessing existing physical and virtual environments. In this part of the course we discussed proof of concept, assessing deployments, user personas, and application groups.</p>
<p>Next came assessing network capacity and speed requirements for Azure Virtual Desktop, where we looked at network architecture, the different connectivity types, and looked at what can cause network latency. Recommending an operating system for Azure Virtual Desktop came next. And in this module, we talked about supported virtual machine images, the different supported and deployment types.</p>
<p>We moved on to look at planning and configuring name resolution for active directory and Azure AD Domain Services, where we talked about Azure AD, Active Directory and Azure AD Demand Services. Next came planning host pool architectures. And in this module, we took a closer look into what pooled and personal host pools are. Coming towards the end of the course, we discussed recommending resource groups, subscription and management groups.</p>
<p>In this module, we covered what a resource group, subscription and management group are, and then looked at hierarchical view of how they are utilized in an enterprise environment. Next, we discussed configuring a location for Azure Virtual Desktop metadata and the different types of data that were stored, including customer data, diagnostic data, and service generated data. </p>
<p>In the final module of this course, we looked at calculating and recommending a configuration for performance requirements. In this module, we look to understanding the different workload types and sizing guidelines for virtual machines.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/huawei-ver22-hcip-notes-27/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/huawei-ver22-hcip-notes-27/" class="post-title-link" itemprop="url">huawei-ver22-hcip-notes-27</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-13 13:26:03 / Modified: 13:26:04" itemprop="dateCreated datePublished" datetime="2022-11-13T13:26:03-04:00">2022-11-13</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/huawei-ver22-hcip-notes-27/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/huawei-ver22-hcip-notes-27/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/12/%E9%83%A8%E7%BD%B2%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/12/%E9%83%A8%E7%BD%B2%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4/" class="post-title-link" itemprop="url">部署高可用集群</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-12 23:24:33 / Modified: 23:24:34" itemprop="dateCreated datePublished" datetime="2022-11-12T23:24:33-04:00">2022-11-12</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/12/%E9%83%A8%E7%BD%B2%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/12/%E9%83%A8%E7%BD%B2%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/69/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/69/">69</a><span class="page-number current">70</span><a class="page-number" href="/page/71/">71</a><span class="space">&hellip;</span><a class="page-number" href="/page/199/">199</a><a class="extend next" rel="next" href="/page/71/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">1986</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
