<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hang&#39;s Blog">
<meta property="og:url" content="https://example.com/page/35/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/page/35/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Structure-and-Analyze-Data-with-Google-BigQuery-25/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Structure-and-Analyze-Data-with-Google-BigQuery-25/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Structure-and-Analyze-Data-with-Google-BigQuery-25</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:11" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:11-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:57:06" itemprop="dateModified" datetime="2022-11-22T20:57:06-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Structure-and-Analyze-Data-with-Google-BigQuery-25/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Structure-and-Analyze-Data-with-Google-BigQuery-25/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Introduction-to-Google-BigQuery-24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Introduction-to-Google-BigQuery-24/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Introduction-to-Google-BigQuery-24</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:09" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:09-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:51:44" itemprop="dateModified" datetime="2022-11-22T20:51:44-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Introduction-to-Google-BigQuery-24/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Introduction-to-Google-BigQuery-24/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to “Introduction to Google BigQuery”. My name’s Guy Hummel, and I’m a Google Certified Professional Cloud Architect and Data Engineer. If you have any questions, feel free to connect with me on LinkedIn and send me a message, or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course is intended for anyone who’s interested in analyzing data on Google Cloud Platform.</p>
<p>To get the most from this course, it would be helpful to have some experience with databases. It would also be helpful to have some familiarity with writing queries using SQL, but it’s not a requirement.</p>
<p>This is a hands-on course with lots of demonstrations. The best way to learn is by doing, so I recommend that you try performing these tasks yourself on your own Google Cloud account. If you don’t have one, then you can sign up for a free trial.</p>
<p>To save you the trouble of typing in the URLs and commands shown in this course, I’ve created a GitHub repository with a readme file that contains all of them. The link to the repository is at the bottom of the course overview below.</p>
<p>We’ll start by running some basic queries and saving the results.</p>
<p>After that, I’ll show you how to load data into BigQuery from files and from other Google services.</p>
<p>Then, you’ll see how to stream data into BigQuery one record at a time.</p>
<p>Finally, we’ll wrap up with how to export data from BigQuery.</p>
<p>But first, I’ll give you a quick overview of why you’d want to use BigQuery.</p>
<p>Data warehouses have been around for decades. When databases first became popular, they were primarily used for transaction processing (and that’s still the case today). But managers also needed to analyze data and create reports, which is difficult to do when the data resides in numerous databases across an organization. So data warehouses were created to collect data from a wide variety of sources, and they were designed specifically for reporting and data analysis.</p>
<p>If data warehouse technology has been around for so long, why did Google release BigQuery, and why would you use it instead of a more established data warehouse solution? Well, for two main reasons: ease of implementation and speed.</p>
<p>First, building your own data warehouse can be expensive, time consuming, and difficult to scale. With BigQuery, on the other hand, the only thing you have to do to get started is load your data into it. And you only pay for what you use, so you don’t need to spend a lot of money building capacity to handle peak periods.</p>
<p>Second, even if you do build your own high performance data warehouse, it will probably never be as fast as BigQuery because BigQuery can process billions of rows in seconds. This speed is especially valuable if you need to perform real-time analysis of streaming data, such as from online gaming systems or Internet of Things sensors.</p>
<p>Okay, now if you’re ready to learn how to crunch big data with ease, then let’s get started. We’d love to get your feedback on this course, so please give it a rating when you’re finished.</p>
<h1 id="Running-a-Query"><a href="#Running-a-Query" class="headerlink" title="Running a Query"></a>Running a Query</h1><p>To open BigQuery, go to the Google Cloud Platform console, then find BigQuery in the menu. Alternatively, you can type “bigquery” in the search bar, which is probably easier.</p>
<p>Suppose you wanted to see which US state had the most babies with the same name in one year. There’s a public dataset with baby name data available on BigQuery. If you look under bigquery-public-data, you’ll see one called “usa_names”. If you click on it, you’ll see two tables that are almost the same. We’ll use the first one.</p>
<p>When you click on the table, it brings up the schema. If you click on the Details tab, it’ll show you a description of the data in the table. Let’s make this bigger. If you click on the Preview tab, it’ll give you a sample of the data. If you click the “Query Table” button, it will even give you the skeleton of a SQL query.</p>
<p>However, the query that it put in isn’t complete. You can tell because the Validator circle at the bottom right is a red exclamation point, which means there’s a problem. To see why, click on it and open the Validator. It says the “SELECT list must not be empty”. Let’s “SELECT *” from the table, which, if you’re not familiar with SQL, means select everything. Now the exclamation point has turned into a green check mark, so it’s a proper query.</p>
<p>We should sort the results with the biggest number at the top, so use “ORDER BY number DESC” (for “descending”), and then, since we only need to see the top results, let’s put in a LIMIT of 10. This line is quite long now, so if you want to make it easier to read, select the “Format” option. That’s better.</p>
<p>Now click the “Run” button. It only takes a few seconds to run.</p>
<p>The top result is Robert in New York in 1947, with 10,025 occurrences. You might be wondering if we did something wrong with this query because all of the top 10 names are boy’s names. Let’s look only for girl’s names and see what happens. Add “WHERE gender &#x3D; ‘F’”. Remember to put quotes around the F.</p>
<p>Now it makes sense why we only saw boys’ names before. The highest number of occurrences for a girl’s name was “Mary” in Pennsylvania in 1918, with 8,184 occurrences. Although that’s a lot of Marys, there were 9,054 Roberts in New York in 1951 and that was the 10th highest number of occurrences, so no girl’s names showed up in the top 10.</p>
<p>Before we run any more queries, let’s see how much this is costing us. I’ll cover that in the next lesson.</p>
<h1 id="Pricing"><a href="#Pricing" class="headerlink" title="Pricing"></a>Pricing</h1><p>There are two components to BigQuery pricing: storage and queries.</p>
<p>BigQuery’s storage charges are incredibly cheap. It costs two cents per gigabyte per month, which is the same price as Cloud Storage Standard. What’s even better is that if you don’t edit a table for 90 days, then the price for that table drops to one cent per gig per month until you modify the data in the table again. That’s as cheap as Nearline Storage! In fact, it’s even cheaper because when you read data from Nearline Storage, there is a one-cent per gig charge. With BigQuery storage, you aren’t charged for reading data at all.</p>
<p>Since we’ve only been using public datasets so far, there won’t be any storage charges.</p>
<p>The only other charge is for queries. (There’s also a charge for streaming data to BigQuery in real-time, but that doesn’t apply to these examples and I’ll cover it in another lesson.) For queries, the first terabyte per month is free. After that, it costs $5 per terabyte, which is half a cent per gigabyte. Wait a minute, didn’t I just say that you aren’t charged for reading data from BigQuery storage? Yes, that’s true because BigQuery charges query fees regardless of where you read the data from. For instance, if you query a dataset that’s in Cloud Storage, then you get charged at the same rate that you would from querying a dataset in BigQuery storage, so the charge isn’t for reading – it’s for processing.</p>
<p>For high-volume customers, there’s also flat-rate pricing, but it’s only worthwhile if you spend at least $2,000 per month. It only applies to query costs and not storage, which is still separate.</p>
<p>To see how much data is processed by a query, look in the Validator message area. Since there isn’t an error in the syntax, now it’s showing how much data would be processed by the query above. In this case, it’s 163 MB. Considering that the first terabyte of processing in a month is free, this won’t cost us anything, but even if we were already over the 1 terabyte mark this month, it wouldn’t cost much. How much? Less than a tenth of a cent. I’d say that’s pretty reasonable.</p>
<p>And that’s it for this lesson.</p>
<h1 id="Saving-Query-Results"><a href="#Saving-Query-Results" class="headerlink" title="Saving Query Results"></a>Saving Query Results</h1><p>Now that you know how inexpensive it is to store data on BigQuery, you may want to save some of your query results there too.</p>
<p>It’s very easy to do that. First, though, since you don’t have a dataset to put tables in, you’ll need to create one. Click your project name and then click “Create Dataset”. You need to give it a name, so call it “babynames”. That’s the only thing you have to specify in this dialog box, but if you want to, you can set the location, which you might want to do for compliance reasons. You can also set an expiration time so that a certain number of days after a table has been created, it will be automatically deleted. You would do this if it’s temporary data that you don’t want to have to remember to delete later. Now click “Create dataset”, and you should see your new dataset show up under your project name.</p>
<p>Great, now we’re ready to run a query. Let’s open one of our previous queries, so we don’t have to type a new one in. If the list of your previous queries isn’t already showing, then click “Query History”. Click the button to the right of your first query to bring it up again.</p>
<p>Now before you re-run this query, select “Query settings” from the menu…and then select “Set a destination table for query results”. It has already set the right project and dataset name. Now we just need to tell it which table to use. If the table doesn’t already exist, it’ll create it, so you can type in whatever table name you want. Let’s call it “babynames_top10”. Click Save and then click “Run”.</p>
<p>Now if you click on the babynames dataset, you’ll see that it created the “babynames_top10” table. Then click the “Preview” tab and you’ll see the results from the query.</p>
<p>What if you decide to save the results to a table after you’ve run the query? That’s easy too. Click “Query History” and click on the first query. We didn’t specify that the results should be saved to a table when we ran this query the first time, but if you scroll down, you’ll see that it saved the results to a temporary table. Click that to see the table. Now you can click “Copy Table” and specify where you want to save it. You have to select the dataset first and then type in a new table name.</p>
<p>One more thing to be aware of is that if you don’t specify a destination table and it puts the results in a temporary table, the temporary table stays in cache for about a day. So if you run the query again within 24 hours, it’ll retrieve the cached copy and you won’t be charged for the query.</p>
<p>However, if you run a query again and specify a destination table, like we just did, then it won’t read the data from cache. So let’s run it again without the destination table option.</p>
<p>If you go to the “Job information” tab, you can see that it didn’t process any bytes because the results were cached. Also, the duration of the query was zero seconds because it just retrieved the results from cache rather than running the actual query. Of course, since we could have just looked at the results in the temporary table, there may not seem to be a lot of point in re-running the query. That’s probably true if you’re using the web interface, but if you’re using the bq command or the BigQuery API, then it might be useful in some cases.</p>
<p>Before we go, let’s get rid of the table we created. Click on the dataset name, and then click “Delete Dataset”. This will delete the dataset and all of the tables in it, so you have to type the name of the dataset before it’ll delete it. </p>
<p>Okay, that’s it for this lesson.</p>
<h1 id="Loading-Data"><a href="#Loading-Data" class="headerlink" title="Loading Data"></a>Loading Data</h1><p>It’s great having public datasets in BigQuery that you can use, but what about analyzing your own datasets? How do you get them into BigQuery? There are many ways to do this. If your data is already in another Google service, then there’s usually a way to get it into BigQuery, although sometimes it requires an intermediate step. Some of the most commonly used sources are Cloud Storage, Google Drive, Firestore, Cloud Operations, Bigtable, and Google Analytics.</p>
<p>If your data isn’t in a Google service, then you can upload it to BigQuery through the web interface, the command line, or the API. Uploading through the web interface is the simplest, although it does have limitations.</p>
<p>Suppose you want to upload a dataset of the number of occurrences of all baby names across the US for a particular year. Since you don’t already have a copy of this dataset, you’ll need to download it from the Social Security website. The URL is in the GitHub <a target="_blank" rel="noopener" href="https://github.com/cloudacademy/bigquery-intro">repository</a> for this course. Then unzip the file. You can see that it contains one text file for each year from 1880 to 2019. Let’s have a look at the 2019 file.</p>
<p>It’s a very simple file, with a name, a gender, and the number of occurrences of that name for babies born in 2019. Although the filename extension is “txt”, it’s actually a comma-separated values file (or CSV). BigQuery can upload files in 5 formats: CSV, JSON, Avro, ORC, or Parquet.</p>
<p>Before you can upload a file, you need to create a dataset and table in BigQuery to hold it. Let’s call it “babynames”.</p>
<p>Now you need to create a table in that dataset, so click the “Create Table” button. Change the Source to “Upload”. If you click on the menu, you’ll see that you could also choose Cloud Storage, Google Drive, or Cloud Bigtable. If your data were in one of those three services, then you could load it into BigQuery from here or you could even leave the data where it is and make it an external data source, also known as a federated data source. However, the performance is usually slower when you query an external data source than if the data resides in BigQuery storage, so it’s often better to copy the data into BigQuery instead.</p>
<p>Okay, back to the task at hand. Set the Location to “Upload” and click the “Browse” button. Then select the “yob2019.txt” file. Change the file format to CSV. Now you need to give your table a name. Let’s call it “names_2019”.</p>
<p>You’ll notice there’s an option to automatically detect the schema and input parameters. That’s often a very handy feature because it saves you from having to enter the schema manually. Let’s see if it works with this data file.</p>
<p>It got an error. The message is a little bit cryptic, but here’s what happened. When BigQuery tries to detect the schema, it only looks at the first 100 records. In this file, the first 100 records all have ‘F’ in the second column. BigQuery assumes this means that the second column can be either an ‘F’ for “False” or a ‘T’ for “True”, so it sets this column to Boolean. When it tries to upload records with ‘M’ in that column, it gets an error because it’s expecting an ‘F’ or a ‘T’.</p>
<p>In situations like this, you have to specify the schema manually. Fortunately, it’s pretty easy in this case. First, I’ll redo everything except the schema.</p>
<p>Okay, now instead of asking it to auto-detect the schema, click “Add field”. The first field is the name, so type “name”. It’s a string, so the type is set correctly. The mode is set to “Nullable” by default, which means that this field can be empty for some records. If we wanted to make sure that no records were missing the name, then we would set the mode to “Required”. This file isn’t missing any names, but let’s leave it as Nullable anyway.</p>
<p>Now we’ll add the second field. Call it “gender”, and leave it as a string. The third field is the number of people who have this name, so call it “count”. It’s a whole number, so set the Type to “Integer”. Okay, now click “Create table”. It only takes a couple of seconds to upload all of the data into the table.</p>
<p>All right, go to the table and click on the Preview tab to see a sample of the data. That looks right. At this point, you could run queries on this table just like you did with the table in the public dataset.</p>
<p>Okay, that was all pretty easy, but remember when I said that the web interface has limitations? One big limitation is that you can only upload files that are 10 megabytes or less in size. There are lots of data files that are bigger than that. Here’s an example. It’s a 35 meg file that contains over 200,000 questions and answers from the game show, Jeopardy. You can find the URL for this file in the GitHub <a target="_blank" rel="noopener" href="https://github.com/cloudacademy/bigquery-intro">repository</a>. If you try to load it using the web interface, it’ll give you an error.</p>
<p>In cases like this, you need to use the command line. Alternatively, you could upload it to Cloud Storage first and then move it to BigQuery, but that would be a bit of a hassle, so it’s better to use the command line.</p>
<p>If you haven’t used any of Google Cloud’s command line tools yet (that is, gcloud, gsutil, kubectl, or bq), then you’ll have to install the Google Cloud SDK. The installation instructions are at this <a target="_blank" rel="noopener" href="https://cloud.google.com/sdk/docs/install">URL</a>. If you need to install the SDK, then pause this video while you do that. .</p>
<p>Okay, first you need to create a table to put data in, which we could do through the web interface again, but let’s use the command line for that too. Before we create the table, we need to have a dataset to put the table in. If we had used a more generic name for the previous dataset, instead of “babynames”, then we could have created a table for the Jeopardy data in that dataset too. Let’s not make that mistake again. What should we call it? Maybe we should put all of the data that we downloaded from the internet in it. We could call it “downloads” or something like that, but maybe we should just call it “public”.</p>
<p>The command for all BigQuery operations is “bq”. To create a dataset, type “bq”, and then “mk” for make, and then the name of the dataset, which is “public” in this case.</p>
<p>Okay, the dataset was created. Now we need to create a table. Let’s call the table “jeopardy”. There are a couple of ways to create the table. You could create an empty table and then upload the data into it or you could do it all in one step, which is usually easier.</p>
<p>To upload a file, type “bq load”, then the autodetect flag, which tells it to automatically detect the schema so you don’t have to specify the schema yourself. Then type the name of the table you want to load it into. If you haven’t set a default dataset, then you also need to specify the dataset name. In this case, you would type “public.jeopardy”. Then type the filename you want to upload, which is JEOPARDY_CSV.csv. If you’re not in the directory where the csv file resides, then you’ll have to put in the pathname to that file. It’ll take a little while to upload the file.</p>
<p>By the way, another reason to use the command line instead of the web interface is if you need to upload lots of files at the same time. With the bq command, you can put an asterisk in the filename, which will act as a wildcard and upload all matching files.</p>
<p>Let’s have a look in the web interface again to make sure the file uploaded properly. You have to refresh the page first so you can see the updates. Great, there’s the “public” dataset and there’s the “jeopardy” table. Click on the jeopardy table, and then go to the Preview tab. It looks good. Did you notice that the column names are actually descriptive? They have names like “Show Number” and “Category” instead of generic names like “string_field_0”. That’s because the first line of the csv file listed the field names.</p>
<p>On a different topic, you might be wondering why we didn’t just rename the “babynames” dataset to “public” instead of creating a new dataset. Well, that’s because you can’t rename a dataset in BigQuery. The only way to do it is to create a new dataset, copy all of the tables from the old dataset to the new dataset, and then delete the old dataset and its tables. So choose your dataset names carefully.</p>
<p>Let’s move the names_2019 table from the babynames dataset to the public dataset. Click on it, then select “Copy Table”. Now change the destination dataset to “public” and call the destination table “babynames_2019”. Click Copy. It takes a few seconds. Now click on the “babynames” dataset, and click “Delete dataset”. This will delete the dataset and all of the tables in it, so you have to type the name of the dataset before it will delete it. There, it’s done.</p>
<p>And that’s it for this lesson.</p>
<h1 id="Streaming-Data"><a href="#Streaming-Data" class="headerlink" title="Streaming Data"></a>Streaming Data</h1><p>So far, we’ve run queries on public datasets and on pre-existing data that we loaded into BigQuery. But there’s another way to get data into BigQuery – streaming, where you add data one record at a time instead of a whole table at a time. One example is if you need a real-time dashboard that gives you an up-to-the-minute (or even up-to-the-second) view of your data.</p>
<p>One common way to stream data into BigQuery is to use Cloud Dataflow, but that’s the subject of another course. You can stream data directly into BigQuery by calling the API in your software. I’ll show you an example using the API Explorer, which lets you make an API call from a nice interface in your browser.</p>
<p>Before we do that, we need to create a table to stream the data into. We should also create a new dataset because we’re not going to put public data in the table, so the public dataset isn’t the right place to put it. Let’s call it “streaming”. Now create the table. This time, we’re going to leave it as “Empty table” because we’re not loading any data into it right now. Let’s call the table “stream”.</p>
<p>For the schema, we could put in pretty much anything, since we’re just going to stream some test data, but let’s have at least two fields. Create a string field called “greeting” and a string field called “target”. And click “Create table”.</p>
<p>Okay, now we’ll go to the BigQuery API documentation. The URL is in the GitHub repository for this course. We’re going to use the “tabledata.insertAll” method to stream data into the table.</p>
<p>On the right-hand side is a form you can fill out to call the API. First, put in your project ID (which will be different from mine, of course). You can get your project ID from BigQuery. Then put in “streaming” for the datasetId, and “stream” for the tableId.</p>
<p>Now, in the “Request body” text box, click the plus sign and select “rows”. This saves you from having to type in everything yourself. It’s especially helpful with the brackets because we’re going to have quite a few nested brackets in a minute. Now click the plus sign under “rows” and select “[Add Item]”. It put in a couple more brackets. Then click the plus sign between those and select “json”.</p>
<p>Now we finally need to type something. This is where we say what data we want to put in the row we’re adding to the table. If you’ll recall, the first field is called “greeting”, so type that between quotes after the curly bracket. Then type colon quote Hello quote comma. Hit Enter. We called the second field “target”, so type quote target quote colon quote world quote.</p>
<p>All right, that’s a complete record, so the request body is complete. It added a bunch of junk at the bottom for some reason, so just delete those lines. Good, the errors went away.</p>
<p>Now click the “Execute” button. Okay, the return code is 200 and it’s colored green, which means the API call was successful. It also didn’t return an error, so it looks like it worked. Let’s see.</p>
<p>Go back to the BigQuery page and click on the “stream” table. Click the “Preview” tab. Great, there’s our “Hello world” message that we just sent.</p>
<p>Although that was a quick way to show you how streaming works, you likely won’t be calling the API directly when you write your own streaming code. Instead, you should use the BigQuery client libraries. </p>
<p>Google provides client libraries for C#, Go, Java, Node.js, PHP, Python, and Ruby. There’s a different way of doing a streaming insert for each language, but it’s easier than writing the API call yourself. If you need to write code to stream data into BigQuery, have a look at the documentation for your language.</p>
<p>Oh, and one more thing. Remember in the pricing lesson when I said that there’s a separate charge for streaming? Well, it’s 5 cents per GB to do streaming inserts. That actually makes it the most expensive BigQuery operation. Loading data in any other way is free, querying data costs half a cent per gig, and storing data costs 2 cents per gig, at most. But if you need to do up-to-the-minute analysis of streaming data, then 5 cents a gig is still pretty cheap.</p>
<p>And that’s it for this lesson. </p>
<h1 id="Exporting-Data"><a href="#Exporting-Data" class="headerlink" title="Exporting Data"></a>Exporting Data</h1><p>Sometimes you need to export data from BigQuery, such as when you want to use third-party tools on the data. Exporting is pretty easy, but there is only one place you can export the data to and that’s Cloud Storage. So if you want to export data anywhere else, you have to export it to Cloud Storage first, and then download it from there.</p>
<p>Let’s do that with the babynames data. Click the table name, then select “Export to GCS” from the “Export” menu. It supports CSV, JSON, and Avro formats. Just for something different, let’s select JSON. Then you can choose whether to compress it or not. GZIP is the only compression option. This is a pretty small file, so let’s not bother compressing it.</p>
<p>Now you need to specify the Cloud Storage location where you want to save the file. I’ll put it in my ca-example bucket, but you’ll have to put it somewhere else, of course. Make sure you have write access to whatever bucket you specify. You also have to put in the filename. I’ll call it babynames_2019.json. Then click the Select button…and the Export button.</p>
<p>It tells you that it started an export job. It doesn’t take long to finish. Now if we go to the Cloud Storage bucket, we can see that the file was created. If you click on the filename, you can download it to your computer.</p>
<p>Now if you open it up, you’ll see the data in JSON format, which looks far different from the CSV file we originally uploaded into the table.</p>
<p>If you want to see a history of the exports you’ve done, click on Job History. If you click on one of the jobs in the list, it’ll give you more detail. Notice that it also lists other types of jobs, such as when we loaded the data originally. You can even re-run a load job from here if you want.</p>
<p>You can also use the bq command to run an export job, but the option is called “extract” rather than “export”. That is, you use the “bq extract” command.</p>
<p>As you’ve seen, exports are quite straightforward, but they get a little more complicated if you need to export more than a gig of data. Here, I’ll show you what happens. Take a look at the games_wide table in the baseball dataset. It’s 1.76 gig. I’ll try to export it, and I’ll even compress it, so hopefully the exported file will be less than one gig. </p>
<p>It gives us an error. It says that it’s “too large to be exported to a single file. Specify a uri including a * to shard export.” That second sentence is a little cryptic, isn’t it? What it means is you have to include a wildcard so it knows to export the data in multiple files.</p>
<p>Here’s how to do that. I’ll export it again, and this time, I’ll put an asterisk after “games”. You can put the wildcard anywhere in the path except for the bucket name, but putting it just before the first file extension is usually the best place to put it as you’ll see in a second.</p>
<p>It’s running this time, which is a good sign. It’ll take a lot longer, so I’ll fast forward. Now it’s done, so if I go back to Cloud Storage, you’ll see two new files with long numbers in them. BigQuery simply appends numbers starting from 0 and goes up by one for every file, but it puts in 12 digits with all zeros at the beginning, just in case it needs to split the data into a lot of files.</p>
<p>Also notice that the sum of those two files is nowhere near one gig. It’s less than a hundred meg. That’s because BigQuery looks at the size of the source data rather than estimating the size of the destination file when it decides whether you have to split it into multiple files or not.</p>
<p>Okay, if you don’t want to incur ongoing storage charges for the data you’ve saved in this course, then you should remove it. First, delete the files you exported to Cloud Storage. Select all three files, and then click “Delete”. Now go back to BigQuery, and delete the public dataset you created. You have to type “public” to confirm the deletion. Then delete the streaming dataset. There, now everything you loaded or exported in this course should be gone.</p>
<p>And that’s it for this lesson.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>I hope you enjoyed learning how to use BigQuery. Now you know how to load data, run queries and save the results, stream data one record at a time, and export data. Let’s do a quick review of what you learned.</p>
<p>BigQuery’s advantages over on-premises databases are ease of implementation and speed.</p>
<p>If you want to import data that’s already in another Google service, then there’s usually a way to get it into BigQuery, although sometimes it requires an intermediate step. It’s also possible to query data in certain Google services without importing it into BigQuery. However, the performance is usually slower when you query an external data source than if the data resides in BigQuery storage.</p>
<p>If your data isn’t in a Google service, then you can upload it to BigQuery through the web interface, the command line, or the API. One limitation of the web interface is that it can only upload files that are 10 megabytes or less in size. The command-line tool for all BigQuery operations is “bq”.</p>
<p>When you’re uploading data, BigQuery includes an option to automatically detect its schema, but it doesn’t always work, so you may have to specify the schema manually.</p>
<p>Another way to get data into BigQuery is streaming, where you add data one record at a time instead of a whole table at a time. This is most useful for real-time applications. Although there’s no cost to upload data to BigQuery in bulk, it does cost money to stream data into BigQuery. To add streaming code to your applications, it’s easiest to use Google’s BigQuery client libraries, which are available for many different languages.</p>
<p>BigQuery stores data in tables, and each table must be part of a dataset. You can’t rename a dataset in BigQuery.</p>
<p>When you run a query, if you don’t specify a destination table, it puts the results in a temporary table. This temporary table stays in cache for about a day. So if you run the query again within 24 hours, it’ll retrieve the cached copy, and you won’t be charged for the query.</p>
<p>Cloud Storage is the only place where you can export data from BigQuery. If you need to export more than one gig of data, then you have to shard the data into multiple files by including an asterisk in the destination filename. You can also use an asterisk when you’re uploading files.</p>
<p>To learn more about BigQuery, you can read Google’s online documentation. You can also try one of the other BigQuery courses on Cloud Academy.</p>
<p>Please give this course a rating, and if you have any questions or comments, please let us know. Thanks!</p>
<h1 id="5Loading-Data"><a href="#5Loading-Data" class="headerlink" title="5Loading Data"></a>5<strong>Loading Data</strong></h1><p><a target="_blank" rel="noopener" href="https://github.com/cloudacademy/bigquery-intro">Course GitHub repository</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.google.com/sdk/docs/install">Google Cloud SDK Installation Instructions</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Run-SQL-Queries-and-Analyze-Data-with-Google-Cloud-SQL-23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Run-SQL-Queries-and-Analyze-Data-with-Google-Cloud-SQL-23/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Run-SQL-Queries-and-Analyze-Data-with-Google-Cloud-SQL-23</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:08" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:08-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:56:52" itemprop="dateModified" datetime="2022-11-22T20:56:52-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Run-SQL-Queries-and-Analyze-Data-with-Google-Cloud-SQL-23/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Run-SQL-Queries-and-Analyze-Data-with-Google-Cloud-SQL-23/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Configuring-GCP-Access-and-Security-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Configuring-GCP-Access-and-Security-22/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Configuring-GCP-Access-and-Security-22</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:06" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:06-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:52:26" itemprop="dateModified" datetime="2022-11-22T20:52:26-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Configuring-GCP-Access-and-Security-22/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Configuring-GCP-Access-and-Security-22/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello, and welcome to “Configuring GCP Access and Security”. My name is Daniel Mease and I am a trainer at Cloud Academy. This course was developed by Abhishek Gupta who has over 10 years of experience in the domains of high-performance computing, cloud, and security.</p>
<p>This course is intended for cloud administrators. If you are a cloud security practitioner or are involved in any sort of development with GCP, you will also benefit from taking this course.</p>
<p>At a high level, we’ll cover the following topics. After this introduction, I will dive into how you can manage identity and access management in GCP. Then, you will learn about service accounts, what they mean, and how you can manage them. Next, I will talk about audit logs and how to review those. And finally, I will summarize the key learning objectives.</p>
<p>Feedback on our courses is valuable, both to us as trainers and our future students. If you have any criticisms or suggestions for improvement, we would greatly appreciate it if you would share those with us.</p>
<p>Please note that, when this video was recorded, all course information was accurate. Google is constantly updating its services as part of its ongoing drive to innovate. As a result, over time, minor discrepancies may appear in the course content. Here at Cloud Academy, we strive to keep our content up to date in order to provide the best training available. </p>
<p>So, if you notice any information that is outdated, please contact <a href="mailto:&#x73;&#x75;&#112;&#112;&#x6f;&#114;&#x74;&#x40;&#x63;&#x6c;&#x6f;&#117;&#100;&#97;&#x63;&#97;&#100;&#101;&#109;&#121;&#x2e;&#x63;&#x6f;&#109;">&#x73;&#x75;&#112;&#112;&#x6f;&#114;&#x74;&#x40;&#x63;&#x6c;&#x6f;&#117;&#100;&#97;&#x63;&#97;&#100;&#101;&#109;&#121;&#x2e;&#x63;&#x6f;&#109;</a>. This will allow us to make all necessary fixes to the course during its next release cycle.</p>
<h1 id="Cloud-IAM"><a href="#Cloud-IAM" class="headerlink" title="Cloud IAM"></a>Cloud IAM</h1><p>In this lecture, you will learn the basics of identity and access management in Google Cloud. I will also cover some best practices on how to apply IAM to a GCP project. </p>
<p>When it comes to security, you typically do not want every employee to have the same level of access to every resource. For example, you probably want your system administrators to be able to create and delete virtual machines. However, your developers should probably stick to using the existing ones. Your developers <em>will</em> edit access to your code repository, but not your testers. Each role requires a different set of permissions. When running your workloads in the cloud, you need a way to effectively manage access to all your resources.</p>
<p>Google Cloud IAM (which stands for Identity and Access Management) is a managed service used to enforce security for your GCP resources. Cloud IAM offers a single dashboard where you can view the different identities and the associated access levels. IAM also presents a consistent interface that applies to many GCP services: including Compute Engine, App Engine, Kubernetes Engine, and Cloud Storage. You do not have to maintain separate access control mechanisms for each individual service.</p>
<p>In order to provide the most flexibility, GCP resources are organized into a hierarchy. With IAM, any policies applied at a higher level will automatically propagate down as well. So a policy applied at the organization level will also affect the underlying folders, projects, and resources. If you want to limit a policy to the project level, you can easily do that. And, in some cases, you can also apply policies directly to a specific resource. This makes it easy to create project, department, or company-wide protections. While also giving you the flexibility to override or extend them in certain cases.</p>
<p>At the very top, is the organization level. This is where you can apply policies to make them apply to the entire company. </p>
<p>The next level down is folders. Having this level is actually optional. But the most common structure is to have a separate folder for each department in your organization. You can also add subfolders to represent different teams or projects as well.</p>
<p>Under folders is the project level. All of your resources must be assigned to a project. A project is used to group related cloud resources together. They are also used to isolate groups of resources for security and billing purposes. Projects are commonly used to represent team projects or even individual applications. IAM policies directly applied to one project do not affect the resources in another.</p>
<p>For example, a user can be granted full access to the resources in Project A, but have limited or no access to the resources in Project B. This is a good way to prevent one team from affecting the resources used by another team (either intentionally or inadvertently). For fine-grained control, you can also apply IAM policies on individual resources themselves (such as cloud storage buckets or Kubernetes containers). </p>
<p>These security controls are all built around the core principle of “least privilege”. The main idea is to limit the permissions of your users and applications to be as small as possible. Ideally, you give each piece just enough power to do its job, and no more. </p>
<p>By using Cloud IAM, you can enforce strong platform security and be certain that only authorized users are accessing your resources.</p>
<h1 id="Cloud-IAM-Demo"><a href="#Cloud-IAM-Demo" class="headerlink" title="Cloud IAM Demo"></a>Cloud IAM Demo</h1><p>In this lesson, you are going to get a practical demonstration on how to use Cloud IAM.</p>
<p>You will notice that for this demo, I am using the “Daniel-Sandbox” project under the “CloudAcademy.com” organization. So first off, to access the IAM dashboard, you can use the navigation menu. Just click on “IAM &amp; Admin”. Or you could also search for “IAM &amp; Admin” in the search bar like this.</p>
<p>Now on the left-hand side, you will see several menu items including “IAM”, “Service Accounts”, and “Roles”. Let’s look at the IAM page first. Here you can see the project principals and roles. The principal list contains all the principals (or accounts) that currently have access to this project. Basically, this is mostly going to be a list of users. This particular entry represents my account. You can use this page to create or delete accounts. So if I wanted to give access to another person, I can add them here.</p>
<p>The role list shows the roles that are assigned to accounts. Basically, roles are groups of permissions. So here if I expand this “Owners” entry, you can see that my user account is currently assigned the owner role. Roles define what an account is allowed to do.</p>
<p>So, the basic idea is that you create accounts under “principals” and then you can grant sets of permissions to those accounts by assigning one or more “roles”. The owner role means I can pretty much do whatever I want. I can add, delete, change or access almost anything. An owner role is great for starting out because it allows you to build whatever you want without restrictions. However, you do not want every user to be an “owner”. That would violate the principle of least privilege. Instead, users should use smaller roles with far more limited permissions. Not everyone needs to be able to change everything.</p>
<p>I am currently only using a couple of roles in this project, but there are many more available to choose from. You can get the full list by clicking on “Roles” in the side menu here. Currently, I have over 900 to choose from.</p>
<p>While some roles have a lot of permissions (like owner), most roles have only a small handful. In fact, most roles are specific to a particular service. For example, if I filter for “App Engine”, you can see that there are several roles specifically for working with App Engine. If a user was only assigned this “App Engine Code Viewer”, then they will only be able to “view App Engine app status and deployed source code”. That’s it. Basically, it’s a “look but not touch” rule. They won’t be able to create, delete or modify App Engine applications. Also, they won’t be able access any of the other services as well. By default, a user has no permissions. In order to do anything, you need to be granted permissions via roles. So as you can see, roles can be used to provide very large or very small sets of permissions to each user.</p>
<p>If you look here, you can see the permissions associated with this role. Each of these permissions is extremely specific. For example, this permission called “resourcemanager.projects.list” gives the user the ability to get a list of all projects. Without this permission, you wouldn’t be able to pick a project when logging in, since you couldn’t know which projects exist. This other permission “resourcemanager.projects.get” allows you to get more information about a specific project. </p>
<p>Each role is comprised of many different permissions. And the reason you assign roles to principals instead of directly assigning permissions is because to do anything useful you need many different permissions. It would be a lot of extra work to have to assign each permission individually. So instead, you have roles which provide common groups of permissions. And then assign one or more roles to your principals.</p>
<p>You can use the Google default roles listed here, or you can also create your own custom roles as well. Roles allow you to assign hundreds or thousands of permissions, quickly and accurately.</p>
<p>So now that you understand the theory behind principals and roles, it’s time to give you a practical example. I am going to add a new user and assign it a few roles. To add a new user, click on “IAM” in the side menu and then click on the “Add” button here. The form is pretty simple. First, you need to enter the individual’s email addresses. And then you can pick the roles you wish to assign. </p>
<p>So first, I am going to select the “Basic Viewer” role. This will provide read-only access to all the resources in this project. So this new user will at least be able to look at everything. Now I also want this user to be able to make some changes to App Engine. So I can add another role by clicking here. Now for this role, I will select “App Engine Creator”. This will allow this user to be able to create new App Engine applications. And once I click “save”, the user will be created and assigned the selected roles. </p>
<p>And there you go. I have created a new user account. Now, an email will be sent to the “testuser1” email address and it will include instructions for how to log in and access the project. </p>
<p>Now, this process works great for adding one user at a time. But what if you need to add hundreds or thousands of users? Using this technique would be extremely tedious. Luckily, there is a way to add many users at once. The trick here is to use Google Groups. A Google Group allows you to assign many different email addresses to a group email address. And you can use that group email address to create accounts for all the associated users. Let me show you how to do that.</p>
<p>So I’ll bring up Google Groups and you can take a look at the groups that I have already set up. For this demo, I have created a group called “IAM Demo Group”. Now I just have a single user assigned to the group, but you could add as many as you want. And I can now use this group email address and to create a new account on the IAM page. </p>
<p>Instead of creating a single account, this will actually create separate accounts for each user in the group. And any roles I pick here will be assigned to every account in the group as well. You might make a Google Group for all your developers, and then another group for all your testers, and a third group for your security team. Each member of the group will have the exact same permissions, so you wouldn’t want to create a single group with all employees in it.</p>
<p>Speaking of roles, it is helpful to know that they are categorized into three types: Basic, Predefined, and Custom. Basic roles provide large sets of permissions. The “owner” role is a good example. Assigning the “owner” role gives full access to all resources in a project. There are other basic roles as well including “viewer” (which allows you to view the current state of your resources, but not change them) and “editor” (which allows you to create and edit resources but does not include things such as modifying billing or adding new users).</p>
<p>Now, in addition to “basic” roles, there are also “predefined” roles. Predefined roles are much smaller sets of permissions. For example, “App Engine Code Viewer” is an example of a predefined role. Predefined roles allow you to assign granular sets of permissions to your users. While it might seem easier at first to just give everyone Editor or Owner level access, remember that would allow anyone to change anything. Do you really want a tester to be able to break production? Using predefined roles instead of basic roles is a security best practice.</p>
<p>The third type is the custom role. A custom role allows you to pick the exact permissions you want to assign to a user. You can combine several different predefined roles into a new role, or create a completely unique role from scratch. Let me show you how to do that.</p>
<p>First, click on “Roles” from the side menu, you can then click on “create role”. Let’s call this custom role “IAM Demo Role”. You can also add a description if you want. And then you need to specify a unique ID for this role. I will call this “ca_iam_demo_role”. </p>
<p>Next, you need to select a launch stage. This setting is mostly informational. It allows you to keep track of whether a new role has been sufficiently tested and is ready for widespread use. Normally you would start out in “Alpha”. After some initial testing, you could update the launch phase to “Beta” to signify that the role could be used for more extensive tests. Once you are finally certain that the role is ready for general use, you should then set the stage to “General Availability”. You also can set the launch stage to “Disabled” which means that granting this role to an account will have no effect. So I am going to follow best practices and set this to “Alpha”.</p>
<p>Finally, I can add permissions to the role. I just need to click on the “Add Permissions” button here. And now I get the entire list of all permissions. You can see that there are quite a few available. It looks like I have almost 5000. Because there are so many, Google has provided this filter. You can use it to list out the permissions associated with any existing roles. So let’s say I am interested in adding “Compute” Engine-related permissions. I can search for “Compute” and then select “Compute Viewer”. And this will list out the permissions assigned to that role. From here, I can then select the specific ones I want to add to my new custom role. I can search for other roles and grab permissions from there as well. Or I can directly pick permissions from the main list.</p>
<p>Once I am done, I just have to click on the “Create” button to confirm. Now, this new custom role will be added to my total list of roles, and I can assign it to a new or existing user. So let me add the role to my test user account. And there we go.</p>
<p>At this point, you should understand the difference between principals and roles. You also should know how to create a user, create a role, and assign roles to users.</p>
<h1 id="Managing-Service-Accounts"><a href="#Managing-Service-Accounts" class="headerlink" title="Managing Service Accounts"></a>Managing Service Accounts</h1><p>In this lesson, I am going to teach you what a service account is, and show you how to use them in a GCP project.</p>
<p>A service account is very similar to a user account. Both are used to control access to different GCP resources. However, the main difference between the two is that people use user accounts, while computers use service accounts. So if <em>you</em> wanted to write out a file to Cloud Storage, you would need access to a valid user account. If a piece of software wanted to write a file out to Cloud Storage, then it would need to use a valid service account.</p>
<p>It is a very common scenario to want something like a virtual machine or a container to be able to access other GCP resources. Maybe it needs to call an API or pull some data from a database. In order to do that, it needs to be able to authenticate with a trusted service account, and that service account also needs to be authorized by having the correct permissions. </p>
<p>So service accounts and user accounts seem almost identical. But there are differences. For example, service accounts do not have email addresses associated with them. Also, they do not have passwords. Instead, they use RSA key pairs. However, they generally act like and are managed very similarly to user accounts. You create and assign them roles in much the same way.</p>
<p>By creating and assigning service accounts, you can ensure that unauthorized programs cannot access your GCP resources. This also allows you to keep your different environments separate as well. For example, you make sure your test systems cannot connect to your production systems, and you can easily control whether Team A can access the resources of Team B.</p>
<h1 id="Service-Accounts-Demo"><a href="#Service-Accounts-Demo" class="headerlink" title="Service Accounts Demo"></a>Service Accounts Demo</h1><p>So now, I am going to show you how to manage service accounts from the GCP console. First, I will create a new service account and assign it a role. And then, I will show you how to associate the service account with a virtual machine. </p>
<p>To work with service accounts, first head to the “IAM &amp; Admin” page. Then click on “Service accounts” in the side menu here. As you can see, I have a few default service accounts already. I have one for Compute Engine. This is the service account that will be used by default when launching a VM. I also have a default service account for App Engine as well. These default service accounts are used to provide a basic set of permissions. For simple projects, these default accounts work fine. But more advanced solutions will probably require extra permissions which will often require creating a new service account.</p>
<p>So let me show you how to do that. To start, click on “Create Service Account”. Then enter a name. You will notice that it will automatically generate a service account ID for you (which ends up looking like an email address). Then you can enter a description, but it is optional. </p>
<p>So at this point, you can click “Done” and it will create a service account with no permissions. If you want to also assign some roles to the service account, you can instead click “Create and Continue”. Assigning roles to service accounts works much the same way as it does for user accounts. You can scroll through all the roles, or you can do a search. Let’s say I want to make sure this account can read files from Cloud Storage. So I’ll pick “Storage Object Viewer”. After I am done picking roles, I can pick “Done”, Or I could click on “Continue” to go on to the next optional step. This last step will allow you to grant users access to this service account. This is a more advanced feature, so I am going to skip it. And I will click on “Done” to finish.</p>
<p>Now that I’ve created the service account, let me show you how to actually use it. I am going to create a new VM and assign this service account to it. Then the VM will inherit all the associated permissions. </p>
<p>So I’ll go to Compute Engine and click on “Create Instance”. Let me call this “demo-vm1”. And if I scroll down, you’ll see that it has the default account selected. I am going to change that to use the service account I just created. Now I just need to confirm the creation of the VM. And we will have to wait a little bit for this to complete. Ok it should be done.</p>
<p>Let me verify that the correct service account was assigned. There we go. Now you know how to assign a service account to a virtual machine.</p>
<p>So what if you forget to change the service account while creating a VM? Or what if you need to change it later? Well don’t worry. That is actually pretty easy. </p>
<p>To do that, you first need to make sure the VM is not running. So I’ll go ahead and stop it. Now I can edit the VM and change the service account down here. I just need to save and restart the VM for the change to take effect.</p>
<p>As you saw previously, service accounts are not just for Compute Engine. You also use service accounts for other things like App Engine and Google Kubernetes Engine. Basically anytime you have an app or service that needs to access a GCP resource. </p>
<p>Service accounts give you a lot of flexibility. One of the cool things you can do with service accounts is to use them across projects. For example, you can use a service account to access resources in project B from a VM in project A.</p>
<p>So now you should understand what a service account is and how to create one. You also should know the difference between a service account and a user account, and when to use one versus the other.</p>
<h1 id="Audit-Logs"><a href="#Audit-Logs" class="headerlink" title="Audit Logs"></a>Audit Logs</h1><p>In this lecture, I am going to cover the basics of audit logs in Google Cloud Platform.</p>
<p>Normally, in a production environment, there are many different users, applications, and resources. All these components are constantly interacting with each other. So what happens when something goes wrong? What if a VM is deleted and you want to know who did it? What if you are denied access to a resource that you should be authorized to manage? With so many things happening at once, it can be almost impossible to figure out what went wrong without having detailed logs.</p>
<p>Google Cloud services maintain audit logs that record all activity and access to your GCP resources. They contain records of all critical events in your system and help answer questions such as: Which resource was accessed? Who accessed the resource? What action was attempted? When did the attempt occur?</p>
<p>There can be hundreds, thousands, or even millions of operations going on in a production environment. That is why Google provides scalable logging and searching tools, all accessible from a single, easy-to-use dashboard. Now because the audit logs are tracking and recording so many different things, they are broken up into four main categories: </p>
<ol>
<li>Admin Activity</li>
<li>Data Access </li>
<li>System Event</li>
<li>Policy Denied</li>
</ol>
<p>Admin Activity audit logs record any attempts to create, delete or modify your resources. So an example would be provisioning a new Cloud SQL database. Data Access audit logs contain entries for reading or writing data to your resources. So this would be something like reading from or writing data to a Cloud SQL database. System Event audit logs contain entries for Google-initiated actions. These are actions that are triggered by Google that modify the configuration of your resources. System event logs can help you identify if the problem exists in your systems or in Google’s.</p>
<p>Policy Denied audit logs record every time a user or service account is denied access to a resource. You can use these logs to investigate suspicious activity or identify potential issues. All four of these audit logs will help you protect your data and prevent system misuse.</p>
<h1 id="Audit-Logs-Demo"><a href="#Audit-Logs-Demo" class="headerlink" title="Audit Logs Demo"></a>Audit Logs Demo</h1><p>Now let me show you how to access the audit logs for your GCP project. The service that provides this interface is called Google Cloud Operations suite. Operations suite includes a centralized logging interface where you can view the various types of logs from different services in GCP in a single place. </p>
<p>To get to the interface, you can use the navigation menu or search for “Logging”. Here you can see all the different logs. You can filter the logs using these dropdown menus here. You can filter by resource. You can filter by log name. Or you can filter by the severity of error. When you find the logs that you are interested in, you can click this icon to zoom in. You can scroll through the various entries and expand the different sections to read the details.</p>
<p>By default, it will only return entries made in the last hour, but you can change that as well. Just click down here on “Edit time”. And then you can set the time period for the records you are interested in. Here I am selecting records from the last 7 days. So you can see that you have lots of options for finding exactly the records you are interested in. </p>
<p>Now another way to view activity is available from the main console. So if I return to the main screen, and then click on the “Activity” tab here. You can get a simplified summary of the activity logs. You see the abbreviated versions of the same entries as in the log explorer, such as stopping and starting of VMs. You can also see entries for activities like creating and deleting service accounts, setting IAM policies, and so on.</p>
<p>There are filter options on this screen as well. You can filter by country. You can filter by activity type. So I can just show billing-related entries. And then I can also add configuration changes. And you can also filter on resource types, such as specific services like VMs.</p>
<p>So now you know how to find and read the logs. Google Cloud Operations suite makes it easy to search and find the events you are interested in to assist with both troubleshooting and auditing your system.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>Congratulations, you’ve made it to the end of this course. Let’s review the key takeaways before wrapping things up. </p>
<p>First, I talked about how Google Cloud Identity and Access Management (also known as IAM) provides you an easy way to manage your user accounts. You can create custom roles, or use the existing ones to maintain property security access to your cloud resources.</p>
<p>Second, I talked about service accounts. Service accounts offer a way to assign identities to non-humans, such as virtual machines and cloud applications. You saw how to create, manage, and assign service accounts to a virtual machine.</p>
<p>Finally, I covered audit logs. Centralized audit logs are critical for security and event management in the cloud. Google Cloud Operations suite provides a complete picture of everything happening all in a single dashboard. </p>
<p>Well, that’s all I have for you today. Remember to give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching, and make sure to check out our many other courses on Cloud Academy!</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Build-and-Deploy-a-Container-Application-with-Google-Cloud-Run-21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Build-and-Deploy-a-Container-Application-with-Google-Cloud-Run-21/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Build-and-Deploy-a-Container-Application-with-Google-Cloud-Run-21</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:05" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:05-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:54:18" itemprop="dateModified" datetime="2022-11-22T20:54:18-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Build-and-Deploy-a-Container-Application-with-Google-Cloud-Run-21/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Build-and-Deploy-a-Container-Application-with-Google-Cloud-Run-21/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Respond-to-Events-with-Google-Cloud-Functions-20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Respond-to-Events-with-Google-Cloud-Functions-20/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Respond-to-Events-with-Google-Cloud-Functions-20</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:03" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:03-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:57:12" itemprop="dateModified" datetime="2022-11-22T20:57:12-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Respond-to-Events-with-Google-Cloud-Functions-20/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Respond-to-Events-with-Google-Cloud-Functions-20/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Deploying-a-Google-Cloud-Marketplace-Solution-19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Deploying-a-Google-Cloud-Marketplace-Solution-19/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Deploying-a-Google-Cloud-Marketplace-Solution-19</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:02" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:02-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:53:00" itemprop="dateModified" datetime="2022-11-22T20:53:00-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Deploying-a-Google-Cloud-Marketplace-Solution-19/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Deploying-a-Google-Cloud-Marketplace-Solution-19/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to “Deploying a Google Cloud Marketplace Solution”. My name is Daniel Mease and I’ll be taking you through this course. I am a trainer at Cloud Academy with over 20 years of software and web development experience.</p>
<p>This course is intended for:</p>
<ul>
<li>Google Cloud Platform users</li>
<li>Anyone preparing for a Google Cloud certification</li>
</ul>
<p>Upon completing this course, you will learn:</p>
<ul>
<li>What Google Cloud Marketplace is</li>
<li>How to browse the catalog</li>
<li>How to deploy a solution</li>
</ul>
<p>The following prerequisites will be helpful for completing this course:</p>
<ul>
<li>Access to a GCP account</li>
</ul>
<p>Feedback on our courses is valuable, both to us as trainers and our future students. If you have any criticisms or suggestions for improvement, we would greatly appreciate it if you would share those with us.</p>
<p>Please note that, when this video was recorded, all course information was accurate. Google is constantly updating its products and services as part of its ongoing drive to innovate. As a result, over time, minor discrepancies may appear. Here at Cloud Academy, we strive to keep our content up to date in order to provide the best training available.</p>
<p>So, if you notice any information that is outdated, please contact <a href="mailto:&#x73;&#x75;&#112;&#112;&#111;&#x72;&#x74;&#64;&#99;&#108;&#x6f;&#x75;&#100;&#97;&#x63;&#x61;&#x64;&#x65;&#x6d;&#121;&#46;&#x63;&#x6f;&#x6d;">&#x73;&#x75;&#112;&#112;&#111;&#x72;&#x74;&#64;&#99;&#108;&#x6f;&#x75;&#100;&#97;&#x63;&#x61;&#x64;&#x65;&#x6d;&#121;&#46;&#x63;&#x6f;&#x6d;</a>. This will allow us to make all necessary fixes to the course during its next release cycle.</p>
<h1 id="Discovery-and-Installation"><a href="#Discovery-and-Installation" class="headerlink" title="Discovery and Installation"></a>Discovery and Installation</h1><p>Google Cloud Platform is extremely powerful. You can use it to build almost anything you can imagine. But not every problem requires some crazy, custom solution. In fact, most of the time, there is already a commercial or open-source software package that can meet your needs.</p>
<p>Luckily, Google has provided an easy way to deploy many common applications to the cloud. The Google Cloud Marketplace provides a wide array of software packages to choose from. You can browse through the catalog, pick something you like, and deploy it all with the click of a few keys.</p>
<p>Marketplace requires a lot less expertise to use. You do not have to mess with manually provisioning compute resources or trying to figure out how to download, install and configure the right software packages. Instead, Cloud Marketplace makes it simple. Just pick the package you want, review the estimated costs, and then click on “Launch” .</p>
<p>Let me show you how easy the Marketplace is to use. To start, you need to log into the GCP console. Then you want to search for “Marketplace” and click on the link. This will take you to the main catalog page. From here, you can scroll down to browse the catalog. This will contain all the software that is available. You can also search for a particular product by typing in its name here. Or you can use the side menu here; you can filter by categories. </p>
<p>You can deploy an operating system such as Linux or Windows. There are popular databases to choose from including mySQL and MongoDB. They even offer popular blogging and Content Management Systems like WordPress and Drupal. And there is much, much more.</p>
<p>You will notice that there can be multiple matches for a particular piece of software. Sometimes these represent different versions. But the other main reason is because these packages have different “types”. The types include Virtual Machines, SaaS &amp; APIs, Kubernetes apps, and Container images.</p>
<p>Let me explain what each one is:</p>
<p>A “Virtual machine” type means that this solution is going to provision a Virtual Machine on Compute Engine. A “Kubernetes app” will deploy an application to a GKE cluster. You need to understand the differences because it is going to affect your costs as well and how you need to maintain it.</p>
<p>APIs and Containers are a little different. An API won’t actually install anything. Instead, it is simply going to grant you access to a service offered by another company. Typically, these are not free and they will require a subscription. </p>
<p>Containers will not install anything directly. Instead, these are just a safe and verified container image that you can use to deploy yourself. These are great if you want to deploy to Cloud Run or App Engine. But you can also use these to install to an existing GKE cluster or even Compute Engine VM if you want.</p>
<p>So, if you are looking for a simple “click to deploy” solution, you will want to choose either a Virtual Machine or a Kubernetes App. If you don’t want to install anything at all, but instead need access to a third party service, then pick a Saas or API. If you want to install something but you want to set it up yourself, then you can pick a Container.</p>
<p>So now it’s time to run through a real demonstration. First, I am going to show you how to install Drupal using a Virtual machine. I just need to search for the name here. And then I need to be sure to pick the correct type. Note that this is going to create a single VM on Compute Engine. There are additional details listed here as well, including the version number, operating system and any included packages. You always should review this information and verify that you are picking the right package.</p>
<p>You also probably want to scroll down or click on the “Pricing tab” to review any estimated costs. Note that while Drupal itself is free to use, the VM it will be running on is not. So if I accept the defaults, I can assume it will cost me about $50 a month. If I change the machine type or if I don’t run the VM 24 hours a day, 7 days a week, the final cost will be different.</p>
<p>If you scroll down a little further, you can see the support information as well as the terms of service. After you have carefully reviewed all the details and you have decided you wish to proceed, scroll up and click on “Launch”.</p>
<p>The first step during installation is to verify that you have the required APIs enabled. If some are still disabled, then it will tell you which ones. You can click on the API to get more information about what it does. Once you are satisfied, click on “Enable” to continue.</p>
<p>Next you will be presented with a form that lets you override any of the default values. Here I can pick a different name for my VM. I can change the zone. Here I can modify the machine type. If I need a more powerful CPU or need more memory, I can do that. Remember, this will affect the cost. I can also increase or decrease my disk size. You can customize networking and firewall rules here. And you can also decide if you want to enable logging and monitoring. You don’t need to change anything. But you do need to accept the Terms of Service before you can click on Deploy.</p>
<p>At this point. the Deployment Manager will start executing the deployment template. You can see there are several steps involved. You might have to wait a while for everything to finish. Once installation is finally complete, you will get a summary here on the right. We can see the site address for my new Drupal installation. And it does appear to be working. It also gives a bunch of other stuff I will need to use my new website. We also have some next steps and further documentation.</p>
<p>So now I should be able to jump over to the Compute Engine page and see my new VM. And here it is. Now I can manage this just like any other Virtual Machine. I can make changes. I can start and restart it. Whatever I want. However, if I wanted to delete this, the best way is probably to go back to the Deployment Manager screen and do it from there. By removing it from the Deployment Manager, this will ensure that everything that was installed (including VMs, load balancers and disks) will get cleaned up. Alright, there we go. The VM is now gone and the Drupal install has been completely removed.</p>
<p>I also want to show you how to install a Kubernetes app. Now this is similar to installing a virtual machine, but there are a few differences. So you have to select your product. Review the details. Make sure to verify the version number and ensure that you aren’t going to accidentally install an old version. Now, one of the main differences from a Virtual machine is pricing. Remember, Drupal does not cost anything but the cluster it needs to run on will. Here we are not going to see a price estimate, because it will depend on the size and type of your cluster.</p>
<p>Once you are ready, scroll up and click on “Configure”. It will quickly verify my APIs. And if everything is good, it will display this form. Since this is a Kubernetes app, I must select a cluster. I can also create a brand new one if I wish. Once you have the cluster set, then you can choose a namespace, app name, storage class and size. Or you can just accept all the defaults. Here are some other options for making the instance publicly accessible or enabling metrics. And once again, if you want to proceed you have to accept the Terms of Service. Once you get everything the way you want, just click on “Deploy”.</p>
<p>Creating a cluster and deploying to a cluster both take a long time. So you will probably have to wait a while. However once it is complete, you can review the details. Once again, we see the URL for the new Drupal site, along with any generated accounts and passwords. And if you scroll down, you can review all the components that were added. Also note that there is more documentation on the right. You are going to want to make sure you view this, because it can help troubleshoot any issues. For example, if I click on the site address I get an error. But luckily that is already explained if you look over here. It says I need to update the certificate for HTTPS to work. However, in this case, I am just going to change it to HTTP to verify that this site is working.</p>
<p>If I want to manage the installation, everything is available on the GKE page. Here I can view the new cluster that I just created. If I want, I can make any necessary changes. The installation actually deployed multiple workloads, but everything is bundled under the application named “drupal-1”. So if I want to uninstall it, I just need to delete this app. And then I’ll also make sure to remove any workloads that did not get cleaned up. In this case, I should probably delete my cluster as well. Now if I had picked an existing cluster instead of creating a new one, I would have skipped this last step.</p>
<p>Alright, there you go. Now you know how to deploy software using the Google Cloud Marketplace.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>Well, I hope you enjoyed learning about the Google Cloud Marketplace. Now you know you have a wide array of easy-to-install software at your fingertips. Remember, before you install anything, remember to carefully review your options. You want to understand what version of the software you are deploying, as well any associated costs. You also should keep in mind that there are four main types of products that are offered: </p>
<ol>
<li>Virtual Machines are deployed to a Compute Engine VM.  You manage them using the Compute Engine screen, but it is best to use Deployment Manager to delete them. </li>
<li>Kubernetes apps are deployed to a GKE cluster. These can be fully managed using the GKE screen.</li>
<li>SaaS &amp; APIs don’t require any installation, but they do usually require a subscription.</li>
<li>Container images require manual installation.</li>
</ol>
<p>Well, that’s all I have for you today. Remember to give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching, and make sure to check out our many other courses on Cloud Academy!</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Deploying-and-Implementing-Google-Cloud-Platform-Solutions-18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Deploying-and-Implementing-Google-Cloud-Platform-Solutions-18/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Deploying-and-Implementing-Google-Cloud-Platform-Solutions-18</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:03:00" itemprop="dateCreated datePublished" datetime="2022-11-19T00:03:00-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:51:32" itemprop="dateModified" datetime="2022-11-22T20:51:32-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Deploying-and-Implementing-Google-Cloud-Platform-Solutions-18/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Deploying-and-Implementing-Google-Cloud-Platform-Solutions-18/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Course-Intro-Deploying-and-Implementing-Google-Cloud-Platform-Solutions"><a href="#Course-Intro-Deploying-and-Implementing-Google-Cloud-Platform-Solutions" class="headerlink" title="Course Intro: Deploying and Implementing Google Cloud Platform Solutions"></a>Course Intro: Deploying and Implementing Google Cloud Platform Solutions</h1><p>Welcome to Deploying and Implementing Google Cloud Platform Solutions. My name is Thomas Mitchell and I’ll be taking you through this course. </p>
<p>I’m a Content Author at Cloud Academy and I have over 25 years of IT experience, several of those with cloud technologies. If you have any questions, feel free to connect with me on LinkedIn, or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. </p>
<p>This course is intended for Google Cloud Engineers who <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/deploying-applications-on-gcp-compute/introduction/">deploy applications</a>, monitor operations, and manage enterprise solutions. It’s also intended for those interested in obtaining the Associate Cloud Engineer certification. </p>
<p>To get the most from this course, you should have a <a target="_blank" rel="noopener" href="https://cloudacademy.com/learning-paths/google-cloud-platform-fundamentals-54/">basic understanding of the Google Cloud Platform</a> and its offerings. </p>
<p>We’ll kick off this course by covering <a target="_blank" rel="noopener" href="https://cloudacademy.com/learning-paths/cloud-academy-introduction-to-kubernetes-92/">Kubernetes</a> Engine resources. You’ll learn how to deploy a Kubernetes Engine cluster and how to deploy a container application to Kubernetes Engine, using pods. Rounding out the first section, you’ll learn how to configure Kubernetes Engine application monitoring and logging.</p>
<p>Next, we’ll dive into the deployment and implementation of App Engine and Cloud Functions resources. In this section, you’ll learn how to deploy an application to App Engine and how to deploy a Cloud Function that receives Google Cloud Events. </p>
<p>As we progress through the course, you’ll learn how to upload data to Google offerings such as cloud storage and cloud SQL. </p>
<p>After learning about deploying to Google cloud, you’ll learn how to deploy a solution using Cloud Launcher. You’ll learn about things like browsing the Cloud Launcher catalog and viewing solution details. You’ll also learn how to deploy a Cloud Launcher marketplace solution. </p>
<p>Rounding out the course, we’ll get into using Deployment Manager for deploying Applications. you’ll learn about using Deployment Manager templates, including how to use them to automate application deployment. </p>
<p>By the time you complete this course, you’ll have a full understanding of how to deploy and implement Google Cloud Platform solutions. </p>
<p>We’d love to get your feedback on this course, so please give it a rating when you’re finished. So, if you’re ready to learn how to Deploy and Implement Google Cloud Platform Solutions, let’s get started.</p>
<h1 id="Kubernetes-Engine-Clusters"><a href="#Kubernetes-Engine-Clusters" class="headerlink" title="Kubernetes Engine Clusters"></a>Kubernetes Engine Clusters</h1><p>Kubernetes Engine allows organizations to quickly develop and deploy containerized applications and services. It also makes it easy for organizations to update and manage those applications and services. Although stateless applications immediately come to mind when discussing containerized solutions, Kubernetes Engine isn’t just for stateless applications. As a matter of fact, you can run databases in a Kubernetes cluster, and you can even attach persistent storage to a cluster. </p>
<p>To leverage a Kubernetes Engine cluster, all you need to do is specify the compute memory and storage resources that your app container will need. Once you’ve done that, the Kubernetes Engine will provide and manage the underlying resources automatically. </p>
<p>You can create four types of clusters in Kubernetes Engine. They include zonal clusters, regional clusters, private clusters and alpha clusters. </p>
<p>A zonal cluster runs in one or more compute zones within a region. Multi-zone clusters run their nodes across two or more compute zones within a single region. I should also point out that any given zonal cluster will run a single cluster master. Regional clusters run three cluster masters across three different compute zones.</p>
<p>Regional clusters also run nodes in two or more compute zones. </p>
<p>A private cluster can be a zonal cluster or a regional cluster. Either way, a private cluster hides its cluster master and nodes from the public internet by default. </p>
<p>The fourth type of Kubernetes cluster is the alpha cluster. The alpha cluster is an experimental zonal or regional cluster that runs with alpha Kubernetes features enabled. </p>
<p>It’s important to note that alpha clusters expire after 30 days. It’s also important to note that they cannot be upgraded nor do they receive security updates. Most importantly, alpha clusters are not supported for production use. </p>
<p>When you use the GCP console to create a Kubernetes cluster, you’ll see all of the cluster templates that are available to you. The Standard template is selected by default. </p>
<p>The complete selection of templates includes the Standard cluster, Your first cluster, CPU intensive applications, Memory intensive applications, GPU accelerated computing, and Highly available. </p>
<p>As I mentioned, the Standard cluster template is the default selection. </p>
<p>Your first cluster is a small cluster that runs less powerful nodes. Some advanced features like autoscaling are disabled. </p>
<p>The CPU intensive applications template creates a cluster with nodes that offer more powerful multi-core CPUs than a standard cluster. </p>
<p>The Memory intensive applications template creates a cluster with moderately powerful multi-core CPUs and a large amount of memory. </p>
<p>GPU accelerated computing clusters feature a default node pool that’s configured with less powerful nodes, along with an additional GPU-enabled node pool. Autoscaling is disabled by default on clusters built from the GPU accelerated computing template. </p>
<p>The Highly available template creates a cluster that’s configured as a regional cluster. Cluster masters are available in each zone of a given region. Unlike the GPU accelerated computing cluster, autoscaling on a Highly available cluster is enabled by default. In addition, maintenance window is enabled as well. </p>
<p>In the next lesson, I’ll show you how to deploy a Kubernetes Engine cluster.</p>
<h1 id="Creating-a-Single-Zone-Cluster"><a href="#Creating-a-Single-Zone-Cluster" class="headerlink" title="Creating a Single-Zone Cluster"></a>Creating a Single-Zone Cluster</h1><p>In the previous lesson, we covered the different types of cluster templates that are available to us. In this demonstration, I’m going to create a single-zone cluster using one of those templates. To get started, I need to browse to the Google Kubernetes Engine menu in GCP console. From here, I just need to browse to Clusters and then click Create Cluster. </p>
<p>After clicking Create Cluster, I have several cluster templates to choose from, and they are here on the left hand side. We covered these templates in the earlier lesson, so I’m not going to bore you with them again. What I’m going to do for this exercise is choose the Standard cluster template. To customize my template, I need to provide a unique name for my cluster along with a location type. I’m going to call my cluster mygkecluster and I’m going to select Zonal for my location type. </p>
<p>After setting my zone type, I can specify the zone where I want to deploy my cluster here. </p>
<p>This master version dropdown allows me to choose the cluster master version for mygkecluster. The master version that I select here will determine the version of Cloud Run on GKE that is installed when I create the cluster. You should always use a version with the latest supported version of Cloud Run, so for this exercise, I’ll leave it at the default setting. </p>
<p>What I need to do here is specify my node pool settings. Each node pool is a separate instance group running Kubernetes in the cluster. </p>
<p>For this exercise, I’ll leave it set to three nodes, I’ll also need to specify the machine type to use for my instances. Now, I should point out that each machine type is built differently, so keep that in mind when deploying resources. As you can see here, the default machine type features one CPU and 3.75 gig of ram. I’m going to leave this at the default setting and then just click create to deploy my cluster. </p>
<p>Once I’ve created a cluster in the GCP console, I’ll need to configure kube control to interact with the cluster. To do this, I need to create a kubeconfig entry. To create this entry, I need to launch Cloud Shell. </p>
<p>Once this cluster is up and running, we’ll launch Cloud Shell and I’ll show you how to create a kubeconfig entry. Okay, now that our cluster has been created and is active, what I’ll do here is launch Cloud Shell, and let me paste the command down here. So like I was saying, what we need to do is create a kubeconfig entry for our cluster to allow kube control to interact with the cluster, so we can run commands against it. </p>
<p>This gcloud container clusters command, what it does is retrieves the credentials for mygkecluster, now when I run this command, I also have to specify the region in which the cluster resides, in this case, we deployed to the us-central1-a. So we’ll go ahead and hit Enter here. This command doesn’t return a whole lot of information, but what it does do is tell us that it’s fetching the cluster end-point and authentication data. It’s also telling me that the kubeconfig entry has been generated for mygkecluster, so by doing this, this allows me to later on, if I want to manage my cluster using kube control, I can use kube control to interact with the cluster, and since I’ve created the kubeconfig entry here, my deployment is now complete and I can run individual kube control commands against the cluster.</p>
<h1 id="Deploying-a-container-application-to-Kubernetes-Engine-using-pods"><a href="#Deploying-a-container-application-to-Kubernetes-Engine-using-pods" class="headerlink" title="Deploying a container application to Kubernetes Engine using pods"></a>Deploying a container application to Kubernetes Engine using pods</h1><p>In this lesson I’m going to explain how to deploy a container application to Kubernetes Engine using pods. After explaining the process, we’ll jump into a demo in the next lesson where I’ll show you how it’s done. </p>
<p>For this lesson and the next, we’ll take a basic web app as an example. We’ll run that web app on a Goggle Kubernetes Engine cluster. </p>
<p>When deploying a container app to Kubernetes using pods, you need to complete a series of steps. You first need to package the app into a Docker image. Once the app is packaged, you need to upload the image to a registry. From there, you need to create a container cluster to host the app. </p>
<p>With the container cluster created, you can then deploy the app to the cluster and then expose the app to the internet. </p>
<p>In the next lesson, I’m going to walk you through the process of deploying a containerized web app to Kubernetes Engine.</p>
<h1 id="Deploying-a-containerized-app-to-GKE-Cluster"><a href="#Deploying-a-containerized-app-to-GKE-Cluster" class="headerlink" title="Deploying a containerized app to GKE Cluster"></a>Deploying a containerized app to GKE Cluster</h1><p>Welcome back! In the previous lesson, I explained the process that you need to follow when deploying a containerized app to a GKE Cluster. In this demonstration, I’m going to show you how to perform the deployment. </p>
<p>What we’re going to do here is deploy a containerized sample app, called “hello-app”. It’s a web app from the Google Container Registry. </p>
<p>Now before we get started, I need to use gcloud to configure to default settings: my default project and my compute zone. For this demonstration, I’m going to use my cloud academy project. And the compute zone I’m going to use is us-central1-a. </p>
<p>I should point out, that although configuring these two settings isn’t mandatory, doing so makes it easier to run gcloud commands later on. </p>
<p>So, let’s get started. </p>
<p>What I need to do here is launch cloud shell, so I can set my default project. So, we’ll go ahead and launch it. What I’ll do here is make it a little bit bigger, so we can see it here. </p>
<p>To set my default project, I need to run the gcloud config set command. So, I’ll type this out here. </p>
<p>Now, I’m going to set the actually project I.D.. This sets my default project to my cloud academy project. Next, I need to set my default compute zone. To do this, I run the gcloud config set command. And then, what I’m going to do is set the compute zone. And I’m gonna specify us-central1-a. You can see here that it updated my compute zone as well. So, with my project and compute zone set, I can begin working on the deployment. </p>
<p>Before deploying anything, I need to get authentication credentials for my cluster. In this demo, I’m gonna to deploy to the cluster called “my GKE Cluster”, which I created earlier in this course. To get my authentication credentials to interact with the cluster, I need to run gcloud container clusters to get credentials. So, lets type that out here. And then I need to specify my cluster. Now, what this command does is configure cube control to use the cluster that I created earlier. </p>
<p>At this point, I’m ready to deploy my containerized app. Now, as I mentioned earlier, I’m going to deploy a sample web application from the Google container registry. This app is called “hello app”. </p>
<p>To run “hello-app” in my cluster, I need to use cube control run to create deployment. What I’m going to do here is just paste in the full command and then explain what’s going on. This cube control one command creates a new deployment named “hello-server”. The deployment’s pod will then run the “hello-app” image in its container. The image flag specifies the container image to deploy. In this example, the image is being pulled from the Google container registry. The 1.O suffix specifies the image version to pull. The port flag is used to specify a port that the container needs to expose for the app to be accessible. </p>
<p>Now, hitting Enter here, launches the deployment. Now, after a few moments, you can see here the deployment is complete. But, I still have to expose it to the internet, so that users can get to it. This is done by creating a service that exposes the app to external traffic. To expose “hello app” to the world, I need to use the cube control expose command. </p>
<p>Now, I’m going to again copy this over because its a longer command. What this command does is create a compute engine load balancer for my container. And it does this via the “type” flag. The “port” flag initializes public port 80 to the internet. And the target port flag, routes inbound traffic to port 8080 of the application. So, we’ll go ahead and hit enter here. </p>
<p>We can see here that it tells me that service hello-server is exposed. Now, to test my app deployment, I need to browse to it in a browser. However, I first need to find out what its public IP address is. To do this, I can run cube control get, and specify my deployment. Now, we can see here it’s still pending an external IP address. So, we’ll give this a few minutes for it to complete and get its IP. This can sometimes take a minute or two. I’ll quickly re-run it again. And we can see that we’ve gotten an external IP now. </p>
<p>So, I’ll copy this and with this external IP, I can browse to it in a browser and confirm that it works. So, I’ll open up an incognito window here. And as you can see here on your screen, my app is in fact, working. </p>
<p>So, Congratulations! You now know how to deploy a containerized web application to GKE.</p>
<h1 id="Configuring-Kubernetes-Engine-application-monitoring-and-logging"><a href="#Configuring-Kubernetes-Engine-application-monitoring-and-logging" class="headerlink" title="Configuring Kubernetes Engine application monitoring and logging"></a>Configuring Kubernetes Engine application monitoring and logging</h1><p>When you enable logging for a Kubernetes cluster, the logs are stored in a dedicated, persistent datastore. Such logs include the admin activity log, the data access log, and the events log. </p>
<p>These logs include information on several types of GKE-related resource types. For example, when you enable monitoring and logging, you’ll start capturing information about the Kubernetes cluster itself, as well as for GKE cluster operations. You’ll also capture data for the GKE container and for GKE node pool operations. </p>
<p>It’s important to note that although GKE stores these logs, these logs are not stored permanently. For example, if you remove a pod, the GKE container logs associated with this pod are also removed. Logs are also removed when the disk on which the logs are stored runs out of space, or when logs are overwritten by newer logs. </p>
<p>You should also be aware that logging is actually a Google Cloud Platform service that’s separate from GKE. </p>
<p>In the next lesson, I’ll show you how to enable Kubernetes monitoring and logging.</p>
<h1 id="Enabling-Kubernetes-Monitoring-and-Logging"><a href="#Enabling-Kubernetes-Monitoring-and-Logging" class="headerlink" title="Enabling Kubernetes Monitoring and Logging"></a>Enabling Kubernetes Monitoring and Logging</h1><p>When you sit the GCP exam, you may find yourself being asked to enable Kubernetes monitoring or logging. In this brief demonstration, I’m going to show you how to enable Stackdriver logging and monitoring for an existing Kubernetes cluster. </p>
<p>To do this, let’s browse to the Clusters page under Kubernetes Engine. From here, I can click the Edit icon to edit my cluster. Now, to enable both logging and monitoring, I just have to choose Enable from the Stackdriver Kubernetes Engine Monitoring dropdown. So if I scroll down here, we can see it right here, so we’ll go ahead and enable this. </p>
<p>Now you might notice right here, there are also two other options. These Legacy options for monitoring and logging are also supported. However, Stackdriver Kubernetes Engine Monitoring is the preferred option, beginning with GKE versions 1.12.7 and 1.13, while Legacy Stackdriver is the default option up through GKE version 1.13. </p>
<p>Because these Legacy options aren’t getting any future improvements, nor do they offer features that are present in Stackdriver Kubernetes Engine Monitoring, you should use the Stackdriver Kubernetes Engine Monitoring whenever possible. We’ll go ahead and set this back to enabled again, and you’ll see here that when I enable the Stackdriver Kubernetes Engine Monitoring, I can’t use the Legacy options, and that’s because they’re not compatible. </p>
<p>So having said that, I’m going to click Save down here at the bottom, to enable monitoring and logging for my cluster. And we can see here our Stackdriver Kubernetes Engine Monitoring is now enabled, and our Legacy are disabled, so that’s pretty much it. We now have Stackdriver logging and monitoring enabled for our existing Kubernetes cluster.</p>
<h1 id="Deploying-an-application-to-App-Engine"><a href="#Deploying-an-application-to-App-Engine" class="headerlink" title="Deploying an application to App Engine"></a>Deploying an application to App Engine</h1><p>Google App Engine allows you to build and deploy applications on a completely managed platform. It allows you to scale applications seamlessly, without having to deal with underlying infrastructure. App Engine automatically scales, depending on traffic, and it only consumes resources when your code is running. This means that you only need to pay for the resources that you consume. &#x3D;</p>
<p>In this demonstration, I’m going to show you how to deploy a basic web application to Google App Engine. </p>
<p>To do this I need to create a new project on Google Cloud platform. To create a new project, I need to go to the Google Cloud platform console, and then go up here and click New Project.</p>
<p>I need to provide a name for my project and I need to note it’s project ID. For this demonstration I’m going to call my project “GAE Demo Site”. And I’m going to assign it a project ID of GAE Demo Site 007.</p>
<p>I’ll just click the Create button here to create my project.</p>
<p>And then I’ll go into my project here. Now each cloud platform project can contain one App Engine Application. So what I’m going to do here is prepare an app for our project. What I have on my desktop is a sample PHP app that I’m going to publish.</p>
<p>If we look at it here, we could see that the website folder contains our website content. Now, the app file, or the app.yaml file here, this is the application configuration file for our app that we’re going to publish. This file tells App Engine how to map the URLs to our static files in our website. So let me close this, and go back to desktop here. </p>
<p>So, now that we have our project created and we have our sample app files in hand, we can publish our PHP web app to our App Engine. </p>
<p>Now to do this, we need to launch Google Cloud Shell. With Google Cloud Shell opened we’ll need to launch the code editor, and then drag and drop our My App folder into the left pane. So let’s minimize this. Launch our Cloud Shell here. And I’ll expand this a little bit. And then what we’ll do is we’ll launch our editor here. So let’s minimize my template demo here, and let’s go ahead and drag my app into my editor. So now we can see my app is now up in my explorer. </p>
<p>What we need to do now is select our project that we created earlier. Now you can see here, the Google Cloud Platform project in this session is already set to GAE Demo Site 007, but what I want to do is show you the command that you would use to set your project if you had to. What you do is you run a G Cloud config command here, and we’ll just type it out here. And then we do a set project. And then we’ll call it GAE demo site 007. It essentially tells us it updated the property for the core project. So with our project set, we can now switch over to our My App directory by typing the CD My App command. This switches us over to the directory that we uploaded into our explorer. We could deploy our app from this directory, by running the G Cloud App deploy from our prompt. So what we’ll do here is do g cloud app deploy. And what this is going to do is upload our app to App Engine. Now as you can see here we’re being prompted to choose a region where we want our app to be located. I’m just going to choose option thirteen here for US East one.</p>
<p>Now what this is doing is creating the App Engine application in our project in the US East region. Now at this point it’s going to ask me if I’m sure or if I want to continue, and of course we do. So we’ll hit Y and Enter. And at this point it begins the deployment. We can see that the file uploads are completed, and now it’s updating the service. Now this is a pretty basic application, so you can see that the process is already complete. Now since this upload is done and the process is completed, I can test my application by browsing to GAE Demo Site 007 dot app spot dot com. So I’m going to copy this from offscreen here, because I don’t feel like typing it out. And what we’ll do is we’ll open incognito here.</p>
<p>And then we can see here that our application is now live. So by leveraging App Engine, I can focus on my app code, rather than infrastructure, and this essentially is the whole point of the App Engine service.</p>
<h1 id="App-Versioning"><a href="#App-Versioning" class="headerlink" title="App Versioning"></a>App Versioning</h1><p>In the next lesson, I’m going to talk about traffic splitting when deploying multiple app versions. That being the case, I just wanted to briefly touch on the deployment of multiple app versions. However, because the deployment process for multiple versions is identical to the deployment of the first version, I’m not going to do a full demonstration. Instead, I’m just going to tell you that to deploy multiple versions of an app, you can simply rerun the gcloud app deploy command that we covered in the last lesson. By doing so, another copy of the app will be deployed and GCP will automatically generate a version for it. You can rerun the gcloud app deploy to create as many versions of your application that you need. If you need a different configuration for each version, as will be the case when doing A&#x2F;B testing, you would just modify the configuration of the web app and then rerun the gcloud app deploy command. </p>
<p>So, with that said, let’s hop into the next lesson so I can explain traffic splitting.</p>
<h1 id="Traffic-Splitting"><a href="#Traffic-Splitting" class="headerlink" title="Traffic Splitting"></a>Traffic Splitting</h1><p>In previous lessons, you learned how to deploy an app to the GCP app service and how to deploy multiple versions of the app. When you deploy multiple app versions, you can split traffic across them. What you can do is specify a percentage of traffic that should go to one version and another percentage that should go to another version or even several other versions within a service. </p>
<p>Traffic splitting is a great way to conduct A&#x2F;B testing between different versions and it provides more control over the process of rolling out features. </p>
<p>You can split traffic by IP address or via cookie splitting. You can also configure random splitting. </p>
<p>If you decide to split traffic by IP address, the application, when it receives a request, hashes the IP address to a value between zero and 999. It then uses that number to route the request to a version of your app. </p>
<p>When cooking splitting, the application will look in the HTTP request header for a cookie named GOOGAPPUID. This cookie contains a value between zero and 999. If the cookie exists, the value is used to route the request. In the event there is no cookie, the request is routed randomly. </p>
<p>Randomly splitting traffic results in a split that’s based on a weighted random assignment. Incoming requests are randomly routed to a version of the app in the traffic split. </p>
<p>In the next demonstration, I’m going to show you how to split traffic across two versions of an app hosted by app service.</p>
<h1 id="How-to-Configure-Traffic-Splitting"><a href="#How-to-Configure-Traffic-Splitting" class="headerlink" title="How to Configure Traffic Splitting"></a>How to Configure Traffic Splitting</h1><p>Welcome back. In the last lesson we talked a little bit about traffic splitting. What I want to do here is show you how to do it via the console. It’s actually rather easy to do, but it makes sense to demonstrate how it’s done. </p>
<p>As you can see here on your screen, I’m in the app engine dashboard. What I’m going to do here is click over here on Versions. Now what this shows is two versions of my app that I deployed earlier. If you notice, only one of these apps is receiving all of the traffic. </p>
<p>To split traffic across both of these versions, I just need to click Split Traffic up here at the top, and then from here I can choose my split option. For this exercise I’m going to choose Random. Clicking Add version allows me to add my second version of the app to the split, and then from here I can configure the split percentages. </p>
<p>With my split configured, I just have to click Save to save my split configuration. Now what this configuration does is randomly split traffic evenly across both versions of my application, and if we go back here, we can see the 50-50 split. </p>
<p>So that, in a nutshell, is how you configure traffic splitting across multiple versions of an application.</p>
<h1 id="Deploying-a-Cloud-Function-that-receives-Google-Cloud-events"><a href="#Deploying-a-Cloud-Function-that-receives-Google-Cloud-events" class="headerlink" title="Deploying a Cloud Function that receives Google Cloud events"></a>Deploying a Cloud Function that receives Google Cloud events</h1><p>Google Cloud Functions is an event-driven serverless compute platform that allows you to run serverless code in the cloud. It automatically scales and requires no server provisioning. The way it works is simple. When a cloud service emits an event, Cloud Functions responds to the event and then invokes other services and APIs as necessary. It then writes back to the cloud service. </p>
<p>In this lesson, I’m going to demonstrate how to deploy a Cloud Function that receives Google Cloud events using a Pub&#x2F;Sub trigger. </p>
<p>What we’re going to do is deploy a background cloud function called helloworld and then trigger the function by publishing a message to a Cloud Pub&#x2F;Sub topic called mytopic. </p>
<p>To prepare for this demo, I’ve already created a topic called mytopic in Google Cloud Platform. I’ve also downloaded the helloworld sample function from GitHub and extracted it to my laptop. </p>
<p>You can see the helloworld sample function folder here on my screen. </p>
<p>In order to make this stuff all work, what I need to do is launch my Cloud Shell and open up the Code Editor because what I want to do is upload the helloworld folder which contains my function to Google Cloud Platform. So let’s go ahead and launch the Cloud Shell here and then what I’ll do is I’ll launch Code Editor here. </p>
<p>So now that I have my Shell and Code Editor opened here, let me drag my helloworld folder into my Explorer here. Now we’re doing this because this is where I’m going to deploy from. </p>
<p>To deploy our function with a Cloud Pub&#x2F;Sub trigger, I need to run the G Cloud Functions deploy command. However, I need to run the command in the directory that I uploaded my function to so let me switch over to the helloworld directory first here. </p>
<p>Now that I’m in the helloworld directory, I can run the G Cloud Functions deploy command. What I’ll do here is copy and paste this command in and then I’ll explain it. </p>
<p>Notice the name that I’m using for the trigger topic flag. It’s the topic that I created ahead of this demo that’s called mytopic. I’m going to call my function deployment hello_pubsub. You can also see in this command that I’m specifying the Python 3.7 runtime. Let’s go ahead and deploy. And we can see here that my deployment has completed. </p>
<p>Now the function that I just deployed is going to check mytopic for messages. I can trigger the function by publishing a message to mytopic. For this example, the message that I publish is simply going to be my name. The function will then include my name in a greeting message. To publish my message which will in turn trigger my function, I need to run the G Cloud Pub&#x2F;Sub topics publish command and let me copy it over here so you can see what it looks like. I’m going to expand this window a little bit. There we go. </p>
<p>Essentially what we’re doing here is we’re publishing a message with the name Thomas to the mytopic topic. So let’s go ahead and publish our message here. Okay, so we have our message published to our topic. Now that I’ve published my message, I can check the logs to make sure that the process has actually completed, that the message was actually sent. To do this, I need to run the G Cloud Functions logs read command that I’m going to copy in now. </p>
<p>What this does is allow me to read the logs that have been generated. Now what the limit flag does here is limit the return of the logs to the last 50. And let’s hit Enter a few times here to bring this up. Now as you can see on your screen, there is a message here that displays Hello Thomas. This tells me that my function is working as expected because that’s exactly what it was supposed to do. Now if you want to perform this demo in your own environment, visit the first URL that you see on your screen and follow the instructions for creating a topic called mytopic in GCP. </p>
<p>To download the sample helloworld function that I used in this demo, visit the second URL to download it. Extract the downloaded zip file and copy the helloworld folder to your desktop. The helloworld folder is located in the functions subfolder within python-docs-samples master. Once you’ve created a topic called mytopic and extracted the helloworld folder that contains the sample function, you can pick up at the beginning of this demo and do it yourself.</p>
<h1 id="Loading-data-into-Cloud-Storage"><a href="#Loading-data-into-Cloud-Storage" class="headerlink" title="Loading data into Cloud Storage"></a>Loading data into Cloud Storage</h1><p>There are many ways to load data into your Cloud Storage Bucket. You can use the command line, APIs, the console, and even various programming languages such as Python, PHP, Ruby, and more. </p>
<p>To load data into Google Cloud using the console, open the Cloud Storage browser in the Google Cloud Platform Console and then, while viewing the list of buckets, click the bucket that you want to upload data to. From the bucket’s Objects tab, you can drag and drop your files from your workstation to the main pane in the GCP Console. However, you can also just click the Upload Files button, and then choose the files that you need to upload, and then click Open. </p>
<p>Either way, uploading data into GCP from your workstation, using the console, is pretty straightforward. </p>
<p>You can also use the command line to get data into Google Cloud. To upload data to Google Cloud using the command line, you need to leverage gsutil. To upload data using gsutil, run the gsutil cp command that you see on your screen. </p>
<p>What you’d need to do is replace OBJECT_LOCATION with the folder on your workstation that hosts the data you want to upload. You’d replace DESTINATION_BUCKET_NAME with the name of the bucket you are uploading to. </p>
<p>For example, if I wanted to upload finances.txt from my desktop, I’d replace OBJECT_LOCATION with Desktop&#x2F;finances.txt. If I wanted to upload to a bucket named mybucket, I’d replace [DESTINATION_BUCKET_NAME] with mybucket. </p>
<p>My full command would look like the one that you now see on your screen. </p>
<p>If you need, or want, to upload data to GCP using APIs, you have two main choices. You can leverage the JSON API or the XML API. </p>
<p>In either case, you first need to obtain an authorization access token from the OAuth 2.0 Playground, and then configure the playground to use your OAuth credentials. </p>
<p>Once you’ve got your OAuth credentials configured, you can use the API of your choice to upload data. </p>
<p>If using the JSON API, you need to use curl with a POST command to upload your data. The sample code on your screen would upload a file named photo.png from the desktop to a bucket called mybucket. </p>
<p>OAUTH2_TOKEN would be replaced with the access token that you obtained from the OAuth 2.0 Playground. If using the XML API, you need to use curl with a PUT command to upload your data. The sample code on your screen would upload a file named photo.png from the desktop to a bucket called mybucket. Again OAUTH2_TOKEN would be replaced with the access token that you obtained from the OAuth 2.0 Playground. </p>
<p>So, as you can see, there are quite a few ways to get data into Google Cloud. In a production setting, you’d obviously use whatever method works for what you are trying to accomplish.</p>
<h1 id="Initializing-a-Data-System-with-Products"><a href="#Initializing-a-Data-System-with-Products" class="headerlink" title="Initializing a Data System with Products"></a>Initializing a Data System with Products</h1><p>There may be times when you need to upload data to other services, such as Cloud SQL. For example, you may want to initialize your data system with an inventory of products. In this demonstration, I’m going to show you how to connect to a Cloud SQL instance, how to create a database, and then how to upload data to that database. </p>
<p>We’ll do this via Cloud Shell. </p>
<p>Now to prepare for this exercise, I’ve already provisioned a MySQL instance, called myinstance. </p>
<p>To connect to myinstance and upload my data or initialize that seed data, I’m going to launch my Cloud Shell. Let’s go ahead and do that here. Let’s drag this up here. </p>
<p>Now, from the Cloud Shell prompt, I’m going to run a gcloud SQL connect command here. So let’s type it in here. Now what this is going to do is white-list my IP address so I can connect to SQL. </p>
<p>As you can see here, I am prompted for the root password that I created when I created the instance. So I’ll go ahead and enter it here. </p>
<p>Now once I’ve done that, I’m presented with the MySQL prompt. Now to create my SQL database, I need to run a create command. So let’s go ahead and do that now. We’ll type in create and then database and we’ll call it mydatabase. We can see by the query OK that my database creation was successful. </p>
<p>Now that my database is created, I can begin uploading data, but before I do that, I need to create a table and to do that, I need to use the create table command. Now before running the create table command, I’m going to run a use command to make sure I’m using my database. So now we’re connected to my database. What this use command does is essentially specify the database that I want to work with. </p>
<p>Now with my database selected, I need to create my table. Now what I’m going to do here is I’m going to copy the create table command over because it’s rather lengthy. This create table command creates a table within my database and creates three columns within that table. It creates a product name column, a content column, and an entry ID column. It also sets the entry ID column as the primary key for the table. </p>
<p>Let’s go ahead and hit Enter here to create our table. And we can see that the query is OK so we’re good. So with my table created, I’m going to run an insert command to add an apple as a product and red delicious as the content for that apple. And what I’ll do here is I’ll copy it over. So you can see what we’re going to do is run an INSERT INTO command to insert data into our entries table. Now the entries table is the table that we created up here. </p>
<p>What we’re going to do is insert apple as our product name and red delicious, which is a type of apple, as the content. So essentially what we’re going to do is build an inventory or initialize an inventory of products. So we’ll go ahead and hit Enter here. And we can see our query was OK with one row affected. Now I’ll run the same command again to add another type of apple into my inventory. This time we’ll do a Cortland apple. So as you can see here, this is how I can initialize something like an inventory system with product using basic insert commands. </p>
<p>Now to retrieve the data that I entered, I simply run a select command. So what we’ll do is we’ll run select and then we’ll specify star, which means return everything, and we’ll select from our entries table. I forgot my semicolon. And there we go. And just to show you what happened here, when I ran the select command, I forgot the trailing semicolon here to denote the end of the command, so it was looking for more info. And that’s what it’s telling me here. We had an error in our SQL syntax but once I ran the command correctly, select star from entries semicolon, it returns all of the entries from our entries table. </p>
<p>And we can see here apple as our product name, red delicious. Apple as another productive name and Cortland. Now of course this is a simple demonstration, but it does give you an idea of what’s involved in creating databases and initializing them with product data.</p>
<h1 id="Developing-Deployment-Manager-templates-to-automate-deployment-of-an-application"><a href="#Developing-Deployment-Manager-templates-to-automate-deployment-of-an-application" class="headerlink" title="Developing Deployment Manager templates to automate deployment of an application"></a>Developing Deployment Manager templates to automate deployment of an application</h1><p>Although basic configuration files can be used to deploy less complex workloads, more complex workloads and configurations that you plan to reuse should be handled with templates. A deployment manager template is a file that’s imported and used as a type in a configuration. Deployment manager templates allow you to break out a configuration into multiple pieces that you can reuse with different solution deployments. In this lesson, I’m going to show you a basic deployment manager template and its architecture. The template we’re going to look at is called demovm.jinja. We’ll use it later in this course to deploy a VM. On the screen, you can see our basic demovm deployment template in Jinja format. I created this in preparation for this exercise. In this template, we’re defining the name of our VM instance with the name value. In addition to providing a name for our VM, we need to specify the type of resource we’re deploying. We do this with the type value. Since we’re deploying a VM instance, we need to specify compute.v1.instance as the type. Using the properties value, we need to specify the zone where we want to deploy to and the machine type. In this example, we’re deploying an n1-standard-1 machine to the us-central1-a region. The disks value allows us to specify disk information. For this exercise, we’re specifying a persistent boot disk called boot and we’re configuring the disk for autoDelete so that it’s removed when the VM instance is removed. Under initializeParams, we’re using the sourceImage value to tell GCP that we want to deploy a debian-9 virtual machine. With the networkInterfaces setting, we’re configuring the VM to connect to the default network. In the next lesson, we’ll compare configuration files with deployment manager templates. After that, we’ll deploy a VM from our demovm deployment manager template.</p>
<h1 id="Configuration-Files-vs-Deployment-Manager-Templates"><a href="#Configuration-Files-vs-Deployment-Manager-Templates" class="headerlink" title="Configuration Files vs Deployment Manager Templates"></a>Configuration Files vs Deployment Manager Templates</h1><p>Before we get into the process of deploying a resource using a deployment manager template, I wanted to quickly explain what the configuration file is and what its relationship is to the template because before using a template to deploy a resource, we must first create a configuration. </p>
<p>Now, what a configuration file is is a list of resources, and their respective properties that will be part of the deployment. A configuration file contains a top-level resources section, which, in turn, contains a list of resource entries that are used to configure the deployment. Each resource entry includes a name field, a type field, and sometimes, a properties field. </p>
<p>On the screen, here, you can see what a typical configuration file looks like, when using a template for deployment. The information you see is from a configuration file, called myvm.yaml, that I created ahead of this lesson. If you remember the previous lesson, where I showed you the demovm deployment manager template, you’ll recall that I specified all the necessary values for our VM in the demovm.jinja file. </p>
<p>Since we already configured these values in the template file we’ll be using, we don’t have to provide this information directly in the configuration file here. Instead, we’ll simply pull this information from our template into the configuration, using the imports command, along with a path designation. </p>
<p>Since both my config file and template both reside in the same templatedemo folder, I don’t need to specify a complete path. The name field in the resources section is used to specify a name for the resource being deployed. </p>
<p>For this exercise, we’re calling our new VM myfirstvm. Type specifies the base type of the resource being deployed. Since we already defined the type in our template that we’re referencing, we just need to configure the type to reference our template. As you can see here, the config file is pretty bare, when using templates. This makes sense because all the configuration settings are defined in the template file meaning there isn’t much needed in the config file. </p>
<p>So, now that I’ve explained the config file and template file, let’s hop into the next lesson where I’ll show you how to deploy a VM using a combination of the config file and template.</p>
<h1 id="Deploying-a-VM-via-a-Deployment-Manager-Template"><a href="#Deploying-a-VM-via-a-Deployment-Manager-Template" class="headerlink" title="Deploying a VM via a Deployment Manager Template"></a>Deploying a VM via a Deployment Manager Template</h1><p>Over the last two lessons, we covered the creation of a deployment manager template file and we also covered the role of the configuration file. In this lesson, I’m going show you how to combine the two to deploy a VM instance. </p>
<p>So, let’s get started. </p>
<p>Before I do anything, I need to decide which project I’m going to use, since Deployment Manager requires a GCP Console project to be specified. For this exercise, I’m using my existing Cloud Academy project. </p>
<p>I’m going to run this deployment from Google Cloud Shell, which comes with gcloud installed. Gcloud is what we are going to use to deploy our template. </p>
<p>To run my deployment from Cloud Shell, I need to launch the shell and then launch the code editor window. So let’s go ahead and activate Cloud Shell. And then we’ll launch the code editor window. </p>
<p>At this point, I need to drag my templatedemo folder from my workstation into the explorer here in code editor. This will allow me to run my commands and to access the files that they reference. So let me go down here and open my Desktop here. </p>
<p>You can see here that my templatedemo folder, and everything in it, is now up in cloud shell </p>
<p>So, now that I have everything in my environment set up, I can begin my deployment. </p>
<p>What I’m going to do here is change to my templatedemo directory and then run my deployment from there since that’s where my files are. To run my deployment here, using the demovm template that I showed you earlier, I need to run the command that I’m going to show you here on your screen. And I’ll copy this in here ‘cause it’s a long command. So what we’re going to do here is we’re going to use gcloud deployment-manager to create a deployment called myvm-with-templates and we’re going to configure that deployment using the myvm.yaml file. </p>
<p>When this deployment runs, my config file will import that template and remember the config file is the YAML file. And that’s going to import the ginger file which is the template via the imports section that was added to that configuration file and we covered that earlier. So we’ll go ahead and hit Enter here. And we can see the deployment begins. </p>
<p>Now if we switch over to the console here and go into compute engine, we can see my first VM being deployed. Let’s switch back over to Cloud Shell here and we’ll continue with the deployment. Now, this’ll take a few minutes to complete and we can see here that it’s completed with no errors. </p>
<p>What I’m going to do now is run the gcloud deployment-manager command that we’re going to pull in here and what this command is going to do is allow me to view my deployment. So let me pull this command in here. We’re calling gcloud deployment manager and we’re using the deployments command and instead of using a create, we’re using a describe and essentially what this is doing is telling Deployment Manager to show me the deployment called myvm-with -emplates. So we’ll go ahead and hit Enter here. </p>
<p>And as you can see here, this command returns my deployment information. We can see the name, the end time, the operation type, the progress of the deployment when it started and its status. We can also see who ran it. At the bottom here we can see the status is complete. So, with that, you now know how to create a basic VM deployment using a template!</p>
<h1 id="Course-Conclusion-Deploying-and-Implementing-Google-Cloud-Platform-Solutions"><a href="#Course-Conclusion-Deploying-and-Implementing-Google-Cloud-Platform-Solutions" class="headerlink" title="Course Conclusion: Deploying and Implementing Google Cloud Platform Solutions"></a>Course Conclusion: Deploying and Implementing Google Cloud Platform Solutions</h1><p>I hope you’ve enjoyed <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/deploying-and-implementing-google-cloud-platform-solutions/course-intro-deploying-and-implementing-google-cloud-platform-solutions/">Deploying and Implementing Google Cloud Platform Solutions</a>. Let’s review what you’ve learned. </p>
<p>We began the course with Kubernetes Engine resources. You learned how to deploy a Kubernetes Engine cluster, and how to deploy a container application to Kubernetes Engine using pods. Closing out the first section, you learned how to configure Kubernetes Engine application monitoring and logging. </p>
<p>Next, we covered the deployment and implementation of App Engine and Cloud Functions resources. In this section, you learned how to deploy an application to App Engine and how to deploy a Cloud Function that receives Google Cloud Events. </p>
<p>As we progressed through this course, you learned how to upload data into Google Cloud solutions such as Cloud Storage and Cloud SQL. </p>
<p>After learning how to upload data, you learned how to deploy a solution using Cloud Launcher. You learned about things like browsing the Cloud Launcher catalog, and viewing solution details. You also learned how to deploy a Cloud Launcher marketplace solution. </p>
<p>Rounding out the course, we talked about using Deployment Manager for deploying applications. You learned about using Deployment Manager templates, including how to use them to automate deployments. </p>
<p>At this point, you should now have a full understanding of how to deploy and implement Google Cloud Platform solutions. </p>
<p>To learn more about deploying and implementing Google Cloud Platform solutions, you can and should read Google’s documentation. Be sure to also watch for new courses on Cloud Academy, because we’re always publishing new ones. Be sure to give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching, and happy learning.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Deploying-Containerized-Applications-on-Google-Kubernetes-Engine-GKE-17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Deploying-Containerized-Applications-on-Google-Kubernetes-Engine-GKE-17/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Deploying-Containerized-Applications-on-Google-Kubernetes-Engine-GKE-17</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:02:59" itemprop="dateCreated datePublished" datetime="2022-11-19T00:02:59-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:53:58" itemprop="dateModified" datetime="2022-11-22T20:53:58-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Deploying-Containerized-Applications-on-Google-Kubernetes-Engine-GKE-17/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Deploying-Containerized-Applications-on-Google-Kubernetes-Engine-GKE-17/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/19/GCP-Cloud-Engineer-Managing-Google-Kubernetes-Engine-and-App-Engine-16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/19/GCP-Cloud-Engineer-Managing-Google-Kubernetes-Engine-and-App-Engine-16/" class="post-title-link" itemprop="url">GCP-Cloud-Engineer-Managing-Google-Kubernetes-Engine-and-App-Engine-16</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-19 00:02:57" itemprop="dateCreated datePublished" datetime="2022-11-19T00:02:57-04:00">2022-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-22 20:50:50" itemprop="dateModified" datetime="2022-11-22T20:50:50-04:00">2022-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GCP-Cloud-Engineer/" itemprop="url" rel="index"><span itemprop="name">GCP-Cloud-Engineer</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/19/GCP-Cloud-Engineer-Managing-Google-Kubernetes-Engine-and-App-Engine-16/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/19/GCP-Cloud-Engineer-Managing-Google-Kubernetes-Engine-and-App-Engine-16/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Greetings, welcome to Cloud Academy’s course on managing Google Cloud Kubernetes and App Engine Resources. I’m delighted to have you join me in what is bound to be an educational and exciting adventure into the world of Google Cloud development.</p>
<p>First, I’ll let you know a bit about myself, before I get into the course outline. My name is Jonathan. I’m one of the course developers with Cloud Academy. I’m a former high school teacher turned technical consultant specializing in DevOps and data engineering. It’s a pleasure to get back into the world of teaching, only now talking about technology.</p>
<p>This course is designed to be very practical. It is meant for technology professionals, developers, data architects, CTOs, etc. With the goal of helping them get a solid understanding of how to build infrastructure using Google Cloud services. This course will also help you to prepare for the Google Associate Cloud Engineer Certification exam.</p>
<p>So you may be wondering what the prerequisites are for a course like this. What do you need to already know to be successful in this class? Well a few things. For one, you should have some familiarity with Google Cloud Platform. This course assumes you know basically what GKE and App Engine and Compute Engine are. You should also be comfortable working with command line tools and in a web console. You don’t need to be an expert programmer you don’t need years of experience working with GCP or AWS or something similar, however, general knowledge of what cloud providers do is helpful as this course will not cover rudimentary concepts such as, “What is a VM?”</p>
<p>So now let’s talk learning objectives. In this course, there are two main takeaways related to Google Cloud Platform. Number one, the student will learn how to manage and configure GCP Kubernetes Engine resources. And number two, the student will learn how to manage and configure GCP App Engine resources.</p>
<p>In short, this course covers GCP compute services related to Kubernetes and serverless architectures, specifically GKE, and App Engine. This might seem familiar if you took an earlier course, Planning and Configuring a Cloud Solution, which also covers these topics but the difference here is that the learning objectives in that earlier course was just deploying and configuring, whereas the material was more of an overview because of that.</p>
<p>In this course, we’re going to go deeper. If you have zero familiarity with GCP we definitely recommend taking the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/planning-configuring-google-cloud-platform-solution/introduction/">Planning and Configuring</a> course first. That will more gently introduce you to these compute services. This course, by contrast, will assume that you have a basic understanding of the different services and will instead serve as a deep dive on how to actually manage these systems. By the end of this course, you should be truly ready to be responsible for a GCP environment, specifically App Engine and Kubernetes Engine. You’re not just clicking through a wizard and hoping for the best.</p>
<p>So, one last thing before we start, I want to encourage everyone to leave feedback. Email <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a> if you have any questions, comments, suggestions, concerns. We always appreciate people taking the time. And so now without further ado, let’s get started.</p>
<h1 id="Section-One-Introduction"><a href="#Section-One-Introduction" class="headerlink" title="Section One Introduction"></a>Section One Introduction</h1><p>Welcome to section one. In this quick introduction lesson, we’ll go over the learning outcomes for this first section of the course. Our focus will be on <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> Kubernetes Engine. So there are two high-level goals for this section. First, we wanna make sure you understand Kubernetes generally. Whether it is inside GCP or with another cloud provider, there are certain concepts you need to be familiar with to utilize Kubernetes effectively. Second, we will go over GCP Kubernetes Engine’s specific tools for implementing a Kubernetes application and we’ll do this in two lessons, the first focusing on creating a cluster and setting up an application container, and then, the second lesson, we’re focusing on more fine-grained Kubernetes configuration. We’ll drill down into topics like pods, nodes, services, deployments, and stateful applications, so on and so forth. Finally, we’ll end the section with a practical demonstration. We’ll do a video walkthrough on how to utilize GKE starting with nothing and ending with a running app in a GKE cluster. So if you’re ready, let’s dive in.</p>
<h1 id="Kubernetes-Concepts"><a href="#Kubernetes-Concepts" class="headerlink" title="Kubernetes Concepts"></a>Kubernetes Concepts</h1><p>Review of Kubernetes Concepts. If you’re coming from the more introductory, “Planning and Configuring” <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> course, then you recall its basic overview of GKE. The goal there was really to just show how it works with enough information to get you started. In this course, we want to get you ready to be responsible for maintaining a GKE cluster in a real production environment. So this will require a deeper dive into how GKE works, and before we do that, we want to ensure you have a deep understanding of Kubernetes concepts. If you’re already are a Kubernetes expert and you wanna just dive into GKE, feel free to skip this lesson.</p>
<p>So let’s start by talking about what Kubernetes is at a high level. Stated most succinctly, Kubernetes is a system for orchestrating containerized applications. So if you are packing your software application using something like Docker, and wish to deploy and manage those Docker containers, Kubernetes gives you the tools to abstract away most hardware and networking considerations to make managing your system much easier.</p>
<p>Consider the basic resources needed to deploy a Dockerized application. The Docker container needs a server to run on, so that means compute resources. It needs a certain amount of CPU and memory. It also needs network access, port configuration, firewalls, load balancing, DNS configs. The app may need to talk to other backend services, or it may be part of a larger system of microservices involving several other Docker apps. Managing all of this complexity manually is very difficult. We’d need to create all sorts of scripts and documentation for each server, each network setup, each application’s hardware needs, config files, etc., etc. Kubernetes, like other orchestration frameworks such as Docker Swarm or Mesos Marathon, it makes all of this work much easier.</p>
<p>It starts with the concept of a cluster. A Kubernetes cluster is a complete set of resources for an application environment. Hardware resources. So in general, this will be confined to a single data center and will comprise a number of servers and network interfaces. Storage is also a possible resource here as Kubernetes can create ephemeral and persistent volumes. The servers, whether physical machines, VMs running in EC2, or Google Cloud Compute, or somewhere else, they are referred to as nodes. Servers are nodes. A Kubernetes cluster may, for example, run on three nodes, three virtual servers, that will host your container-based applications. Having multiple nodes grants redundancy in case of hardware failure and it also makes scaling up or down easier. Each node will run a kubelet, a lightweight Kubernetes agent, that allows it to communicate with other nodes and stay in sync regarding cluster configuration and help.</p>
<p>A Kubernetes cluster with just nodes, however, is not really doing anything useful. In order to run a container, the cluster must have access to an image repository and it has to create pods. Now, a pod is a basic workload unit in Kubernetes. Often, a pod is an instance of a single container, however, it can also be comprised of multiple containers. A pod will also have a unique IP address within the network as well as storage resources based on its config. This is the smallest unit of what we might think of as a microservice in a software as a service architecture. So for example, you might have a simple stateless Python app run as a pod in your Kubernetes cluster. And we’ll dig in deeper on the container configuration and cluster setup in the next section.</p>
<p>So now, with a basic understanding of clusters, nodes, and pods, there are only two other core concepts of Kubernetes that you need to really get started working with GKE. And these two are Controllers and Services. Now, we’ll link to the <a target="_blank" rel="noopener" href="https://cloud.google.com/kubernetes-engine/docs/">Kubernetes documentation</a> if you wanna really go deeper on all the other terminology. That’s a bit out of scope for this class, we’re just doing a basic conceptual overview.</p>
<p>But let’s diagram there, let’s start with Controllers. You can think of a Kubernetes Controller as a <em>control loop</em>. This is a basic CS concept. It’s a tool for maintaining a certain desired state. In Kubernetes, this refers to an API that manages a pod or set of pods by preserving a pre-set configuration. So there are actually a few different types of Controllers. One of the most basic is the ReplicaSet, which simply guarantees that a certain number of copies of a given pod are kept running. So for example, let’s say we have our stateless Python app running as three pods across the nodes in our cluster. If they are running as a ReplicaSet, then Kubernetes will make sure that three pods are always running. If there is a failure, a crash, an error of some kind that causes a pod to die, the ReplicaSet controller will try to bring up a replacement.</p>
<p>Now, there are other Controller types for different purposes. There is the DaemonSet controller which is meant to guarantee a specific distribution of pods on each node. This controller is useful for hardware monitoring, logging applications that need a one-to-one mapping to servers for whatever reason. There’s also the StatefulSet controller designed for stateful applications. This controller provides guarantees about pod ordering, uniqueness, and stable storage. Finally, there is the Deployment Controller. This is designed to work with other Controllers, such as ReplicaSets. The Deployment Controller, as the name implies, is designed for declarative updates to a set of pods. It handles transitioning a set of pods from its current state to a defined desired state.</p>
<p>So there’s more we could add about Controllers but this is enough to get the basic idea. Again, don’t hesitate to dig through the Kubernetes documentation for more details about each specific Controller if you’re interested. But for now, let’s move on and talk about Services.</p>
<p>Services are very important. Services are Kubernetes’ way of exposing pods to external networks including the public internet. So if we wanna make our application reachable from a browser, we’re going to need a Service to set up the IP address and DNS name. The basic configuration needed is a network protocol, such as TCP as well as ports and some metadata such as a Service name. Now as with Controllers, there are a few different types of Services. There are ClusterIP services that only expose an internal IP address, suitable for apps that don’t need to be accessed from the public internet. Then you have NodePort services that expose the node’s IP address on a specific port. This might make sense depending on your firewall setup. You may not want your Kubernetes nodes, the actual VMs, to expose their IP addresses, even if its only on a specific port. And then, you also have LoadBalancer and ExternalName services, both of which work more closely with your cloud provider. The former, the LoadBalancer, it works with your provider’s LoadBalancer resources to expose a set of pods while the latter, the ExternalName type returns a CNAME record based a DNS name of your choosing.</p>
<p>So Controllers let us turn sets of running containers into resilient, updateable applications with predictable behavior. And Services let us control access to those applications by publishing them in various ways. Now, if you understand these five terms, cluster, node, pod, controller, service, then you now know enough Kubernetes to get your hands dirty. In the next short lesson, we’re gonna do just that. We’ll review setting up a cluster and preparing a container for deploy using GKE. It’s gonna be a blast. We’ll see you there.</p>
<h3 id="Lectures"><a href="#Lectures" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Cluster-and-Container-Configuration"><a href="#Cluster-and-Container-Configuration" class="headerlink" title="Cluster and Container Configuration"></a>Cluster and Container Configuration</h1><p>Welcome to part three. In this lesson, we’re gonna cover just two things; launching a cluster and setting up a Docker image for deploy as a pod in the cluster. We’ll go over both the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> console approach and the CLI, which can be used from your local computer or a remote shell environment or the GCP cloud shell tool from the browser, so let’s get right into it.</p>
<p>Now, recall that in order to have a cluster, we need to have nodes, which are just virtual machine instances. In the early days of Kubernetes, we would have to manually create those instances, install the Kubernetes agents, known as kubelets, and then, run some commands to wire it together. Now, with GKE, we can get a cluster up and running much faster. In the web console, it’s as simple as clicking on the Kubernetes Engine menu and then, selecting the blue Create Cluster to kick off the setup wizard. I recommend going through this sort of hand-holding wizard approach your first time to get a sense of what configuration is available. We can set a name, a number of nodes, a machine type, a geographic region, and some other config options. GKE has some really nice defaults and it has options for things like CPU-intensive or memory-intensive applications. Once you finish running through it, you’ll have a running Kubernetes cluster with some set of nodes.</p>
<p>Now, we should also take a moment to talk about node pools. Node pools are groups of nodes within a cluster that share the same configuration. This is a GKE-specific feature. It’s an extension of Kubernetes functionality essentially. When we create a cluster in GKE, it will by default create a set of nodes known as the default node pool. We can then just work with that node pool or we can add additional node pools with different configuration. So for example, we might want to have a set of nodes dedicated to in-memory caches, so we create some instances with lots of RAM and a particular network config, and that could be our cache node pool. Each node pool can use distinct virtual machine images, distinct instance type, and storage options.</p>
<p>So you can create node pools in the web console or using the CLI tools with the gcloud container node-pools command. With the console, you can also upgrade or delete node pools as well. So to do this with the console, simply go into the Kubernetes Engine menu and click Edit on the cluster you wanna change. There should be a node pools section with expandable menus. Click on the one you want to change, set the size value to the desired count, and click Save.</p>
<p>So that’s node pools. Now that we understand the makeup of clusters a little bit more, let’s go ahead and create one. The command to instantiate our basic cluster is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container clusters create cluster-name</span><br></pre></td></tr></table></figure>

<p>Now, this will just spin up a minimal cluster with default values and a specified name. You’ll likely have to at least add a –zone argument if you don’t have a default geographic zone configured. The container clusters create command actually has a lot of optional flags to configure all of the things we saw in the web console, stuff like machine type and region, number of nodes, etc.</p>
<p>Now, after running this command, at this point, all we have is a Kubernetes cluster running with no actual application. Now, we can launch an application in container form by using the deployment controller, that is by creating a deployment with a command like so. We do:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create deployment app --image=$ImageRepo:$Tag</span><br></pre></td></tr></table></figure>

<p>This will create a running application here, named app, using an image of our choosing. So before we can run this, we need to deal with that <code>--image</code> argument. Kubernetes needs the location of your container registry, as well as the tag. Now, the container registry, it doesn’t actually have to be in Google Cloud. It could be Docker Hub or AWS ECR or somewhere else. As long as we can provide GKE with the right URL and credentials, we can access our images from anywhere.</p>
<p>Google Cloud, however, it does have a container registry service. In the console, all you have to do is enable it. You enable the Container Registry API and you can use it. It’s just a couple of clicks. We’ll have a documentation link <a target="_blank" rel="noopener" href="https://cloud.google.com/container-registry/docs/quickstart">here</a>. And when you push Docker images to the registry, you should see them in the UI. You can click on the image’s button in the Container Registry section and then, select individual images to see details. This is a really convenient way to check names, tags, dates, other information about your images.</p>
<p>So in our video demo, we’ll run through the Docker commands for building images, logging in, and pushing them to the repo. For our purposes here, we can use one of GCP’s sample applications for the image argument and we can run it as so:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create deployment hello-server --image=gcr.io/google-samples/hello-app:1.0</span><br></pre></td></tr></table></figure>

<p>So that’s the hello app, tag 1.0, we run this and with that, we have deployed a container application to our GKE cluster. We can see cluster health in the console or by running kubectl or gcloud commands, and congratulations, you’ve got something running. However, this is just the start of the fun. We need to go a bit deeper. We need to understand what we just did.</p>
<p>In our next lesson, we’ll learn more about controllers, services, and pods. It’ll be a blast. See you there.</p>
<h3 id="Lectures-1"><a href="#Lectures-1" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Working-with-Pods-Services-and-Controllers"><a href="#Working-with-Pods-Services-and-Controllers" class="headerlink" title="Working with Pods, Services, and Controllers"></a>Working with Pods, Services, and Controllers</h1><p>Working with pods, services, and controllers. In the last lesson, we reviewed how to spin up a cluster and execute a simple deployment. By the end of it you had a simple app running, however, it probably all seemed a bit magical if you’re not already very familiar with GKE and Kubernetes. In this lesson, we’re going to break things down further to ensure you know what is really going on under the hood.</p>
<p>So let’s start by talking about the pod we launched. Remember this is our workload, usually defined by a single container taken from an image repository. We used a sample image from a public <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> repository. We deployed it by running a create deployment command using kubectl, the Kubernetes command line tool. The deployment is the controller for a given pod or set of pods.</p>
<p>So why did we use a deployment controller at all? Why bother using a controller in the first place? Couldn’t we just generate pods without that construct as overhead to deal with? Well, technically yes, we could just create pods, but this is bad practice. In general, with Kubernetes, we always want to use controllers when creating pods. This is, as the name implies, meant to give us more control. It reduces our maintenance and monitoring workload considerably to have a controller responsible for the state of pods. It lets us ensure that pods are healthy, that we have the right number, that the right networking is there, the right configuration, etc., etc. In general, in Kubernetes, we want to work with the highest level of abstraction possible, so we prefer to work with controllers instead of individual nodes or pods.</p>
<p>So, for now, we can get a bit more information about the pods that are running, by running this command: <code>kubectl get pods</code>. This will spit out some basic information about pods running in a cluster. We should see 1&#x2F;1 running, meaning the cluster expects one pod and sees one pod. We see its age, we see its status, we see the number of restarts. We can now add more pods to this cluster a few different ways. We can use the web console by navigating to Kubernetes Engine UI. And there we just click on the Workloads button and from there we can click on Deploy to launch more pods. There is a default nginx pod we can do just to test that out. And by default, this will create three pods out of the same container. And again it will do this by using the deployment controller.</p>
<p>We can get information about our deployments by running this command: <code>kubectl get deployments</code>. This will show us our available deployment controllers. Here we aren’t seeing nodes or pods, but rather deployments, which are kind of an abstraction level higher. So we will see the hello-server deployment which you might recall was the name we gave the deployment in the command. And also remember that a deployment is a type of controller, and crucially it can work with other controller types to both execute updates and ensure that our apps are in a desired healthy state. In this example, our pods are also running using the ReplicaSet controller.</p>
<p>So we can actually see this by running a command: <code>run kubectl get replicasets</code>. And we should see both the hello-server and the optional nginx-1 application if you launched it. They should both pop up since they’re both ReplicaSets. Now if we were to run a similar get command for DaemonSets or StatefulSets, <code>kubectl get daemonsets</code>, or something like that, it will return nothing, because the pods we have launched so far do not use those controllers.</p>
<p>ReplicaSets work really great for stateless apps that are easily distributed across a set of nodes. Recall that DaemonSets are designed for scenarios when we want to ensure that all or a specified set of nodes run a copy of the pod. And when we need that mapping of pods to nodes. When we care about hardware-level mapping, basically, that’s when we use a DaemonSet, and when we care about state, pod deployment order and persistent storage, then we will want to use a StatefulSet.</p>
<p>So now let’s talk a little bit about services. If we run <code>kubectl get services</code>, the only thing that should come up is something named Kubernetes, initially. This is the default service for the cluster that is unrelated to the pods that we have created. So how do we go about exposing our pods running as ReplicaSets to the public internet? Well to do that we need to create services, and this will create generating some additional config. We can create that config as a YAML and run a <code>kubectl apply,</code> run that command to execute that config in the cluster. We could also run a <code>gcloud</code> or <code>kubectl</code> command with some arguments. Or, easiest of all, we can go into our GKE console and click on Workloads. And from there we just click on the pod we care about, for example hello-server, and then just click the blue Expose button to generate a service. Once we do this it will ask for a port mapping before assigning an external IP. Now by default GKE will create a load balancer type service, but recall that there are other options here such as a ClusterIP or a NodePort service. </p>
<p>So pat yourself on the back. You now know enough Kubernetes and GKE to really kick some butt. You should have a sufficient grasp of pods, services, controllers to not only spin up a cluster, but also to deploy resilient services using appropriate controllers. To really lock in our understanding though, we need to see all of this in action. That’s what the next section, the video demonstration, is designed to do. See you there.</p>
<h3 id="Lectures-2"><a href="#Lectures-2" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Kubernetes-Demo"><a href="#Kubernetes-Demo" class="headerlink" title="Kubernetes Demo"></a>Kubernetes Demo</h1><p>Welcome to our video demonstration on GKE in GCP. That’s Google Kubernetes Engine in the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">Google Cloud Platform</a>. In this demo, we’re gonna do a few fun things. First, we’ll create a basic application package, using Docker, and then upload it to a registry. Second, we’ll create a GKE cluster and deploy our app into it and see it running. And then finally, we’ll expose the app to the internet before scaling it up and practicing deploying a new version of the app, an upgrade essentially. So we’ll do most of these things using the GCP Cloud Shell. And also, maybe occasionally the Web Console a bit. So feel free to follow along at home in your own account.</p>
<p>Now, this tutorial comes mostly from GKE’s own documentation. So we’ll <a target="_blank" rel="noopener" href="https://cloud.google.com/kubernetes-engine/docs/tutorials/hello-app">link</a> that below. You’re welcome to just go and look at that. It’ll help if you have questions. If you do plan to follow along, be sure that the Kubernetes API is enabled. You can do this by just going into Kubernetes Engine on the console. Or you can do it if you’re running from your local laptop or something, you can run the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud components install kubectl</span><br></pre></td></tr></table></figure>

<p>And it should just set it up for you. So make sure that’s ready to go. So let’s get started. Okay, so to start, we need a Docker image with our application code, we need to prepare that. So we could build our own Dockerfile from scratch and using our own app code and test everything, but we’re gonna be lazy. Instead, we’re just going to save some time by taking one of GCP’s test projects. So we can just clone that using git, like so. And once we have it cloned, we’ll just cd into the directories, we wanna use their hello-app, and what we need to do after that, so it’s actually four commands, we clone it, we cd into the directory, we’re gonna export a project ID environment variable, and then we’re gonna do the Docker build.</p>
<p>So we’re gonna do <code>export PROJECT_ID=[PROJECT_ID]</code>, which we can get right from the console. And then we’re gonna do a Docker build of that. So the only thing you might have to look up is the project ID. You can get it right from the console if you don’t know it. And there’s other ways to get it. We’ll have a <a target="_blank" rel="noopener" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifying_projects">link</a> for that. But once that’s done, you’ll build your image and you’ll have it locally in your Cloud Shell environment. </p>
<p>Now what we have to do after that is, so you can see it building, just give it another sec. But what we have to do after it’s finished building, see it’s finished right here, is we have to push the image to a Docker registry. Because we can’t play from our shell environment, we need it in Google Cloud registry. And that we can do pretty quickly. We can do that with just two commands. We need to first run this. This is <code>gcloud auth configure-docker</code>, and what this will do is it will set the right credentials for a Docker push command, for Docker to push the image to our container registry. And then we just run the Docker push command, which will take the image that we just built, and it will push it to our Google Cloud container registry with the ID that we set, and with the tag that we set, we have hello-app tagged with the v1, it’s our version one. So just give this a sec, it needs to execute. And there you go. Well, it was already there, but it’ll go for the first time, you’ll see it. </p>
<p>Okay, so now that we have the image in the Docker in the container registry, we need to deploy it somewhere, right? We need a cluster to deploy it too. So how can we do that? How can we get a GKE cluster running? There are a few ways to do this. But the simplest way, if we don’t already have a cluster running, is to use the <code>gcloud container clusters create</code> command. Now before we run that, we’re going to set the project ID in our environment.</p>
<p>Okay. And so after that, we have to set our zone, our region where we’re going to actually deploy or create the cluster. So we’ll do US east1-b. And so these two configuration options, the project ID and the zone, this just tells Gcloud what project to associate the cluster with, and where geographically to create it.</p>
<p>So once we have that configuration set, we can run the <code>container clusters create</code> command. Now we see a couple of warnings here, just issue going on around this time, November 2019. But after a while, it’ll take a few minutes, we will see the cluster come up. And it takes a minute because it has to actually create the VM instances that will host the Kubernetes infrastructure and it has to set up some networking. But once it completes, you should be able to see the instances with a gcloud list command. So eventually the cluster will come up, it’ll be finished, it’ll be in a healthy state.</p>
<p>We can see the instances if we run a <code>compute instances list</code> command. So you can see these two here are the two instances we created for GKE hello-cluster. And we can also see it from running a container clusters list. So we should see our cluster come up, and we should see it’s in status running two nodes. So that should be good. So now that we have a cluster running, and we have an image that’s been uploaded, how do we go about deploying that image into our cluster, right? It must be pretty involved, we have to set up deployment configuration, we have to download the image, we have to run it, we have to sync everything, you know, probably requires a lot of work, right? Well, no, actually, it’s pretty simple. We can do the deployment with a single command. We run <code>kubectl create deployment</code> like so, we pass a couple of arguments. We’re gonna call it hello-web, that’s the name of our deployment. And we’re going to pass in the image we wanna use with –image. And that’s our gcr.io. That’s the cluster, the container repository for GCP. And we’ll put in our project ID and the name and tag we had.</p>
<p>So this literally does everything, this one command. We’re leaning on the deployment controller functionality to do most of the legwork. So we’re telling Kubernetes to create a pod using that image. So we can actually see if we do <code>kubectl get pods</code>. And we’ll see there’s our, the pod, the image running in the deployment. And it’s going to create the deployment controller. That’s what keeps everything running. And it’s what moves us from the empty cluster to the desired state. It’ll keep things that way until we make a change.</p>
<p>So now let’s have some fun. Let’s go ahead and make a service. Let’s expose our app to the public internet. We can do that also with a single command. We’re just gonna do <code>kubectl expose deployment hello-web</code>. So this is similar in that we are working with the deployment controller again. So please note that we use expose on the deployment, not on the pod. The deployment is responsible for the overall app configuration. And as far as best practices go, in general with Kubernetes, we wanna work at the highest level of abstraction possible.</p>
<p>So we wanna work with controllers instead of pods or nodes. So in this command, we tell Kubernetes to create a service, a load balancer type service, set to accept traffic on port 80. And that is going to target, it’s gonna be route trafficked to port 8080 for the container. So we can actually see that as well, we can do <code>kubectl get service</code>. And we should see there’s our service running. There’s actually two. There’s the Kubernetes kind of default service here. And then there’s the new one, the load balancer one right here. And we can see it has an external IP address. And we can see if we can hit that. And we can, there is our application. Hello world, version one, host, yada, yada, yada. So pretty cool. We’ve got a running service exposed to the internet.</p>
<p><a target="_blank" rel="noopener" href="https://cloud.google.com/kubernetes-engine/docs/tutorials/hello-app">https://cloud.google.com/kubernetes-engine/docs/tutorials/hello-app</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifying_projects">https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifying_projects</a></p>
<h3 id="Lectures-3"><a href="#Lectures-3" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Section-Two-Introduction"><a href="#Section-Two-Introduction" class="headerlink" title="Section Two Introduction"></a>Section Two Introduction</h1><p>Welcome to section two. In this second half of the course, we’ll be focusing on <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a>‘s App Engine service. Since this course assumes you already have some familiarity with App Engine, we won’t spend time explaining what App Engine is, and instead, we’ll dive right into spinning up a basic app in the very next lesson. After that, we’ll get into some of the critical management components. First with a lesson on configuring application traffic, and then after that with a lesson on autoscaling. As with the previous section, we will end with a video demonstration, walking through the entire setup and deployment process. So if you’re ready, let’s dive in.</p>
<h3 id="Lectures-4"><a href="#Lectures-4" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Creating-a-Basic-App-Engine-App"><a href="#Creating-a-Basic-App-Engine-App" class="headerlink" title="Creating a Basic App Engine App"></a>Creating a Basic App Engine App</h1><p>Creating a basic App Engine app. This lesson will be a walkthrough of how to create a simple Python service using App Engine. Our focus will be on using the command line tools instead of the web console. While the console is nice for beginners thanks to its setup wizards and friendly UI, the terminal is really where our understanding is properly crystallized, so without further ado, let’s dive in.</p>
<p>Now, first, we need a proper shell environment. As before, we can work from any computer that has the Google Cloud SDK installed. We could connect to a remote server using SSH and install the gcloud tools there or perhaps easiest of all, we could just use the GCP Cloud shell tool from the console, right from our browser.</p>
<p>Now, whichever you choose, the first thing you’ll need to do from the command line is create your App Engine project. This is basically the highest level abstraction for your app. App Engine apps are tied to a project in your <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> account, so you will need your project ID to run the app create command. You can get your project ID from the web console or from running <code>gcloud projects list</code>. So the command for creating your App Engine project will be <code>gcloud app create --project=$PROJECT_ID</code>, so this will create the project.</p>
<p>Now, to verify, you run <code>gcloud app describe</code>. So congratulations, we’re done, right? Well, not quite yet. We don’t just want some empty App Engine framework with no actual service running. We want to deploy something, so for this lesson, we’re going to just use the sample Python app from GCloud’s own documentation. Now, if you’re not very familiar with Python development, I recommend using the GCP Cloud shell, as it is a standardized environment, so you won’t have to worry about Python version or library dependencies. To set up the needed gcloud components, we start by just running this command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud components install app-engine-python</span><br></pre></td></tr></table></figure>

<p>That will take care of the environment configuration for Python, and then, after that, we need to actually get the code. We need to clone that from GitHub, so we’ll do a Git clone. The <a target="_blank" rel="noopener" href="https://github.com/googlecloudplatform/python-docs-samples/">URL</a> will be posted below. And so, now, we have the code that we intend to deploy. The actual hello world app we want is in the following directory <a target="_blank" rel="noopener" href="https://github.com/GoogleCloudPlatform/python-docs-samples/tree/master/appengine/standard/hello_world">here</a>, it’s under python-docs-samples&#x2F;appengine&#x2F;standard&#x2F;hello_world. And then, if you wanna try it out and see what it does, you can actually run this command here, <code>dev_appserver.py app.yaml</code>.</p>
<p>Now, this will start the app server and run the service. Now, if you’re doing this from the GCP Cloud shell, all that you’re gonna see is some output showing that it’s running. This is a decent test, but it’s not really what we want. What we’d really like is to see is the app running in a browser and we can’t do that from running it on localhost in Cloud Shell, at least not trivially. If you happen to be doing this from your laptop or desktop, you can browse to the app. Using a browser, you can go to <a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a> and you should see your output.</p>
<p>Now, either way, we still need to actually deploy this thing, right? We need to make it into a real web service reachable from the public internet. Now, fortunately, this is pretty easy to do since it’s a completed project. All we have to do is, in that same hello_world directory, we run <code>gcloud app deploy</code>. This will use the app.yaml file in that directory for instructions, and then, actually deploy it to the public internet.</p>
<p>So to actually see it from the browser, you run <code>gcloud app browse</code>, and this will give us the URL that we can navigate to to see the app running. Now, for more fun, go ahead and look at the main.py code to see what the app actually does. Feel free to edit it. You can make it output a different message if you’d like. So with that, we can end our first lesson. You now know the basics of deploying an app in App Engine using the shell. This is, of course, a very simple case. We’ll need to go a bit deeper on the actual App Engine configuration, so that you can build confidence for using it in different scenarios. We’ll start on that in our next lesson. See you there.</p>
<h3 id="Lectures-5"><a href="#Lectures-5" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Configuring-Application-Traffic"><a href="#Configuring-Application-Traffic" class="headerlink" title="Configuring Application Traffic"></a>Configuring Application Traffic</h1><p>Section Two Part Three: Configuring Application Traffic. Welcome to Part Three. Now that we’ve gotten our feet wet with App Engine and actually deployed a basic app using the command line, let’s go a bit deeper by looking at how configuration works. Our goal in this lesson is to understand how to configure traffic to different parts of our App Engine environment. However, before we do that, we should review a bit about App Engine generally just to set the foundation.</p>
<p>So recall that there are two types of App Engine environments, Standard and Flexible. The core difference between the two is that the Flexible environment gives you direct control over your application runtime via docker files. You can enable root access to the underlying VM instances. So overall, this is a better option if you have a more unique environment use case, hence the name Flexible. Now the main trade off is that the Flexible environment is slower and it’s less resilient. Instances take minutes to deploy and start up and the instances are automatically restarted more frequently by GCP. You also don’t get access to all the same App Engine API, such as the users and images APIs, which are useful for scripting an environment automation. Another difference is that the Standard environment has a bit more flexibility with its autoscaling options. Now we’ll go into that in the next lesson.</p>
<p>But generally speaking, if you’re using App Engine to go serverless, you’re probably gonna wanna use the Standard environment for its greater speed, reliability, and feature richness. The Flexible environment is more for niche use cases. For most of the remaining lesson and demo content, we’ll be making use of the Standard environment. But keep in mind these differences with the Flexible environment in case you have need of it.</p>
<p>Now whichever environment you use, you’re going to configure your app with YAML files. Only one YAML file is absolutely required, and that is the app.yaml file. This is for application level settings. An application may be made up of multiple services. And these are configured in service.yaml files. You can have more than one service.yaml file in your applications root directory. Now for a fairly simple app, this is okay. But for something more complex, it is better practice to have separate subdirectories for each service.</p>
<p>So here’s a sample app.yaml file. This is the one for the Python app we launched in the last lesson. One line, “r<code>untime: python 37</code>“. As you can see, our app.yaml file is pretty simple. The only thing app.yaml really needs is runtime, is to specify a runtime and potentially a version parameter.</p>
<p>Now if we wanted to, we could break this out into a separate service by using a service.yaml file. And it would look pretty similar, with the only difference being that the service.yaml file generally starts with a field called “service”. So it would look something like this.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">service: python-service</span><br><span class="line">runtime: python37</span><br><span class="line">api_version: 1</span><br><span class="line">threadsafe: true</span><br></pre></td></tr></table></figure>

<p>We have a service name, runtime. And we can also put in an API version, and some other config. Now a more complex app might have several of these service.yaml files to create microservices, to create a microservices architecture within App Engine. Now aside from this, there are five other optional configuration files that can help you to extend your app’s overall functionality. And these are dispatch.yaml, queue.yaml, index.yaml, cron.yaml, and dos.yaml.</p>
<p>So real quick, let’s go through them. Dispatch.yaml is for overriding routing rules. You set this file in your application root directory and you use it to route incoming requests to specific services based on specific paths or host names in the URL.</p>
<p>Queue.yaml is for configuring push and pull task queues. This lets us define retry parameters, such as minimum back off time in seconds or, and a maximum task age, for example. We won’t be doing any queue-based services in this course. But we’ll link to the documentation. If it’s relevant to your use case, definitely take a look at this, queue.yaml.</p>
<p>Now dos.yaml is a security feature that lets you blacklist IP addresses or subnets to protect your application from DOS attacks.</p>
<p>And then cron.yaml lets you define scheduled tasks. You set a schedule, such as every 24 hours, or every Monday at six p.m. and then give it a URL for a task definition, much like a typical cron job. The task definitions should live in the specified path. Now, this is very handy for maintenance, monitoring, and other standard automated tasks that you might want to configure and have in one easy to work with location.</p>
<p>And then finally, there is the index.yaml. Now you may have noticed that in our simple Python app from last lesson, an index.yaml file was automatically generated. This file is a reference of properties on various application entities. For simple applications, you will not have to manually edit this file at all. App Engine will automatically update it for you.</p>
<p>So, now that we have some strong background on App Engine configuration and environments, let’s talk about traffic management. There are a few use cases that we need to consider. As mentioned above, we know that we can control service routing by using the dispatch.yaml file. But what about running multiple versions of a service for A&#x2F;B testing or migrating traffic to a single specified version?</p>
<p>To do these two things, we need to talk about traffic splitting and traffic migration. Splitting refers to taking a percentage of our traffic and directing it to one or more distinct versions of a service within our app. Migration refers to the opposite process, moving traffic that’s split among different versions to a single specified new version. So let’s start by talking about splitting. The first thing to know is that traffic splitting is automatically applied if the URLs in your service do not specify an app version. So if you have multiple service.yaml files with different versions of the same service and the URL in your app.yaml file do not have version parameters at all, then traffic will be split automatically and randomly. If you wish to be more precise, you can explicitly enable traffic splitting in the console or by using G Cloud CLI tools or the GCP API.</p>
<p>So for example, if we did this in the console, we would just go to the application page in App Engine and select the versions we want to split. Click on Split Traffic, and then just put in the percentage each service should receive.</p>
<p>Now we could do the same thing with the G Cloud CLI tool with a command like this. Here we have “<code>gcloud app services set-traffic</code>“ and a number of flags here. Now if you look at these flags here, there’s one option you really need to note. It’s the one that says “IP_OR_COOKIE” options in the dash dash split by flag. We have to tell App Engine whether to split traffic using IP address splitting or cookies.</p>
<p>IP address splitting is easier to do. It will just make App Engine hash the request’s IP address from zero to 999 and then route based on whatever random value it gets. This isn’t as precise as cookie routing, though, because of how IP addresses tend to be somewhat ephemeral, particularly from cellphone traffic and from the public internet. IP address splitting is also bad for traffic coming from internal <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> services because those services tend to utilize a small set of internal IP addresses. That will get stuck to the same version of your app.</p>
<p>So for better precision, you should use Cookie-based splitting. The trade-off here is that it will take a bit more setup because the application will look for a specific HTTP request header. So you may need to make a code change in your app to deal with this, but it will help ensure you get a precise split for traffic.</p>
<p>And then finally, let’s talk a little bit about traffic migration. In the Standard App Engine environment, we can choose to migrate traffic either immediately or gradually. In the Flexible environment, we can only do it immediately. There’s no option for gradual migration. When we do an immediate migration, you’ll generally see a spike in latency, as it causes all instances of the older version of your service or services to shut down. For a latency-sensitive application, this could be a deal-breaker, as you could see requests hang or it can drop as the traffic is rerouted.</p>
<p>For the Standard environment, the solution is to use gradual migration. This is configured in your app.yaml file with this one setting here, “<code>inbound_services: - warmup</code>“. And with that, you are informed and ready to deal with migration, splitting, and deployment in the App Engine world.</p>
<p>Phew, okay, so we made it through a deep dive into App Engine environments and configuration and traffic. You’re almost ready to really do some damage. In the next short lesson, we’ll talk about autoscaling and deployment. If you’re ready, let’s get going. Cheers.</p>
<h3 id="Lectures-6"><a href="#Lectures-6" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Autoscaling-App-Engine-Resources"><a href="#Autoscaling-App-Engine-Resources" class="headerlink" title="Autoscaling App Engine Resources"></a>Autoscaling App Engine Resources</h1><p>Autoscaling App Engine resources. To understand how scaling works in App Engine, it’s important to first remember that even though we think of App Engine as serverless, in reality, all of our code must run on virtual instances somewhere within <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a>. So when we talk about scaling, we’re talking about scaling that underlying hardware, the virtual instances of GCP.</p>
<p>Now, first and foremost, we have to be aware of instance types. From App Engine’s perspective, there are two types of instances: dynamic and resident. Dynamic instances automatically shut down based on usage, while resident instances will run all the time, no matter what. The former is better for cost optimization, while the latter can improve app performance since you won’t have to wait for instances to restart.</p>
<p>Next, we should talk about scaling types. There are actually three types of scaling in App Engine: Automatic, Basic, and Manual. Automatic scaling is the most common type. It will create dynamic instances based on specific metrics, such as response latencies or request rate, and you can also specify a minimum number of idle instances that will run as resident instances to maintain a baseline.</p>
<p>So next, there’s manual scaling. As you can guess, this is done manually. This uses resident instances only. When set, App Engine will continuously run these instances irrespective of load. You can use manual scaling for temporary load spikes or performance tests.</p>
<p>And then, finally, there is what is known as basic scaling. When your application receives requests, dynamic instances come up. When the app becomes idle, all dynamic instances shut down, so, obviously, this is not suitable for latency-sensitive continuously running services. It is great, however, for intermittent work that is not latency-sensitive, such as the occasional user-initiated script or batch job or service. Basic scaling is not available in the flexible App Engine environment, so do keep that in mind.</p>
<p>And congratulations, that’s it, you’ve made it through all three of our rigorous lessons on App Engine. You have enough theory to launch a billion-dollar startup. Now, let’s go and put that theory into practice. Let’s have some fun. We’re gonna do a video demonstration where we will take our Hello World app to the next level. See you there.</p>
<h3 id="Lectures-7"><a href="#Lectures-7" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="App-Engine-Demo"><a href="#App-Engine-Demo" class="headerlink" title="App Engine Demo"></a>App Engine Demo</h1><p>Okay, welcome to our video demonstration for GCP App Engine. Now we’re gonna have some real fun in this little section here. We’re gonna actually play around a bit with a real app in the standard App Engine environment. Now, if you made it through the earlier four parts without too much trouble, you should have no problem following along with this demo, though, we do encourage students to actually try things out in their own <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> account, if possible.</p>
<p>So, there are gonna be basically three parts to this demo. First, we’ll quickly spin up a sample app in the standard environment. This will be identical to what we showed in part two, very quick. And then secondly, we will practice traffic splitting and migration by creating a second version of the service. So, that we’ll walk through how to configure traffic basically. And then finally, we’ll check out some scaling functionality, we’re gonna manually scale the app up and we’ll also go through the automatic and basic scaling system. We’ll just show how those are configured and that’s basically it.</p>
<p>So let’s get started. Welcome to our video demonstration of App Engine on GCP. We’re gonna have some real fun now. We’re gonna actually play around with a real app in App Engine using the standard environment. Now, if you made it through the earlier four parts without too much trouble, you should have no problem following along with this demo, we are going to encourage students to actually try things out in their own GCP account, if possible, but of course, feel free to just watch along. So, this demo has basically three parts.</p>
<p>First, we’ll review the how to spin up a sample app in the standard environment. This will be identical to what we showed in part two, we already have an app up and running for that. Secondly, we’ll practice traffic splitting and migration by creating a second version of the service. So, we’ll see the traffic shift. And then finally, we will check out some of the scaling functionality by manually scaling the app and walking through the automatic and basic scaling configuration systems. So that’s the basic plan.</p>
<p>So, now, let’s just review how we deploy a basic app. We start by ensuring that we have our project ID set in the environment. So, you’re gonna do an export project ID equals whatever your project name is. Here, it’s Test Project CA555. You can get your project ID and organization ID all from the dashboard pretty easily. So we’ll export that and what we need to do is get the actual App Engine code. We’ll just clone the sample project and that is from Google’s GitHub <a target="_blank" rel="noopener" href="https://github.com/googlecloudplatform/python-docs-samples/">directory</a>. So I do a git clone of that and then we will need to go into the directory with the App Engine configuration. So we’ll do this and that’ll take us into the Hello World app in standard App Engine, Python 3.7. Be sure to do the Python 3.7 version, there’s also a Python 2 version, but that’s pretty deprecated now.</p>
<p>So, once you’re there, you should see in the directory that it has the app.yaml, the main.py. That’s the actual Python code that we’re gonna run and a requirements file and a test file there. The app.yaml is what we’re interested in. That’s gonna, you know, be the actual configuration for App Engine. The only thing here now is the runtime definition, Python 3.7. And then the actual… The deployment command is pretty straightforward. We’re just gonna do gcloud app deploy to launch our app.</p>
<p>Now this one is already up. So it’ll go through it pretty quickly, but the very first time that you do this deploy, it might take a little while. You know, once it finishes, we should be able to go to the URL and see the code actually running. So, let’s just give this a second to complete. Okay and once that has completed, we can run this command, gcloud app browse to actually see the application in the browser. Sometimes you might see this error, did not detect your browser, go to this link instead, we can click on it and we can see it return “Hello world,’ which is really all the code is doing, we go into the main.py and we can see that it’s really just a server returning “Hello world.” That’s all it is.</p>
<p>So our app is up and running. Just like that, we have a basic app running in GCP using App Engine. So next, what we wanna do is to test how to do traffic splitting and migration and in order to do this, we’ll need a second version of our service and doing this is gonna require a little bit of file manipulation. Specifically, we’re gonna need to create two directories with the same service.yaml file and we’ll make a minor change in the Python code so that we can see that there are in fact, two different versions of the service running.</p>
<p>So, let’s go about creating those two versions of the service. The way we’re gonna do that is we’re going to create two directories. We’re gonna create a v1 and a v2 directory and then we’re, you know, we’ll see that we have them in the same directory as all of our code right now. So what we wanna do is copy all of our code into those directories. So we have a v1 and we will have everything in v2.</p>
<p>Now, it is important to copy everything. If you try to copy only the yaml and the Python code, it will fail. The requirements that TXT file is very important. If you look at it, you’ll see that it is what tells App Engine to install Flask and what version of it. So if you forget that, it’ll try to deploy an app, but it will be broken because it won’t have Flask. So make sure you do that. So, if we go into, let’s say, v2. and we look at our code here, what we’re gonna need to do is change the app.yaml file into a service.yaml file. So we can just change it to service.yaml. And then to make it its own… To make it a little bit more unique… Oh, so yeah, we keep the same configuration here, but to make the code different, we’re gonna go into the main.py and we’re gonna have it return something different. So instead of “Hello world,” we’ll say this is the other version. Keep it very clear.</p>
<p>So, now we can actually deploy this as another version of the service by doing a similar command, we’ll do gcloud app deploy and this time we’ll pass in service.yaml. And, again, it’ll use the same… It’s the same basic default service, but now it’ll have another version with this different code. So hit the deploy, we confirm, it’ll take a minute to come up. So let’s just wait for that.</p>
<p>Okay, so now that that has finished deploying, we can see again, gcloud app browse if we wanna get the URL for the service, but before we do that, just to verify that we have two versions running, in the console, we can check and see this. We can see it in two places, in the services page, there should be a two under the number of versions there. So we can click on that or we can click on versions and we can reload this. Sorry, here. We can see that if we refresh it, there are two versions here. One of them is getting 100% of the traffic, the other is not.</p>
<p>Now, if we do check the versions here, this is the one getting 100% of the traffic. If we click on it, it’ll return the service output, which is the other version, the new one instead of “Hello world.” If we click on this one, this is the older one that outputs “Hello world.” Now, this is not the official service URL. This is not the app URL. This is just for those individual versions of the service. If we look at the app URL, gcloud app browse, we will get this app URL, testprojectca555.appspot.com and it’ll give us this is the other version. It’ll do that because 100% of the traffic is going to the new version that we just deployed. You can see it has a more recent timestamp. So, the console gives us these two URLs to see the two versions of the service, but the service itself, remember the traffic allocation is what determines what a user will see.</p>
<p>So now we have to think about splitting the traffic and migration. So that’s gonna take a little bit of work, but nothing too tricky. So, let’s start by talking about traffic splitting. If we wanna do traffic splitting, we can do that from the command line, but it’s a little bit clearer in demo if we use the console. So, what we’re gonna do is click on traffic split here and remember that there are IP address and cookies splitting types. For when you need a very precise split, you use the cookie type, though it takes a little more configuration. The IP address one is a little bit simpler. There’s also this random option here, you can see. So we’re gonna pick that and we’re gonna click on, you know, the other version of the service here, these are the two versions running and we can decide what percentage we want. Let’s say we want 50&#x2F;50. So half the time, it should randomly choose the “Hello world” output and half the time it should choose the other one.</p>
<p>So we click save, it’ll update our traffic settings, just give it a moment to execute. Okay, that should be done. Now we go back to our Services page. Still, there are two versions there. Go to the versions page, we can see there’s a 50&#x2F;50 split. So, if that’s the case, we can test this pretty clearly by going to the app URL and half the time we should get hello world, half the time we should get this is the other version. So let’s click on it. There’s “Hello world.” Reload. This is the other version. Reload. “Hello world.” Reload. Well, there’s “Hello world” again, but as you can see, it’s randomly choosing 50&#x2F;50 between the two versions of the app. So we have the two versions of the service. So we have successfully split our traffic and the nice thing is that migrating back to a single version is similarly very easy.</p>
<p>We can do it through the web console with just a few clicks. What we do is we click on the version that we wanna migrate to, let’s say the newer one, we wanna get that back to 100% of the traffic, all you do is click migrate traffic and confirm. And then in a matter of seconds, 100% of the traffic will go to the newest version of the service. Executed, now we’re back at 100%. We should only get this is the other version now. If we reload it, we can see that that’s what’s happening. Right, there’s three times, so. So there you go, splitting and migration, pretty straight forward.</p>
<p>So let’s do some scaling. Scaling, there’s a few different versions of scaling within App Engine. In the standard environment, the easiest one to test since it won’t require any traffic manipulation, it would be manual scaling and manual scaling, we can configure at the level of individual services by just going to our service.yaml and what we’re gonna do is add a little bit of configuration.</p>
<p>Now one thing to note, another reason we’re showing manual scaling is that automatic scaling is enabled by default in the standard environment. There’s also the basic scaling option, but for demonstration purposes, this is actually much neater, much cooler. So how do we add scaling? Well, what we do is we add the manual scaling config to our yaml here, and we’re gonna set that to instance count of, let’s say five. Let’s say we want five instances backing our app. So what we do is we edit that and we redeploy it and we should see it. Oh. Actually, we have a light slight error there. We wanna make that into instances. Sorry. And then that should come up with five instances behind our app. So let’s just give that a sec to run and of course, be careful about the name of your configuration, instances not instance.</p>
<p>Okay, so the deploy completed and as we can see, a third version of the service came up because we did the app deploy again and this version will have five instances of traffic behind it, five instances behind it to manage the traffic. We can see here, they all just came up around the same time. So, the scaling is actually pretty fast. You’ll recall from the lesson that there is an option for more gradual scaling if you want or gradual migrations, but we’re doing just immediate changes here with the deploy command.</p>
<p>Now we can also migrate back with the same method by just deleting that configuration. We can go into service.yaml and just kill that and then just deploy it again. And again, by default, you know, we create a new service and all traffic goes to that… A new version of the service and all traffic will be split toward that new version. Now that’s a default that you can override by changing the splitting options or by migration.</p>
<p>So, let’s see if the instances go away for this new version. We’re doing our update, let’s give that a second to run. Okay, so the update completed. So now, again, if we go to our versions here, we’ll refresh, we’ll see there’s a fourth version now. It’s getting all the traffic and if we look at our instance count, there are no instances. They’re all gone because the scaling config was deleted.</p>
<p>So we can see, it’s really that simple to manually adjust the scaling with your App Engine services. So that’s basically it, congrats. That’s it for our App Engine demo. We’ve done quite a bit in just a few minutes. We spun up a basic app, we created multiple versions, we split traffic, we ran a migration, we scaled everything up and down, pretty cool stuff. You should have a good basic understanding. Thanks for toughing it out and cheers.</p>
<h3 id="Lectures-8"><a href="#Lectures-8" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>So congratulations! You made it! Give yourself a pat on the back because it has been a long and tough ride. We went through a lot of material so before we start celebrating let’s take a minute to briefly review what we’ve learned.</p>
<p>By completing this course you should have a very thorough understanding of how to configure and manage GCP’s App Engine and Kubernetes Engine services. You should be ready to spin up a cluster in GKE, create a Kubernetes deployment, and set up an autoscaling in App Engine with a basic app. Basically you should be ready to set up or take over administration of a <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/google/">GCP</a> compute environment. For clarity’s sake, let’s review the two learning objectives.</p>
<p>Number one: Learn how to manage and configure GCP Kubernetes Engine resources. We did this in section one. We not only covered how to manipulate cluster configuration using the web console and SDK, but we also reviewed basic Kubernetes concepts just in case you aren’t familiar with them.</p>
<p>Number two: learn how to manage and configure GCP App Engine resources. This was done in section two. We focused on setting up App Engine standing environment and autoscaling to help you establish that truly serverless experience.</p>
<p>With these two learning outcomes solidified in your mind, you should now be ready to dig in and build your own applications from scratch. You should also have the conceptual foundation necessary to branch out to other infrastructure platforms if you’d like. Go you!</p>
<p>Now that you are done I’d like to end by inviting you to send feedback about the course to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. We really appreciate your comments, questions, suggestions, really anything. Congratulations again on fighting through the whole course and good luck in your future endeavors.</p>
<h3 id="Lectures-9"><a href="#Lectures-9" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/introduction/">Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-one-introduction/">Section One Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-concepts/">Kubernetes Concepts</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/cluster-and-container-configuration/">Cluster and Container Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/working-with-pods-services-and-controllers/">Working with Pods, Services, and Controllers</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/kubernetes-demo/">Kubernetes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/section-two-introduction/">Section Two Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/creating-a-basic-app-engine-app/">Creating a Basic App Engine App</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/configuring-application-traffic/">Configuring Application Traffic</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/autoscaling-app-engine-resources/">Autoscaling App Engine Resources</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/app-engine-demo/">App Engine Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-google-kubernetes-engine-app-engine/conclusion/">Conclusion</a></p>
<h1 id="3Kubernetes-Concepts"><a href="#3Kubernetes-Concepts" class="headerlink" title="3Kubernetes Concepts"></a>3<strong>Kubernetes Concepts</strong></h1><p><a target="_blank" rel="noopener" href="https://cloud.google.com/kubernetes-engine/docs/">Kubernetes documentation</a></p>
<h1 id="4Cluster-and-Container-Configuration"><a href="#4Cluster-and-Container-Configuration" class="headerlink" title="4Cluster and Container Configuration"></a>4<strong>Cluster and Container Configuration</strong></h1><p><a target="_blank" rel="noopener" href="https://cloud.google.com/container-registry/docs/quickstart">Container Registry documentation</a></p>
<h1 id="6Kubernetes-Demo"><a href="#6Kubernetes-Demo" class="headerlink" title="6Kubernetes Demo"></a>6<strong>Kubernetes Demo</strong></h1><p><a target="_blank" rel="noopener" href="https://cloud.google.com/kubernetes-engine/docs/tutorials/hello-app">GKE Documentation</a></p>
<h1 id="8Creating-a-Basic-App-Engine-App"><a href="#8Creating-a-Basic-App-Engine-App" class="headerlink" title="8Creating a Basic App Engine App"></a>8<strong>Creating a Basic App Engine App</strong></h1><p><a target="_blank" rel="noopener" href="https://github.com/googlecloudplatform/python-docs-samples/">Python Docs samples</a></p>
<h1 id="11App-Engine-Demo"><a href="#11App-Engine-Demo" class="headerlink" title="11App Engine Demo"></a>11<strong>App Engine Demo</strong></h1><p><a target="_blank" rel="noopener" href="https://github.com/googlecloudplatform/python-docs-samples/">Google GitHub directory</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/34/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/34/">34</a><span class="page-number current">35</span><a class="page-number" href="/page/36/">36</a><span class="space">&hellip;</span><a class="page-number" href="/page/274/">274</a><a class="extend next" rel="next" href="/page/36/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
