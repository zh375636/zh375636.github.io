<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hang&#39;s Blog">
<meta property="og:url" content="https://example.com/page/93/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/page/93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Hang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Managing-Role-Based-Access-Control-on-Azure-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/15/AZ-500-Managing-Role-Based-Access-Control-on-Azure-7/" class="post-title-link" itemprop="url">AZ-500-Managing-Role-Based-Access-Control-on-Azure-7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:28" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:28-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:15:50" itemprop="dateModified" datetime="2022-11-20T19:15:50-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Managing-Role-Based-Access-Control-on-Azure-7/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Managing-Role-Based-Access-Control-on-Azure-7/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to Managing Role-Based Access Control on Azure. My name is Eric Leonard and I’ll be leading you through this course. I’m a Microsoft Azure MVP and an Azure content author at Cloud Academy. I have over 15 years of experience in IT, several of those working with cloud technologies in the public and private sectors. If you have a question, feel free to connect with me on LinkedIn and send me a message, or send an email to <a href="mailto:&#115;&#x75;&#112;&#x70;&#x6f;&#114;&#116;&#64;&#99;&#x6c;&#x6f;&#117;&#x64;&#x61;&#x63;&#x61;&#x64;&#101;&#x6d;&#x79;&#46;&#x63;&#x6f;&#x6d;">&#115;&#x75;&#112;&#x70;&#x6f;&#114;&#116;&#64;&#99;&#x6c;&#x6f;&#117;&#x64;&#x61;&#x63;&#x61;&#x64;&#101;&#x6d;&#x79;&#46;&#x63;&#x6f;&#x6d;</a>. Who should take this course? This course is intended for people who want to take the AZ-101 exam to become a certified Azure administrator, or for people who are tasked with administrating Azure resources and security.</p>
<p>To get the most from this course, you should have a general understanding of the Azure portal. We’ll begin the course by touching on an overview of managing role-based access control on Azure. We will then work through how we configure access to Azure resources, create custom roles, and finally go over some troubleshooting steps. By the end of this course, you should be able to configure and assign the appropriate role-based access controls. We would love to get your feedback on this course, so please give it a rating when you are finished. So if you are ready to learn more about managing role-based access control, let’s get started.</p>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>RBAC provides fine-grained access management to your resources in Azure. What this does is it allows you to segregate duties between different teams in your organization. As an example, one team could be tasked with managing VMs and a subscription, or someone could be tasked with cost management, or give your IT security team access to Azure Security Center. Making these RBAC examples work is by creating role assignments. Role assignments define how you can access resources in Azure. This can be at the management group level and all the way down to the resource itself. A role assignment consists of three elements, the security principal, the role definition, and the scope you apply it to. A security principal can be a user, group, service principal, or managed identity that requires access to Azure resources. A role definition is a list of actions that you can or cannot do. Your role definition could allow you to create and manage virtual machines but prevent you from deleting them. </p>
<p>The following are the most common or known RBAC roles. Owner provides full access to resources in Azure, and you can delegate access to other users. Contributor, just like the owner role, provides full access to resources in Azure, but you cannot delegate control. As the name implies, the reader can only view resources in Azure. And lastly, the user access administrator role is granted permission to manage access to Azure resources. Beyond these fundamental roles, Azure provides many built-in roles to meet your organization needs. As an example, the security admin role provides access to Azure Security Center, where they can read, edit security policies, and view and dismiss alerts. The last element is scope. In Azure, the RBAC roles can be assigned at different levels depending on how wide you want to provide access. Scope can be applied at the management group level, or at the subscription, or at the resource group, all the way down to individual resources. Combining these three elements makes the role assignments work by defining the role definition it will apply to a security principal and then is assigned to a scope.</p>
<h1 id="Configure-Access-to-Azure-Resources"><a href="#Configure-Access-to-Azure-Resources" class="headerlink" title="Configure Access to Azure Resources"></a>Configure Access to Azure Resources</h1><p>Role-based access control is how you can manage access to resources in Azure. As you navigate through Azure, from the management group, subscription, resource group all the way down to the individual resources, you will notice a blade called Access Control IAM. This is where you can view, add and remove role assignments. Let’s go to the Azure portal and see how we can view, add and remove these role assignments. Here we are in the Azure portal under Resource Groups. Let’s select our resource group and we will notice that we have a virtual machine that is already deployed. Let’s give access to Ari as he is tasked with managing all virtual machines in this resource group. Click on Access Control. To add a role assignment, we can add it by clicking on the Add button on the right-hand side or we can hit the Add Role Assignment in the menu bar. Under Role, we will see a list of all the built-in roles possible. And we’ll scroll all the way down to Virtual Machine Contributor. In the Select field, we can search for Ari’s name, select his name and hit Save. Now Ari has access to this user’s group and to manage the virtual machine. </p>
<p>We can check Ari’s access by typing in his name. And here we’ll see the results of the access that he has. We can close that. As well as you can go to Role Assignments. Here we’ll see all of the role assignments for the resource group. Some of them are inherited and Ari is at the bottom, we’re a virtual machine contributor for this resource group. We can remove Ari’s access by selecting his user and clicking Remove. In this short demo, we added our user, Ari, to the virtual machine contributor role. We then verified his access by going to Check Access and reviewed the Role Assignments tab. We then finished off by removing the role assignment to the resource group.</p>
<h1 id="Activity-Logs"><a href="#Activity-Logs" class="headerlink" title="Activity Logs"></a>Activity Logs</h1><p>The Azure Activity Log provides visibility into subscription-level events that have occurred in Azure. Using the Activity Log, you can determine what operations were taken on the resources in your subscription. The Activity Log has eight categories. Administrative. This will contain all the records for create, update, delete, and actions operations performed. Here we will see events related to RBAC like create role assignment and delete role assignment. Service health. Service health will contain any health-related events that affect Azure. Resource health will contain the records of any resource health events that have occurred to your deployed resources in Azure. Alerts will contain all the alerts that were activated. Autoscale will include the records related to autoscaling. Recommendations. This will have the recommendations from Azure Advisor. </p>
<p>Security, which will contain all of the logs generated by Azure Security Center. And finally, policy. The policy will contain records of all effect actions performed by Azure Policy. The Azure Activity Log only retains records for the last 90 days, and if you need to keep them longer for auditing or compliance reasons, you will need to use an Azure Event Hub to send your logs to your security information and event management application or archive the records in an Azure storage account. For Role-Based Access Control, the Azure Activity Log will log any changes made to role assignments or role definitions in your subscription. The events will be recorded as create role assignment, delete role assignment, create or update custom role definition, and delete custom role definition.</p>
<h1 id="Custom-Roles"><a href="#Custom-Roles" class="headerlink" title="Custom Roles"></a>Custom Roles</h1><p>Create a custom role for RBAC. Azure has many built-in roles that cover most of the needs for any team, but sometimes those built-in roles don’t cut it. You can create your own custom role to meet those needs. Custom roles can be created using Azure PowerShell, Azure CLI or the REST API. For this demonstration we will use the Azure Cloud Shell to create a custom role using Azure CLI. Here we are back in the Azure portal, where we will create a custom role. To start we need to go to the Azure Cloud Shell. We can open the Cloud Shell by selecting the Cloud Shell icon at the top of the page, or we can open a new tab and go to shell.azure.com. We will be creating a custom role called Virtual Machine Operator. Let’s open Visual Studio Code and look at our custom role. Our template is broken down into several sections. We have the name of the custom role, then we have the IsCustom, which indicates that this is a custom role. We have the description, which provides a short description of the role so others can understand what this custom role does. Action, which specifies what you’re allowed to do. NotActions, which is to deny actions. And AssignableScope, this is where we will list our scope for our custom role. </p>
<p>Let’s apply the custom role to the subscription. Type in AZ role definition create dash dash role definition and the name of the file, which is vmoperator.json, and hit Enter. After we have applied the command we can go back to the Azure portal, where we will select our resource group and go to Access control, Roles and scroll to the bottom to find our Virtual Machine Operator custom role. You will notice that the icon is different to easily indicate that this is a custom role. If during your testing of the new custom role, you notice that the role cannot do a certain action, you can return to your role definition and add the missing action. In this instance we will allow the role the ability to schedule shutdowns. We will add the Microsoft.DevTestLab&#x2F;schedules. We will then save the file and then we’ll type AZ role definition update dash dash role-definition and the name of the file. If the custom role is no longer needed you can delete it by typing AZ role definition delete name and provide the name of the custom role. In summary, we looked at a custom role definition and reviewed all the sections. We then created a new custom role, updated the role and then deleted the roll as we no longer needed it.</p>
<h1 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h1><p>Role-based access control changes in Azure don’t always go as planned. Let’s look at some scenarios where you may encounter issues. Scenario one. You can’t create a new resource in a resource group. Check access control to verify the user has the appropriate role assignment. If the user is part of a custom role, verify that the role definition can deploy that resource. Scenario two. You attempt to add a role assignment in your subscription and you receive an error role assignment limit exceeded. In your subscription, there is a limit of 2,000 role assignments. If you see this error, consider assigning roles to groups instead of individual users. Scenario three. You attempt to create or update a custom role but you get an error. Confirm that the user has the Microsoft.Authorization&#x2F;roleDefinition&#x2F;write permission. Scenario four. You attempt to create a new custom role and you receive an error role definition limit exceeded. In your tenant, there is a limit of 2,000 custom roles. Scenario five. You make a change in Access Control or you add a custom role and the changes do not reflect in the portal or in the console. Sometimes these changes can take time to take effect. You can log out and re-log in to force the refresh.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>I hope you enjoyed learning about managing role-based access control on Azure. Let’s review what you learned in this course. RBAC provides fine-grained access management to your resources in Azure. A role assignment consists of three elements, the security principal, that’s the user group, service principal, or managed identity. Then we have the role definition, that’s the role definition which is a list of actions that you can or cannot do and lastly, the scope that it applies to. We configured access to Azure resources by going to Access Control at the resource group level where we can also make these modifications at the management group, subscription or individual resource levels. In the resource group, we added a role assignment, checked the individual access, reviewed the role assignments and then removed the access. The Azure Activity Log provides visibility into subscription-level events that have occurred in Azure. Using the Activity Log, you can determine what operations were taken on the resources in your subscription. </p>
<p>The RBAC events will be recorded as create role assignment, delete role assignment, create or update custom role definition and delete custom role definition. Activity logs are kept for only 90 days and if you need them for auditing or compliance reasons, you will need to export your logs using an event hub or a storage account. Custom roles can be created in Azure to meet the necessary requirements. You can use the Azure Cloud Shell with Azure CLI or PowerShell to create, update and delete role definitions. Adding role assignments or creating custom roles in Azure can lead to configuration errors. We reviewed some common scenarios in troubleshooting RBAC. To learn more about managing role-based access, be sure to read Microsoft’s documentation. Be sure to also watch for new Microsoft Azure courses on Cloud Academy because we’re always publishing new courses. Please give this course a rating. If you have any questions or comments, please let us know. Thanks for watching and happy learning.</p>
<h1 id="4Activity-Logs"><a href="#4Activity-Logs" class="headerlink" title="4Activity Logs"></a>4<strong>Activity Logs</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log#send-to-log-analytics-workspace">Sending to a Log Analytics Workspace</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Managing-Azure-Subscriptions-and-Resource-Groups-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/15/AZ-500-Managing-Azure-Subscriptions-and-Resource-Groups-6/" class="post-title-link" itemprop="url">AZ-500-Managing-Azure-Subscriptions-and-Resource-Groups-6</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:27" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:27-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:14:18" itemprop="dateModified" datetime="2022-11-20T19:14:18-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Managing-Azure-Subscriptions-and-Resource-Groups-6/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Managing-Azure-Subscriptions-and-Resource-Groups-6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to managing Azure subscriptions and resource groups. My name is Thomas Mitchell and I’ll be leading you through this course. I’m an Azure content author at Cloud Academy and I have over 25 years of IT experience, several of those with cloud technologies. If you have any questions, feel free to connect with me on LinkedIn or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course was developed with an eye toward people who want to become certified Azure architects or those who are simply tasked with managing and supporting Azure resources. To get the most from this course, you should have a general understanding of Microsoft Azure.</p>
<p>In the first part of this course, we’ll cover the management of Azure subscriptions. More specifically, we’ll take a look at some of the key built-in roles that are used to manage Azure subscriptions. These roles include contributor, owner, reader, and user access administrator. You’ll learn what each role does and what permissions each role grants. We’ll then get into subscription policies and how to apply them.</p>
<p>The second part of the course will cover resource groups and it will talk about resource policies and how to assign them. We’ll also cover resource locks and tagging. In addition to some lecture time, we’ll work through a few demonstrations to reinforce the concepts covered.</p>
<p>We’ll wrap up the course by covering how to move resources between resource groups and how to delete resource groups altogether.</p>
<p>By the end of this course, you should be able to effectively manage Azure subscriptions as well as resource groups within those subscriptions.</p>
<p>We love to get your feedback, so please give this course a rating when you’re finished. So if you’re ready to learn about Azure subscriptions and resource groups, let’s get started.</p>
<h1 id="Overview-of-Key-Roles"><a href="#Overview-of-Key-Roles" class="headerlink" title="Overview of Key Roles"></a>Overview of Key Roles</h1><p>Hello and welcome to key roles. To effectively manage Azure subscriptions and resource groups, you must be familiar with the different RBAC roles. What we’re going to do here is take a look at some of the key built-in roles along with some of the other more important RBAC roles.</p>
<p>The four key roles that I want to introduce you to are contributor, owner, reader, and user access administrator. The contributor role is used to grant full access to manage all Azure resources. However, this role does not allow the user to whom it’s been assigned to assign roles in Azure RBAC. In other words, a user with a contributor role assigned to him can only manage resources. He cannot assign roles to other users.</p>
<p>The owner role is similar to the contributor role. However, as you might expect, it grants additional permissions. Like the contributor role, the owner role grants the user to whom it’s been assigned full access to manage all Azure resources. However, it also allows the user to assign roles to other users in Azure RBAC. The owner role can be viewed as essentially having the keys to the kingdom for whatever resource it applies to.</p>
<p>The reader role is pretty self-explanatory. A user that’s been assigned the reader role will be able to view resources or read them, but will not be allowed to make any changes. User access administrators are allowed to manage user access to Azure resources and that’s it. They have no access to the actual resources themselves. Rather, they manage the access to those resources.</p>
<p>Now, these four key roles are not by far the only roles that are used to manage Azure subscriptions and resource groups. There are literally dozens or maybe even hundreds of different roles that are available depending on the Azure resource that you’re talking about. For example, for compute resources, we have roles like the virtual machine contributor which allows you to manage virtual machines without providing access to them. This role also blocks access to the virtual networks and storage accounts that virtual machines are connected to.</p>
<p>Other compute roles include virtual machine administrator login, virtual machine user login, and classic virtual machine contributor. There are even more built-in roles for networking resources, including network contributor which allows you to manage networks, but not access them.</p>
<p>There are several CDN-related roles as well that allow for different levels of CDN management. There are also several other networking-related roles to choose from. The same thing goes for storage, web, containers, databases, and a host of other types of Azure resources. The <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles">URL</a> on your screen provides a complete and updated list of all the different built-in RBAC roles that come into play when managing Microsoft Azure.</p>
<p>Now, I should point out that you aren’t going to be expected to memorize a list of hundreds of different roles, that’s just not practical, but you should really familiarize yourself with the four key roles that I mentioned earlier. They include the contributor role, the owner role, the reader role, and the user access administrator role.</p>
<p>You should also be aware that in addition to all of these built-in roles, you can create custom roles when necessary as well. That being said, the built-in roles are more often than not sufficient for typical environments. Join me in the next lesson where I’ll demonstrate how to add an owner to an Azure subscription.</p>
<h1 id="DEMO-Add-an-RBAC-Owner"><a href="#DEMO-Add-an-RBAC-Owner" class="headerlink" title="DEMO: Add an RBAC Owner"></a>DEMO: Add an RBAC Owner</h1><p>Hello, and welcome back. what I’m going to do here in this demonstration and admittedly, it is a, a brief demonstration but I wanted to just make sure that I showed you how you can use our back to add an owner to a resource or to a subscription.</p>
<p>So what we’re going to do here is add a second owner to the Azurelabs subscription here in my Azure environment. On the screen here, I’m logged in as the administrator for my red widget corporation a fictitious organization here, I guess it you will.</p>
<p>Now to add an owner to my subscription, I simply select my Azurelabs subscription here from my Microsoft Azure homepage here and then from Azure labs here see this access control here, or I am entry. What we do here is we go into access control. And from here, we can look at the existing role assignments for this specific subscription, and we can see we have administrator here as owner.</p>
<p>Now, if I want to add an owner to this subscription what I can do is click the add button here up in the top menu pane here. And we can add a role assignment, we can add a co administrator, or we can add a custom role.</p>
<p>What we’re going to do here is Add role assignment and then from here, we’ll select Owner. And then what we’ll do is we’ll make Joe Kinish an owner of this subscription. And now we can see that under the owner role assignment here for the Azure subscription, we have Joe Kinish listed and we can do the same thing for a complete resource group.</p>
<p>If we go back home here and we go into our Azurelabs resource group here we can see the focus is at the resource group level. And again, we use the access control entry here, or I am we can look at the existing role assignments and we can see Joe Kinish is already an owner at the resource group level because it’s inherited from the subscription. But if I wanted to add a user as an owner specifically at this level directly on the resource group we do the same thing, we click Add we’d Add role assignment, select Owner. And then what we could do is we could make, say Lester Murphy an owner here and there you have it. And that’s pretty much it. That’s how you add an owner at both the subscription level and at the resource group level.</p>
<h1 id="DEMO-Add-or-Change-Azure-Subscription-Administrators"><a href="#DEMO-Add-or-Change-Azure-Subscription-Administrators" class="headerlink" title="DEMO: Add or Change Azure Subscription Administrators"></a>DEMO: Add or Change Azure Subscription Administrators</h1><p>Hello and welcome back. In this brief demonstration here, what we’re gonna do is walk through the process of adding or maybe changing an Azure subscription administrator. Now on the screen here, I’m logged into the Azure portal. I’m at my home page here, and I’m logged in as an administrator here.</p>
<p>What we’re going to do is browse to Azure labs through either the recent resources that I’ve worked with which is a subscription here, or I can navigate to subscriptions under the navigate section here or I can browse to subscriptions through Azure services.</p>
<p>What I’ll do here is browse to subscriptions. And then from here, I can see I only have one Azure subscription here and it’s called Azure labs. So we’ll go ahead and open up our subscription. And it takes us to the overview page.</p>
<p>To add or change subscription administrators for this subscription, what we’re going to do is browse into access control. And before I do that, I just wanna make a quick note here. The Azure portal changes rather frequently or at least more frequently than I’d like it to. So don’t focus as much attention on where you’re clicking, the actual physical location, but more on what you’re clicking. And in this case we want to use, I am or access control for the Azure lab subscription.</p>
<p>So if you try this in your own environment and this access control link is somewhere else in the list then that’s fine. The idea is you wanna click access control. So that PSA out of the way, let’s go ahead and get into access control here. And we can see from access control.</p>
<p>What we’re going to do is add a subscription administrator. And to do that, we click add here, and then we have a couple options. Role assignment, the co-administrator which is what we’re going to do here or we’re going to add a custom role.</p>
<p>So to add our administrator, which is essentially a co-administrator, we select the co-administrator option and then from here, we can select the user we want to make a co-administrator. So for this demonstration here, we’ll select John Gold and we’ll make him a co-administrator of this Azure labs subscription. And if we select role assignments here we can see that our new co-administrator and even administrators for that matter are not shown. That’s because these permissions are not role assignments. They’re actually permissions over the subscription for actual administrators.</p>
<p>Now to remove that co-administrator, we can actually go into classic administrators. And that’s because this is more of a classic role. If we select classic administrators, we can see that John Gold is listed as a co-admin. And this is the important piece here. We can see that classic administrators are only needed if you’re still using Azure classic deployments.</p>
<p>If you’re not using Azure classic deployments you wouldn’t be assigning co-admin roles within your subscription. But I wanted to just show you what that was because if you happen to go into, I am, you’ll see that option here. So I wanted to at least let you know what this is and how you use it.</p>
<p>So what we’re going to do here is we’re going to remove John Gold as a classic administrator. And there we now have our classic co-administrator access removed for John Gold. Then from here, we’ll bounce back to the role assignments.</p>
<p>And from here, this is where you would want to grant the permissions to the subscription as you see fit. So with that, let’s call it a wrap and I’ll see you in the next lesson.</p>
<h1 id="Configure-Subscription-Policies"><a href="#Configure-Subscription-Policies" class="headerlink" title="Configure Subscription Policies"></a>Configure Subscription Policies</h1><p>The Azure Security Center creates a default security policy automatically for each Azure subscription. These policies can be edited and monitored for compliance in Security Center. Security Center policies can also be extended by using Azure policy, which is a service in Azure that you use to create, assign, and manage policies.</p>
<p>Because security requirements for development resources typically vary from the requirements for production resources, it’s critical to maintain policies that fit these requirements. As such, security policies are used to drive security recommendations and monitoring. This helps identify potential vulnerabilities and mitigates threats.</p>
<p>As you can see on the screen, the default security policy contains numerous policies and definitions that govern among other things, system updates, security configurations, endpoint protection, and disk encryption. The system updates policy retrieves a daily list of available security and critical updates and recommends that missing updates be applied.</p>
<p>The security configurations policy analyzes OS configurations to identify virtual machine vulnerabilities and recommends configuration changes to mitigate such vulnerabilities.</p>
<p>Endpoint protection and disk encryption policies make recommendations for protecting virtual machines from viruses and data theft. In addition to these policies, other policies are also useful for protecting the environment, such as network security groups, web application firewall, next-gen firewall, SQL auditing, and threat detection, SQL encryption, vulnerability assessment, storage encryption, and just-in-time network access. By leveraging all of these different policies, you can help identify potential vulnerabilities in the environment and mitigate any threats identified.</p>
<h1 id="Overview-of-Resource-Groups"><a href="#Overview-of-Resource-Groups" class="headerlink" title="Overview of Resource Groups"></a>Overview of Resource Groups</h1><p>A resource group in Microsoft Azure is a logical container so to speak. It is used to group a collection of Azure resources, such as virtual machines, VNets, storage accounts, et cetera into logical groupings for easy provisioning, monitoring, and access control.</p>
<p>Resource groups are also very effective for management of costs. A key benefit of using resource groups in Azure is that by grouping related resources together, they typically share a unified lifecycle. Although Azure requires the admin to specify a region when creating a resource group, resources contained within that resource group can span across multiple regions.</p>
<p>The requirement of a resource group being deployed to a specific region comes from the need to store the deployment metadata and definitions associated with that resource group in a specific location. As such, it doesn’t dictate that resources belonging to that resource group need to be in the same region as the resource group itself.</p>
<p>As easy as resource groups make management of Azure resources, it’s important to use resource groups with care. The key to clean and meaningful use of resource groups is an understanding of the resources that are included in them. For example, if a line of business application requires resources that need to be updated together, it makes sense to group these resources in the same resource group.</p>
<p>It’s equally important, however, to use different resource groups to separate out dev&#x2F;test resources, staging resources, production resources, et cetera. This is important because resources in each bucket so to speak will typically have different lifecycles.</p>
<p>In the upcoming lectures and demonstrations, you are going to learn how to manage resource groups by using policies, resource locks, and tags. You’ll also learn how to move resources between resource groups and how to delete resource groups altogether.</p>
<h1 id="Resource-Policies"><a href="#Resource-Policies" class="headerlink" title="Resource Policies"></a>Resource Policies</h1><p>IT governance is critical to organizations. It ensures achievable goals through effective and efficient use of IT by creating clarity between business goals and IT projects. As such, IT governance requires careful planning of initiatives and setting priorities on a strategic level to help manage and prevent issues.</p>
<p>Azure Policy helps accomplish this. Azure Policy is an Azure service used to create, assign and manage policies that enforce different rules over Azure resources. In doing so, such resources remain compliant with corporate standards and SLAs.</p>
<p>Azure Policy accomplishes this by evaluating deployed resources and scanning for those not compliant with the policies that have been defined. An example of this would be a case in which a policy is defined to allow only a certain size of virtual machine in an Azure environment. Such a policy once implemented would be evaluated when creating and updating resources as well as over existing resources.</p>
<p>Managing resources with Azure Policy begins with the creation of a policy definition in the portal. Attached to such a definition are conditions under which it is enforced along with an effect that takes place when the defined conditions are met.</p>
<p>Azure Policy offers several built-in policies that are available by default require SQL Server 12.0 contains conditions and rules to ensure that all SQL servers deployed use version 12. This policy denies all servers that do not meet these criteria.</p>
<p>Allowed Storage Account SKUs contains conditions and rules that determine if a storage account being deployed is within a certain set of SKU sizes. It denies all storage accounts that do not adhere to the defined set of SKU sizes.</p>
<p>Allowed Resource Type contains conditions and rules to specify which resource types can be deployed. This policy denies any resources that are not part of this defined list. Allowed Locations restricts the locations to which resources can be deployed. It is used to enforce geo-compliance requirements. The Allowed Virtual Machine SKUs policy restricts the set of virtual machine SKUs that can be deployed.</p>
<p>Apply tag and its default value applies a required tag and its default value to resources if it is not specified by the user. The enforce tag and its value policy enforces a required tag and its value to a resource. Not allowed resource types enables the ability to specify resource types that cannot be deployed.</p>
<p>To leverage these policy definitions as well as any other custom definitions, they need to first be assigned. This can be accomplished through the Azure portal, PowerShell or through Azure CLI. Policy re-evaluation happens about once an hour. As such, changes to a policy definition after implementation of the policy will be re-evaluated over the resources within the hour.</p>
<h1 id="DEMO-Assigning-Policies"><a href="#DEMO-Assigning-Policies" class="headerlink" title="DEMO: Assigning Policies"></a>DEMO: Assigning Policies</h1><p>Understanding compliance in Microsoft Azure requires the ability to identify the status of resources in a subscription. In this demonstration, we’ll walk through the process of creating a policy assignment to identify virtual machines that are not using managed disks.</p>
<p>To get started, let’s create a policy assignment and assign the audit virtual machines without managed disks policy definition. To do this, browse to the Azure portal, and then click All services. From here, search for Policy, and then select it from the results list.</p>
<p>Click Assignments in the left pane. An assignment is a policy that’s been assigned to take place within a specific scope. Next, click Assign policy from the top of the Policy Assignments page. From the Assign policy page, select a scope by clicking the ellipsis, and then choosing either a management group or a subscription. The scope determines which resources the policy assignment gets applied to.</p>
<p>Click Select at the bottom of the scope page. Exclusions are optional, so we’ll leave this option blank since we aren’t excluding anything. Click the policy definition ellipsis to open the list of available definitions. By default, Azure policy offers built-in policy definitions that you can use. For this exercise, we can search through the list of policy definitions to find the Audit VMs that do not use managed disks definition.</p>
<p>Click on that policy, and then click Select. The assignment name is automatically populated with the policy name, but that can be changed. For this exercise, we’re just going to leave Audit VMs that do not use managed disks. Adding a description is optional. The description, if used, should provide details about the policy assignment itself.</p>
<p>Assigned by is filled in automatically, based on who is logged in. This field is also optional, and as such, custom information can be entered here as well. For this exercise, I’m going to leave Create a Managed Identity unchecked. This option must be checked if the policy being assigned includes a policy with the deploy if not exists effect. Since the policy we are working with in this exercise does not, we can leave it blank.</p>
<p>Click Assign to assign the policy. With the policy assigned, we can identify non-compliant resources To do so, click Compliance in the left side of the page, and then find the Audit VMS that do not use managed disks policy assignment that was created.</p>
<p>Resources that are not compliant with this new assignment will appear under Non-compliant resources. When conditions are evaluated against resources and are found to be true, those resources are marked as non-compliant with the assigned policy. Compliance State results are either compliant or non-compliant. So, as you can see from this demonstration, policies are extremely helpful when trying to ensure resource compliance with predefined standards.</p>
<h1 id="Resource-Locks"><a href="#Resource-Locks" class="headerlink" title="Resource Locks"></a>Resource Locks</h1><p>Day-to-day administration will sometimes require you to lock a subscription, resource group, or specific resource to prevent other users from accidentally deleting or modifying critical resources. When this need arises, you can set resource locks by setting lock levels to CanNotDelete or to ReadOnly you can ensure resources are not deleted or modified.</p>
<p>In the Azure portal, the locks are called Delete and ReadOnly respectively. The CanNotDelete lock allows authorized users to read and modify a resource, but not delete the resource. ReadOnly allows authorized users to read a resource but not delete or update the resource.</p>
<p>Applying the ReadOnly lock is similar to restricting all authorized users to the permissions granted by the reader role. When a lock is applied at a parent scope all resources within that scope inherit the lock. Resources added later, will also inherit the lock from the parent.</p>
<p>The most restrictive lock in any inheritance takes precedence. It’s important to note that applying ReadOnly can sometimes lead to unexpected results because some operations that appear to be read operations are actually operations that require additional actions. For example, a read-only lock on a storage account will prevent all users from listing the keys. This is because the list keys operation is handled through a post request because the keys returned are available for right operations.</p>
<p>Similarly, placing a ReadOnly lock on an app service resource will prevent visual studio server Explorer from displaying files for the resource because displaying files requires right access. To create or delete management locks, you must have access to Microsoft.authorization&#x2F;* or Microsoft.authorization&#x2F;locks&#x2F;*actions. Only the built-in owner and user access administrator roles are granted these actions.</p>
<h1 id="DEMO-Setting-a-Resource-Lock"><a href="#DEMO-Setting-a-Resource-Lock" class="headerlink" title="DEMO: Setting a Resource Lock"></a>DEMO: Setting a Resource Lock</h1><p>To set a resource lock, browse to the settings blade for the resource, resource group or subscription that you wish to lock and then click locks. To add a lock, click add. You can create a lock at a parent level by selecting the parent. Resources will inherit the lock from the parent.</p>
<p>Provide a name for the lock and specify the lock level. You can also add notes that describe the lock if you wish. You can delete a lock simply by selecting ellipsis and then clicking delete from the available options.</p>
<h1 id="Implement-and-Set-Tagging-on-Resource-Groups"><a href="#Implement-and-Set-Tagging-on-Resource-Groups" class="headerlink" title="Implement and Set Tagging on Resource Groups"></a>Implement and Set Tagging on Resource Groups</h1><p>Applying tags to Azure resources provides metadata that’s used to logically organize those resources into a taxonomy. Each tag consists of a name and a value pair. A common example is the use of a tag named Environment along with the value of Production that’s applied to all resources in production.</p>
<p>Applying tags offers the ability to retrieve all resources in a subscription that are assigned a specific tag name and value. Using tags enables the administrator to even retrieve related resources from different resource groups. This is helpful when organizing resources for billing and management.</p>
<p>As helpful as tags, there are some limitations that apply to them. For example, each resource or resource group is limited to a maximum of 15 tag name&#x2F;value pairs that can be directly applied to the resource group or resource.</p>
<p>Another limitation is tag name length. Tag names are limited to 512 characters. Tag values are limited to 256 characters. For storage accounts, the tag name is limited to 128 characters and the value is limited to 256. Virtual machines are limited to a total of 2048 characters for all tag names and values.</p>
<p>It’s important to note that tags that are applied to a resource group are not inherited by the resources within that resource group. Also, tags can’t be applied to classic resources such as Cloud Services and they can’t contain special characters. The ability to apply tags to resources requires the user to have write access to that resource type.</p>
<p>Use the Contributor role to enable the ability to apply tags to all resource types. If it’s necessary to provide the ability to apply tags to only one resource type, use the Contributor role for that particular resource. For example, to apply tags to virtual machines, use the Virtual Machine Contributor role.</p>
<h1 id="DEMO-Tagging-Resources"><a href="#DEMO-Tagging-Resources" class="headerlink" title="DEMO: Tagging Resources"></a>DEMO: Tagging Resources</h1><p>To view tags for a resource, browse to the resource and click overview. From here, click tags. If tags have been applied, they will be listed. If you have not previously applied tags, the list will be empty. To add a tag, select the name dropdown and provide a name and then a value for the new tag and then click save to add the tag. The new tag will now be displayed in the overview window.</p>
<p>You can delete a tag by highlighting it and then clicking the trash icon. Clicking save completes the deletion. If you need to bulk assign a tag to multiple resources, browse to a resource group, or really any list of resources, and click the checkbox for the resources you want to assign a tag to and then click assign tags. When done, click save.</p>
<p>To view all resources with a specific tag, click tags in the left pane and then select the tag from the dropdown box. Click the show resources icon on the right. By leveraging tags, you can make your day-to-day administration of resources far easier and more organized.</p>
<h1 id="Moving-Resources-across-Resource-Groups"><a href="#Moving-Resources-across-Resource-Groups" class="headerlink" title="Moving Resources across Resource Groups"></a>Moving Resources across Resource Groups</h1><p>Day-to-day operations will sometimes require that resources be moved from one resource group to another. While this is possible, it’s important to note that when moving resources between resource groups, both the source group and the target group are locked during the operation.</p>
<p>Write and delete operations are both blocked on the resource groups involved until the move completes. As such, resources can’t be added, updated, or deleted in the locked resource groups while the move is in progress. However, this doesn’t mean the resources themselves are frozen. For example, if you move an application server and its database to a new resource group, the application experiences no downtime. It continues to function as normal.</p>
<p>It’s important to note that the location of a resource cannot be changed. Moving a resource only moves it to a new resource group. While the new resource group may have a different location, this fact doesn’t change the location of the resource itself being moved to the new resource group.</p>
<p>Before moving a resource to a new resource group, there are some important steps to perform to prepare for such a move. By taking these steps, errors can be avoided. For starters, the source and destination subscriptions must exist within the same Azure Active Directory tenant. The destination subscription must be registered for the resource provider of the resource being moved.</p>
<p>If the destination subscription isn’t registered for that resource type being moved, you’ll see an error stating that the subscription is not registered for a resource type. This often happens when moving a resource to a new subscription but that subscription has never been used with that resource type before.</p>
<p>The account moving the resources must have the permissions you see on your screen. Before moving resources, ensure the subscription quotas for the subscription you’re moving the resources to supports the resources you plan to move.</p>
<p>If moving the resources will cause the destination subscription to exceed its limits, an increase in the quota for that resource must first be requested. When moving resources, it’s best to break large moves into separate smaller move operations. As a matter of fact, Resource Manager will immediately fail if there is an attempt to move more than 800 resources in a single move operation. That said, a move of fewer than 800 resources may also fail, but that would be due to timeouts and other miscellaneous reasons.</p>
<h1 id="DEMO-Move-Resource-to-New-Resource-Group"><a href="#DEMO-Move-Resource-to-New-Resource-Group" class="headerlink" title="DEMO: Move Resource to New Resource Group"></a>DEMO: Move Resource to New Resource Group</h1><p>To move resources to a different resource group select the resource group containing those resources, and then click the Move button. Choose move to another resource group from the dropdown, and then select the resources to move along with the destination resource group.</p>
<p>Acknowledge that you need to update scripts for these resources, and then click Okay to move the resources. In notifications, you see that the move operation is running and when the move is completed you’re notified of the result.</p>
<h1 id="Removing-Resource-Groups"><a href="#Removing-Resource-Groups" class="headerlink" title="Removing Resource Groups"></a>Removing Resource Groups</h1><p>As a course instructor, I often have dozens of resource groups provisioned, each containing resources associated with a separate course or lab. When I’m done with the course or lab I simply delete the entire resource group. Doing so deletes all of the resources contained within it. This makes it easy for me to keep my Azure subscription clean of any unused resources.</p>
<p>Deleting a resource group is pretty straightforward. To do so, simply browse to the resource group, in the Azure portal, and then click the delete icon at the top. Confirm that you want to delete the resource group and then begin the deletion. Be careful when deleting a resource group, because when it’s deleted all resources contained in it are also deleted.</p>
<p>The amount of time it takes to delete a resource group, largely depends on how many resources are inside of the resource group, at the time of deletion. Obviously, the deletion of an empty resource group will be far quicker than that of a resource group that contains 800 objects in it.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>I hope you’ve enjoyed learning about managing Azure subscriptions and resource groups. Let’s review what you’ve learned. We kicked things off by covering key roles within an Azure subscription, including the contributor role, the owner role, reader, and user access administrator. You learned what each role does and how to assign and change roles.</p>
<p>We then dove into subscription policies and what role they play within a subscription. Next, we took a look at resource groups and how to manage those. You learned about resource policies and how to assign them. You also learned what Resource Locks are and how to use them to secure Azure resources.</p>
<p>Coming down the homestretch, we cover tagging and how to use tags to group resources together. Rounding out the course, you learned how to move resources between resource groups and how to delete resource groups altogether.</p>
<p>To learn more about managing Azure subscriptions and resource groups, be sure to review the documentation published by Microsoft. Be sure to also watch for new Microsoft Azure courses on Cloud Academy because we’re always publishing new ones. Please give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching and happy learning.</p>
<h1 id="2Overview-of-Key-Roles"><a href="#2Overview-of-Key-Roles" class="headerlink" title="2Overview of Key Roles"></a>2<strong>Overview of Key Roles</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles">List of built-in RBAC roles</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Configuring-Azure-VM-and-Container-Security-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/15/AZ-500-Configuring-Azure-VM-and-Container-Security-5/" class="post-title-link" itemprop="url">AZ-500-Configuring-Azure-VM-and-Container-Security-5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:25" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:25-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:12:06" itemprop="dateModified" datetime="2022-11-20T19:12:06-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Configuring-Azure-VM-and-Container-Security-5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Configuring-Azure-VM-and-Container-Security-5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hi there. Welcome to Configuring Azure VM and Container Security. My name is Thomas Mitchell and I’ll be leading you through this course.</p>
<p>I’m an Azure instructor at Cloud Academy and I have over 25 years of IT experience, several of those with cloud technologies. If you have any questions, feel free to connect with me on LinkedIn or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course is intended for people who want to become Microsoft-certified Azure security engineers or those who are simply tasked with implementing security controls, maintaining the security posture of an Azure environment, or protecting data, applications, and networks. To get the most from this course, you should have a moderate understanding of <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft Azure</a> and of basic security principles.</p>
<p>To kick things off, we’re going to start with host security. We’re going to dive into <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-endpoint-security-within-vms/">configuring endpoint security</a> within VMs and how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/hardening-virtual-machines/">harden VMs in Microsoft Azure</a>. We’ll also get into configuring system updates for VMs in Azure, as well as baseline configuration.</p>
<p>Next, we’ll get into configuring container security. You’ll learn how to configure networks, authentication, and container isolation. You’ll also learn how to configure AKS security and how to configure container registry.</p>
<p>Lastly, you’ll learn about vulnerability management tools and strategies.</p>
<p>By the time you finish this course, you should have a full understanding of how to configure Azure VM and container security.</p>
<p>We’d love to get your feedback on this course, so please give it a rating when you’re finished.</p>
<p>If you’re ready to learn how to configure Azure VM and container security, let’s get started.</p>
<h3 id="Lectures"><a href="#Lectures" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-endpoint-security-within-vms/">Configuring Endpoint Security within VMs</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-and-monitoring-antimalmare-vms/">Configuring and Monitoring Antimalmare for VMs</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-virtual-machine-security/">Configuring Virtual Machine Security</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/hardening-virtual-machines/">Hardening Virtual Machines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-system-updates-for-virtual-machines/">Configuring System Updates for Virtual Machines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/starting-runbook-azure-portal/">Starting a Runbook from the Azure Portal</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-baselines/">Configuring Baselines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/azure-networking/">Azure Networking</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/configuring-authentication/">Configuring Authentication</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/container-isolation/">Container Isolation</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/aks-security/">AKS Security</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/azure-container-registry/">Azure Container Registry</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/creating-container-registry/">Creating a Container Registry</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/implementing-vulnerability-management/">Implementing Vulnerability Management</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-vm-and-container-security/conclusion/">Conclusion</a></p>
<h1 id="Configuring-Endpoint-Security-within-VMs"><a href="#Configuring-Endpoint-Security-within-VMs" class="headerlink" title="Configuring Endpoint Security within VMs"></a>Configuring Endpoint Security within VMs</h1><p>Hi there, welcome to Configuring Endpoint Security within VMs. The term endpoint system refers to a computer system that interacts directly with an end user. So this means that devices like desktop computers, laptops, tablets and smartphones are all considered endpoint systems. That being the case, they need to be secured. Failing to properly secure these endpoint systems opens them up to becoming launchpads for security attacks on other networked systems.</p>
<p>Because securing infrastructure-as-a-service offerings requires more customer responsibility than platform-as-a-service and software-as-a-service did, Microsoft has made available the Azure Security Center. The Azure Security Center provides you with the tools that are necessary for hardening your network and securing your services.</p>
<p>The first step to protecting your virtual machines is to protect them from malware. To do this, you need to install anti-malware on them. This helps you identify and remove viruses, spyware, and many other kinds of malicious software. There are two ways you can go about this. You can either install Microsoft Antimalware, or you can install a third-party endpoint protection solution.</p>
<p>Once you have your anti-malware solution installed on your virtual machines, you’ll want to integrate that solution with Azure Security Center so you can monitor the status of your anti-malware protection on those VMs.</p>
<p>Azure Security Center allows you to view reports on the Endpoint protection issues blade. What it does is highlight detected threats and insufficient protection, which obviously make your VMs vulnerable to malware threats. By deploying anti-malware on your machines and then integrating it with Azure Security Center, you’ll have the information necessary to create plans for addressing potential threats.</p>
<p>In the upcoming demonstration, I’ll show you how to configure and monitor anti-malware on virtual machines.</p>
<h1 id="Configuring-and-Monitoring-Antimalmare-for-VMs"><a href="#Configuring-and-Monitoring-Antimalmare-for-VMs" class="headerlink" title="Configuring and Monitoring Antimalmare for VMs"></a>Configuring and Monitoring Antimalmare for VMs</h1><p>In this demonstration, I’m going to show you how to enable and configure Microsoft Antimalware while provisioning a new VM in the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal.</p>
<p>On the screen here, you can see I’m in the Azure portal. So what I’m going to do is deploy a new VM. Now, we’re not gonna do step by step on VM deployment because I’m going to assume you know how to do that already. I just want to show you where you’d go to deploy the Microsoft Antimalware during this process.</p>
<p>So what we’re going to do is select virtual machines here. And then we’re going to click add to deploy a new VM. And what we’ll do here is we’ll just select one of my test resource groups here. And we’ll give our new VM a name, not doing anything specific here. And we’ll leave our region and information here at their defaults. We will select our Windows Server OS image here, since we are installing the Microsoft Antimalware. And we’ll specify a username here. Okay, and we’ll leave everything else here at its default.</p>
<p>We’ll move on to disks. Again, we’ll leave everything at its default. What we’re going to do is get over here into advanced. So we’ll click through networking. We’ll leave our default network interface information set here. We’ll go into management. Again, we’ll leave everything at the default here. I’m not trying to show you how to configure management of a VM. And then we’ll go into advanced. Now, under advanced here, under extensions, what we do is click the select an extension to install link. And what this is going to do is allow us to select an extension we want to install. And over here on the right, we can see Microsoft Antimalware as an option. We’ll select that, and then we’ll click create.</p>
<p>Now, in the installation configuration screen here, we can exclude certain files and locations. We can exclude different extensions and even processes for Antimalware. And then we can enable or disable real-time protection, or we can configure it to run a scheduled scan. The scan type here allows us to specify whether we want to do a quick scan or a full scan. And then, of course, we can specify the day and the scan time. I’ll leave these options at their defaults. We’ll click OK. And then from here, what we would do is go back down to the bottom of the page for our VM creation. We would review and create. And then what we would do is create the VM. When this VM is deployed, it’s going to be deployed with Microsoft Antimalware installed. And that’s pretty much it. It’s not real difficult to get Microsoft Antimalware installed, but I wanted to show you that process and where you needed to go to install that extension.</p>
<h1 id="Configuring-Virtual-Machine-Security"><a href="#Configuring-Virtual-Machine-Security" class="headerlink" title="Configuring Virtual Machine Security"></a>Configuring Virtual Machine Security</h1><p>Hi there, welcome to Configuring VM Security. Before we get into VM policies and templates, I should probably make sure that you first understand the key features of Azure Resource Manager, since it serves as the deployment and management service for Azure subscriptions.</p>
<p>The main function of Azure Resource Manager is to provide a consistent management layer for creating, updating, and removing resources. The Resource Manager is also used to manage access control, auditing, and tagging. This, in turn, helps you secure and organize <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources after they’ve been deployed.</p>
<p>Any time you perform an action via one of the management tools, like the portal, or Azure PowerShell, the Azure CLI, or one of the other available management tools, it’s actually the Resource Manager API that handles the request. This produces consistent results and capabilities across all the different management tools.</p>
<p>Whenever you deploy a resource in Azure, the request is handled by the Resource Manager API. Successful requests result in the creation of the resource and the assignment of it to a resource group. Whenever you need to deploy resources that are related to each other, you should use Resource Manager to deploy them into the same resource group. This allows you to deploy, update, manage, and monitor them as a group.</p>
<p>So, now that we’ve given Resource Manager a good once-over, let’s take a look at some key terms that you should be familiar with when working with Resource Manager.</p>
<p>The term Resource Provider refers to a service that supplies Azure resources. One of the more common resource providers in Azure is Microsoft.Compute. The Microsoft.Compute resource provider, as you may have guessed, supplies VM resources. I’ll let you guess what the Microsoft.Storage resource provider supplies.</p>
<p>A Resource Manager Template is a JSON file. The JSON file defines one or more resources that you wish to deploy into a resource group or subscription. Using Resource Manager Templates allow you to consistently and repeatedly deploy resources over and over again, without the need to manually configure them each time.</p>
<p>Declarative Syntax is a syntax that you use to create resources without having to write out the sequence of programming commands that are necessary to create them. A prime example of Declarative Syntax is actually the Resource Manager template, because within the JSON file, you define the properties for the infrastructure to deploy to in Azure.</p>
<p>When you use a Resource Manager template to define your virtual machines, you can easily deploy and redeploy them later on, if necessary. As a matter of fact, Microsoft actually recommends periodically redeploying your virtual machines, why? Because it forces the deployment of a freshly updated and security-enhanced virtual machine OS. That said, it’s likely difficult to do in practice, due to business SLAs, approvals, and the coordination involved. But that still doesn’t mean it’s a bad idea.</p>
<p>It’s important to understand that Resource Manager processes templates like any other request. What it does is parse the template and then convert the syntax into REST API operations.</p>
<p>Now, because this course isn’t about building templates, I’m not going to get into the weeds on template building. However, if you want to learn about building them, visit the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-gb/azure/azure-resource-manager/templates/template-syntax">URL</a> that you see on your screen (<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-gb/azure/azure-resource-manager/templates/template-syntax">https://docs.microsoft.com/en-gb/azure/azure-resource-manager/templates/template-syntax</a>).</p>
<p>I should also point out, that, because RBAC, or role-based access control, is integrated into the management platform, you can apply access controls to all services in your resource group.</p>
<p>At this point, I want to talk a little bit about the four levels of scope, in the context of Azure management. They include management groups, subscriptions, resource groups, and resources.</p>
<p>The image that you see on your screen now shows how these scopes are related. So, what’s the significance of scope? Well, what you can do is apply management settings at any one of these levels. Obviously, the level you apply your settings to will dictate how widely your settings are applied. Lower scope levels will generally inherit settings that are applied at the higher scope levels.</p>
<p>For example, if you apply a policy to a resource group, that policy will apply to not only the resource group itself, but it will filter down and apply to the resources within the resource group.</p>
<p>It’s also important to understand that you can deploy templates to management groups, subscriptions, and resource groups.</p>
<p>Speaking of resource groups, let’s talk a little bit about them now. Although they are quite possibly the simplest resources that you can deploy, there are some things to consider when defining a resource group.</p>
<p>First and foremost, when planning your resource group deployments, it’s important to understand that all resources within a resource group should share the same lifecycle. You should be deploying, updating, and deleting such resource all together. An example of this would be an internet-facing web app that communicates with a backend database. Generally speaking, in such a scenario, you’d have a web server, an app server, and a database server, that all exist solely to support the app. In such a case, they would all go in one resource group. However, if one of those resources, say the database server, for example, exists on a different deployment cycle because it supports other apps, that database server should be deployed in another resource group.</p>
<p>While we’re on the subject of which resource groups should house which resources, I should also point out that each resource can only exist in one resource group. You can’t add a resource to two different resource groups. That said, you can add and remove resources to and from a resource group at any time. You can even move resources from one resource group to another.</p>
<p>I should also note that a resource group, despite being located in one region, can contain resources that are located in different regions. For example, a resource group in East US can host resources that are deployed in West US. And, of course, resources in one resource group have no problem interacting with resources in another resource group. Essentially, resource groups serve as LOGICAL groupings.</p>
<p>You can also use a resource group to scope access control for administrative actions.</p>
<p>When you create a resource group, you are prompted to provide a location for that resource group. The location you choose is important because it tells Azure where to store metadata about the resources within that resource group. This has potential compliance ramifications, especially if you need to ensure that your data is stored in a particular region.</p>
<p>In the next lesson, we’ll get into VM hardening.</p>
<h1 id="Hardening-Virtual-Machines"><a href="#Hardening-Virtual-Machines" class="headerlink" title="Hardening Virtual Machines"></a>Hardening Virtual Machines</h1><p>Hi there, welcome to Hardening Virtual Machines. In this lecture, we’re going to look at some of the steps that you can take to harden your Azure VMs, using Azure Security Center.</p>
<p>As I mentioned earlier in this course, Azure Security Center is a service offering that you can use to prevent, detect and respond to threats. It also provides increased visibility into your Azure resources as well as added control over them. Using Security Center, you can safeguard virtual machine data in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> because of this improved visibility.</p>
<p>When you use Security Center to help protect your virtual machines, several capabilities become available to you. For example, you can configure OS security settings by leveraging recommended configuration rules. You can also manage system security updates and see which critical updates are missing. Security Center also provides endpoint protection recommendations and disk encryption validation.</p>
<p>Other capabilities that become available to you include threat detection and the ability to perform vulnerability assessments and remediations.</p>
<p>Before Azure Security Center can collect the information necessary to make recommendations and to generate alerts, you need to enable data collection. On the screen you can see that data collection has been enabled in this example.</p>
<p>Once you’ve begun collecting data, you can begin configuring security policies. A security policy defines a set of controls that are recommended for resources within the subscription or resource group.</p>
<p>Security Center analyzes the security state of your resources in Azure, and when it identifies potential security vulnerabilities, it creates recommendations, which are based on your security policies. The recommendations will even walk you through the process of configuring the necessary controls.</p>
<p>The recommendations that security policy makes are presented in a table format. Each line in the table represents one recommendation. When you select a recommendation in the table, Security Center presents you with information that can assist you with the implementation of that recommendation.</p>
<p>You can also use Security Center to monitor and analyze your enabled security policies in order to identify possible vulnerabilities. You can check on the security state of resources from the resource security health blade.</p>
<p>The way threat detection works in Security Center is pretty straightforward. Essentially what happens is that Security Center collects security information from your Azure resources, the network itself, and other connected partner solutions. It then analyzes the collected information. It will then correlate information from multiple sources to identify threats.</p>
<p>Azure Security Center uses advanced security analytics and leverages big data and machine learning to evaluate events across the entire cloud. Using these technologies, Security Center can detect threats that would otherwise be impossible to identify via manual methods.</p>
<p>The Advanced Security analytics that Security Center relies on include things like integrated threat intelligence, behavioral analytics and anomaly detection.</p>
<p>These types of analytics allow Security Center to effectively disrupt the kill chain because they result in detection at different phases of it. The image that you see on your screen highlights a few common alerts for each phase.</p>
<h1 id="Configuring-System-Updates-for-Virtual-Machines"><a href="#Configuring-System-Updates-for-Virtual-Machines" class="headerlink" title="Configuring System Updates for Virtual Machines"></a>Configuring System Updates for Virtual Machines</h1><p>Hi there! Welcome to Configuring System Updates for Virtual Machines. Azure Update Management is a service that’s included with each Azure subscription. This service allows you to assess your update status across your entire environment and to manage updates for both on-prem and Azure-hosted Windows servers and Linux servers from a single location.</p>
<p>The Azure Update Management service is a free offering. The only costs that you incur are for the log data that Azure Log Analytics stores. To use Azure Update Management, all you need to do is browse to the VM tab in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>, and then enable Update Management for one or more virtual machines. Update Management can also be enabled from your Azure Automation account.</p>
<p>Computers that are managed by the Azure Update Management service use the services and features that you see on your screen to perform assessments and to update deployments. They include:</p>
<ul>
<li>Microsoft Monitoring Agent for Windows or Linux </li>
<li>Desired State Configuration in Windows PowerShell for Linux </li>
<li>Hybrid Runbook Worker in Azure Automation </li>
<li>Microsoft Update for Windows computers</li>
<li>Windows Server Update Services for Windows computers</li>
</ul>
<p>Azure Automation uses Runbooks to install updates. Essentially, what happens, is when an update deployment is created, a schedule is also created. That schedule starts a master update runbook at the specified time for the included computers. The master runbook, in turn, starts a child runbook on each agent. This child runbook on each agent installs the required updates.</p>
<p>The diagram that you see on your screen depicts the flow and how the solution assesses and applies security updates.</p>
<p>In the upcoming demonstration, I’ll show you how to start a runbook from the Azure portal.</p>
<p>Welcome back. In this quick demonstration, I’m going to show you how to start a runbook from the Azure portal. On the screen here, you can see I’m logged in to my Azure portal as my administrator.</p>
<p>To start my runbook, what I’m going to do here is go into Automation, and we’ll select myautomationaccount. Now, from myautomationaccount, I simply select Runbooks under Process Automation and then, I can either create a new runbook or I can run an existing runbook simply by selecting the runbook and then clicking Start. Go ahead and click Yes to start the runbook. And then from the job page here, I can view the status of my runbook job. I can view any input, any output, errors, warnings, any kind of logs and any exceptions. And that’s all it really takes to manually run a runbook from the Azure portal.</p>
<h1 id="Starting-a-Runbook-from-the-Azure-Portal"><a href="#Starting-a-Runbook-from-the-Azure-Portal" class="headerlink" title="Starting a Runbook from the Azure Portal"></a>Starting a Runbook from the Azure Portal</h1><p>Welcome back. In this quick demonstration, I’m going to show you how to start a runbook from the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal. On the screen here, you can see I’m logged in to my Azure portal as my administrator. To start my runbook, what I’m going to do here, is go into Automation. And we’ll select Myautomationaccount. Now from my automation account, I simply select Runbooks under process automation, and then I can either create a new runbook or I can run an existing runbook, simply by selecting the runbook and then clicking Start. Go ahead and click Yes to start the runbook. And then from the job page here, I can view the status of my runbook job. I can view any input, any output, errors, warnings, any kind of logs, and any exceptions. And that’s all it really takes to manually run a runbook from the Azure portal.</p>
<h1 id="Configuring-Baselines"><a href="#Configuring-Baselines" class="headerlink" title="Configuring Baselines"></a>Configuring Baselines</h1><p>Hi there. Welcome to Configuring Baselines. Before we get started, I want to mention that this section alone could probably be its own entire course if we wanted to go down the rabbit hole of every type of baseline. However, what we’re going to do instead is touch on each of the types of baselines that are available so you know where to go when you need to configure a specific baseline.</p>
<p>Before we do that, let’s talk a little bit about the best practices that Microsoft’s cybersecurity group and the Center for Internet Security or CIS have developed.</p>
<p>Microsoft initially partnered with the Center for Internet Security to develop an off-the-shelf-hardened Azure VM. This soon turned into an initiative to use CIS benchmarks, along with Azure security services and tools to provide security and compliance for applications that run on <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>.</p>
<p>The CIS Microsoft Azure Foundations Security Benchmark guide provides organizations with guidelines for establishing a secure baseline configuration for Azure. Throughout the rest of this lecture, we’re going to look at the recommended technology groupings that can help you create secure cloud-enabled workloads.</p>
<p>There are two different implementation levels that CIS bases their recommendations on. There are also several different categories of recommendations that are made. The two levels are called Level 1 and Level 2. I know, very original.</p>
<p>Level 1 recommendations are the minimum recommended security settings that should be configured on all systems. Level 1 recommendations typically cause little or no interruption of services, nor do they usually result in reduced functionality. Level 2 recommendations are designed for highly secure environments. That being the case, they can sometimes result in reduced functionality of the systems they’re implemented on.</p>
<p>On the screen is a table that shows you each technology group that we’re going to touch on, along with an overall description of the recommendations for each group. Also included in this table are the total number of recommendations for each technology group. As you can see, there are lots, which is why we’re not going to get down into the weeds on these.</p>
<p>Let’s start by taking a quick look at identity and access management. Identity management is critical to the security of corporate assets. To ensure security and control of your assets, you need to manage identity and access for the Azure administrators in your organization, the application developers in your organization and for the application users as well. An identity and access management baseline is a big part of this.</p>
<p>Some of the key recommendations when configuring an identity and access management baseline include: Level 1 actions like restricting access to the Azure AD administration portal, ensuring that no unnecessary guest users exist, notifying users on password resets and requiring two methods to reset passwords.</p>
<p>Some key Level 2 actions that you should be taking include things like: enabling Azure MFA, blocking the ability to remember MFA on trusted devices, notifying all admins when other admins reset passwords and establishing an interval for reconfirming user authentication methods.</p>
<p>Some other recommended Level 2 actions include: not allowing members and guests to invite external users, not allowing users to create and manage security groups, disabling self-service group management and disabling the ability for users to register apps.</p>
<p>The Azure Security Center offering provides security management and threat protection for on-prem workloads, Azure workloads and workloads in other clouds.</p>
<p>The Security Center recommendations that you see on your screen will set various security policies on your Azure subscription. By implementing these recommendations on your own Azure subscription, you can further secure your environment.</p>
<p>These recommendations include: enabling the standard pricing tier, enabling the automatic provisioning of a monitoring agent and enabling system updates. Other key recommendations include: enabling security configurations enabling endpoint protection and enabling disk encryption.</p>
<ul>
<li>Enabling Network Security Groups (Level 1)</li>
<li>Enabling Web Application Firewall (Level 1)</li>
<li>Enabling Vulnerability Assessment (Level 1)</li>
<li>Enabling Storage Encryption (Level 1)</li>
<li>Enabling JIT Network Access (Level 1)</li>
<li>Enabling Adaptive Application Controls (Level 1)</li>
<li>Enabling SQL Auditing &amp; Threat Detection (Level 1)</li>
<li>Enabling SQL Encryption (Level 1)</li>
<li>Setting a Security Contact Email and Phone Number (Level 1)</li>
<li>Enabling the Send me emails about alerts option (Level 1)</li>
<li>Enabling the Send email also to subscription owners option (Level 1)</li>
</ul>
<p>As you can see on your screen, there are also several other recommendations to follow when creating an Azure Security Center baseline. </p>
<p>Azure storage accounts provide namespaces that you can use to store and access Azure Storage data objects. The seven key recommendations that you see on your screen are those that you should implement to validate your storage security.</p>
<p>They include:</p>
<ul>
<li>Requiring security-enhanced transfers (Level 1)</li>
<li>Enabling blob encryption (Level 1)</li>
<li>Periodically regenerating access keys (Level 1)</li>
<li>Requiring Shared Access Signature (SAS) tokens to expire within an hour (Level 1)</li>
<li>Requiring SAS tokens to be shared only via HTTPS (Level 1)</li>
<li>Enabling Azure Files encryption (Level 1)</li>
<li>Requiring only private access to blob containers (Level 1)</li>
</ul>
<p>By implementing these recommendations as part of a storage account baseline, you can vastly improve your security position.</p>
<p>Azure SQL Server is Microsoft’s cloud-based relational database server offering. It supports many of the same features as the on-prem version of Microsoft SQL Server and it’s a good way to transition from an on-prem database into a cloud-based database.</p>
<p>The security recommendations that you see on your screen are those that you should implement when creating an Azure SQL Database security baseline. They include:</p>
<ul>
<li>Enabling auditing (Level 1)</li>
<li>Enabling a threat detection service (Level 1)</li>
<li>Enabling all threat detection types (Level 1)</li>
<li>Enabling the option to send security alerts (Level 1)</li>
<li>Enabling the email service and co-administrators (Level 1)</li>
<li>Configuring audit retention for more than 90 days (Level 1)</li>
<li>Configuring threat detection retention for more than 90 days (Level 1)</li>
</ul>
<p>Implementing these recommendations improves the security posture of your Azure SQL Server environment.</p>
<p>When it comes time to identify and mitigate security threats, if you aren’t performing any sort of logging and monitoring, you’re going to be in for a world of hurt. Properly configured logging policies will not only help you determine when a security violation has occurred, but it will also help identify the culprit responsible as your activity logs can provide information about external access to resources and it can also provide diagnostic logs that provide information about the operation of those resources.</p>
<p>Follow these Level 1 recommendations that you see on your screen to set logging and monitoring policies on your Azure subscriptions:</p>
<ul>
<li>Ensure that a log profile exists </li>
<li>Ensure that activity log retention is set to 365 days or more </li>
<li>Create an activity log alert for “Creating a policy assignment” </li>
<li>Create an activity log alert for “Creating, updating, or deleting a Network Security Group” </li>
<li>Create an activity log alert for “Creating or updating an SQL Server firewall rule”</li>
</ul>
<p>Azure networking service are designed to maximize flexibility, availability and security. These services provide connectivity between resources in Azure, on-prem resources and the Internet. The key security recommendations you see on your screen can be used to set Azure networking policies in your Azure subscriptions. These recommendations include:</p>
<ul>
<li>Restricting RDP and SSH access from the Internet (Level 1) </li>
<li>Restricting SQL Server access from the Internet (Level 1)</li>
<li>Configuring the NSG flow log retention period for more than 90 days (Level 2)</li>
<li>Enabling Network Watcher (Level 1)</li>
</ul>
<p>Aside from configuring the NSG flow log retention period, which is a Level 2 recommendation, all listed recommendations are Level 1 recommendations.</p>
<p>When it comes to security recommendations for virtual machines, the ones you see on your screen should be followed to set virtual machine policies on your Azure subscription. These recommendations include: </p>
<ul>
<li>Installing a VM agent on all VMs and enabling the agents for data collection for Azure Security Center (Level 1) </li>
<li>Ensuring that OS disks are encrypted (Level 1)</li>
<li>Ensuring only approved extensions are installed (Level 1)</li>
<li>Ensuring that the OS patches for the VMs are applied (Level 1)</li>
<li>Ensuring that VMs have an installed and running endpoint protection solution (Level 1)</li>
</ul>
<p>Performing these steps will allow you to validate the security for VMs in your environment. In addition to the recommendations we’ve already introduced, there are some other security recommendations that should be followed.</p>
<p>These additional recommendations include:</p>
<ul>
<li>Setting an expiration date on all keys in Azure Key Vault (Level 1) </li>
<li>Setting an expiration date on all secrets in Azure Key Vault (Level 1) </li>
<li>Setting resource locks for mission-critical Azure resources (Level 2)</li>
</ul>
<p>These additional recommendations that you see on your screen can be followed to set general security and operational controls on an Azure subscription.</p>
<p>To download the complete CIS Microsoft Azure Foundations Security Benchmark document, which includes over 200 pages of baseline and benchmark information, visit the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/security/benchmark/azure/v2-cis-benchmark">URL</a> that you see on your screen.</p>
<h1 id="Azure-Networking"><a href="#Azure-Networking" class="headerlink" title="Azure Networking"></a>Azure Networking</h1><p>Hi there, welcome to Azure Networking. In this lecture, we’re going to take a quick look at several key networking components that you need to be familiar with before attempting to configure networking and <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. We’re not going to get into too much detail, because I’m going to assume that if you’re preparing for the Microsoft Azure Security Technologies exam, you already have at least a basic knowledge of these concepts already. So for most of you, this should be more like a refresher than anything.</p>
<p>Let’s start with virtual networks. Virtual networks are used to connect resources. Whether those resources reside in Azure or on-prem. You use Azure virtual networks to enable secure communication between all kinds of Azure resources between Azure resources and on-prem environments and between Azure resources and the internet. It’s important to note that each virtual network which consists of one or more subnets is scoped to a single Azure region.</p>
<p>While you can deploy multiple virtual networks within each Azure subscription and within each Azure region, it’s important to understand that each virtual network is isolated from other virtual networks.</p>
<p>When you deploy a virtual network, you can specify a custom private IP address space that consists of public or private addresses. When you connect resources to a virtual network, Azure assigns a private IP address to that resource. The address that it assigns comes from the address space that you assign.</p>
<p>For name resolution, you can use either Azure provided name resolution, or you can provide your own custom DNS server. Resources on the virtual network you are configuring will use this DNS for name resolution. </p>
<p>In much the same way as physical on-prem machines do, Azure resources like VMs, load balancers, and application gateways require unique IP addresses to function. Virtual networks use two types of IP addresses. They include private IPs and public IPs.</p>
<p>Private IP addresses can be allocated to resources dynamically or statically. Resources use these addresses to communicate with other Azure resources or on-prem devices.</p>
<p>Public IP addresses allow Azure resources to communicate with external clients. This kind of address is assigned directly to the virtual network adapter of a virtual machine or to the load balancer. Public IP addresses can also be added to Azure only virtual networks. With that being said, in an Azure only virtual network, all IPs are routable only within the customer’s network. Meaning that they won’t be reachable from outside. </p>
<p>Subnets in Azure, in the same way as physical subnets on-prem, allow you to subdivide your virtual network. This helps attain logical and security related isolation of Azure resources. A subnets range of addresses must fall within the defined address space of the parent virtual network. What subnetting does is hide the details of the organization of the internal network from external routers. It also segments the hosts within the network. This makes it easier to apply network security at the interconnections between subnets.</p>
<p>Virtual network adapters are used by virtual machines to communicate with other virtual machines as well as with other resources. When you deploy a virtual machine, you configure the virtual machine’s virtual network adapter with a private IP address and optionally, a public IP address. It’s also important to note that a virtual machine can have more than one virtual network adapter attached to it.</p>
<p>DNS or the Domain Name System allows clients to resolve fully qualified domain names to IP addresses. Although Azure does provide a built-in DNS that supports most name resolution scenarios, there will be times when you need to configure custom external DNS in order to provide the necessary name resolution services. A typical use-case for custom DNS is a scenario where you want to extend an on-prem Active Directory into Azure by deploying a VM in Azure that will function as a domain controller for the on-prem AD.</p>
<p>In situations where you wish to increase scalability or availability of an application that’s hosted on a VM, what you can do is create two or more VMs and publish the same application on them. You can then use an Azure load balancer to distribute traffic among the VMs that host the application. In such a configuration, all of the VMs share the same endpoint. That being the case, you can spread the traffic load across multiple servers.</p>
<p>You have two types of load balancers at your disposal; a public load balancer and an internal load balancer.</p>
<p>A public load balancer is used to map the public IP address and port number of incoming traffic to the private IP address and port number of your VMs. And of course, vice versa for the response traffic from your VMs.</p>
<p>You use an internal load balancer to direct traffic to resources that exist inside a virtual network, or to resources that use a VPN to access the Azure infrastructure. This is what differentiates internal load balancers from public load balancers.</p>
<p>I should also note that Azure restricts access to the load-balanced front-end IP address of a virtual network. In other words, the front-end IP addresses and virtual networks are never directly exposed to the internet. </p>
<p>The application gateway is another service that you can use to deploy load balanced solutions. However, unlike load balancers, application gateways are designed strictly for HTTP traffic. That being the case, they use routing rules as application-level policies that can offload SSL processing from load-balanced VMs. I should also mention that you can use application gateways when cookie-based session affinity is required.</p>
<p>Azure Traffic Manager is yet another Azure-based load balancing solution. You typically use traffic manager to balance loads across endpoints in different Azure regions, across hosted providers or across different on-prem data centers. The endpoints of Traffic Manager can be Azure VMs or Azure websites. Generally speaking, you use the Traffic Manager load balancing service to ensure that end users connect to an endpoint that is located closest to their physical location. This typically results in faster response times.</p>
<p>It’s important to note that Traffic Manager works at the DNS level. In other words, it uses DNS to direct users to specific service endpoints based on a combination of the traffic routing method you choose, and the current endpoint health. This doesn’t mean that Traffic Manager is a proxy, it’s not. Once clients are directed to the appropriate endpoint, they directly connect to that endpoint. Traffic Manager doesn’t see the traffic passing between the client and the service being load balanced.</p>
<p>At this point, we just have a few more networking concepts to review. Let’s take a quick moment to touch on network security groups. Network security groups are used to provide network isolation for Azure resources. This is accomplished by defining security rules that either allow or deny specific traffic to specific VMs or subnets.</p>
<p>A common use case for network security groups is a scenario where you want to isolate traffic between multi-tier applications. For example, if you have a three-tier web app that consists of a web front-end VM, a VM hosting the app and a back-end SQL server that the app VM talks to, you might leverage network security groups to ensure that only the app VM can communicate with the SQL VM over Port 1433. Since there’s no need for the front-end web VM to be communicating directly with the back-end SQL VM.</p>
<p>Lastly, let’s take a look at cross-prem network connectivity. Using Azure virtual networks and VPNs, you can extend your on-prem network to Microsoft Azure. You can create connectivity between an on-prem network and an Azure virtual network by deploying a site to site VPN that traverses the public internet. However, if you’re looking for more security and reliability you can use ExpressRoute to create a connection that doesn’t cross the internet. Using either of these two methods allows you to provide on-prem users access to Azure resources as if they were physically located on-prem in your own data center.</p>
<p>A point to site VPN can be used to allow individual users or computers to connect to Azure, just like you might leverage Cisco AnyConnect or any other VPN service to allow users to connect to your on-prem network from home.</p>
<p>With that said, we’ll wrap up this lecture. Like I said at the outset, this lecture was probably just a refresher for most of you. But I had to mention these concepts because you may run into them while sitting the exam. I’d rather run through that and have you not see them on the exam, that not go through them and then have you getting hit with questions about them when you sit the exam.</p>
<h1 id="Configuring-Authentication"><a href="#Configuring-Authentication" class="headerlink" title="Configuring Authentication"></a>Configuring Authentication</h1><p>Hi there, welcome to configuring authentication. In this lecture, we’re going to take a look at how to create and use service principals for AKS clusters.</p>
<p>So before an AKS cluster can interact with Azure APIs, it needs an Azure AD service principal. This is required to dynamically create and manage other <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources, like Azure load balancer or container registry. </p>
<p>Over the next few minutes here, I’m going to explain how to create a service principal for an AKS cluster.</p>
<p>Before we dive in, I need to point out that in order to create an Azure AD service principal, you need permissions to register an application with the Azure AD tenant. You also need permissions to assign the app to a role in the subscription.</p>
<p>To create a service principle for an AKS cluster using Azure CLI, you’ll need to use Azure CLI version 2.0.59 or later installed and configured.</p>
<p>When you create an AKS cluster, be it in the Azure portal or by using the az aks create command in Azure CLI, Azure can automatically create a service principal for you.</p>
<p>Using the Azure CLI command that you see on your screen (shown below) does not specify a service principal, so what happens in this case is Azure CLI automatically creates a service principal for the cluster.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az aks create --name MyCoolAKSCluster --resource-group myRG</span><br></pre></td></tr></table></figure>

<p>Now, if you want to manually create a service principal using the Azure CLI, you can use this next command that you see on your screen:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az ad sp create-for-rbac --skip-assignment --name myAKSClusterSP</span><br></pre></td></tr></table></figure>

<p>In this example, we’re using the <code>az ad sp create-for-rbac</code> command. The <code>--skip-assignment</code> parameter in this example command prevents any additional default assignments from being assigned.</p>
<p>After running the command you see here, what you need to do is take a look at your output, which should look something like what you see on your screen, and you’ll need to make a note of the appID and password because you’ll use these when you create your AKS cluster. Once you’ve created your service principal, you can use it when you create the AKS cluster.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JSONCopy</span><br><span class="line">&#123;</span><br><span class="line">  &quot;appId&quot;: &quot;559513bd-0c19-4c1a-87cd-851a26afd5fc&quot;,</span><br><span class="line">  &quot;displayName&quot;: &quot;myAKSClusterSP&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;http://myAKSClusterSP&quot;,</span><br><span class="line">  &quot;password&quot;: &quot;e765722a-5eee-40e8-a466-dc87d980f315&quot;,</span><br><span class="line">  &quot;tenant&quot;: &quot;72f985bf-86f1-41af-92ab-2d7ce011db48&quot;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To specify this existing service principal while you create the AKS cluster, you can use the <code>az aks create</code> command, along with the <code>--service-principal</code> and <code>--client-secret</code> parameters. Using these parameters allows you to specify the appID and password that you noted.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">az aks create --resource-group myResourceGroup --name myCoolAKSCluster --service-principal &lt;appId&gt; --client-secret &lt;password&gt;</span><br></pre></td></tr></table></figure>

<p>Now, if you’re doing things the easier way and deploying your AKS cluster via the Azure portal, what you can do is, once you get to the Authentication page of the Create Kubernetes cluster dialog, you can choose the option to Use Existing when prompted to Configure service principal. What you would do in this case is provide your appID in the Service principal client ID field and your password in the Service principal client secret field.</p>
<p>Before we wrap up this lecture, I do want to point out a couple things to keep in mind when using AKS and Azure AD service principals.</p>
<p>First and foremost, while the service principal for Kubernetes is a part of the cluster configuration, it should not be used to deploy the cluster. Secondly, by default, service principal credentials are only valid for one year. That being the case, you’ll need to either update or rotate the service principal credentials on a regular basis.</p>
<p>Speaking of service principals, every service principal is associated with an Azure AD application. In the case of a Kubernetes cluster, the service principal for it can be associated with any valid Azure AD application name. However, the application URL doesn’t have to be a real endpoint. This sometimes trips people up.</p>
<p>I should also point out that the service principal credentials are stored in a file called &#x2F;etc&#x2F;kubernetes&#x2F;azure.json on the agent node VMs within the Kubernetes cluster.</p>
<p>Lastly, even if you delete an AKS cluster that was created via the <code>az aks create</code> command, the service principal that was automatically created is not deleted. This is another point that sometimes trips people up.</p>
<h1 id="Container-Isolation"><a href="#Container-Isolation" class="headerlink" title="Container Isolation"></a>Container Isolation</h1><p>Hi, everyone, welcome to container isolation. Azure Container Instances, also known as ACI, provide the easiest way to deploy containers in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> without worrying about any higher level service overhead. This is because you can deploy independent containers without the need to manage any backend virtual machines.</p>
<p>Container instances are, inherently, deployed securely. This ensures that a deployed application runs in isolation, much like it would if it was run on an Azure virtual machine.</p>
<p>Because the Azure Container Instances service is a deep security model, each individual container that’s deployed is isolated at the hypervisor level. This offers a much stronger security boundary for multi-tenant scenarios. The ability to enable this type of isolation without the need for a separate hosting cluster makes Azure Container Instances a true cloud-native model.</p>
<h1 id="AKS-Security"><a href="#AKS-Security" class="headerlink" title="AKS Security"></a>AKS Security</h1><p>Hi there, welcome to AKS security. In this lecture, we’re going to take a look at various concepts that you need to be familiar with in order to configure AKS security. We’ll look at master components security, node security, network security, and Kubernetes secrets.</p>
<p>In AKS, Kubernetes master components are provided by Microsoft as part of the managed service. That being the case, each AKS cluster has its own single-tenanted, dedicated Kubernetes master. This dedicated Kubernetes master, which is managed and maintained by Microsoft, provides the API server, scheduler, and other functionality.</p>
<p>The Kubernetes API server uses a public IP address and is accessible via a fully qualified domain name. Access to the API server can be controlled via Kubernetes RBAC controls and Azure AD.</p>
<p>We already know that AKS nodes are actually Azure VMs that we need to manage and maintain. Linux nodes run Ubuntu using the Moby container runtime. Windows Server nodes run Windows Server 2019. They, too, use the Moby container runtime. Whenever a new AKS cluster is created or when an existing cluster is scaled up, the nodes of that cluster are automatically deployed with the latest OS security updates and configurations.</p>
<p>Then, in the case of Linux nodes, <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> automatically applies the latest OS security patches on a nightly basis. However, it’s important to note that if a particular Linux OS update requires a host reboot, that reboot is not automatically performed. Instead, you can manually reboot the node when it’s convenient. You can also use Kured, which is an open-source reboot daemon for Kubernetes.</p>
<p>Windows Server nodes are updated via Windows Update. However, Windows Update does not automatically run nor apply the latest updates. Instead, what you should do on a regular basis is perform an upgrade on your Windows Server node pool, or pools, in your AKS cluster. What this upgrade process does is create nodes that run the latest Windows Server image and patches. Once you have the new nodes created, you can remove the older ones.</p>
<p>I should point out that, when nodes are deployed, they’re deployed into a private virtual network subnet. There are no public IP addresses assigned. That being the case, SSH is enabled by default. You can use this SSH access, using the internal IP address, to manage your nodes.</p>
<p>AKS nodes use Azure Managed Disks for storage. The data that gets stored on these managed disks is automatically encrypted at rest by Azure.</p>
<p>It’s important to understand that Kubernetes environments, in general, aren’t considered to be completely safe for hostile multi-tenant usage. While security features like Pod Security Policies and role-based access controls make exploits a little more difficult, the best way to achieve true security when running hostile multi-tenant workloads is to leverage a hypervisor.</p>
<p>For more information on cluster isolation in AKS, visit the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-gb/azure/aks/operator-best-practices-cluster-isolation">URL</a> that you see on your screen (<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-gb/azure/aks/operator-best-practices-cluster-isolation">https://docs.microsoft.com/en-gb/azure/aks/operator-best-practices-cluster-isolation</a>)</p>
<p>To facilitate security and connectivity with on-prem networks, AKS clusters can be deployed into existing Azure virtual networks that have Azure Site-to-Site VPN connections or Express Route connections back to your on-prem network. You can define Kubernetes ingress controllers with private IP addresses, so those services are only accessible via an internal network connection.</p>
<p>I should mention here that as you create services with load balancers, port mappings, or ingress routes, the Azure Kubernetes Service will automatically modify the applicable network security groups to ensure traffic flows as necessary.</p>
<p>The last security component that I want to touch on is the concept of Kubernetes secrets. So what is a Kubernetes secret and what does it do? Well, a Kubernetes secret injects sensitive data, like access credentials or keys, into pods. After you’ve created a secret using the Kubernetes API, you can request that secret when you define your pod or deployment.</p>
<p>A Kubernetes Secret is only supplied to a node that contains a scheduled pod that requires it, and instead of being written to disk, the secret is stored in tmpfs.</p>
<p>It’s important to note that when the last pod on a node that requires a secret is deleted, the secret itself is also deleted from that node’s tmpfs. I should also point out that secrets are stored within a specific namespace. That being the case, they can only be accessed by pods within that namespace.</p>
<p>Using secrets reduces the amount of sensitive information that needs to be defined in YAML manifest for pods and services. Instead of defining sensitive data in the manifest, what you do is you request the secret that’s stored in Kubernetes API Server. Taking this approach, you only provide the specific pod with access to the secret.</p>
<h1 id="Azure-Container-Registry"><a href="#Azure-Container-Registry" class="headerlink" title="Azure Container Registry"></a>Azure Container Registry</h1><p>Welcome to Container Registry. This is going to be a rather brief lecture because all I want to do here is introduce you to Container Registry.</p>
<p>So what is an Azure Container Registry? Well, an Azure container registry is really just a managed, private Docker registry in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. It’s based on the open-source Docker Registry 2.0. You use Azure container registries to store and manage private Docker container images along with related artifacts.</p>
<p>You can use Azure container registries with existing container development and deployment pipelines, or you can use Azure Container Registry Tasks to build container images in Azure.</p>
<p>You can pull images from an Azure container registry to various deployment targets, including orchestration systems like Kubernetes and Docker Swarm, and you can also pull images from the container registry to Azure services that help you build and run apps at scale. These services include Azure Kubernetes Service, App Service, Service Fabric, and several others.</p>
<p>In the upcoming demonstration, we’ll create a container registry with the Azure portal.</p>
<h1 id="Creating-a-Container-Registry"><a href="#Creating-a-Container-Registry" class="headerlink" title="Creating a Container Registry"></a>Creating a Container Registry</h1><p>Welcome back. In this demonstration, I’m going to quickly show you how to create a container registry using the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal. On the screen here you can see I’m logged in to my portal and I’m logged in as an Administrator. To create my container registry, what I’m going to do is click on Create a Resource here and then I’m going to browse to Containers here within the Azure marketplace.</p>
<p>Now within Containers here, I can select Container Registry. To create my Container Registry, I need to provide a unique registry name and when I say unique, I mean it needs to be unique across Azure because it’s going to get an FQDN with the domain name here of Azure CR.IO. So what I’ll do here is I’ll call it my 9878 registry. This name that I give it can contain anywhere between five and 50 alphanumeric characters. And then what I do here is select the subscription I’m going to deploy to and then a resource group.</p>
<p>So I’ll select one of my resource groups here and then of course as with any other Azure resource, I need to select the location. I’ll leave it in East U.S. Now if we hover over the icon next to Admin User, we can see that if we enable this option, we can use the registry name as username and Admin User Access Key as the password to dock or log in for the container registry. I’m going to leave this disabled here and go with the standard SCU. We’ll go ahead and click Create and what this will do is create my new container registry.</p>
<p>Now that my registry had been created, what I’ll do here is browse out to the resource group that contains it and we’ll open up our registry.</p>
<h1 id="Implementing-Vulnerability-Management"><a href="#Implementing-Vulnerability-Management" class="headerlink" title="Implementing Vulnerability Management"></a>Implementing Vulnerability Management</h1><p>Hi there. Welcome to “Implementing Vulnerability Management.” In this lecture, I want to talk a little bit about security measures that you can take to manage vulnerabilities.</p>
<p>To ensure effective vulnerability management, you need to secure and protect your container ecosystem, from build to run. You need to protect against vulnerabilities throughout the entire container lifecycle, from development to production deployment. You also need to ensure that you protect all container orchestrators, hosts, and platforms.</p>
<p>An effective vulnerability management plan that’s implemented throughout the entire container development lifecycle makes it more likely that you’ll be able to identify and resolve security concerns before they become a serious problem.</p>
<p>There are several steps you should take when implementing vulnerability management. These include scanning for vulnerabilities, mapping image vulnerabilities to running containers, and ensuring that only approved images are used in the environment. You also want to allow only approved registries and ensure the integrity of your images throughout the lifecycle.</p>
<p>Other steps that you can take to manage vulnerabilities include the enforcement of least privileges in runtime and the removal of unneeded privileges, which reduces the container attack surface. You can also whitelist files and executables that each container is allowed to access or run.</p>
<p>Some other best practices for managing vulnerabilities include network segmentation of running containers, monitoring container activity user access, and container resource activity. Logging container administrative access for auditing purposes is also, of course, a best practice.</p>
<p>Because new vulnerabilities are constantly discovered, scanning for them and identifying related vulnerabilities needs to be performed on a continuous basis. That being the case, you really need to incorporate vulnerability scanning that is threaded throughout the entire container lifecycle.</p>
<p>To ensure security issues can be more easily mitigated, you need to ensure that you’re mapping vulnerabilities that are identified in container images to running containers.</p>
<p>Speaking of images, you need to ensure that you only allow approved container images. You need to have tools and processes in place that you can rely on to monitor for, and prevent, the use of unapproved container images. You can leverage image signing or fingerprinting to create a chain of custody that you can rely on to verify the integrity of your containers.</p>
<p>In addition to only allowing approved images, you should also ensure that you use only approved container registries. This is important because requiring the use of approved container registries only reduces exposure to risks by limiting the possibility of introducing unknown vulnerabilities or security issues.</p>
<p>Managing vulnerabilities throughout the container lifecycle requires you to ensure the integrity of your container images in the registry and whenever those images are altered or deployed.</p>
<p>The best way to do this is to periodically audit any images deployed in production to identify images that are out of date.</p>
<p>The concept of least privileges is a widely-accepted security best practice that applies to all sorts of resources. It also applies to containers. Generally speaking, whenever a vulnerability is exploited, the attacker often assumes access and privileges that are equal to that of the compromised application or process. By locking things down with least privileges, your containers will operate with the lowest privileges and access required to get the job done. This obviously limits exposure.</p>
<p>Removing unused and unneeded processes or privileges from the container runtime reduces the container attack surface.</p>
<p>To maintain a stable environment, you should ensure that your containers can access or run only pre-approved or whitelisted files and executables. Not only does this help you maintain a stable container environment, but it also limits your exposure to risk.</p>
<p>Enforcing network segmentation helps protect containers in one subnet from any potential security risks in another subnet.</p>
<p>I should also mention that, as is the case with any other IT environment, you always need to be consistently monitoring activity and user access to your container ecosystem. This allows you to quickly identify suspicious activity. You can use Azure Monitor for Containers and the Azure Container Monitoring Solution, both of which are <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> solutions, to perform this monitoring.</p>
<p>Monitoring resource activity and consumption helps you not only manage performance but it also serves as a helpful security measure. You can use Azure Monitor’s activity log to see what new resources are created or modified.</p>
<p>Maintaining an accurate audit trail of administrative access to your container ecosystem is critical. It’s most useful when you need to dig up forensic evidence after a security incident. The Azure Container Monitoring Solution can be used to perform this auditing.</p>
<p>As you can see, there are quite a few pieces to a solid vulnerability management implementation, but by leveraging them all you can ensure a secure environment.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Congratulations! You’ve reached the end of Configuring Azure VM and Container Security. Let’s review what you’ve learned. We kicked things off with host security. Throughout the early part of this course, you learned about configuring endpoint security within VMs and how to harden VMs in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. You also learned how to configure system updates for VMs in Azure as well as how to configure baselines. As we moved through this course, you learned about container security. You learned how to configure networks, authentication and container isolation. You also learned how to configure AKS security and how to configure container registry. Rounding things out, you learned about vulnerability management tools and strategies.</p>
<p>So now that you’ve been through this course, you should have a full understanding of how to configure Azure VM and container security. We’d love to get your feedback on this course, so please give it a rating. As always, thanks for watching and happy learning.</p>
<h1 id="4Configuring-Virtual-Machine-Security"><a href="#4Configuring-Virtual-Machine-Security" class="headerlink" title="4Configuring Virtual Machine Security"></a>4<strong>Configuring Virtual Machine Security</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-gb/azure/azure-resource-manager/templates/template-syntax">Building Templates</a></p>
<h1 id="12AKS-Security"><a href="#12AKS-Security" class="headerlink" title="12AKS Security"></a>12<strong>AKS Security</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-gb/azure/aks/operator-best-practices-cluster-isolation%C2%A7">Cluster Isolation in AKS</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Lab-Managing-Access-in-Azure-Using-Privileged-Identity-Management-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/15/AZ-500-Lab-Managing-Access-in-Azure-Using-Privileged-Identity-Management-4/" class="post-title-link" itemprop="url">AZ-500-Lab-Managing-Access-in-Azure-Using-Privileged-Identity-Management-4</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:23" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:23-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:16:36" itemprop="dateModified" datetime="2022-11-20T19:16:36-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Lab-Managing-Access-in-Azure-Using-Privileged-Identity-Management-4/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Lab-Managing-Access-in-Azure-Using-Privileged-Identity-Management-4/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>·

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Implementing-Multi-Factor-Authentication-on-Azure-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/15/AZ-500-Implementing-Multi-Factor-Authentication-on-Azure-3/" class="post-title-link" itemprop="url">AZ-500-Implementing-Multi-Factor-Authentication-on-Azure-3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:20" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:20-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:15:38" itemprop="dateModified" datetime="2022-11-20T19:15:38-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Implementing-Multi-Factor-Authentication-on-Azure-3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Implementing-Multi-Factor-Authentication-on-Azure-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hi, and welcome to Implementing Multi-Factor Authentication on Azure. My name is Eric Leonard, and I’ll be leading you through this course on implementing multi-factor authentication. I’m a Microsoft Azure MVP and an Azure content author at Cloud Academy. I have over 15 years of experience in IT, several of those working with cloud technologies in the public and private sectors. If you have a question, feel free to connect with me on LinkedIn and send me a message, or send an email to <a href="mailto:&#x73;&#x75;&#112;&#x70;&#111;&#114;&#116;&#64;&#x63;&#108;&#x6f;&#x75;&#100;&#97;&#99;&#97;&#100;&#101;&#109;&#x79;&#x2e;&#99;&#x6f;&#x6d;">&#x73;&#x75;&#112;&#x70;&#111;&#114;&#116;&#64;&#x63;&#108;&#x6f;&#x75;&#100;&#97;&#99;&#97;&#100;&#101;&#109;&#x79;&#x2e;&#99;&#x6f;&#x6d;</a>. </p>
<p>Who should take this course? This course is intended for people who are tasked with managing Azure Active Directory. To get most out of this course, you should have a general understanding of Azure Active Directory. We’ll begin the course by touching on an overview of implementing multi-factor authentication on Azure. We will then work through the implementation process by enabling MFA on an Azure tenant. Next, we will talk about configuring a user account for MFA and the different options that are available to secure your identities. By the end of this course, you should be able to implement multi-factor authentication on Azure. We would love to get your feedback on this course, so give it a rating when you are finished. So if you are ready to learn more about implementing multi-factor authentication, let’s get started.</p>
<h1 id="Overview-of-Multi-Factor-Authentication"><a href="#Overview-of-Multi-Factor-Authentication" class="headerlink" title="Overview of Multi-Factor Authentication"></a>Overview of Multi-Factor Authentication</h1><p>Azure Multi-Factor Authentication helps protect access to your data and applications, all the while keeping it easy for users. It provides additional security by requiring a second form of authentication and deliver strong authentication via a range of easy-to-use authentication methods. Those authentication methods can be called to the phone. This will automatically call the registered phone number with MFA. The user will need to answer and select a pound key to verify, or SMS message to the phone. </p>
<p>This will send a text message to the user containing the verification code. The user will then need to answer the code at the sign in interface, or notification through the authenticator app. This will send a push notification to the Microsoft Authenticator app on the user’s mobile phone. The user can accept the push notification to verify. And lastly, a verification code from a mobile app or hardware token. This will prompt the user to enter a verification pin. The user will need to launch the Microsoft authenticator app and enter the pin that is presented to them. The pin expires after 30 seconds and a new one will be generated. Within Azure Multi-Factor Authentication many options can be configured by the administrator to better customize the user experience.</p>
<p> The organization can determine what authentication method we mentioned earlier to allow. If for example, SMS messages are considered a security risk, then this option can be turned off. Fraud alerts can be configured so that the users can report fraudulent attempts if they receive a two-step verification request that they didn’t initiate. A one-time bypass code can be used to sidestep the two-step verification for a limited time. An example of this would be if an employee lost her phone. Lastly, we will look at trusted IP’s for managed and federated tenants to bypass the two-step verification when they’re in a trusted location such as company officials.</p>
<h1 id="Enable-MFA-for-an-Azure-Tenant"><a href="#Enable-MFA-for-an-Azure-Tenant" class="headerlink" title="Enable MFA for an Azure Tenant"></a>Enable MFA for an Azure Tenant</h1><p>There are three ways to enable MFA in Azure. You can enable MFA by changing the user state or configuring a registration policy in Azure AD Identity Protection, or by creating a conditional access policy in Azure AD. Let’s have a look at each option to see how we can enable MFA. Azure AD Identity Protection is part of the Azure AD Premium 2 offering which gives you the ability to detect potential issues with your corporate identities, investigate suspicious activity, and take appropriate action to them. When something suspicious is detected, you can have an automated response to the event. </p>
<p>Set risk conditional access policies to automatically protect users. Risk-based conditional access policies in Azure AD Identity Protection allows you to create a registration policy to force some or all of your users to complete the MFA registration. Azure AD conditional access is part of the premium offering in Azure AD, allows you to set the right access controls under the right condition. This means that if a user tries to access a web app from the corporate network, they will not be prompted, but if they try it from their favorite coffee shop, then they will be prompted for their username and password. This condition is based on location. Conditional access allows Azure AD to determine when to enforce MFA or not. </p>
<p>Enabling MFA by changing the user state is a traditional method of enabling two-step verification. It allows you to go to the MFA site and configure each account and enable MFA. Once MFA’s enabled by user state, it will always require the two-step verification. In the upcoming videos, we will cover all the configuration options around user accounts.</p>
<h1 id="Configure-User-Accounts-for-MFA"><a href="#Configure-User-Accounts-for-MFA" class="headerlink" title="Configure User Accounts for MFA"></a>Configure User Accounts for MFA</h1><p>Enabling multifactor authentication for users is just as important to enable as administrators. Azure users could have access to sensitive data such as financial or employee data. Multifactor authentication can be enabled quickly from the Azure portal and should be enabled for all administrators including global administrators as well as for all users. As an example, if you have a user that has access to financial employee data, it’s just as important you enable MFA for those users as you would for an administrator. All users start out disabled. When you enroll users in Azure MFA their state changes to enabled. When enabled users sign in and complete the registration process, their state changes to enforced. </p>
<p>Let’s enable multifactor authentication for our users. Here we are in the Azure portal. On the left hand side I have a short cut for Azure Active Directory. Select it and go to users. And here you’ll see a list of all of our users. In the menu bar select multifactor authentication. A new page will display and it will show you all of the state of the users. You’ll see that Allen has it’s state as enabled. But other users are disabled. So let’s go to Ari and enable MFA. Select him. And then click Enable. A warning message will display, including the URL that the user needs to go to, to set up. Click enable multifactor authentication and then click close. Now Ari has it’s state as enabled. Once Ari finishes his set up he will be listed as enforced.</p>
<h1 id="Configure-Verification-Methods"><a href="#Configure-Verification-Methods" class="headerlink" title="Configure Verification Methods"></a>Configure Verification Methods</h1><p>The Multi-Factor Authentication can be configured to accept different forms of authentication methods, be it calling your phone, sending a text message, notification in the Microsoft Authenticator app, or using a verification code. Call to phone option will be an automated call to the number you have provided, and simply hit the pound symbol to authenticate. When entering your number, ensure you enter it with the country code, then the 19-digit number. SMS messages option will send an automated text message to your mobile phone number. You typically have about five minutes to enter the code before it times out. Just like the voice call option previously, ensure you enter a number with country code, then a 10-digit number. </p>
<p>Notification through the app. Microsoft has a free app called Microsoft Authenticator that’s available in the Google Play store and the App Store. After you have configured your accounts to receive notification, every time you log in, you will receive a notification on your phone to approve or decline the login through the app. Verification code, just like receiving notifications, you need to have the app installed on your mobile phone. After you have configured your account to enter verification codes, you will be prompted to enter a code every time. The verification codes cycle every 30 seconds, so make sure you enter it quickly.</p>
<h1 id="Configure-Fraud-Alert"><a href="#Configure-Fraud-Alert" class="headerlink" title="Configure Fraud Alert"></a>Configure Fraud Alert</h1><p>Azure Multi-Factor Authentication includes the ability to report fraud alerts. This empowers the user to proactively report attempts of someone trying to use their account. Users can report the fraud alerts through the Microsoft Authenticator app by denying the approve request or when receiving the automated phone call by entering the fraud code. Fraud alert is not enabled by default and will need to be configured in Azure Active Directory. Luckily, it’s a pretty simple process of enabling it with minimal configuration. The first option is, allow users to submit fraud alerts. By default, this is set to off. But you can then switch it on to enable fraud alerts. The second option is, automatically block users who report fraud. Once the user reports fraudulent activity through the Multifactor Authentication their account will be automatically blocked for 90 days or until an administrator unblocks their account. </p>
<p>The third and last option is, code to report fraud during the initial greeting. When a user receives the automated phone call for the two-step verification, you will hit pound to authenticate. If you receive the automated phone call and didn’t sign in, you can report fraud, by typing the code followed by pound. The default is zero pound. Here we are back in the Azure portal, where we’ll configure fraud alerts for Multifactor Authentication. In Azure active directory under security, select MFA, and then select fraud alert. In this screen we will set the allow users to submit fraud alerts setting to on. You can then choose to automatically block users who report fraud or not. And finally you can set the code to report fraud during the initial greeting. Select save. </p>
<p>Now that fraud alert is enabled our fictitious user, Ari, has received a phone call to authenticate. But Ari did not initiate the request. Ari can simply hit zero and then pound sign to report. This will automatically block this account. Now let’s see what happens when a user is blocked. Back in Azure active directory you go to MFA and select block unblock users. Here we will find a list of blocked users with the reason why it’s blocked and the date. To unblock an account as the administrator you can select unblock and provide a short description of why you are unblocking the account and click okay.</p>
<h1 id="Configure-Bypass-Options"><a href="#Configure-Bypass-Options" class="headerlink" title="Configure Bypass Options"></a>Configure Bypass Options</h1><p>The one-time bypass feature of Azure Multi-Factor Authentication is used as a single time to bypass the two-step verification. As an example, if a user lost their phone, they could not complete the two-step verification. In this instance, they would need to contact an administrator to bypass the two-step verification. Once a user is added to the one-time bypass list, it goes into effect immediately and expires after the specified time. The default period is 300 seconds or five minutes. </p>
<p>Back in the Azure Portal where we will allow a user to bypass the two-step verification. In Azure Active Directory under Security, select MFA and then select One-time bypass. On the One-time bypass page, you can change the global default from 300 seconds to between five and 1,800 seconds. To add a user to bypass the two-step verification, select Add. Add the user name under User. You can change the default seconds and enter a reason for the one-time bypass and click OK. Now the user can log in and bypass the two-step verification, but remember that this is only one time or single bypass of the two-step verification.</p>
<h1 id="Configure-Trusted-IPs"><a href="#Configure-Trusted-IPs" class="headerlink" title="Configure Trusted IPs"></a>Configure Trusted IPs</h1><p>The trusted IPs feature of Azure Multi-Factor Authentication is configured by your administrator to bypass two-step verification for users who sign in from a trusted location like the office. But will be prompted by MFA elsewhere, like your favorite coffee shop. Trusted IPs fall into two categories, managed and federated. </p>
<p>Managed users, you can simply add the IP address range from your office to bypass the two-step verification. Federated users on the other hand, if your organization uses Active Directory Federated Services, select the check box for skip multifactor authentication for requests from federated users on my intranet, and users who sign in to the office will bypass the two-step verification by using a claim that is issued by Active Directory Federated Services. </p>
<p>Back in Azure Active Directory where we will configure trusted IPs. Go to users and select multifactor authentication. Once the multifactor authentication page displays, select service settings. Under trusted IPs you can enter the IP address, using the CIDR notation. As an example, we can add 192.168.0.0&#x2F;24. If your users are federated you can select a check box to skip multifactor for requests from federated users on my intranet. You do not need to provide an IP address range for this option. Scroll to the bottom and select save.</p>
<h1 id="Conditional-Access"><a href="#Conditional-Access" class="headerlink" title="Conditional Access"></a>Conditional Access</h1><p>Azure Active Directory Conditional Access enables you to enforce controls on access to Cloud-based applications based on a set of defined conditions. Those conditions represent a conditional access policy which is integrated with your set of access controls. Conditional Access policy works with the principle of, when this happens, then do this. The, when this happens, is what triggers the conditional access policy. The two mandatory conditions are the user. That’s who tried to access what. </p>
<p>And the Cloud-based application, that’s the what, which application was accessed. There are other optional conditions that you can apply to a policy. The, then do this, is the response of the policy. Conditional access policy does not grant access to the application, but sets conditions on how to access the application. Conditions can be accessed. This Cloud application, you must use multifactor authentication. With conditional access, we can enforce the use of multifactor authentication to Cloud-based applications like the Azure portal when not accessing it from the corporate network. Let’s head back to the Azure portal and configure conditional access for multifactor authentication. Back in Azure Active Directory we will scroll down to conditional access, where we will select new policy. When the new blade appears we will provide a name of our policy. </p>
<p>Let’s call it MFA for Portal Access. Under users and groups, select users and groups radio button. Select the users and group check box. And select the appropriate group. Here we will select MFA users. Click select and click done. Under Cloud apps, select the select apps radio button. A list of Cloud applications will be presented and pick Microsoft Azure Management. Click select and click done. Under access control select grant and select the check box for require multifactor authentication. Click select. Enable the policy by switching the toggle to on and click create. Now we have created a conditional access policy for accessing the Azure Portal, by requiring the use of multifactor authentication.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>I hope you enjoyed learning about implementing Multi-Factor Authentication on Azure. Let’s review what you learned in this course. Azure Multi-Factor Authentication adds additional security by requiring a second form of authentication and is delivered via a range of easy-to-use authentication methods. The second form of authentication can be an automated voice call, or an SMS message containing a verification code, or a notification through the Microsoft Authenticator app, or using verification codes using the authenticator app or a third party app. Azure multi-factor authentication can be enabled through Azure Active Directory by changing the user state. All users start off as disabled and the administrator can enable multi-factor authentication on a per-user basis. </p>
<p>Once the user has completed the registration process, the user state changes to enforced. Azure multi-factor authentication includes the ability to report fraud alerts. This empowers a user to proactively report attempts of someone trying to use their account. Users can report fraud alerts through the Microsoft Authenticator app by denying the approve request or when receiving the automated phone call by entering the fraud code. In the event you are unable to provide the second form of authentication, you can contact your administrator for a one-time bypass code to bypass the two-step verification. Trusted IPs feature of Azure’s multi-factor authentication is configured by your administrator to bypass two-step verification for users who sign in from the corporate network, but will be prompted by multi-factor authentication elsewhere. Azure Active Directory conditional access enables you to enforce controls on access to cloud-based application based on a set of defined conditions. </p>
<p>With conditional access, we can enforce the use of multi-factor authentication to cloud-based application like the Azure portal when not accessing it from the corporate network. To learn more about implementing and managing Multi-Factor Authentication, be sure to read Microsoft documentation. Be sure to also watch for new Microsoft Azure courses on Cloud Academy because we’re always publishing new courses. Please give this course a rating and if you have any questions or comments, please let us know. Thanks for watching and happy learning.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Designing-for-Azure-Identity-Management-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/15/AZ-500-Designing-for-Azure-Identity-Management-2/" class="post-title-link" itemprop="url">AZ-500-Designing-for-Azure-Identity-Management-2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:18" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:18-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:11:06" itemprop="dateModified" datetime="2022-11-20T19:11:06-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Designing-for-Azure-Identity-Management-2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Designing-for-Azure-Identity-Management-2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to Designing for Azure Identity Management. My name is Thomas Mitchell and I’ll be taking you through this course on the key technologies to consider when designing an identity management solution. I’m an Azure Content Author at Cloud Academy and I have over 25 years of deep IT experience, several of those with cloud technologies. If you have any questions, feel free to connect with me on LinkedIn, or send an email to <a href="mailto:&#115;&#117;&#x70;&#x70;&#x6f;&#114;&#x74;&#64;&#99;&#108;&#111;&#x75;&#x64;&#97;&#x63;&#x61;&#100;&#x65;&#109;&#x79;&#x2e;&#x63;&#111;&#x6d;">&#115;&#117;&#x70;&#x70;&#x6f;&#114;&#x74;&#64;&#99;&#108;&#111;&#x75;&#x64;&#97;&#x63;&#x61;&#100;&#x65;&#109;&#x79;&#x2e;&#x63;&#111;&#x6d;</a>. This course is intended for IT professionals who are interested in earning Azure certification, those who wish to become Azure architects, and those who are tasked with designing an Azure identity management solution. To get the most from this course, you should have at least a moderate understanding of Microsoft Azure, and of identity management concepts. We’ll kick off the course by discussing <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a> and what it offers. We will then talk a bit about hybrid identities and what purpose they serve. Next, we’ll cover Azure AD Domain Services and how to deploy this feature. </p>
<p>After covering Azure AD Domain Services, we’ll get into <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/single-sign-on-overview/">single sign-on</a>, and how to configure it for a web application. Azure MFA or multi-factor authentication is another cool feature that we will discuss. We’ll cover what it is, what it offers, and how to enable it. After covering MFA, we will get into Azure AD B2B and Azure AD B2C. These are Azure AD Business to Business and Azure AD Business to Consumer. You will learn what they are, what they offer, and how to deploy them. We’ll then move into Privileged Identity Management, otherwise known as PIM. Rounding out the course are topics on <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-password-reset/">self-service password reset</a>, self-service group management, and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/overview-of-managed-identities-for-azure-resources/">managed identities for Azure resources</a>. There are demonstrations sprinkled throughout the course. These demos will show you how to deploy and use the technologies covered. By the end of this course, you should have a good understanding of all key technologies and features as they relate to designing for Azure identity management. You should also be able to deploy each feature with an understanding of what it offers and how it fits into any identity management solution. We’d love to get your feedback on this course, so please give it a rating when you’re finished. If you’re ready to learn about Designing for Azure Identity Management, let’s get started.</p>
<h2 id="Azure-Role-Based-Access-Control"><a href="#Azure-Role-Based-Access-Control" class="headerlink" title="Azure Role-Based Access Control"></a><strong>Azure Role-Based Access Control</strong></h2><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/azure/role-based-access-control/overview">Azure RBAC overview</a></p>
<h1 id="Introduction-to-Azure-AD"><a href="#Introduction-to-Azure-AD" class="headerlink" title="Introduction to Azure AD"></a>Introduction to Azure AD</h1><p>Microsoft’s Azure Active Directory is a cloud-based identity and access management service. With it, users can sign in and access external resources such as Office 365, the Azure portal, and other software as a service applications. Azure AD, of course, also allows users to access internal resources as well. Such resources include applications inside the corporate network and on the internet along with cloud applications that have been developed and deployed by your organization. Azure AD is used to control access to applications and resources according to business requirements. For example, Azure AD can be configured to require multi-factor authentication or MFA when a user needs access to important company resources. In addition, Azure AD can be used to automate user provisioning between an existing on-prem Windows server AD and corporate cloud applications like Office 365. With Azure AD, organizations have access to tools that can used to automatically help protect user identities and credentials which allows them to meet access governance requirements. Microsoft Online services like Office 365 and Microsoft Azure leverage Azure AD for sign-in and for identity protection. As such, an organization that subscribes to any of the Microsoft Online business services automatically gets at least the free version of Azure AD along with those services. </p>
<p>Adding paid services to a tenant can enhance an Azure AD implementation. Such paid services include Azure Active Directory Basic, Azure Active Directory Premium 1, and Azure Active Directory Premium 2. These Azure AD paid licenses ride on top of an existing free directory, and they can provide additional services such as self-service, security reporting, enhanced monitoring, and secure access for mobile users. One thing to note, however, is that while all of these added features can add cool functionality and security, Azure Active Directory Basic, Azure Active Directory Premium 1, and Azure Active Directory Premium 2 are not currently supported in China. The free version of Azure Active Directory offers basic user and group management functionality and on-prem directory synchronization. It also offers basic reporting and single sign-on or SSO across Office 365, Microsoft Azure, and many popular SaaS applications. In addition to the free features available in the Azure AD Free version, Azure AD Basic provides cloud-centric application access as well as group-based access management. Other features included with the Basic version include self-service password reset for cloud apps and Azure AD Application Proxy which is a feature that allows you to publish on-prem web applications using Azure AD. Azure Active Directory Premium P1 offers quite a bit more than either Free or Basic. In addition to what those versions offer, Azure AD Premium P1 offers hybrid users access to both on-prem and cloud resources. Premium P1 also supports advanced administration tasks like self-service group management, dynamic groups, and it even integrates with Microsoft Identity Manager or MIM. Microsoft Identity Manager is an advanced, on-prem identity and access management solution. </p>
<p>Azure AD Premium P1 also offers cloud write-back capabilities which are used to allow self-service password reset for your on-prem users. Azure Active Directory Premium P2 builds upon what is offered in the P1 edition by offering everything included in the Free, Basic, and P1 versions plus Azure Active Directory Identity Protection which helps provide risk-based conditional access to applications and critical company data. Azure AD Premium P2 also offers Privileged Identity Management or PIM which is useful for discovering, restricting, and monitoring administrators as well as their access to corporate resources. Privileged Identity Management also provides just-in-time access when it’s needed, meaning access to resources can be limited to only those times when it’s required and then be taken away automatically when the access is no longer needed. Other pay-as-you-go feature licenses such as Azure AD Business-to-Consumer are also available to assist with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a>. Azure AD B2C as it’s called helps provide identity and access management solutions for customer-facing applications.</p>
<h1 id="Create-Directory-and-Add-Custom-Domain"><a href="#Create-Directory-and-Add-Custom-Domain" class="headerlink" title="Create Directory and Add Custom Domain"></a>Create Directory and Add Custom Domain</h1><p>To create a new directory and add a custom domain for it, log into the Azure portal. While in the portal, open <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a> and click on the create a directory link. Provide an Organization name along with the domain to use for the directory. Select a country or region and then click create. Once the directory has been provisioned, click the link to manage the new directory and sign in if required to do so. From within Azure Active Directory click custom domain names and then add your custom domain name. Provide and internet routable custom domain name and then click add domain. </p>
<p>At this point you’re provided with the option to verify the domain via either a text record or an MX record. My preference is to typically use the text record. Copy the record value and then visit your domain’s DNS management console. Create a text record and supply the value that you were provided. Save your new text record and switch back over to Azure. Click the verify button to verify the domain using the DNS record that you’ve just created. After verifying the domain, set its primary. And then click yes to confirm.</p>
<h1 id="Azure-AD-Domain-Services-Overview"><a href="#Azure-AD-Domain-Services-Overview" class="headerlink" title="Azure AD Domain Services Overview"></a>Azure AD Domain Services Overview</h1><p>Azure AD Domain Services is a Microsoft cloud-based offering that provides managed domain services, such as domain join, group policy, LDAP, and Kerberos and NTLM authentication. The domain services provided are fully compatible with traditional on-prem Active Directory and they can be deployed without any need for deployment or management of domain controllers in the cloud. Azure AD Domain Services integrates with the existing <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> tenant and makes it possible for users to log in with their corporate credentials. Existing user accounts and groups can be leveraged to secure access to resources. As such, this offers a smoother transition of on-prem resources to Microsoft Azure. Companies leveraging a hybrid IT infrastructure will typically synchronize their <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity</a> information from their on-prem directories to the Azure AD tenant. As more of their on-prem applications are migrated to Azure, Azure AD Domain Services can become more useful. An important caveat to consider when deciding if Azure AD Domain services are the right solution is that password sync is mandatory for a hybrid organization to use Azure AD Domain Services. </p>
<p>This is required because users’ credentials are needed for authentication via NTLM and Kerberos in the managed domain that is provided by Azure AD Domain Services. When considering Azure AD Domain Services, keep in mind that the managed domain is actually a stand-alone domain. It is not, and I repeat, it is not an extension of the on-prem AD domain. This is a common misconception among IT professionals. Also, because the domain is managed, the IT administrator does not need to, nor can he, manage, patch, or monitor the domain controllers for the managed domain. Likewise, there is no need to manage or even monitor AD replication within the managed domain. Quite frankly, there really isn’t much for the administrator to do in the managed domain, especially since the administrator doesn’t even have Domain Admin or Enterprise Admin privileges on the managed domain.</p>
<h1 id="Deploy-Azure-AD-Domain-Services"><a href="#Deploy-Azure-AD-Domain-Services" class="headerlink" title="Deploy Azure AD Domain Services"></a>Deploy Azure AD Domain Services</h1><p>To deploy <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/azure-ad-domain-services-overview/">Azure AD Domain Services</a> log into the Azure portal. Once in the portal click on Create a Resource and then search for Domain Services. Select Azure AD Domain Services from the search results and then click Create. Provide the basic information for the domain, including the DNS name for the domain as well as the Subscription you are deploying to, along with a Resource group. You’ll also need to supply a Location. Click Okay to move onto the next step. At this point you’re prompted to create a Virtual network for the managed domain that you are setting up. Provide a name for the network along with an address space that works for your environment. You will also need to define a Subnet and a Subnet address range that you’d like to use for the managed domain. </p>
<p>The managed domain controllers and associated infrastructure that gets deployed by <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> as part of the Manage Domain setup will reside on this network and on this subnet. Click Okay and then Okay again. Next you are advised that the AAD DC Administrators group has been created. This group is used to manage the domain. It’s similar to but not quite like Domain Admins in an On-Prem Active Directory Domain. Click on the group to add members to it. When you’re done adding members that need to manage the domain go back and click Okay. This synchronization step has nothing to do with Azure AD Connect or with On-Prem AD if one exists. Instead, this synchronization step is meant to sync users and groups from Azure AD into Domain Services. You have a choice of syncing all users or scoping the sync to just certain groups. In this demonstration I’m just going to sync all users and groups from Azure AD to Domain Services. Clicking Okay takes you to the next step where you can review your options. Click Okay to commence the deployment of Azure AD Domain Services. </p>
<p>The actual deployment can take the better part of an hour because it’s deploying lots of stuff in the background. It’s deploying the network infrastructure that you’ve defined as well as two managed domain controllers. It’s also setting up the managed domain itself. After enabling Azure Active Directory Domain Services you need to enable computers within the Virtual Network to connect to and consume these services. To do so you need to update the DNS Server Settings for your Virtual Network so that it points to the two IP addresses where Azure Active Directory Domain Services are available. To update the DNS Server settings for the Virtual Network hosting your Azure Active Directory Domain Services browse to the Azure portal and open up your instance of Azure AD Domain Services. The Overview tab will list a set of required configuration steps. One of those is to update the DNS Server settings for the Virtual Network. You will be presented with two different IP addresses. These are the IP addresses where Azure AD Domain Services is available. These are essentially the managed domain controllers that were stood up as part of the deployment of Azure AD Domain Services. After making a note of these IP addresses, click the Configure button and update the DNS Server settings for the Virtual Network. With Azure AD Domain Services provisioned and your DNS updated you can now move on and enable password hash synchronization using Azure AD Connect.</p>
<h1 id="A-Word-About-Personas"><a href="#A-Word-About-Personas" class="headerlink" title="A Word About Personas"></a>A Word About Personas</h1><p>Personas can be an important tool that drives adoption and business value realization. What happens quite often is that organizations deploy technology solutions without a full understanding of the users that those solutions are intended for. When this happens, the deployed solutions do not get used, and the value of those solutions goes unrealized.</p>
<p>If an organization deploys an Azure solution, but nobody uses it, the organization doesn’t realize the value – and it becomes a waste. In order to generate value from an Azure solution, an organization must determine what users should START doing or STOP doing, in order to realize the value of the solution.</p>
<p>Essentially, its user behavior change that becomes the yardstick for evaluation, adoption, and use of solutions deployed in Azure. Personas can be useful when trying to drive adoption of new Azure solutions.</p>
<p>A persona is really just a fictitious character that represents a certain user type. Personas refer to the “who” when discussing an organization. The use of personas helps organizations characterize different sets of users, and to capture details about what a typical day looks like to those users. Personas can be used to capture the pains, needs, and desired outcomes that users have as they perform their daily tasks. </p>
<p>To build personas that reflect the workforce, organizations need to communicate with end users. Organizations need to know how work currently gets done in order to deploy Azure solutions that help users get that work done. Defining personas for each user type can help organizations accomplish this. More specifically, from an Azure perspective, an organization can build personas to assist with the creation of roles. By defining different personas, the organization has better visibility into what roles are necessary – and if custom roles are needed.</p>
<p>As a result, organizations can realize more value when deploying Azure solutions, because the solutions that are deployed can then be tailored to the users for whom the solutions are intended. Management of those solutions can be streamlined via built-roles that match the defined personas, or via custom roles, when the built-in roles are not sufficient.</p>
<h1 id="Hybrid-Identities"><a href="#Hybrid-Identities" class="headerlink" title="Hybrid Identities"></a>Hybrid Identities</h1><p>As the move to the cloud gathers steam, corporations are finding themselves supporting a mixture of on-prem and cloud applications. Users obviously are finding themselves requiring access to those applications as well. This, of course, becomes a challenge to implement. The <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity</a> solutions we previously discussed are solutions that span on-prem and cloud-based capabilities. Leveraging these solutions allows an organization to create a common user identity for authentication and authorization to all resources, regardless of whether they are on-prem or in the cloud. This concept is called hybrid identity. Achieving hybrid identity requires the development of one of three authentication methods. The authentication method that is deployed is dependent on the specific scenario being addressed. The three authentication methods include Password Hash Synchronization, Pass-Through Authentication, and Federation. Password Hash Synchronization is also referred to as PHS, while Pass-Through Authentication is referred to as PTA. Federation is referred to as, well, Federation. Password hash synchronization is a sign-in method used as part of a hybrid identity solution. This is accomplished with Azure AD Connect by synchronizing a hash, of the hash, of a user’s on-prem AD password to a cloud-based <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> instance. This feature is useful for signing in to Azure AD services like Office 365 with the same password as an on-prem AD account, which reduces end-user impact. The password hash synchronization strategy reduces, to just one, the number of passwords that an organization’s users need to maintain. As such, password hash synchronization can improve user productivity and reduce helpdesk costs. Password hash synchronization, which is the most common hybrid identity solution, requires an organization to install Azure AD Connect. </p>
<p>Once Azure AD Connect is installed, directory synchronization between the on-prem Active Directory instance and the Azure Active Directory instance is configured. As part of the synchronization configuration, password hash synchronization is enabled. Azure AD Pass-through Authentication, or PTA, much like Password Hash Synchronization, allows users to sign in to both on-prem and cloud-based apps with the same password. And much like password hash synchronization, this option offers a better end user experience. However, pass-through authentication validates user passwords directly against the on-prem Active Directory, instead of using a synced password hash. A key benefit of pass-through authentication over password hash synchronization is that it affords organizations the ability to enforce their on-prem AD security and password policies, since pass-through authentication is actually leveraging the on-prem credentials. By combining Pass-through Authentication with Seamless Single Sign-On, organizations can allow users to access applications on corporate machines inside the network without the need to type in their passwords again. Azure AD Pass-through Authentication provides an improved end-user experience because it offers end users the ability to complete self-service password management tasks in the cloud. Deployment and administration are easy because Pass-Through Authentication only requires a lightweight agent to be installed on-prem. Since the agent automatically receives updates, there is no management overhead. Pass-Through Authentication offers improved security over Password Hash Synchronization because on-prem passwords are never stored in the cloud. </p>
<p>Because it works with Azure AD Conditional Access policies, including MFA, Pass-Through Authentication offers additional account protection. Another benefit of Pass-Through Authentication is the fact that the agent only makes outbound connections from the network, removing all requirements for a DMZ as part of a solution. Communication between the on-prem agent and Azure AD is secured via cert-based authentication, which adds another layer of security. Further, the certificates that are used are automatically renewed every few months by Azure AD, removing the requirement to manually maintain them. In addition to high security, Azure AD Pass-Through Authentication offers high availability by allowing the installation of additional agents on multiple on-prem servers. Federation is a bit different from the other two solutions. It is a collection of domains with an established trust, which typically includes authentication, and almost always includes authorization. In a common configuration, a federation might include multiple organizations that have established trust for shared access to a specific set of resources. Federating an on-prem environment with Azure AD allows and organization to use the federation for authentication and authorization. Federation ensures that all user authentication happens on-prem and it provides administrators with the ability to implement more rigorous levels of access control. Federation with ADFS and PingFederate is available. To protect against a failure of the ADFS infrastructure when using federation with ADFS, organizations can set up password hash synchronization, or PHS, as a backup. Doing so allows authentication to continue, despite an ADFS infrastructure failure. All three of these authentication methods including PHS, PTA, and Federation provide single-sign on capabilities, which automatically signs users in when they are on their corporate devices inside the corporate network.</p>
<h1 id="DEMO-Managing-Users-Groups-and-Devices-in-Azure-AD"><a href="#DEMO-Managing-Users-Groups-and-Devices-in-Azure-AD" class="headerlink" title="DEMO: Managing Users, Groups, and Devices in Azure AD"></a>DEMO: Managing Users, Groups, and Devices in Azure AD</h1><p>Hello and welcome back! In this brief demonstration, I just wanted to walk you through the process of managing users and groups within Azure Active Directory. Now on the screen here, you can see I’m logged into my Azure Portal for the directory called Test9878.org. This is the custom domain I’m using for my Azure AD here.</p>
<p>Now to get to this screen from Azure, what I’ll do here is I’ll bounce back out to my homepage and here’s the homepage. To get into Azure AD, I can simply select Azure Active Directory from the top here, or I can go to the hamburger and select Azure Active Directory.</p>
<p>So from this overview page, I can browse to lots of different pieces of Azure AD. Under the manage section is where I’ll manage my users and groups along with devices, app registrations, all of this fun stuff where you’ll do your day to day management of your Azure Active Directory. Down the bottom is where you’ll perform your monitoring. And then down at the very bottom, you’ll do your troubleshooting and support.</p>
<p>So from this page, let’s go ahead and create a user in Azure Active Directory. And to do that, it’s pretty straight forward. We simply select users here. And from this screen, we can see all of the existing users in our AD.</p>
<p>We can see, we have two accounts here. One is an admin in the actual Azure Active Directory as shown here under source. The ThomasMitchell.net account is actually an external Azure Active Directory account from another directory.</p>
<p>What we’re going to do here is create a new user and we’ll just call this Dave. And in this dropdown we can select the actual domain name we want to use, we’re using the custom domain, so we’ll leave it at Test9878.org and we’ll give our username. And then we have the option to auto-generate a password or create one, we’ll leave the auto-generate here. And this will show us what the password is.</p>
<p>We can then provide that password to the new user. I would not send this out via any kind of electronic methods when possible. That’s obviously a security risk. As we create our user, we can then select a group to add our user to. So we’ll go ahead and make him a user within our box users group.</p>
<p>This is actually a group I created earlier for some other demonstration. So we’ll go ahead and we’ll select him. So now what we’re doing here is creating our <a href="mailto:&#x44;&#x61;&#x76;&#x65;&#x40;&#84;&#101;&#x73;&#116;&#57;&#56;&#55;&#x38;&#46;&#x6f;&#x72;&#103;">&#x44;&#x61;&#x76;&#x65;&#x40;&#84;&#101;&#x73;&#116;&#57;&#56;&#55;&#x38;&#46;&#x6f;&#x72;&#103;</a>, we’re auto generating a password and we’re placing this new user in the box users group.</p>
<p>The block sign in is pretty self explanatory. We can either block sign in by selecting yes or allow sign-ins by leaving the no option selected here. And then we have some additional info we can add. We can add a job title in a department.</p>
<p>We can also specify the usage location. So we’ll go ahead and we’ll select United States down here. And we’ll go ahead and create the user. And at this point, we now have a new user in our directory. If we select our user from our list, we can then look at the user’s profile, which includes his identity, his job information, any kind of special settings, contact info. This is where we manage this information as far as the profile goes.</p>
<p>We can then go into assigned roles where we can actually look at any roles that have been assigned to this user. And we can add assignments. You can see all of the different directory roles here that are included by default.</p>
<p>Now we can also see, we can assign custom roles, but if you look at the little icon up here, it tells us that if we want to assign custom roles to a user, the organization needs Azure AD Premium P1 or P2. I’m using the free Azure edition right now. But if he wanted to make, you know, Dave an application administrator, we simply check the box and add the role. And now we can see under assigned roles for Dave, we have application administrator, and of course the description tells us what an application administrator can do.</p>
<p>If we want to remove this assignment for this user, we select the assignment and remove it. Now, if we go back out to our directory, let’s take a look at groups and how we can manage groups here. By selecting groups, we can look at what groups are currently defined within our Azure AD.</p>
<p>If we want to create a new group, we simply select a new group and we can choose whether it’s a security group or an office 365 group. We’ll leave this at security and we’ll just call this marketing. And we’ll give it a description. We can see, we currently have no owners or members defined for this group.</p>
<p>So we’ll go ahead and select an owner. We’ll just make myself an owner here. And then we’ll add a new member. Let’s go ahead and add Dave. And then we create it. So now we have a new group called marketing. It’s a security group and the membership type here is assigned, which means we’re going to manually add and remove users from this group. So we’ll go ahead and select marketing here. And from here, we can look at the different properties of this group.</p>
<p>We can see when it was created, the membership type, whether it’s a cloud sourced group and what type of group it is. We can see the different direct members and any kind of group memberships. We look at properties here. We can see here, we have the name and we can actually change it here. And the description, and then members and owners will tell us who the members are and who the owners are.</p>
<p>If we select group memberships here, we can see that the marketing group is not a member of any other groups. So this is where you could see group nesting. Now in this applications area, we can see what applications are assigned to our group. So if we have a group of users that needs access to a specific application, we can create that group, assign the application to that group, and then add users to that group.</p>
<p>Any users that get added to that group are the ones that will get access to the application. Same thing with licensing. We can assign licenses to specific groups. So whatever users get added to that group also get those licenses. And same thing for Azure roleassignments.</p>
<p>So that’s the quick and dirty on how to create users and groups and how to manage them through the Azure Portal for Azure Active Directory. And before we run away here, let’s just take a look at devices.</p>
<p>Now, this devices page is where you manage any devices that are joined to your Azure AD. We can see here, I have a workstation that has been joined. And if I select that workstation, I can take a look at its device ID, its object ID, and all kinds of information about this specific device. I can then even disable the device so it’s no longer able to access Azure AD. We’re not going to do that here, but we will bounce back to our directory.</p>
<p>Now from this Azure Active Directory overview page, you can also manage password resets, manage Azure AD connect. You can take a look at the provisioning status. You can manage your custom domain names, even managed company branding. So there’s a lot you can do from your Azure Active Directory page here. And this is where all of your management will happen.</p>
<p>All of your users, all of your groups, all of your devices, all of your branding, all of your domains, all this stuff is done right here from this Azure Active Directory page. So I really recommend that you go in and you play around in here and kind of learn what you can do and do some experimentation because you really want to try to get some stick time to get a real good understanding of all of the different features in Azure Active Directory.</p>
<h1 id="Deploy-Azure-AD-Connect"><a href="#Deploy-Azure-AD-Connect" class="headerlink" title="Deploy Azure AD Connect"></a>Deploy Azure AD Connect</h1><p>In this demonstration, we’re going to deploy Azure AD Connect so we can sync our on-prem active directory users to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a>. We are also going to need to ensure that we synchronize NTLM and Kerberos credential hashes to Azure AD, since this isn’t done by default. To get started, login to the server that will run Azure AD Connect and download the Azure AD Connect software. Launch the Azure AD Connect installer that you downloaded. Because our lab environment in a single forest with an internet routable domain name, we can use the express option. </p>
<p>When prompted, we’ll connect to Azure AD by providing our global admin <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">credentials</a>. And then, we can then connect to the on-prem AD by providing an enterprise admin credential. Clicking install begins the setup of Azure AD Connect. When the installation completes, click Exit. Because Azure AD Connect does not by default synchronize NTLM and Kerberos credential hashes to Azure AD, we must ensure that these hashes get synchronized if we want to use Azure AD Domain Services. To enable synchronization of the required credential hashes from your on-premises directory to the Azure AD tenant, run the script that you see on your screen:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$adConnector = &quot;&lt;CASE SENSITIVE AD DS CONNECTOR NAME&gt;&quot;</span><br><span class="line">$azureadConnector = &quot;&lt;CASE SENSITIVE AZURE AD CONNECTOR NAME&gt;&quot;</span><br><span class="line">Import-Module -Name &quot;C:\Program Files\Microsoft Azure AD Sync\Bin\ADSync&quot;</span><br><span class="line">$c = Get-ADSyncConnector -Name $adConnector</span><br><span class="line">$p = New-Object Microsoft.IdentityManagement.PowerShell.ObjectModel.ConfigurationParameter &quot;Microsoft.Synchronize.ForceFullPasswordSync&quot;, String, ConnectorGlobal, $null, $null, $null</span><br><span class="line">$p.Value = 1</span><br><span class="line">$c.GlobalParameters.Remove($p.Name)</span><br><span class="line">$c.GlobalParameters.Add($p)</span><br><span class="line">$c = Add-ADSyncConnector -Connector $c</span><br><span class="line">Set-ADSyncAADPasswordSyncConfiguration -SourceConnector $adConnector -TargetConnector $azureadConnector -Enable $false</span><br><span class="line">Set-ADSyncAADPasswordSyncConfiguration -SourceConnector $adConnector -TargetConnector $azureadConnector -Enable $true</span><br></pre></td></tr></table></figure>

<p>What this script will do is enable all on-premises users’ NTLM and Kerberos password hashes to be synchronized to the Azure AD tenant. This script will also initiate a full synchronization in Azure AD Connect. </p>
<p>The values for $adconnector and $azureadconnector variables can be found in the Azure AD Connect synchronization service manager. What I’ve done is create a PowerShell script called NTLMSync.ps1. This script includes all of these commands. I just need to open PowerShell on the Azure AD Connect server to run the script. The output tells me that the password hash sync configuration has been updated.</p>
<h1 id="Azure-Role-Based-Access-Control-1"><a href="#Azure-Role-Based-Access-Control-1" class="headerlink" title="Azure Role-Based Access Control"></a>Azure Role-Based Access Control</h1><p>Hello and welcome back. A tool that goes hand-in-hand with Azure active directory is Azure role-based access control, or RBAC. Azure RBAC is used to manage who has access to what resources and to manage what those users can do with those resources. It’s an authorization system that is built upon Azure resource manager, and it offers fine-grained access management to your Azure resources.</p>
<p>Azure RBAC relies on role assignments for access control. Each role assignment consists of three parts, a security principal, a role definition, and a scope.</p>
<p>The Security principal is essentially an object that represents either a user, a group, a service principal, or a managed identity that requires access to resources in Microsoft Azure. </p>
<p>The role definition is essentially a collection of permissions. Role definitions are usually referred to simply as roles. A specific role will list the operations that can be performed by someone with that role. These operations include things like read, write, and delete.</p>
<p>Although there are many built-in roles in Azure that you can use, there are four fundamental roles available. These fundamental roles include owner, contributor, reader, and user access administrator. A person assigned the owner role has full access to all resources, including the rights to delegate access to others. A person assigned the contributor role can create and manage all kinds of Azure resources. However, a contributor cannot grant access to those resources to other users. The reader role allows you to view existing Azure resources, while the user access administrator role allows you to manage user access to your Azure resources.</p>
<p>In addition to the built-in roles you can also create custom roles. This allows you to tailor access to your resources in a way that best suits your organization.</p>
<p>A scope is a set of resources that the access you are setting up applies to. For example, you may provide access to a scope that includes a subscription or maybe a resource group or even a specific resource. A scope in Microsoft Azure can be specified at the management group level, the subscription level, the resource group level, or to specific resources. Because scopes are structured in parent-child relationship, access that is granted at the parent scope level will be inherited by the child scopes.</p>
<p>The process that Azure RBAC uses to determine if a user has access to a specific resource is pretty straightforward. First, the user requesting the access acquires a token from Azure resource manager. This token includes any group memberships for the user. </p>
<p>Next, the user makes a rest API call to Azure resource manager with the attached token.</p>
<p>What Azure resource manager will do next is retrieve all the role assignments and deny assignments for the resource that the user is trying to access. Azure resource manager will then narrow those role assignments down to only those that apply to the user or to groups that the user is a member of. It will also determine which roles have been assigned to the user for the resource being accessed.</p>
<p>Next, Azure resource manager will determine whether or not the requested action in the API call is allowed by the role that the user has for the specific resource being accessed.</p>
<p>Assuming the user is assigned a role that allows the action being requested at the requested scope, access is granted. Otherwise, access is blocked.</p>
<p>Azure RBAC is free and is included with all Azure subscriptions.</p>
<p>To learn more about Azure RBAC, visit the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/azure/role-based-access-control/overview">URL</a> that you see on your screen.</p>
<h1 id="Single-Sign-On-Overview"><a href="#Single-Sign-On-Overview" class="headerlink" title="Single Sign-On Overview"></a>Single Sign-On Overview</h1><p>Unless an organization deploys a single sign-on solution, its users will be required to remember multiple usernames and passwords, one for each different application in use. Additionally, the IT department needs to maintain all of these different accounts and passwords manually. Single sign-on allows users to sign in once with one account in order to access domain-joined devices, corporate resources, SAS applications, and even web apps. After signing in, users can then launch apps right from the O365 portal or via the MyApps access panel. With single sign-on, IT administrators can centralize user account management, allowing them to automatically add or remove user access to applications based on group membership. In this lecture, we are going to discuss the various single sign-on options that are available when designing an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a> solution that incorporates single sign-on. </p>
<p>Choosing a single sign-on solution for an application will largely depend on how the application is configured for authentication. Of all the single sign-on methods we are about to discuss, disabled is the only one that does not automatically sign users into applications without requiring a second sign-on to occur. When deciding on a single sign-on solution, it’s important to know that cloud apps can use SAML, password-based, linked, and disabled methods for single sign-on. Of the bunch, SAML is the most secure method. On-prem apps, when configured for Application Proxy, can use password-based, Integrated Windows Authentication, or IAW, header-based, linked, or the disabled methods for single sign-on. The table that you see on your screen provides a summary of the single sign-on methods that are available. Use SAML for single sign-on whenever possible. </p>
<p>This method works when applications are configured to use a SAML protocol. Use password-based single sign-on when an application authenticates with a username and password. Using password-based single sign-on offers secure application password storage and replay via a web browser extension or via mobile application. Password-based single sign-on uses the existing sign-in process that’s provided by the application while allowing an administrator to manage the passwords for it. The linked single sign-on method is useful when an application is configured for SSO in another identity provider service. This SSO option doesn’t add single sign-on to the application. Use disabled single sign-on when an application isn’t ready for single sign-on. Users of the application will need to provide their username and password each time they launch the application.</p>
<p> Use IWA SSO for applications that use Integrated Windows Authentication or for claims-aware applications. When using this method for SSO, Application Proxy connectors use Kerberos Constrained Delegation to authenticate users to the application. Header-based single sign-on should be used when an application uses headers for authentication. It should be noted that header-based single sign-on requires PingAccess for Azure AD. When using header-based SSO, Application Proxy uses <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> to authenticate the user and then passes traffic through the connector service.</p>
<h1 id="Enable-Single-Sign-On-for-Dropbox"><a href="#Enable-Single-Sign-On-for-Dropbox" class="headerlink" title="Enable Single Sign-On for Dropbox"></a>Enable Single Sign-On for Dropbox</h1><p>In this demonstration, we’re going to walk through the process of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">enabling</a> single sign-on for an application. We’re going to enable single sign-on for Steven Davis so that he can access his Dropbox for Business account. To configure single sign-on for Dropbox, browse to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. From here, click on Enterprise applications, and then click New application. Find the Dropbox application in the gallery, and then select the application and click Add. After adding the application to Azure, click Single sign-on located under Manage. Select SAML to open the SAML configuration screen. Retrieve the sign on URL from the application vendor and provide that URL in the Sign on URL field for the application in Azure. Provide an identifier value. In this case, we’ll just use the word Dropbox. And then next, download the SAML signing certificate from Azure. This certificate needs to be provided to the application vendor. After downloading the certificate, switch over to the application vendor’s configuration dashboard and provide the certificate you downloaded. </p>
<p>The type of certificate you download will be largely dependent on the application itself so you’ll need to refer to the vendor’s documentation for setting up single sign-on. Retrieve the login URL for the application from Azure and provide it to the application. Save the application configuration, and then after the configuration is complete in both Azure and the app vendor’s portal, you can go ahead and test the login. To test single sign-on, assign a user to the application in Azure by clicking Users and groups within the application’s Azure dashboard. Find a user and then click Assign. Ensure that there is a user account for the assigned user also configured in the application itself. Next, open an incognito window and launch the application panel and login as the user to whom the application was assigned. Launch the application from the application panel and confirm that single sign-on works.</p>
<h1 id="MFA-Overview"><a href="#MFA-Overview" class="headerlink" title="MFA Overview"></a>MFA Overview</h1><p>Two-step verification provides a layered approach to security. Even the most enterprising attacker would have problems compromising multiple authentication factors, because, even if the attacker obtains a user’s password, the password would be useless without also being in possession of the additional authentication method, a mobile phone, for example. Multi-factor authentication works by requiring two or more authentication methods, which typically include something like a password that the user knows, something the user owns, typically a mobile phone, and something the user is, biometrics, for example. Azure MFA offers the ability to safeguard access to apps and data while maintaining a simple end-user experience. By providing additional security via a second form of authentication, MFA provides much sought after security for end-user authentication, and it does so via a range of easy to use authentication methods, including passwords, security questions, email address, application, OATH hardware token, SMS, voice call, and app passwords. Multi-Factor Authentication comes as part of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> Premium.</p>
<p> A subset of MFA capabilities is also available as part of an Office 365 subscription and as a means to protect Global Administrator accounts. As part of Azure AD Premium, Azure MFA is offered in two flavors, including the Azure Multi-Factor Authentication Service, which is cloud-based, and the Azure MFA Server option, which is a good option for organizations who have deployed ADFS and that want to or need to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">manage</a> MFA on-prem. Because most users are used to using only passwords to authenticate to applications and services, it’s critical that an organization communicate with the user base when rolling out an MFA solution. Doing so will invariably reduce the number of helpdesk calls that come in during any MFA rollout. Now, despite the best laid plans and deployments, there will be times when you may need to disable MFA in a one-off scenario. For example, if a user can’t sign in because he has lost access to his authentication methods, a lost phone, for example, in such a case, you could use a conditional access policy for Azure MFA. </p>
<p>With a conditional access policy in place, you can create a user group that is excluded from the policy that requires MFA. Placing the user in the excluded group would temporarily allow access until MFA functionality or access can be restored. A way to temporarily bypass MFA for Azure MFA Server users is to allow them to authenticate without two-step verification. Such a bypass can be configured but it expires after a specified number of seconds. Two-step verification prompts can be minimized for users that are on the local network. This can be accomplished with trusted IPs or named locations. By leveraging this features, an administrator for a managed or federated tenant can bypass two-step verification for users that are signing in from a trusted network location.</p>
<h1 id="Enable-MFA-for-O365-User"><a href="#Enable-MFA-for-O365-User" class="headerlink" title="Enable MFA for O365 User"></a>Enable MFA for O365 User</h1><p>In this demonstration, we’re going to enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">Multi-Factor Authentication</a> for an Office 365 user, so you can see how the process works and have a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">log in</a> process works once it’s been enabled. To enable Multi-Factor Authentication for an Office 365 user, open the Office 365 admin portal as a global administrator. Click on Users, and then Active Users. Find the user in the list for whom you wish to enable MFA and double click that entry. On the user’s property page, down at the bottom, click “manage multi-factor authentication”. Select the user in the multi-factor authentication screen and click Enable. Confirm that you want to enable multi-factor authentication by clicking the enable multi-factor auth button, and then close the box out. You’ll notice that the multi-factor auth status now shows enabled for this particular user. Open an incognito browser window and launch the Office 365 portal. Login as the user for whom you just enabled MFA. If you’ve configured MFA properly, the user, Steve in this case, will be prompted for more information before being allowed to login. Continue the login process by providing the information requested. Be sure to save the application password, so that it can be used for other applications if necessary, and then go ahead and click Done. After providing the MFA info, you’re prompted to log back in. Log back in, and be sure to supply the proper MFA info. As you can see on your screen, MFA is now working for Steve.</p>
<h1 id="Azure-AD-B2B"><a href="#Azure-AD-B2B" class="headerlink" title="Azure AD B2B"></a>Azure AD B2B</h1><p>Azure Active Directory Business-to-Business collaboration, also known as Azure AD B2B, allows an organization to securely share company applications and company services with guest users from other organizations while retaining control over company data. With Azure AD B2B, an organization can work with external partners, even if they don’t use Azure AD. The invitation and redemption process of Azure AD B2B allows users in a partner organization to use their own credentials to access a company’s resources. Because the partner organization uses its own <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a> solution, external administrative overhead for the sharing organization is essentially non-existent. There’s no requirement to manage external accounts or passwords, nor is there a need to synchronize accounts or manage account lifecycles. When guest users are invited to access resources in a partner organization, they sign into the shared applications and services with their own identities. Guest users without a Microsoft account or Azure AD account have one created for them when they redeem their invitations. Inviting a guest user to access an app or service, using AD B2B, is as simple as sending an invite to the guest user, using the guest user’s email address.</p>
<p>The guest user then follows a few easy redemption steps to sign in. Azure AD B2B offers the ability to use authorization policies to protect corporate content. Conditional access policies like <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">MFA</a> can be used to protect corporate applications and data. Such policies can be enforced at the tenant level, the application level, and even for specific guest users. With Azure AD B2B, administrators can add guest users to the organization right from the Azure portal. When the administrator creates the new guest user, which is done in a similar fashion to adding a new internal user, the guest user receives an invitation that allows him to sign into the Access Panel for that user. Guest users can be assigned to apps and even groups. By delegating guest user management to application owners, you can reduce the workload of the Azure administrators in your organization. Delegating user management allows application owners to add guest users to any application that they want. By delegating guest user management to application owners, you can reduce the workload of the Azure administrators in your organization. Delegating user management allows application owners to add guest users to any application that they want to share, even if it’s not a Microsoft application. To make this work, an administrator needs to set up self-service app and group management. Once this has been configured, non-admins can use their Access Panel to add guest users to applications or to groups.</p>
<h1 id="Add-Guest-Users-to-the-Directory"><a href="#Add-Guest-Users-to-the-Directory" class="headerlink" title="Add Guest Users to the Directory"></a>Add Guest Users to the Directory</h1><p>In this demonstration, we’re going to add a guest user to our Azure AD. To add a guest user, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">log in</a> to the Azure portal and browse to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. Click users and then click new guest user. Provide the new guest users email address and then click Invite. The user you’ve invited receives an invite email. Upon clicking the get started button in the invite email, the guest user is prompted to accept the invite. After accepting the invite, the guest user is taken to the applications pane, where he will be able to access applications that ultimately get assigned to him.</p>
<h1 id="Azure-AD-B2C"><a href="#Azure-AD-B2C" class="headerlink" title="Azure AD B2C"></a>Azure AD B2C</h1><p>Azure Active Directory Business-to-Consumer, also known as Azure AD B2C, is an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a> service that offers organizations the ability to customize and control how customers interact with corporate applications. It allows organizations to control how users sign up, sign in, and how they manage their profiles when using the applications. Azure AD Business-to-Consumer enables this functionality while also protecting customer identities. Applications registered with Azure AD B2C can be configured to handle many identity management tasks. </p>
<p>For example, you can allow users to sign up to use a registered application, you can enable a signed-up user to edit his profile, and you can even enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">MFA</a> in the application. Other identity management tasks that can be handled include allowing users to sign up and sign in with specific identity providers, such as Facebook, for example. You can even customize the look and feel of the signup experience for users, as well as the sign-in experience. Azure AD B2C completes identity tasks by interacting in sequence with identity providers, also known as IdPs. It also interacts with users, other systems, and with the local directory. The Identity Experience Framework establishes multi-party trust and completes these steps. Along with a Trust Framework policy, this framework defines the actors, actions, protocols, and sequence of steps that need to be completed in order to make things work. Azure AD B2C makes use of SYN cookies and rate and connection limits to protect against denial-of-service and password attacks against applications. It also includes mitigation for brute-force password attacks, as well as dictionary password attacks. </p>
<p>A service that authenticates customer identities and issues security tokens is called an identity provider. Azure AD B2C offers the ability to configure several different identity providers in the tenant. Common identity providers include Microsoft accounts, Facebook, and even Amazon. Before configuring an identity provider in an Azure AD B2C tenant, the application identifier, client identifier, password secret, and client secret, or a combination of each, depending on the identity provider itself, must be recorded from the identity provider application that is created. This identifier information is then used to configure the application that will be accessed via the identity provider being configured. Every Azure AD B2C tenant is distinct and separate from other Azure AD B2C tenants. To leverage the features of AD B2C, you must deploy a B2C tenant, and link it to your Azure subscription. If you wish to allow users to sign in to an application using Facebook, Amazon, or some other identity provider, you must first register the application in the Azure AD B2C tenant.</p>
<h1 id="Create-a-Link-and-Azure-AD-B2C-Tenant"><a href="#Create-a-Link-and-Azure-AD-B2C-Tenant" class="headerlink" title="Create a Link and Azure AD B2C Tenant"></a>Create a Link and Azure AD B2C Tenant</h1><p>In this demonstration, we are going to create a new <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/azure-ad-b2c/">Azure B2C</a> tenant and then, we’re going to link the new B2C tenant to our <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure subscription</a>. To get started, login to the Azure portal and make sure you’re in the directory that contains the Azure subscription. We only have one subscription here, so we’re good on that front. Click create a resource and then search for Azure Active Directory B2C. Click on Azure Active Directory B2C in the search results and then click create. Choose the option to create a new Azure AD B2C tenant. Provide an organization name and a domain name. Select a region and then click create. After creating the Azure AD B2C tenant, you now have to link it to your Azure subscription. While, again, ensuring you’re in the directory that contains your Azure subscription, create a new resource and search for Azure AD B2C, just as you did the first time. Click on Azure SD B2C in the results and click create. This time, however, choose the second option to link an existing Azure AD B2C tenant. In the Azure AD B2C tenant dropdown, choose the B2C tenant that you created earlier. Leave the subscription where it’s at and then select a resource group. Click create to complete the linking process. When the process completes, click Go to resource to manage the newly created B2C tenant.</p>
<h1 id="Privileged-Identity-Management"><a href="#Privileged-Identity-Management" class="headerlink" title="Privileged Identity Management"></a>Privileged Identity Management</h1><p>Azure Active Directory Privileged Identity Management, otherwise known as PIM, is an Azure offering that allows you to manage and control access to resources within <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a>, as well as within other services, such as Intune and Office 365. A valid Azure AD Premium P2 license is required for all users that will interact with or benefit from Privileged Identity Management before enabling the service on a tenant. Alternatively, you can assign an Enterprise Mobility + Security E5 license for each user that interacts with Privileged Identity Management. Generally speaking, licensing is required for users that are assigned to the Privileged Identity Role Administrator role or who are assigned as eligible to other directory roles that are manageable through Privileged Identity Management. If a user can approve or reject requests in Privileged Identity Management, that user also requires a license. Users assigned to a role with time-based assignments, such as Just in time or Direct, or those assigned to an access review role, also require licensing. With Azure AD Privileged Identity Management, an organization can see which users are assigned privileged roles that are used to manage Azure resources. Organizations can also see which users are assigned administrative roles within Azure Active Directory. </p>
<p>Privileged Identity Management also offers the ability to enable on-demand, or just in time, administrative access to services such as Office 365 and Intune, as well as to Azure subscriptions, resource groups, and even individual Azure resources, like virtual machines and such. Azure AD Privileged Identity Management offers the ability to view a history of administrator activation, along with a history of changes that administrators have made to Azure resources. Alerts can also be configured to notify you about changes in administrator assignments. Privileged Identity Management also allows you to require approval for activation of Azure AD privileged admin roles, to review membership of such administrative roles, and to force users to provide justification for ongoing membership in these roles. In Azure Active Directory, Privileged Identity Management can be used to manage users that are assigned to built-in Azure AD roles, such as Global Admin. In Azure itself, Privileged Identity Management can manage users and groups assigned via Azure RBAC roles, such as the Owner and Contributor roles.</p>
<h1 id="Enable-PIM-and-Manage-Subscriptions"><a href="#Enable-PIM-and-Manage-Subscriptions" class="headerlink" title="Enable PIM and Manage Subscriptions"></a>Enable PIM and Manage Subscriptions</h1><p>In this demonstration, we’re going to enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/privileged-identity-management/">Privileged Identity Management</a>, and we’re going to set up a subscription to be managed by Privileged Identity Management. To enable Privileged Identity Management or PIM for short, Login to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> portal, and then click on All services and search for privileged identity management. Click on the Azure AD privileged identity management in the search results. Next, click on “consent to PIM” and then verify your identity when prompted to do so. Provide the additional security verification info that is requested and then click Next. Click Verify to verify your information. At this point you’re taken back to the PIM consent screen. To complete the consent process, click the “consent” link and then click Yes to confirm. With PIM enabled, you can now sign up for PIM for Azure AD role management. To do so, click on Azure AD roles, under Manage. Click sign up for PIM in the left pane and then click the sign-up link at the top. When prompted to confirm, click Yes. After setting up PIM to manage AD roles, you need to discover resources in the subscription, so they, too, can be managed with PIM as well. To do this, go back to the quick start page and click Azure Resources. In this demo, here, we’re going to manage all resources in the subscription. Click Discover Resources and then select the subscription. Click Manage Resource to onboard the resource for management, and then click Yes to confirm. At this point, you’ve deployed PIM and configured Azure AD roles and Azure resources to be managed by it.</p>
<h1 id="Self-Service-Password-Reset"><a href="#Self-Service-Password-Reset" class="headerlink" title="Self-Service Password Reset"></a>Self-Service Password Reset</h1><p>Self-service password, or SSPR, is pretty self-explanatory. This feature allows end users to reset forgotten passwords without the need for a call to the help desk. It’s a feature that many organizations request, as it helps provide a more streamlined and pleasant end-user experience. Depending on the SSPR functionality that is required, license requirements may vary. For example, Self-Service Password Change functionality for cloud users is included in all editions of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a>. In these cases, we are talking about cloud-only users who wish to change their passwords to something new. Self-Service Password Reset functionality for cloud users is only included in Azure AD Basic and higher. It’s not offered in the free version of Azure AD. This functionality applies to cloud-only users who wish to reset their passwords to something they know. Self-Service Password Reset, Password Change, and Password Unlock, leveraging on-premises write-back, requires either Azure AD Premium P1 or Premium P2. This functionality applies to hybrid users that are synced to Azure AD from an on-prem AD. So, when considering Self-Service Password Reset, it’s important to understand the user base and how users are <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">managed</a> and provisioned.</p>
<h1 id="Configure-Self-Service-Password-Reset"><a href="#Configure-Self-Service-Password-Reset" class="headerlink" title="Configure Self-Service Password Reset"></a>Configure Self-Service Password Reset</h1><p>Enabling <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-password-reset/">self-service password</a> for end users take a huge burden off of the shoulders of the help desk. In this demonstration, we will enable self-service password reset, and test that it’s working with a test account. Before enabling self-service password reset, make sure that password writeback is turned on in Azure AD Connect. To do this, launch Azure AD Connect on the server running it. Click configure and then view the current configuration. If its disabled, relaunch Azure AD Connect, click configure, and then select customize synchronization options. Provide the global admin account to connect to Azure AD. Click next to leave the directories and domain and ou filtering options unchanged. Under optional features, check the password writeback box and click Next. Click Configure to update the configuration and then click Exit. After turning on password writeback, switch over to the Azure portal and then browse to Azure active directory. From here, click Password Reset. For this demonstration, I’m going to enable password reset for all of my users so I’m going to click All, and then save. After enabling password reset, click on Authentication methods and select the authentication methods you wish to make available, along with how many are required to set a password. </p>
<p>This is obviously going to be different for every environment. If you select the security questions option, you’ll be presented with more info to supply. We aren’t using security questions here, so I’ll turn this off. For this demonstration, I’m going to make mobile phone available as the only option. After clicking Save, I’m going to click on registration. I’m asked if I want to require users to register when <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">signing in</a>. I’m going to leave the default value set to yes. I’m also going to leave the window set to the default of 180 days. Clicking notifications allows me to set the notification options for when a user resets a password. I’m going to set both options here to yes. this ensures users receive a notification when they reset their passwords, but it also ensures that all administrators are notified when another administrator resets his password. In the customization pane, I can provide a customized helpdesk link for users to visit if they need assistance. I don’t have helpdesk here in the lab, so I’m going to leave this off for this demonstration. When I click on the on-premises integration link, Azure confirms that the on-prem writeback client is running and allows me to determine if I want passwords to writeback to on-prem AD. I need to leave this set to yes. The second option designates whether or not users should be given the option to unlock their accounts without resetting their passwords. </p>
<p>I’m going to leave this set to no for this demonstration. With password reset enabled, we can now test it. To test self-service password reset, open an incognito browser window and launch the single sign on setup process with a test account. In my case here, we previously enabled <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">MFA</a> so let me get through the authentication process here first. As you can see here, I’m prompted to to work through the process of setting up self service password reset for my account. Once I’ve completed the self service password reset setup, I’m presented with my application dashboard. To reset my password, I need to open the password reset URL in my browser. The password reset URL is <a target="_blank" rel="noopener" href="https://aka.ms/sspr">https://aka.ms/sspr</a>. On the next screen, I’m prompted to begin the reset process. I just have to provide my user ID and I need to complete the captcha. Clicking Next takes me to the verification screen, where I can request a code via mobile phone. After I click the Text button, I receive a code on my phone that I need to enter. After providing my verification code and clicking Next, I’m then prompted to create a new password. Clicking Finish completes the process.</p>
<h1 id="Self-Service-Group-Management"><a href="#Self-Service-Group-Management" class="headerlink" title="Self-Service Group Management"></a>Self-Service Group Management</h1><p>To further improve the end user experience, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> offers the ability for users to create and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">manage</a> their own security groups and Office 365 groups. In addition, users can also request security group memberships as well as Office 365 group memberships. In such cases, the owner of these groups can approve or deny their membership requests. By delegating group membership control, organizations can ensure that the people who best understand the business context for such memberships are the ones controlling group membership. It’s important to note, however, that this feature applies only to security groups and Office 365 groups. It does not apply to mail-enabled security groups nor does it apply to distribution lists. There are essentially two flavors of self-service group management currently available. These include delegated group management and self-service group management. An example of delegated group management would be a scenario where an organization uses a SaaS application, whose access is managed by an administrator. As the company grows, access management becomes a bit cumbersome for the administrator to handle. To ease the burden of granting access and revoking access to the application, the administrator requests that the application owner create a new group. </p>
<p>After the group has been created, the administrator assigns access to the application for the new group. He also adds all users who need access to the application to this group. Because the application owner created the group, he has he ability to add and remove users from it. Users added to the group are automatically granted access to the application, while users that are removed from the group have their access to the application revoked when the leave the group. By delegating group membership management to the application owner, the application owner no longer needs to wait on the administrator to provide and revoke access to the application. Of course, however, the administrator would still be able to see who has access to the application, and he could block access as necessary. A self-service group management example would be a scenario where an app owner manages an application. In order to grant a group of business users access to the application, the app owner creates a group in Azure AD, grants the group access to the application, and then enables self-service group management on the group. When a user in the organization needs access to the application, the user simply requests access to it from the Access Panel. When the request is approved, the user receives access to the application.</p>
<h1 id="Demo-Self-Service-Group-Management"><a href="#Demo-Self-Service-Group-Management" class="headerlink" title="Demo: Self-Service Group Management"></a>Demo: Self-Service Group Management</h1><p>In this demonstration we are going to enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-group-management/">Self Service group management</a>, by allowing users to create their own security groups and to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">manage</a> them. To enable Self Service group management, sign into the Azure portal and browse to Azure Active Directory. You’ll need to do this with a Global Admin account for the directory. From here select groups, and then go into the general settings for groups. Set the option for owners can manage group membership requests to yes. And then set the option for users can create security groups to yes as well. With these settings enabled users in the directory are allowed to create new security groups and to add members to those groups. These new groups will also show up in the access panel for all other users. In addition, if the policy settings on the group allow it, other users can create requests to join these groups as well.</p>
<h1 id="Overview-of-Managed-Identities-for-Azure-Resources"><a href="#Overview-of-Managed-Identities-for-Azure-Resources" class="headerlink" title="Overview of Managed Identities for Azure Resources"></a>Overview of Managed Identities for Azure Resources</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Managed Identities</a> for Azure Resources is a feature of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. There are several Azure services that support Managed Identities for Azure Resources. For those who build cloud applications, management of credentials within a code for authenticating to cloud services is often a common challenge. It’s critical to ensure credentials are kept secure. As a matter of fact, preferably, credentials should never appear on a developer’s workstation, nor should credentials ever be checked into source control. With Azure Key Vault, administrators have a way to securely store credentials. However, to be effective, the application code needs to authenticate to Key Vault to retrieve those credentials that are stored. Enter Managed Identities for Azure Resources. Using the Managed Identities for Azure Resources feature in Azure AD solves this problem. This solution provides supported Azure services with an automatically managed identity in Azure AD that can be used to authenticate to any service that supports Azure AD authentication without the need to store any credentials in code. Key Vault is one of the Azure services that is supported. Managed Identities for Azure Resources is a free feature that comes with all Azure AD editions. There are two types of managed identities to choose from. </p>
<p>They include a system-assigned managed identity and a user-assigned managed identity. A system-assigned managed identity is enabled directly on an Azure service instance. Once the identity has been enabled, Azure will create an identity for the instance in the Azure AD tenant that’s trusted by the subscription of the instance. The credentials for the identity are provisioned onto the instance after the identity had been created. System-assigned identities are tied to the Azure service instances that they are enabled on. Deleting an instance with a system-assigned managed identity attached to it will cause Azure to automatically clean up the credentials, along with the identity in Azure AD. A user-assigned managed identity is essentially a standalone Azure resource. Via a creation process, Azure creates the identity in the Azure AD tenant. The subscription in use, in turn, trusts the identity. An identity, once created, can be assigned to one or more Azure service instances. Unlike a system-assigned managed identity, the lifecycle of a user-assigned identity is managed separately from that of the Azure service instance, or instances, to which it’s been assigned. Application code can use managed identities to request access tokens for services that support Azure AD authentication. Azure will handle the rolling of the credentials that are used by the service instance.</p>
<h1 id="Enable-a-Systems-Designed-Management-Identity-on-a-VM"><a href="#Enable-a-Systems-Designed-Management-Identity-on-a-VM" class="headerlink" title="Enable a Systems Designed Management Identity on a VM"></a>Enable a Systems Designed Management Identity on a VM</h1><p>To enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/overview-of-managed-identities-for-azure-resources/">System Assigned Managed Identity</a> on a VM that was originally provisioned without it your account needs at least the Virtual Machine Contributor Role assignment. In the case of our demo here I’m using a global admin so that’s a non-issue. To complete this task sign into the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> portal, navigate to the Resource Group that contains the VM that you wish to configure. Clock on the desired Virtual Machine and then select Identity. Under System Assigned Status select On and then click Save. Once the System Assigned Managed Identity is enabled the VM will be registered with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. After being registered you can then control its access to other services like Storage Accounts and the like.</p>
<h1 id="DEMO-Azure-AD-Reporting-and-Monitoring"><a href="#DEMO-Azure-AD-Reporting-and-Monitoring" class="headerlink" title="DEMO: Azure AD Reporting and Monitoring"></a>DEMO: Azure AD Reporting and Monitoring</h1><p>Hello and welcome back. In this brief demonstration here, what I wanna do is give you a tour, so to speak, of some of the Azure Active Directory Reporting and Monitoring options that are available.</p>
<p>Now, on the screen here, you can see I’m logged in to my Azure Portal, and I’m at the Overview page for my Azure Active Directory. We are working in the test9878.org directory. Now, the Azure Active Directory Reports that are available provide you with a view of the different activities that are going on in your environment.</p>
<p>You can use reports to determine how applications and services are utilized by your users, and you can detect potential risks that affect the health of your environments. You can use reports to also troubleshoot issues.</p>
<p>With Azure Active Directory Monitoring, you can route your Azure AD activity logs to different endpoints. You can then view this data to see what’s going on within your Active Directory.</p>
<p>Let’s take a look at some audit logs and some sign-in activities. Now, to take a look at the audit log for Azure Active Directory, what you do here is scroll down in the left pane from the Overview page of your directory and you select Audit logs under Monitoring. Now, what this Audit Log Report does is provide you with a record of the different system activities that have occurred.</p>
<p>For example, we can take a look and see who had access to an admin group and who gave them that access. We can also see information regarding password resets and the like. Now, in this dashboard here for our audit logs, we can see a few different activities that have occurred. We’ve seen some Add user activities. We’ve seen some Add member activities. We’ve also seen some activities revolving around roles.</p>
<p>If we select an activity here, so for example, we’ll choose this Add owner to group, what this tells us is what happened, when it happened, and what the status was. It also tells us who performed this action. Selecting the target gives us more information about the activity that occurred. And if we select Modified Properties, we can see what properties were actually modified.</p>
<p>So when you need to look at information for compliance, for example, the Audit logs report would be the report to go to. Now, if we click over to Sign-ins, we can see what was going on regarding sign-ins to our Azure Active Directory. Typically, you’d use the Sign-ins Report to find the sign-in pattern of specific users, or to see how many users have logged in in the last week, or what the sign-in status is.</p>
<p>On the screen here, we can actually see two different sign-ins that occurred. One was interrupted and one was successful. If we select the one here that was interrupted, we can see information about that specific sign-in. We can see when it happened, what happened, what the error code was, and what the failure reason was for the interrupted sign-in. We can see which user generated the alert and even the application where the sign-in occurred.</p>
<p>Along this top tab, we have lots of other different information we can look at. We can look at the location where this occurred. The Device Info. We can see that this failed login occurred on a Windows 10 machine from the Chrome browser. If we look at the Authentication Details, we can see that was a CloudOnlyPassword and that it was false. We can see any Conditional Access information that applied here.</p>
<p>In this case, there were no policies applied. And any Additional Details. Now, to configure monitoring for Azure Active Directory, what you can do is go into Diagnostic settings here below Monitoring, and we can see we have no diagnostic settings configured yet. So what we’ll do is add a diagnostic setting.</p>
<p>So we’ll go ahead and call this MyDiags. Now, what we can do here is we can collect audit logs or sign-in logs. And then when we do that, we can send them to either Log Analytics or to a storage account, or we can stream them to an event hub. For this demonstration here, what we’ll do is we’ll gather our audit logs and send them to a storage account.</p>
<p>Now, if we leave Retention here set to zero, if you look down here, you can see that setting it to zero does not apply a retention policy. This means the data that you collect is retained forever. I’ll just retain this for one day for this demonstration.</p>
<p>Now, when we select our storage account, we need to choose what storage account we want to archive to. So I already have a test9878 storage account here, so that’s what’s selected here. But I could change this to a different storage account if I wanted to. So what we’re doing here is collecting our audit logs with a retention of one day and sending them to our storage account, and then we’ll go ahead and save this.</p>
<p>Now, what we could also do here is instead of sending to a storage account, we can send to Log Analytics. Now, to send to Log Analytics, you’ll need to have a Log Analytics workspace already created. We have a default workspace here. We actually have a couple. So what we’ll do here is we’ll send to Log Analytics, and we’ll save it, and we can see we get the success here.</p>
<p>Now, to take a look at our logs, what we can do is go back out to our directory and then go into Logs here under Monitoring. Now, from the Log Analytics page here, what I can do is run different queries to track down the information I’m looking for as it relates to my Azure Active Directory. So that will call it a wrap.</p>
<p>Just keep in mind that you can run reports to track down specific information that’s reported in the Sign-ins Report and in the Audit logs report. And you can use Monitoring to send your information through logs into the Azure Monitor and&#x2F;or Log Analytics workspace.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We’ve covered quite a bit of ground in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">this course</a>. With so many terms and features to keep track of, it’s critical to be able to distinguish them from one another and understand what each does. By understanding what each identity management piece does, it becomes far easier to design an identity management solution. With that said, let’s walk through a high-level recap of all of the key players in the identity management space and what each offers. Microsoft’s <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a> is a cloud-based identity and access management service. With it, users can sign in and access external resources, such as Office 365, the Azure portal, and other SaaS applications. Azure AD is used to control access to applications and resources according to business requirements. A hybrid identity is an identity that spans on-prem and cloud-based capabilities. Leveraging hybrid identities allows an organization to create a common user identity for authentication and authorization to all resources, regardless of whether they are on-prem or in the cloud. Azure AD Domain Services is a Microsoft cloud-based offering that provides managed domain services, such as domain join, group policy, LDAP, and Kerberos and NTLM authentication. These services are fully compatible with traditional on-prem Active Directory and they can be deployed without any need for deployment or management of domain controllers in the cloud. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/single-sign-on-overview/">Single sign-on</a>, also referred to as SSO, allows users to sign in once with one account in order to access domain-joined devices, corporate resources, software as a service apps, and even web applications. </p>
<p>After signing in, users can then launch apps right from the O365 portal or via the MyApps access panel. With single sign-on, IT administrators can centralize user account management, allowing them to automatically add or remove user access to applications, based on group membership. Also known as MFA, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">multi-factor authentication</a> works by requiring two or more authentication methods, which typically include something like a password that the user knows, something the user owns, which is typically a mobile phone, and&#x2F;or something the user is, biometrics would be a good example. Azure MFA offers the ability to safeguard access to applications and data while maintaining a simple end-user experience. Azure Active Directory Business-to-Business collaboration, also known as AD B2B, allows an organization to securely share company applications and services with guest users from other organizations, while retaining control over company data. Azure Active Directory Business-to-Consumer, also known as Azure AD B2C, is an identity management service that offers organizations the ability to customize and control how customers interact with corporate applications. It allows organizations to control how users sign up, sign in, and how they manage their profiles when using the applications. Azure AD B2C enables this functionality while also protecting customer identities. Azure Active Directory Privileged Identity Management, also known as PIM, is an Azure offering that allows you to manage and control access to resources within Azure and Azure AD, as well as within other services such as Intune and Office 365. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-password-reset/">Self-Service Password Reset</a>, also known an SSPR, allows end users to reset forgotten passwords without the need for a call to the helpdesk. It’s a feature that many organizations request, as it helps provide a more streamlined and pleasant end-user experience.</p>
<p>Depending on the SSPR functionality that is required, license requirements may vary. Through self-service group membership, Azure AD offers the ability for users to create and manage their own security groups and Office 365 groups. In addition, users can also request security group memberships as well as Office 365 group memberships. In such cases, the owner of such groups can approve or deny their membership. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/overview-of-managed-identities-for-azure-resources/">Managed Identities for Azure Resources</a> provides supported Azure services with an automatically managed identity in Azure AD that can be used to authenticate to any service that supports Azure AD authentication without the need to store any credentials in code. Key Vault is one of the Azure services that is supported. Managed Identities for Azure Resources is a free feature that comes with all Azure AD editions. So, like I said, lots of terms. To learn more about each feature, you can, and should, read Microsoft’s published documentation on each. Be sure to also watch for new Microsoft Azure courses on Cloud Academy, because we’re always publishing new ones. Please give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching and happy learning!</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-14/" class="post-title-link" itemprop="url">CCIE路由和交换认证考试指南第5版卷1-14</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 22:11:26" itemprop="dateCreated datePublished" datetime="2022-11-14T22:11:26-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 21:30:42" itemprop="dateModified" datetime="2022-11-27T21:30:42-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CCIE/" itemprop="url" rel="index"><span itemprop="name">CCIE</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-14/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-14/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="14.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-13/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-13/" class="post-title-link" itemprop="url">CCIE路由和交换认证考试指南第5版卷1-13</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 22:11:24" itemprop="dateCreated datePublished" datetime="2022-11-14T22:11:24-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 21:30:48" itemprop="dateModified" datetime="2022-11-27T21:30:48-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CCIE/" itemprop="url" rel="index"><span itemprop="name">CCIE</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-13/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-13/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="13.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-12/" class="post-title-link" itemprop="url">CCIE路由和交换认证考试指南第5版卷1-12</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 22:11:22" itemprop="dateCreated datePublished" datetime="2022-11-14T22:11:22-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 21:30:56" itemprop="dateModified" datetime="2022-11-27T21:30:56-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CCIE/" itemprop="url" rel="index"><span itemprop="name">CCIE</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-12/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-12/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="12.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-11/" class="post-title-link" itemprop="url">CCIE路由和交换认证考试指南第5版卷1-11</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 22:11:21" itemprop="dateCreated datePublished" datetime="2022-11-14T22:11:21-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 21:31:06" itemprop="dateModified" datetime="2022-11-27T21:31:06-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CCIE/" itemprop="url" rel="index"><span itemprop="name">CCIE</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-11/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/CCIE%E8%B7%AF%E7%94%B1%E5%92%8C%E4%BA%A4%E6%8D%A2%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%8C%87%E5%8D%97%E7%AC%AC5%E7%89%88%E5%8D%B71-11/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="11.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/92/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/92/">92</a><span class="page-number current">93</span><a class="page-number" href="/page/94/">94</a><span class="space">&hellip;</span><a class="page-number" href="/page/274/">274</a><a class="extend next" rel="next" href="/page/94/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
