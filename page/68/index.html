<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hang&#39;s Blog">
<meta property="og:url" content="https://example.com/page/68/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/page/68/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/AZ-204-Knowledge-Check-Overview-of-Azure-Services-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/14/AZ-204-Knowledge-Check-Overview-of-Azure-Services-3/" class="post-title-link" itemprop="url">AZ-204-Knowledge-Check-Overview-of-Azure-Services-3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-14 06:37:13 / Modified: 19:32:46" itemprop="dateCreated datePublished" datetime="2022-11-14T06:37:13-04:00">2022-11-14</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/AZ-204-Knowledge-Check-Overview-of-Azure-Services-3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/AZ-204-Knowledge-Check-Overview-of-Azure-Services-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="1.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/AZ-204-Overview-of-Azure-Services-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/14/AZ-204-Overview-of-Azure-Services-2/" class="post-title-link" itemprop="url">AZ-204-Overview-of-Azure-Services-2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-14 06:36:42 / Modified: 23:21:18" itemprop="dateCreated datePublished" datetime="2022-11-14T06:36:42-04:00">2022-11-14</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/AZ-204-Overview-of-Azure-Services-2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/AZ-204-Overview-of-Azure-Services-2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Course-Introduction"><a href="#Course-Introduction" class="headerlink" title="Course Introduction"></a>Course Introduction</h1><p>Welcome to Overview of Azure Services. My name’s Guy Hummel and I’m a Microsoft-certified Azure Expert. If you have any questions, feel free to connect with me on LinkedIn and send me a message, or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course is an introduction to Microsoft Azure. It’ll give you a broad overview of the types of services available in Azure without going too deeply into any of them.</p>
<p>This course is intended for anyone who’d like to learn more about Azure, so you don’t need to have any experience with it before taking this course. It would be helpful to have some general technical knowledge though because I don’t explain basic terms like <em>file server</em> or <em>operating system</em>.</p>
<p>The best way to learn is by doing, so I recommend that you try performing these tasks yourself on your own Azure account. If you don’t already have one, then you can create a free trial account.</p>
<p>To save you the trouble of typing in the URLs and commands shown in this course, I’ve put them in a readme file in a GitHub repository. You can find a link to the repository at the bottom of the Overview tab below this video.</p>
<p>By the end of this course, you should be able to describe some of the Azure services available in various categories, use the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-portal/">Azure Portal</a>, and use the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-cli/">Azure command line</a>. We’d love to get your feedback on this course, so please give it a rating when you’re finished.</p>
<p>Now, if you’re ready to learn about what you can do with Microsoft Azure, then let’s get started.</p>
<h1 id="Azure-Overview"><a href="#Azure-Overview" class="headerlink" title="Azure Overview"></a>Azure Overview</h1><p>So what is <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">Microsoft Azure</a>? To put it simply, it’s a collection of online services that organizations can use to build, host, and deliver applications. The best part is that you don’t need to have your own data center or even any servers because Azure runs in Microsoft’s data centers around the world, which your users can access over the internet.</p>
<p>Not only does this approach save you the trouble of having to build and maintain your own on-premises IT infrastructure, but it can also save you money because you only have to pay for what you use, and you can scale your Azure resources up and down as needed.</p>
<p>For most applications, you need three core elements: compute, storage, and networking. Let’s start with compute. In Azure’s early days, Microsoft offered only one type of compute service: virtual machines, or VMs for short. These are machines that run either Windows or Linux. If you currently have an application running on a Windows or Linux server, then the most straightforward way to migrate it to Azure is to do what’s called a “lift and shift” migration. That is, you simply lift the application from your on-premises server and shift it to a virtual server in the cloud. Azure VMs are known as Infrastructure-as-a-Service because they’re traditional IT infrastructure components that are offered as a service.</p>
<p>Later, Microsoft came out with what’s known as a Platform-as-a-Service offering called Azure App Service. This platform lets you host web and mobile applications without having to worry about the underlying infrastructure. After doing a minor amount of configuration, you can just upload your code to an App Service instance and let Azure take care of the details. In most cases, this is a better solution than using virtual machines, but there are times when it makes more sense to use VMs. For example, if you have an application that’s not a web or mobile app, then you can’t use App Service, so you’ll have to use a VM.</p>
<p>These days, the hottest compute technology is containers. These are self-contained software environments. For example, a container might include a complete application plus all of the third-party packages it needs. Containers are somewhat like virtual machines except they don’t include the operating system. This makes it easy to deploy them because they’re very lightweight compared to virtual machines. In fact, containers run on virtual machines.</p>
<p>Microsoft provides a variety of ways to run containers. The simplest way is to use Azure Container Instances. This service lets you run a container using a single command. If you have a more complex application that involves multiple containers, then you’ll probably want to use Azure Kubernetes Service, which is what’s known as a container orchestrator. It makes it easy to deploy and manage multi-container applications.</p>
<p>Before we move on, I should mention one more compute service. It’s called Azure Functions, and it’s Microsoft’s main “serverless” offering. Azure Functions is kind of like Azure App Service except that it executes individual functions rather than entire applications, and you only pay for it when it gets used. When you provision an App Service instance, it runs until you shut it down, and you pay for it the whole time it’s running. Although it’s possible to configure Azure Functions in the same way, it’s usually better to use the Consumption plan, which means that it only uses resources when a function is running, so you only pay when a function is running.</p>
<p>Okay, that was a lot of compute options. Now let’s move on to storage. Believe it or not, there are even more options for storage than for compute. That’s because I’m also including databases and other data stores in the storage category.</p>
<p>The simplest form of storage is called Blob storage. It’s referred to as object storage, but really it’s just a collection of files. It’s not like a normal file system, though, because it doesn’t have a hierarchical folder structure. It has a flat structure. It’s typically used for unstructured data, such as images, videos, and log files.</p>
<p>One of the great things about it is that it has multiple access tiers: hot, cool, and archive. The hot tier is for frequently accessed files. The cool tier is for files you expect to access only about once a month or less. The advantage is that it costs less than the hot tier as long as you don’t access it frequently. The archive tier is for files that are rarely accessed, such as backup files. It has the lowest storage costs but the highest retrieval costs. It also takes several hours to retrieve files from the archive tier.</p>
<p>If you need hierarchical file storage, there are a couple of options. The one that will probably seem more familiar is Azure File Storage, which is like a typical SMB file server. It serves up file shares that you can mount on Windows servers. The less familiar option is Azure Data Lake Storage Gen2. This is Hadoop-compatible storage for use with data analytics applications. </p>
<p>Okay, now how about relational databases? In an on-premises Microsoft environment, SQL Server is the most commonly used database. The cloud equivalent is Azure SQL Database. It’s very similar to SQL Server, although it’s not 100% compatible. If you need to run an open source database, then Microsoft still has you covered. It offers Azure Database for MySQL, MariaDB, and PostgreSQL.</p>
<p>All of these databases, including both SQL Database and the open source options, are suitable for online transaction processing. On the other hand, if you need to build a data warehouse, then Azure Synapse Analytics is the best choice.</p>
<p>If you release an application that attracts a very large number of users, you may find that a traditional relational database can’t scale to meet the demand. One common solution is to use a so-called NoSQL database. These databases are designed to handle far more data than relational databases. However, in order to achieve that massive scalability, they have to sacrifice something, so they don’t support all of the features of relational databases. Nonetheless, they have become a cornerstone of many cloud-based applications.</p>
<p>Microsoft’s main NoSQL offering is called Cosmos DB. It’s an amazing database service that can scale globally. Another NoSQL service is Azure Cache for Redis, which is typically used to speed up applications by caching frequently requested data.</p>
<p>That’s a lot of storage options, and I still didn’t cover them all, but you don’t need to know every single option at this point, so let’s move on to network services.</p>
<p>When you create a virtual machine on Azure, you have to put it in a virtual network, or VNet. A virtual network is very similar to an on-premises network. Each virtual machine in a VNet gets an IP address, and it can communicate with other VMs in the same VNet. You can also divide a VNet into subnets and define routes to specify how traffic should flow between them. </p>
<p>By default, all outbound traffic from a VM to the internet is allowed. If you also want to allow inbound traffic, then you need to assign a public IP address to the VM.</p>
<p>If you want VMs in one VNet to be able to communicate with VMs in another VNet, then you can connect the VNets together using VNet peering. By the way, so far, I’ve only been talking about virtual machines, but other resources, such as Kubernetes clusters, can be in VNets, too.</p>
<p>If you want to create a secure connection between a VNet and an on-premises network, then you can use either a VPN, which stands for Virtual Private Network, or Azure ExpressRoute. A VPN sends encrypted traffic over the public internet, whereas ExpressRoute communicates over a private, dedicated connection between your site and Microsoft’s Azure network. ExpressRoute is much more expensive than a VPN, but it provides higher speed and reliability since it’s a dedicated connection.</p>
<p>There are plenty of other network services available as well, but the ones I’ve covered are enough to give you a good high-level understanding of Azure networking.</p>
<p>Azure also provides a wide variety of other services outside of the core compute, storage, and networking categories, such as in hot areas like artificial intelligence and DevOps. I’ll go over some of those later.</p>
<p>The easiest way to understand how Azure works is to actually use it, so in the next lesson, we’ll create a virtual machine. If you’re ready, then go to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-portal/">next video</a>.</p>
<h1 id="Using-the-Azure-Portal"><a href="#Using-the-Azure-Portal" class="headerlink" title="Using the Azure Portal"></a>Using the Azure Portal</h1><p>Now we’re going to dive into using <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">Azure</a>. Suppose you have a server application that you want to migrate to the cloud. As I mentioned earlier, the most straightforward way to do this is to move the application to a virtual machine on Azure.</p>
<p>There are many ways to interact with Azure, the Azure portal runs in a browser, so you don’t need to install anything to use it. Alternatively, you can install the CLI, which stands for command-line interface, or Azure PowerShell or the SDK, which stands for Software Development Kit.</p>
<p>If you want to use a command-based interface, and you have a lot of experience with PowerShell, then that’s probably your best bet. Otherwise, use the CLI, which is easier to learn than PowerShell. It’s actually possible to use the CLI and PowerShell from inside the browser too without having to install anything on your desktop. I’ll show you how to do that in the next lesson.</p>
<p>The SDK is what you need to use if you’re going to add code in your applications to interact with Azure.</p>
<p>It’s even possible to interact with Azure from a mobile device by using the Azure mobile app. You can even use the CLI and PowerShell from the mobile app.</p>
<p>The easiest way to get started, though, is to use the Azure portal. So if you’re following along on your own account, go to portal.azure.com. There are a few different ways to get to the place where you can create a VM. In this search box, you can start typing virtual machine and you’ll see it come up at the top of the search results.</p>
<p>Another way is to go into the menu on the left and select virtual machines. It takes you to the same place. Once you’re here, you can click Add.</p>
<p>The first thing it wants to know is what subscription to put this VM in. It always sets this to your default subscription, so you can usually just leave it that way. But I should explain what a subscription is.</p>
<p>When you sign up for an Azure account, Microsoft creates both a billing account and a subscription. It’s easy to get the two mixed up because they’re both involved in billing. A <em>billing account</em> is an agreement you or your organization sign to use Microsoft services. A <em>subscription</em> is actually just a collection of Azure resources. But all of the resources in a subscription are on the same monthly bill, so it’s also a unit of billing.</p>
<p>So why do you need to have both a billing account and a subscription? Well, you might want to have multiple subscriptions in your billing account. Since each subscription generates a separate invoice, it can be useful to have a separate subscription for each department in your organization. Also, since the resources in different subscriptions are isolated from each other, you might want to have multiple subscriptions for security or compliance reasons.</p>
<p>Okay, so we’ll leave the subscription with the default. Next, it’s asking for the resource group. Like a subscription, a resource group is a collection of resources, but a subscription can have multiple resource groups so it’s a way of further grouping the resources within a subscription.</p>
<p>There are a variety of ways to divide resources into resource groups. But the best practice is to group related resources together, such as a VM and its associated storage account. Generally speaking, the resources in a group should be created and deleted at the same time, which makes sense if they’re components that work together to provide a solution.</p>
<p>All right, so let’s create a new resource group to hold this VM. I’ll call it example-RG. Now we need to give the VM a name. I’ll call it example-VM. Next we need to decide which region the VM should run in.</p>
<p>Microsoft has data centers on every continent except Antarctica. Each of these dots is a region, and each region contains multiple Azure data centers. You usually want to choose a region that’s closest to where your users are located. I’ll choose West US 2. Notice that it has a diamond in it. That’s because it has availability zones. I’ll explain what those are in a minute.</p>
<p>You need to set an availability option if you want to make sure your application will still be available, even if Azure experiences an outage that affects this VM. The first option is “Availability zone”, which is what I just showed you on the map. A region that supports availability zones has at least three data centers, each of which is called a zone. If you put VMs in multiple zones, then a data center outage won’t take down your application, because your VMs and other zones will still be running.</p>
<p>It added another field called “Availability zone”. We can choose 1, 2, or 3. It doesn’t really matter which one we choose for this VM, but if we were to create a second VM, we’d need to put it in a different availability zone. I’ll choose “1”. </p>
<p>Next, we need to choose a VM image. This is a copy of the disk that will be used for the VM. The choices are different versions of Linux and Windows, such as Ubuntu, Red Hat, and Windows Server. This is only a small subset of the images that are available. You can click on this link to see more. For example, suppose you want an image that includes not only Windows Server but also SQL Server, click on Databases and then type “sql server”. Surprisingly, there are images of SQL Server on Linux first. I’ll add windows to the search to narrow it down. There we go. There are lots of SQL Server image options. For this example, we’ll just go back and pick one of the basic options though. I’ll pick the Ubuntu server option.</p>
<p>If you use an Azure spot instance for this VM, then the cost will be dramatically lower, but the VM might be shut down with only 30 seconds’ notice. So you should only use this option for non-critical workloads.</p>
<p>There are lots of options for the size of the VM. At the top of the list, there’s a size with only one virtual CPU, half a gig of memory, and four gigs of temporary storage. You can see that the cost per month is very low. Some of these other options are much bigger, but so is the cost. Since we’re not actually going to use this VM, I’ll choose the cheapest option.</p>
<p>Here, we need to create the administrator account. In most cases, you should use an SSH public key for authenticating to the VM. But to keep it simple for this demo, I’ll use a password. You can name your administrator account almost anything.</p>
<p>The inbound port rules let you open up the VM to access from the internet. If this VM will be acting as a web server, then you’ll want to open up ports 80 and 443. There’s also an option to open up the SSH port so you can log into the VM remotely. The problem with opening up the SSH port here is that it will allow access from all internet addresses, which is dangerous. There are other more secure ways to give yourself access to the VM. So you shouldn’t select this unless you’re just doing some testing. I’m going to set this to “None”.</p>
<p>That’s it for the basic settings, but there are a few more settings we should have a look at. We’ll click this button to go to the disks tab. The operating system disk is set to premium SSD by default. That option has the highest performance, but it’s much more expensive than the other two. I’ll set it to Standard SSD. You can also add data disks if you want.</p>
<p>And now let’s have a look at the networking options. By default, it creates a virtual network, a subnet inside that virtual network, and a public IP address. If we already had another virtual network, we could put it in there instead if we wanted to.</p>
<p>Okay, that takes care of the compute, storage, and networking options for this VM. So let’s create it. First, click “Review + Create”. It says that our settings have passed validation testing. Then it summarizes all of our settings. Now click the Create button.</p>
<p>It’ll take a little while to create, so I’ll fast forward. All right, it’s done. We can click on “Go to resource” to have a look at the VM. </p>
<p>Here it shows the details of this VM, such as its status, and its public IP address. Up here it has some controls that let you stop and restart the VM or even delete it. If we had set up SSH authentication, then we could connect to it from here too. In the menu on the left, there are all kinds of options for things like activity logs, security, backups, and monitoring.</p>
<p>That’s it for this demo, you should have a pretty good idea of how to create resources in the portal now, because the process is fairly similar, regardless of what kind of Azure resources you’re creating. If you’re following along on your own Azure account, you might want to look around and see what you can do with your new VM.</p>
<p>When you’re done, make sure you delete the VM so you don’t incur any ongoing charges. The best way to delete everything associated with the VM, including the public IP address, etc., is to delete its resource group. Select Resource groups in this menu, and then click on “example-rg”. Here’s a list of all the resources associated with the VM. Now click “Delete resource group”. Then type the name of the resource group. Then click the Delete button.</p>
<p>Now if you’re ready to see how to work with Azure using the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-cli/"><em>command-line interface</em></a>, then please go to the next video.</p>
<h1 id="Using-the-Azure-CLI"><a href="#Using-the-Azure-CLI" class="headerlink" title="Using the Azure CLI"></a>Using the Azure CLI</h1><p>As you saw in the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-portal/">last demo</a>, it’s pretty easy to use the portal to create Azure resources but it’s definitely not the most efficient way to do it because it requires a lot of pointing and clicking. An alternative is to use the command line. Although it can be more difficult since you have to know the exact names of all the command line options. Once you’ve mastered it, you can often create and manage resources much more quickly.</p>
<p>In this demo, I’m going to show you how to create a website using Azure App Service. Do you remember when I said that it’s possible to use the command line without having to install anything on your desktop? Well, now that you’re familiar with the portal, I’ll show you how.</p>
<p>You see this icon to the right of the search bar? That’s how you start something called the Cloud Shell. It’s a very small virtual machine that you can use to run Azure commands. Click on it.</p>
<p>The first time you run Cloud Shell, it’ll ask you for permission to create a storage account that the Cloud Shell VM can use. This isn’t the first time I’ve used Cloud Shell, so my storage account is already set up. If you do get a dialogue box asking for permission, then click the option to create a storage account.</p>
<p>Cloud Shell supports both PowerShell and the Bash shell. You can switch between them using this menu. We’re going to use the Bash Shell because the commands are simpler. If you’re familiar with Linux commands, then it will be especially easy.</p>
<p>First, we need to download the files for a sample website. The command to do that is pretty long, so it’s easiest to copy and paste it. You can get it from the read me file in the GitHub repository for <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">this course</a>. You can find a link to the repository at the bottom of the overview tab below this video.</p>
<p>Okay, copy this <code>git clone</code> command and paste it into the Cloud Shell window. It created a directory (which is the Linux term for folder) called html-docs-hello-world. Change into that directory with the <code>cd</code> command. I’m just going to use keyboard shortcuts to do the copying and pasting now. Now we can create an Azure App Service Web App using one command. Here it is.</p>
<p>It starts with <code>az</code> which means it’s an Azure command. Then we say <code>webapp</code> which is the command for Azure App Service. Then <code>up</code> which means to create the web app using the code in the current directory. Then we say <code>--location</code> and the name of the region where we want to deploy the web app. I’ve set it to <code>westus</code>. Then we say <code>--name</code> and what we want to call the app. I’m calling it <code>ca-example,</code> but you’ll have to call it something else because the name has to be unique among all of the out service names across all Azure customers. Then we say <code>--html</code> to tell it that we’re creating a static HTML website. Now hit Enter.</p>
<p>That’s all you have to do to create a website running on Azure App Service. It’ll take a little while to deploy so I’ll fast forward.</p>
<p>Okay, it’s done. Now we can make sure the website is working by going to this URL. Remember to change this name to the one you used. Great, there’s the sample website.</p>
<p>All right, now let’s delete the web app, so we don’t incur any more charges. In the VM demo, we deleted everything associated with the VM by deleting its resource group. We can do the same thing here but since we didn’t specify a resource group name in the command, how do we do that? App Service created a resource group for us. You’ll see it in the output from the command. Type <code>az group delete --name</code> then copy and paste the resource group name from here. Type “y”.</p>
<p>While that’s getting deleted, I should mention that there are many ways to deploy a web app. For example, both Visual Studio and Visual Studio Code can publish an app directly to Azure App Service without you needing to use the Azure portal or the command line. Once the app is deployed, though, you’ll need to use the portal or the CLI to manage it.</p>
<p>And that’s it for using the CLI.</p>
<h1 id="Service-Categories"><a href="#Service-Categories" class="headerlink" title="Service Categories"></a>Service Categories</h1><p>So far, I’ve only talked about compute, storage, and networking services, but Microsoft offers services in many other categories as well. I won’t talk about all of the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">Azure services</a> available, but I’ll go over some of the highlights.</p>
<p>If your organization is just getting started with Azure, then one of the first things you’ll want to do is figure out how you can migrate at least some of your existing applications to Azure. Microsoft provides a great tool for this called Azure Migrate.</p>
<p>First, it discovers your on-premises servers, both physical and virtual. On the virtual side, this includes both Hyper-V and VMware. Then it assesses these machines. For each one, it tells you whether or not it’s ready to migrate, how big the Azure VM will be, how much it will cost, and any dependent servers that will also need to be migrated. When you’re ready, it will even help you do the migration. Azure Migrate is also integrated with other tools to help you migrate SQL Server databases, web apps, and data. Also, if you have a virtual desktop infrastructure, there’s a tool that will do an assessment to help you migrate it to Windows Virtual Desktop, which is hosted on Azure.</p>
<p>Another question that always comes up is, “How do we integrate our on-premises identities with Azure?” In most cases, organizations are using Active Directory for identity management. Naturally, Microsoft has a good solution for these customers. And, not surprisingly, it’s called Azure Active Directory. This is a managed identity service that takes care of authentication. It’s not exactly the same as Active Directory, but it’s very similar, and there are many options for synchronizing your on-premises directory with your Azure directory.</p>
<p>Let’s move on to the development area. The DevOps approach has spread rapidly in organizations around the world. If you’re not familiar with it, the idea is that you can automate large portions of the building, testing, and releasing of application updates. Microsoft offers a suite of services called Azure DevOps to help you implement these processes. The most important service in this suite is called Azure Pipelines. It lets you create automated workflows to continuously build, test, and deploy code.</p>
<p>Another service that helps with the development process is Azure DevTest Labs, which makes it easy to spin up non-production environments. You could do this in other ways, but DevTest Labs gives you some extra capabilities, such as allowing administrators to control costs by setting limits on how many VMs can be deployed at once and ensuring that VMs are shut down when they’re not in use.</p>
<p>One really helpful service for speeding up the responsiveness of your applications is Azure Content Delivery Network, which lets you take advantage of Microsoft’s extensive global network. It caches your most frequently accessed content in locations around the world so your end-users will retrieve it from the closest point on the network. This really helps with making your web applications feel more like local applications.</p>
<p>Although there are billions of computers connected to the internet, they’re dwarfed by the number of other devices connected to the internet, such as smart thermostats or power meters. This is often referred to as the Internet of Things or IoT.</p>
<p>Microsoft offers a suite of services to help organizations connect, monitor, and control IoT devices. The simplest way to get started is to use Azure IoT Central, which is a fully managed SaaS solution that takes care of the technical details for you. It lets you create IoT applications without writing any code.</p>
<p>If you need something more customized, then you can integrate your applications with Azure IoT Hub. It’s a service that handles secure communications with thousands, or even millions, of IoT devices. In fact, it’s the service that IoT Central uses behind the scenes.</p>
<p>Microsoft also offers a solution called Azure Sphere to make your IoT devices more secure. It includes certified chips, the Azure Sphere operating system, and the Azure Sphere Security Service, all of which provide layers of protection for your IoT devices.</p>
<p>When you have a large volume of data coming in, whether it’s from IoT devices or applications, you’ll probably want to perform analytics on it. Microsoft’s analytics offerings have evolved over time, which is why you’ll see a variety of services in this area.</p>
<p>The oldest one is HDInsight. It supports a wide variety of open-source big data frameworks, including Hadoop, Spark, Hive, Storm, and many others. Azure Databricks is a similar service because it runs Spark as well, but it’s more user-friendly and easier to manage than HDInsight. Azure Synapse Analytics is the new version of Azure SQL Data Warehouse. It includes all of the old data warehouse functionality, but it also supports Spark analytics. Have you noticed a common theme? Apache Spark seems to be the king of big data analytics, and it’s just a question of which service you want to use to run it.</p>
<p>A more sophisticated type of analytics is artificial intelligence. You’ve probably heard about the amazing advances in AI that have enabled computers to do everything from language translation to facial recognition to beating humans at games like chess and Go.</p>
<p>Even though AI seems like it must be incredibly complex, the basic idea is fairly simple. The most common method is called machine learning. The way it works is you feed lots of real-world data into a program and the program tries to make generalizations about the data. This is known as training a model. It then uses these generalizations to make predictions when it’s given new data. For example, it can analyze the viewing habits of millions of Netflix customers and make generalizations about the kinds of movies that different types of people like to watch. Then it can look at movies you’ve watched in the past and predict which movie you’d like to watch now. That’s how Netflix makes its recommendations.</p>
<p>Microsoft offers lots of different AI services. If you’re new to AI, then the best place to start is Azure Cognitive Services. This is a collection of pre-built artificial intelligence tools. These services let you add AI capabilities to applications even if you don’t know anything about machine learning.</p>
<p>They’re grouped into five categories: decision, language, speech, vision, and web search. For example, the vision category includes the Computer Vision API, which can classify images, and the Face API, which can detect faces in images.</p>
<p>A related offering is Azure Bot Service, which gives you the tools to create a chatbot. This is an intelligent agent that can answer questions. For example, you could create a chatbot to handle simple support requests from customers.</p>
<p>If you have some basic knowledge of machine learning, then you might want to try Azure Machine Learning Studio. It lets you train and deploy machine learning models without any coding, using a drag-and-drop interface. I highly recommend it for learning the basics of machine learning.</p>
<p>A much more sophisticated option is Azure Machine Learning Services, which gives you full control over every stage of the machine learning process. You can use any Python-based machine learning framework, such as TensorFlow or PyTorch, train models using services such as Azure Databricks, and deploy models using services such as Azure Kubernetes Service. Azure Machine Learning Services is usually the best solution when you need to build your own custom artificial intelligence application.</p>
<p>The last category I’ll mention is integration tools. Since we use so many applications and services, it would be nice to be able to perform certain tasks on them automatically. For example, suppose you have an Azure blob container that your customer uploads documents to, and you’d like to be notified by email as soon as one arrives so that you can respond to it as quickly as possible. Microsoft offers a service called Azure Logic Apps that lets you automate this sort of task without writing any code. You can create a logic app using a drag-and-drop interface. </p>
<p>In this example, the logic app would be able to detect events that occur in Blob storage, but in most cases, you’d need to use another service called Azure Event Grid to notify your logic app of particular events. For example, if you want to get an email every time a virtual machine is created in a subscription, then you would configure Event Grid to send a message to your logic app whenever this occurs.</p>
<p>These examples are actually pretty trivial. Azure Logic Apps can be used to build complex workflows involving not only Azure services but also third-party services, such as Twitter and Dropbox.</p>
<p>I’ve covered some of the most important Azure services, but there are many more that I didn’t cover. So if you have a need that doesn’t seem to fit with any of these services, there are plenty of other options. First, you can look through Microsoft’s Azure Products page. Another way is to select all services from the main menu in the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-portal/">Azure Portal</a> and then search for what you need. If you still can’t find what you’re looking for, then you can search the Azure Marketplace from the search bar at the top of the portal. The Marketplace includes a wide variety of third-party solutions that work with Azure, such as Docker Enterprise or Barracuda Firewall.</p>
<p>Okay, that’s it for my services overview.</p>
<h1 id="Designing-a-Solution"><a href="#Designing-a-Solution" class="headerlink" title="Designing a Solution"></a>Designing a Solution</h1><p>Now that we have a good idea of what <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">services are available in Azure</a>, let’s see how we can put them together to create a more complex solution. One of the best ways to get started is to look at the examples in the Azure Architecture Center. If you click on reference architectures, you’ll see some recommended architectures for particular types of solutions. You can also check out these example workloads for specific business and technical challenges. I’m going to walk you through this e-commerce example.</p>
<p>The scenario in this example is that we need to build an Azure-based solution for customers who want to buy concert tickets. The diagram they use is a bit confusing, so we’ll use our own. </p>
<p>The first service we need to use is Azure App Service because it’s the easiest way to host a web app. To buy concert tickets, our customers will connect to our website, which will be hosted on Azure App Service.</p>
<p>The website won’t be able to do very much, though, until we add more services. For example, it would be pretty difficult to have a continually updated list of concerts without using a database. We could connect our website to a variety of databases, such as MySQL or Cosmos DB. But the most obvious choice is to use Azure SQL database. We can store concert information there and then have a list of upcoming concerts appear on the website.</p>
<p>If we’re going to have a lot of concerts to choose from, then we should also allow customers to search for specific concerts. Azure Cognitive Search is a good choice for that. It indexes your content so it can provide quick responses to search queries.</p>
<p>Next, we’ll want to give customers the ability to purchase tickets. This example solution for Microsoft doesn’t include the actual payment handling part of the transaction, but it does include a couple of the important pieces. First, we’ll want to give customers the option to create an account so they don’t have to re-enter their information every time they use our app to purchase tickets. The good solution is to use Azure Active Directory, B2C. The B2C stands for business to consumer. It provides everything you need to handle authentication for people outside of your organization.</p>
<p>When we receive custom orders, we should put them in a queue. Then we can have a separate component that pulls orders from the queue and processes them. This is one of the best ways to pass data from one component to another because it makes applications more reliable and scalable. Even if a component goes down, the data will be buffered in the queue until that component comes back up. Microsoft has a special type of storage to handle this need, and it’s called, not surprisingly, Queue Storage. It scales up and down as needed.</p>
<p>To retrieve orders from the queue and process them, we can use an Azure Function. The function will be triggered automatically whenever a new item is added to the queue. The function then creates a printable concert ticket for the customer. When it’s done, it stores the ticket in Blob Storage, which is the perfect place for image files. The ticket will then be sent to the customer, although that’s not shown in this example app.</p>
<p>Okay, now we have a complete solution (other than the couple of missing pieces that I mentioned), but we can add more functionality to our app. Another feature we can add is to allow people to post a review after they’ve seen a concert.</p>
<p>This can be handled in a similar way to the order processing feature. We’ll add new concert reviews to another queue and have an Azure Function that retrieves those concert reviews from the queue. And then it will store the reviews in SQL Database so they can be displayed on the website.</p>
<p>All right, now we have all the functionality we need, but we can add some more services to make our app better.</p>
<p>First, we can add Azure Cache for Redis and use it to cache concert information. This will make searches faster when customers are looking for concerts.</p>
<p>Another important way to make our app faster is to use the Azure Content Delivery Network. It’ll cache our website static files, so they’ll come up faster when customers access our site. </p>
<p>Yet another way to improve responsiveness is to use a service called Azure Traffic Manager. If we create multiple copies of our web app and host them in different regions around the world, then we can configure traffic manager to serve each customer from the web app instance that’s closest to the customer on the internet. So now not only do they get the static website files from the closest point on the content delivery network, but they also interact with the web app using the nearest instance.</p>
<p>To ensure that our app is functioning properly, we can use the application insight service. It takes care of monitoring the app and alerting us if there are issues. It also provides us with analytics to help diagnose issues and to understand how users are interacting with our app.</p>
<p>Finally, if we want to automatically classify concert reviews as positive or negative, we can use the Text Analytics component of cognitive services. We’ll have an Azure Function that runs a sentiment analysis on each concert review and then updates the concert review in the database to show whether it’s positive or negative.</p>
<p>That’s a lot of services for one application. So how much will everything cost? Thankfully, Microsoft provides sample pricing on the solution example page. It even has options for small, medium, and large implementations, depending on how much customer traffic we think we’ll get. Let’s try the medium option, which can handle up to 100,000 users per month.</p>
<p>This brings up the pricing calculator, which is a really handy feature for estimating the price of nearly any Azure service. I’m going to click the “Collapse all button” so we can see a summary of all the costs. The total is up here. It’s around $900 per month for everything.</p>
<p>If you look through the breakdown of the price, you might be surprised to see that app service is not the number one cost on this list. Considering that it hosts the core application, it seems like it should have the highest cost. But actually Azure Active Directory, B2C, and Azure Cognitive Search are higher. That’s a bit misleading, though, because this pricing example only includes app service hosting in one region. If we want to host the app in multiple regions and use traffic manager to make it more responsive for users around the world, then we’ll pay at least this much for each region, which would easily make app service the most expensive component.</p>
<p>And that’s it for designing a solution.</p>
<h1 id="Managing-Services"><a href="#Managing-Services" class="headerlink" title="Managing Services"></a>Managing Services</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/designing-solution/">Building a solution</a> is one thing, but making sure it continues to run properly and cost-efficiently is another. And, of course, you also need to make sure everything is secure and compliant. Fortunately, Microsoft has lots of services to help you with these tasks, too.</p>
<p>Azure Monitor is your one-stop shop for keeping track of what’s happening with your Azure resources. It’s a collection of a variety of monitoring tools. Remember when I mentioned Application Insights in the last lesson? That’s actually just one component of Azure Monitor. Another is Log Analytics, which lets you run complex queries on multiple logs collected from your Azure resources.</p>
<p>But the core features of Azure Monitor are metrics and alerts. Metrics are basically statistics on various aspects of your resources, such as CPU usage on virtual machines and space used on Blob Storage. Azure Monitor creates graphs showing how these metrics have changed over time. It can also watch critical metrics you specify and send you an alert if there’s a problem. For example, it could text you if a database is overwhelmed by a sudden spike in activity.</p>
<p>Microsoft also provides a dashboard called Service Health where you can find out about problems with the Azure platform itself as well as upcoming maintenance events. You can even create alerts so you’ll be notified of both planned and unplanned outages.</p>
<p>Speaking of outages, it’s always a good idea to have backups of your critical resources to help recover from service failures. Most Azure services, such as Cosmos DB, have their own built-in backup capabilities. Azure VMs are a little different because you back them up using a service called Azure Backup. Surprisingly, you can even use this service to back up your on-premises systems.</p>
<p>Even if you’re doing a good job of maintaining your Azure systems, you might still be able to make some improvements. Microsoft provides a very helpful service called Azure Advisor that will not only suggest ways to improve the performance and availability of your applications, but it will even suggest ways to reduce your costs. For example, if it finds underutilized virtual machines, it will recommend that you use smaller (and less expensive) VMs to perform the same tasks.</p>
<p>Azure Advisor also provides security recommendations. It actually gets these recommendations from an important service called Microsoft Defender for Cloud, which was formerly known as Azure Security Center. So if you want to get more details, that’s the place to go. It’s a dashboard that gathers security information from resources across your subscriptions and assesses your vulnerabilities.</p>
<p>First, it shows you your secure score, which is an assessment of how secure your Azure resources are. You can click on it to see a list of recommendations to improve the security of your compute, storage, networking, and identity resources. Each recommendation shows you how much your secure score would be improved if you were to implement the recommendation. You don’t have to implement these recommendations, but it’s usually a good idea.</p>
<p>Then it shows you how well the resources in your Azure subscriptions meet regulatory compliance standards. By default, it will measure your compliance with a set of policies called the Azure Security Benchmark. You can customize these default policies if you want, or you can create your own custom policies from scratch in a service called, naturally, Azure Policy. For example, you could create a policy saying that all storage resources must reside in the European Union, and then if someone in your organization created a storage resource outside of the EU, it would show up in this compliance panel. You can also add other regulatory compliance standards, such as ISO 27001.</p>
<p>Finally, the Workloads protection panel shows you how many security alerts you have. These are potential threats that were detected by Microsoft Threat Intelligence. You can click on it to see the actual alerts so you can address them.</p>
<p>Be aware that only secure score and its recommendations are free. To get the other features, you need to enable enhanced security. This’ll give you lots of additional features as well. One really important feature is the ability to add your on-premises environments to the set of resources that are protected. Another enhanced feature is called just-in-time VM access. This blocks access to a virtual machine until an administrator allows specific users or IP addresses to get in for a limited period of time.</p>
<p>So far in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">this course</a>, I’ve only talked about creating Azure resources manually, but once you’re happy with a particular configuration for a resource, such as a virtual machine, you’ll probably want to create nearly identical resources in a more automated way. The solution is something called an ARM template. ARM is short for Azure Resource Manager.</p>
<p>First, you create an ARM template that specifies all of the configuration details for one or more resources. For example, suppose you create an ARM template for a specific VM configuration. Then, whenever you need to create a VM with those characteristics, you can just run a certain command using that template, and voila, it takes care of all of the details for you. The best part is that Microsoft makes it really easy to create an ARM template. All you have to do is go to an existing resource that has the configuration you want and select “Export template” from the menu.</p>
<p>An even more powerful tool is Azure Blueprints, which lets you automate the deployment of entire Azure environments. A blueprint is a collection of ARM templates plus a few other details, such as policies and user permissions. When a blueprint is assigned to a subscription, it not only automates the creation of an environment, but it also keeps a record of the deployment. This makes it a critical governance tool because it enables the tracking and auditing of deployments.</p>
<p>We’ve covered a lot of Azure management tools, and that’s not even all of them. You can rest assured that Microsoft has the services you need to manage your Azure infrastructure.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>I hope you enjoyed <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/course-introduction/">learning about Azure</a>. Let’s do a quick review of what you learned.</p>
<p>Azure is a collection of online services that organizations can use to build, host, and deliver applications, and it runs in Microsoft’s data centers around the world.</p>
<p>Azure’s primary compute offerings are virtual machines, App Service, Azure Kubernetes Service, and Azure Functions.</p>
<p>In the raw storage area, Microsoft provides Blob storage for unstructured objects, File Storage for traditional file sharing, and Data Lake Storage Gen2 for Hadoop-compatible data analytics.</p>
<p>Azure’s relational database offerings are SQL Database, which is similar to SQL Server, and Azure Database for MySQL, MariaDB, and PostgreSQL for people who need those particular open source alternatives.</p>
<p>Microsoft’s main NoSQL offering is Cosmos DB. Another NoSQL service is Azure Cache for Redis, which is typically used to speed up applications by caching frequently requested data. </p>
<p>Azure’s equivalent of an on-premises network is a virtual network, or Vnet. You can connect VNets together using VNet peering. To create a secure connection between a VNet and an on-premises network, you can either use a VPN, which stands for Virtual Private Network, or Azure ExpressRoute, which is a dedicated, private connection.</p>
<p>Azure Migrate will help you move applications from your on-premises environment to Azure.</p>
<p>Azure Active Directory is a managed identity service that takes care of authentication and integrates with on-premises Active Directory servers.</p>
<p>Azure DevOps can help you automate large portions of the building, testing, and releasing of application updates. Azure DevTest Labs makes it easy to spin up non-production environments.</p>
<p>Azure Content Delivery Network caches your most frequently accessed content in locations around the world so your end-users will retrieve it from the closest point on the network.</p>
<p>Azure IoT Central lets you create Internet of Things applications without writing any code. If you need something more customized, then you can integrate your applications with Azure IoT Hub. Azure Sphere provides extra layers of protection for your IoT devices.</p>
<p>Some of Microsoft’s data analytics services include Azure Databricks, Azure Synapse Analytics, and HDInsight. All of these services can run Apache Spark.</p>
<p>Azure Cognitive Services is a collection of pre-built artificial intelligence tools. Azure Bot Service is a framework for creating chatbots. Azure Machine Learning Studio lets you train and deploy machine learning models without any coding. Azure Machine Learning Services is more sophisticated and gives you full control over every stage of the machine learning process. </p>
<p>Azure Logic Apps lets you automate integration tasks using a drag-and-drop interface.</p>
<p>Azure Monitor is a centralized place for keeping track of what’s happening with your Azure resources. Azure Security Center is a dashboard that gathers security information from your resources and assesses your vulnerabilities.</p>
<p>You can automate your deployments using Azure Resource Manager templates and Azure Blueprints.</p>
<p>You can access Azure using the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-portal/">Azure Portal</a>, the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/overview-of-azure-services/using-azure-cli/">command-line interface</a>, PowerShell, the Azure Software Development Kit, or the Azure Mobile App. You can run CLI or PowerShell commands in a browser by using Cloud Shell in the Azure Portal.</p>
<p>When you sign up for an Azure account, Microsoft creates both a billing account and a subscription. A billing account can contain multiple subscriptions, each of which contains its own isolated set of resources. Within a subscription, each resource is part of a resource group.</p>
<p>Azure has many regions around the world, and each region contains multiple data centers. You can provide high availability by distributing virtual machines across availability zones, which are in separate data centers.</p>
<p>Whew! I think that’s by far the most times I’ve said the word Azure in one video. Okay, now I’m going to say it just a few more times.</p>
<p>To learn more about Azure, please look through our Azure Library. We have courses, labs, and practice exams on nearly every Azure topic, and we have more content coming out all the time.</p>
<p>Please give this course a rating, and if you have any questions or comments, please let us know. Thanks and have fun with Microsoft Azure!</p>
<h2 id="1Course-Introduction"><a href="#1Course-Introduction" class="headerlink" title="1Course Introduction"></a>1<strong>Course Introduction</strong></h2><p><a target="_blank" rel="noopener" href="https://github.com/cloudacademy/azure-overview">Course GitHub repo</a></p>
<h2 id="4Using-the-Azure-CLI"><a href="#4Using-the-Azure-CLI" class="headerlink" title="4Using the Azure CLI"></a>4<strong>Using the Azure CLI</strong></h2><p><a target="_blank" rel="noopener" href="https://github.com/cloudacademy/azure-overview">Course GitHub repo</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Cert-Prep-Configuring-and-Operating-Microsoft-Azure-Virtual-Desktop-AZ-140-26/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Cert-Prep-Configuring-and-Operating-Microsoft-Azure-Virtual-Desktop-AZ-140-26/" class="post-title-link" itemprop="url">AZ-140-Cert-Prep-Configuring-and-Operating-Microsoft-Azure-Virtual-Desktop-AZ-140-26</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-13 19:14:31 / Modified: 20:01:24" itemprop="dateCreated datePublished" datetime="2022-11-13T19:14:31-04:00">2022-11-13</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Cert-Prep-Configuring-and-Operating-Microsoft-Azure-Virtual-Desktop-AZ-140-26/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Cert-Prep-Configuring-and-Operating-Microsoft-Azure-Virtual-Desktop-AZ-140-26/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="9.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Resource-Required-Reading-for-AZ-140-25/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Resource-Required-Reading-for-AZ-140-25/" class="post-title-link" itemprop="url">AZ-140-Resource-Required-Reading-for-AZ-140-25</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 19:13:17" itemprop="dateCreated datePublished" datetime="2022-11-13T19:13:17-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:31:58" itemprop="dateModified" datetime="2022-11-14T06:31:58-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Resource-Required-Reading-for-AZ-140-25/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Resource-Required-Reading-for-AZ-140-25/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Security-best-practices"><a href="#Security-best-practices" class="headerlink" title="Security best practices"></a>Security best practices</h1><p>Azure Virtual Desktop is a managed virtual desktop service that includes many security capabilities for keeping your organization safe. In a Azure Virtual Desktop deployment, Microsoft manages portions of the services on the customer’s behalf. The service has many built-in advanced security features, such as Reverse Connect, which reduce the risk involved with having remote desktops accessible from anywhere.</p>
<p>This article describes additional steps you can take as an admin to keep your customers’ Azure Virtual Desktop deployments secure.</p>
<h2 id="Security-responsibilities"><a href="#Security-responsibilities" class="headerlink" title="Security responsibilities"></a>Security responsibilities</h2><p>What makes cloud services different from traditional on-premises virtual desktop infrastructures (VDIs) is how they handle security responsibilities. For example, in a traditional on-premises VDI, the customer would be responsible for all aspects of security. However, in most cloud services, these responsibilities are shared between the customer and the company.</p>
<p>When you use Azure Virtual Desktop, it’s important to understand that while some components come already secured for your environment, you’ll need to configure other areas yourself to fit your organization’s security needs.</p>
<p>Here are the security needs you’re responsible for in your Azure Virtual Desktop deployment:</p>
<table>
<thead>
<tr>
<th align="left">Security need</th>
<th align="center">Is the customer responsible for this?</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Identity</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">User devices (mobile and PC)</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">App security</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">Session host operating system (OS)</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">Deployment configuration</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">Network controls</td>
<td align="center">Yes</td>
</tr>
<tr>
<td align="left">Virtualization control plane</td>
<td align="center">No</td>
</tr>
<tr>
<td align="left">Physical hosts</td>
<td align="center">No</td>
</tr>
<tr>
<td align="left">Physical network</td>
<td align="center">No</td>
</tr>
<tr>
<td align="left">Physical datacenter</td>
<td align="center">No</td>
</tr>
</tbody></table>
<p>The security needs the customer isn’t responsible for are handled by Microsoft.</p>
<h2 id="Azure-security-best-practices"><a href="#Azure-security-best-practices" class="headerlink" title="Azure security best practices"></a>Azure security best practices</h2><p>Azure Virtual Desktop is a service under Azure. To maximize the safety of your Azure Virtual Desktop deployment, you should make sure to secure the surrounding Azure infrastructure and management plane as well. To secure your infrastructure, consider how Azure Virtual Desktop fits into your larger Azure ecosystem. To learn more about the Azure ecosystem, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/security/fundamentals/best-practices-and-patterns">Azure security best practices and patterns</a>.</p>
<p>This section describes best practices for securing your Azure ecosystem.</p>
<h3 id="Enable-Microsoft-Defender-for-Cloud"><a href="#Enable-Microsoft-Defender-for-Cloud" class="headerlink" title="Enable Microsoft Defender for Cloud"></a>Enable Microsoft Defender for Cloud</h3><p>We recommend enabling Microsoft Defender for Cloud’s enhanced security features to:</p>
<ul>
<li>Manage vulnerabilities.</li>
<li>Assess compliance with common frameworks like PCI.</li>
<li>Strengthen the overall security of your environment.</li>
</ul>
<p>To learn more, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/enable-enhanced-security">Enable enhanced security features</a>.</p>
<h3 id="Improve-your-Secure-Score"><a href="#Improve-your-Secure-Score" class="headerlink" title="Improve your Secure Score"></a>Improve your Secure Score</h3><p>Secure Score provides recommendations and best practice advice for improving your overall security. These recommendations are prioritized to help you pick which ones are most important, and the Quick Fix options help you address potential vulnerabilities quickly. These recommendations also update over time, keeping you up to date on the best ways to maintain your environment’s security. To learn more, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls">Improve your Secure Score in Microsoft Defender for Cloud</a>.</p>
<h2 id="Azure-Virtual-Desktop-security-best-practices"><a href="#Azure-Virtual-Desktop-security-best-practices" class="headerlink" title="Azure Virtual Desktop security best practices"></a>Azure Virtual Desktop security best practices</h2><p>Azure Virtual Desktop has many built-in security controls. In this section, you’ll learn about security controls you can use to keep your users and data safe.</p>
<h3 id="Require-multi-factor-authentication"><a href="#Require-multi-factor-authentication" class="headerlink" title="Require multi-factor authentication"></a>Require multi-factor authentication</h3><p>Requiring multi-factor authentication for all users and admins in Azure Virtual Desktop improves the security of your entire deployment. To learn more, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/set-up-mfa">Enable Azure AD Multi-Factor Authentication for Azure Virtual Desktop</a>.</p>
<h3 id="Enable-Conditional-Access"><a href="#Enable-Conditional-Access" class="headerlink" title="Enable Conditional Access"></a>Enable Conditional Access</h3><p>Enabling <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/overview">Conditional Access</a> lets you manage risks before you grant users access to your Azure Virtual Desktop environment. When deciding which users to grant access to, we recommend you also consider who the user is, how they sign in, and which device they’re using.</p>
<h3 id="Collect-audit-logs"><a href="#Collect-audit-logs" class="headerlink" title="Collect audit logs"></a>Collect audit logs</h3><p>Enabling audit log collection lets you view user and admin activity related to Azure Virtual Desktop. Some examples of key audit logs are:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log">Azure Activity Log</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor">Azure Active Directory Activity Log</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-whatis">Azure Active Directory</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/agents/agent-windows">Session hosts</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/key-vault/general/logging">Key Vault logs</a></li>
</ul>
<h3 id="Use-RemoteApps"><a href="#Use-RemoteApps" class="headerlink" title="Use RemoteApps"></a>Use RemoteApps</h3><p>When choosing a deployment model, you can either provide remote users access to entire virtual desktops or only select applications. Remote applications, or RemoteApps, provide a seamless experience as the user works with apps on their virtual desktop. RemoteApps reduce risk by only letting the user work with a subset of the remote machine exposed by the application.</p>
<h3 id="Monitor-usage-with-Azure-Monitor"><a href="#Monitor-usage-with-Azure-Monitor" class="headerlink" title="Monitor usage with Azure Monitor"></a>Monitor usage with Azure Monitor</h3><p>Monitor your Azure Virtual Desktop service’s usage and availability with <a target="_blank" rel="noopener" href="https://azure.microsoft.com/services/monitor/">Azure Monitor</a>. Consider creating <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal">service health alerts</a> for the Azure Virtual Desktop service to receive notifications whenever there’s a service impacting event.</p>
<h3 id="Encrypt-your-VM"><a href="#Encrypt-your-VM" class="headerlink" title="Encrypt your VM"></a>Encrypt your VM</h3><p>Encrypt your VM with <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption-overview">managed disk encryption options</a> to protect stored data from unauthorized access.</p>
<h2 id="Session-host-security-best-practices"><a href="#Session-host-security-best-practices" class="headerlink" title="Session host security best practices"></a>Session host security best practices</h2><p>Session hosts are virtual machines that run inside an Azure subscription and virtual network. Your Azure Virtual Desktop deployment’s overall security depends on the security controls you put on your session hosts. This section describes best practices for keeping your session hosts secure.</p>
<h3 id="Enable-endpoint-protection"><a href="#Enable-endpoint-protection" class="headerlink" title="Enable endpoint protection"></a>Enable endpoint protection</h3><p>To protect your deployment from known malicious software, we recommend enabling endpoint protection on all session hosts. You can use either Windows Defender Antivirus or a third-party program. To learn more, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/deployment-vdi-windows-defender-antivirus">Deployment guide for Windows Defender Antivirus in a VDI environment</a>.</p>
<p>For profile solutions like FSLogix or other solutions that mount VHD files, we recommend excluding VHD file extensions.</p>
<h3 id="Install-an-endpoint-detection-and-response-product"><a href="#Install-an-endpoint-detection-and-response-product" class="headerlink" title="Install an endpoint detection and response product"></a>Install an endpoint detection and response product</h3><p>We recommend you install an endpoint detection and response (EDR) product to provide advanced detection and response capabilities. For server operating systems with <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/integration-defender-for-endpoint">Microsoft Defender for Cloud</a> enabled, installing an EDR product will deploy Microsoft Defender for Endpoint. For client operating systems, you can deploy <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/onboarding">Microsoft Defender for Endpoint</a> or a third-party product to those endpoints.</p>
<h3 id="Enable-threat-and-vulnerability-management-assessments"><a href="#Enable-threat-and-vulnerability-management-assessments" class="headerlink" title="Enable threat and vulnerability management assessments"></a>Enable threat and vulnerability management assessments</h3><p>Identifying software vulnerabilities that exist in operating systems and applications is critical to keeping your environment secure. Microsoft Defender for Cloud can help you identify problem spots through <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/deploy-vulnerability-assessment-tvm">Microsoft Defender for Endpoint’s threat and vulnerability management solution</a>. You can also use third-party products if you’re so inclined, although we recommend using Microsoft Defender for Cloud and Microsoft Defender for Endpoint.</p>
<h3 id="Patch-software-vulnerabilities-in-your-environment"><a href="#Patch-software-vulnerabilities-in-your-environment" class="headerlink" title="Patch software vulnerabilities in your environment"></a>Patch software vulnerabilities in your environment</h3><p>Once you identify a vulnerability, you must patch it. This applies to virtual environments as well, which includes the running operating systems, the applications that are deployed inside of them, and the images you create new machines from. Follow your vendor patch notification communications and apply patches in a timely manner. We recommend patching your base images monthly to ensure that newly deployed machines are as secure as possible.</p>
<h3 id="Establish-maximum-inactive-time-and-disconnection-policies"><a href="#Establish-maximum-inactive-time-and-disconnection-policies" class="headerlink" title="Establish maximum inactive time and disconnection policies"></a>Establish maximum inactive time and disconnection policies</h3><p>Signing users out when they’re inactive preserves resources and prevents access by unauthorized users. We recommend that timeouts balance user productivity as well as resource usage. For users that interact with stateless applications, consider more aggressive policies that turn off machines and preserve resources. Disconnecting long running applications that continue to run if a user is idle, such as a simulation or CAD rendering, can interrupt the user’s work and may even require restarting the computer.</p>
<h3 id="Set-up-screen-locks-for-idle-sessions"><a href="#Set-up-screen-locks-for-idle-sessions" class="headerlink" title="Set up screen locks for idle sessions"></a>Set up screen locks for idle sessions</h3><p>You can prevent unwanted system access by configuring Azure Virtual Desktop to lock a machine’s screen during idle time and requiring authentication to unlock it.</p>
<h3 id="Establish-tiered-admin-access"><a href="#Establish-tiered-admin-access" class="headerlink" title="Establish tiered admin access"></a>Establish tiered admin access</h3><p>We recommend you don’t grant your users admin access to virtual desktops. If you need software packages, we recommend you make them available through configuration management utilities like Microsoft Endpoint Manager. In a multi-session environment, we recommend you don’t let users install software directly.</p>
<h3 id="Consider-which-users-should-access-which-resources"><a href="#Consider-which-users-should-access-which-resources" class="headerlink" title="Consider which users should access which resources"></a>Consider which users should access which resources</h3><p>Consider session hosts as an extension of your existing desktop deployment. We recommend you control access to network resources the same way you would for other desktops in your environment, such as using network segmentation and filtering. By default, session hosts can connect to any resource on the internet. There are several ways you can limit traffic, including using Azure Firewall, Network Virtual Appliances, or proxies. If you need to limit traffic, make sure you add the proper rules so that Azure Virtual Desktop can work properly.</p>
<h3 id="Manage-Office-Pro-Plus-security"><a href="#Manage-Office-Pro-Plus-security" class="headerlink" title="Manage Office Pro Plus security"></a>Manage Office Pro Plus security</h3><p>In addition to securing your session hosts, it’s important to also secure the applications running inside of them. Office Pro Plus is one of the most common applications deployed in session hosts. To improve the Office deployment security, we recommend you use the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/DeployOffice/overview-of-security-policy-advisor">Security Policy Advisor</a> for Microsoft 365 Apps for enterprise. This tool identifies policies that can you can apply to your deployment for more security. Security Policy Advisor also recommends policies based on their impact to your security and productivity.</p>
<h3 id="Other-security-tips-for-session-hosts"><a href="#Other-security-tips-for-session-hosts" class="headerlink" title="Other security tips for session hosts"></a>Other security tips for session hosts</h3><p>By restricting operating system capabilities, you can strengthen the security of your session hosts. Here are a few things you can do:</p>
<ul>
<li>Control device redirection by redirecting drives, printers, and USB devices to a user’s local device in a remote desktop session. We recommend that you evaluate your security requirements and check if these features ought to be disabled or not.</li>
<li>Restrict Windows Explorer access by hiding local and remote drive mappings. This prevents users from discovering unwanted information about system configuration and users.</li>
<li>Avoid direct RDP access to session hosts in your environment. If you need direct RDP access for administration or troubleshooting, enable <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/just-in-time-access-usage">just-in-time</a> access to limit the potential attack surface on a session host.</li>
<li>Grant users limited permissions when they access local and remote file systems. You can restrict permissions by making sure your local and remote file systems use access control lists with least privilege. This way, users can only access what they need and can’t change or delete critical resources.</li>
<li>Prevent unwanted software from running on session hosts. You can enable App Locker for additional security on session hosts, ensuring that only the apps you allow can run on the host.</li>
</ul>
<h2 id="Azure-Virtual-Desktop-support-for-Trusted-Launch"><a href="#Azure-Virtual-Desktop-support-for-Trusted-Launch" class="headerlink" title="Azure Virtual Desktop support for Trusted Launch"></a>Azure Virtual Desktop support for Trusted Launch</h2><p>Trusted launch are Gen2 Azure VMs with enhanced security features aimed to protect against “bottom of the stack” threats through attack vectors such as rootkits, boot kits, and kernel-level malware. The following are the enhanced security features of trusted launch, all of which are supported in Azure Virtual Desktop. To learn more about trusted launch, visit <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-machines/trusted-launch">Trusted launch for Azure virtual machines</a>.</p>
<h2 id="Azure-Confidential-Computing-virtual-machines-preview"><a href="#Azure-Confidential-Computing-virtual-machines-preview" class="headerlink" title="Azure Confidential Computing virtual machines (preview)"></a>Azure Confidential Computing virtual machines (preview)</h2><p> Important</p>
<p>Azure Virtual Desktop support for Azure Confidential virtual machines is currently in PREVIEW. See the <a target="_blank" rel="noopener" href="https://azure.microsoft.com/support/legal/preview-supplemental-terms/">Supplemental Terms of Use for Microsoft Azure Previews</a> for legal terms that apply to Azure features that are in beta, preview, or otherwise not yet released into general availability.</p>
<p>Azure Virtual Desktop support for Azure Confidential Computing virtual machines (preview) ensures a user’s virtual desktop is encrypted in memory, protected in use, and backed by hardware root of trust. Deploying confidential VMs with Azure Virtual Desktop gives users access to Microsoft 365 and other applications on session hosts that use hardware-based isolation, which hardens isolation from other virtual machines, the hypervisor, and the host OS. These virtual desktops are powered by the latest Third-generation (Gen 3) Advanced Micro Devices (AMD) EPYC™ processor with Secure Encrypted Virtualization Secure Nested Paging (SEV-SNP) technology. Memory encryption keys are generated and safeguarded by a dedicated secure processor inside the AMD CPU that can’t be read from software. For more information, see the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/confidential-computing/overview">Azure Confidential Computing overview</a>.</p>
<h3 id="Secure-Boot"><a href="#Secure-Boot" class="headerlink" title="Secure Boot"></a>Secure Boot</h3><p>Secure Boot is a mode that platform firmware supports that protects your firmware from malware-based rootkits and boot kits. This mode only allows signed OSes and drivers to start up the machine.</p>
<h3 id="Monitor-boot-integrity-using-Remote-Attestation"><a href="#Monitor-boot-integrity-using-Remote-Attestation" class="headerlink" title="Monitor boot integrity using Remote Attestation"></a>Monitor boot integrity using Remote Attestation</h3><p>Remote attestation is a great way to check the health of your VMs. Remote attestation verifies that Measured Boot records are present, genuine, and originate from the Virtual Trusted Platform Module (vTPM). As a health check, it provides cryptographic certainty that a platform started up correctly.</p>
<h3 id="vTPM"><a href="#vTPM" class="headerlink" title="vTPM"></a>vTPM</h3><p>A vTPM is a virtualized version of a hardware Trusted Platform Module (TPM), with a virtual instance of a TPM per VM. vTPM enables remote attestation by performing integrity measurement of the entire boot chain of the VM (UEFI, OS, system, and drivers).</p>
<p>We recommend enabling vTPM to use remote attestation on your VMs. With vTPM enabled, you can also enable BitLocker functionality with Azure Disk Encryption, which provides full-volume encryption to protect data at rest. Any features using vTPM will result in secrets bound to the specific VM. When users connect to the Azure Virtual Desktop service in a pooled scenario, users can be redirected to any VM in the host pool. Depending on how the feature is designed this may have an impact.</p>
<p> Note</p>
<p>BitLocker should not be used to encrypt the specific disk where you’re storing your FSLogix profile data.</p>
<h3 id="Virtualization-based-Security"><a href="#Virtualization-based-Security" class="headerlink" title="Virtualization-based Security"></a>Virtualization-based Security</h3><p>Virtualization-based Security (VBS) uses the hypervisor to create and isolate a secure region of memory that’s inaccessible to the OS. Hypervisor-Protected Code Integrity (HVCI) and Windows Defender Credential Guard both use VBS to provide increased protection from vulnerabilities.</p>
<h4 id="Hypervisor-Protected-Code-Integrity"><a href="#Hypervisor-Protected-Code-Integrity" class="headerlink" title="Hypervisor-Protected Code Integrity"></a>Hypervisor-Protected Code Integrity</h4><p>HVCI is a powerful system mitigation that uses VBS to protect Windows kernel-mode processes against injection and execution of malicious or unverified code.</p>
<h4 id="Windows-Defender-Credential-Guard"><a href="#Windows-Defender-Credential-Guard" class="headerlink" title="Windows Defender Credential Guard"></a>Windows Defender Credential Guard</h4><p>Windows Defender Credential Guard uses VBS to isolate and protect secrets so that only privileged system software can access them. This prevents unauthorized access to these secrets and credential theft attacks, such as Pass-the-Hash attacks.</p>
<h2 id="Nested-virtualization"><a href="#Nested-virtualization" class="headerlink" title="Nested virtualization"></a>Nested virtualization</h2><p>The following operating systems support running nested virtualization on Azure Virtual Desktop:</p>
<ul>
<li>Windows Server 2016</li>
<li>Windows Server 2019</li>
<li>Windows Server 2022</li>
<li>Windows 10 Enterprise</li>
<li>Windows 10 Enterprise multi-session</li>
<li>Windows 11 Enterprise</li>
<li>Windows 11 Enterprise multi-session</li>
</ul>
<h2 id="Windows-Defender-Application-Control"><a href="#Windows-Defender-Application-Control" class="headerlink" title="Windows Defender Application Control"></a>Windows Defender Application Control</h2><p>The following operating systems support using Windows Defender Application Control with Azure Virtual Desktop:</p>
<ul>
<li>Windows Server 2016</li>
<li>Windows Server 2019</li>
<li>Windows Server 2022</li>
<li>Windows 10 Enterprise</li>
<li>Windows 10 Enterprise multi-session</li>
<li>Windows 11 Enterprise</li>
<li>Windows 11 Enterprise multi-session</li>
</ul>
<p> Note</p>
<p>When using Windows Defender Access Control, we recommend only targeting policies at the device level. Although it’s possible to target policies to individual users, once the policy is applied, it affects all users on the device equally.</p>
<h1 id="Enable-or-disable-Start-VM-on-Connect"><a href="#Enable-or-disable-Start-VM-on-Connect" class="headerlink" title="Enable or disable Start VM on Connect"></a>Enable or disable Start VM on Connect</h1><p>Start VM On Connect lets you reduce costs by enabling end users to turn on their session host virtual machines (VMs) only when they need them. You can them turn off VMs when they’re not needed.</p>
<p>You can configure Start VM on Connect for personal or pooled host pools using the Azure portal or PowerShell. Start VM on Connect is a host pool setting.</p>
<p>For personal host pools, Start VM On Connect will only turn on an existing session host VM that has already been assigned or will be assigned to a user. For pooled host pools, Start VM On Connect will only turn on a session host VM when none are turned on and additional VMs will only be turned on when the first VM reaches the session limit.</p>
<p>The time it takes for a user to connect to a session host VM that is powered off (deallocated) increases because the VM needs time to turn on again, much like turning on a physical computer. The Remote Desktop client has an indicator that lets the user know the VM is being powered on while they’re connecting.</p>
<p> Note</p>
<p>Azure Virtual Desktop (classic) doesn’t support Start VM On Connect.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>To use Start VM on Connect, make sure you follow these guidelines:</p>
<ul>
<li>You can only configure Start VM on Connect on existing host pools. You can’t enable it at the same time you create a new host pool.</li>
<li>The following Remote Desktop clients support Start VM on Connect:<ul>
<li>The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-windows?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">Windows client</a> (version 1.2.2061 or later)</li>
<li>The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-web?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">Web client</a></li>
<li>The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-macos?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">macOS client</a> (version 10.6.4 or later)</li>
<li>The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-ios-ipados?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">iOS and iPadOS client</a> (version 10.2.5 or later)</li>
<li>The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-android-chrome-os?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">Android and Chrome OS client</a> (version 10.0.10 or later)</li>
<li>The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-microsoft-store?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">Microsoft Store client</a> (version 10.2.2005.0 or later)</li>
<li>Thin clients listed in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/users/connect-thin-clients?toc=/azure/virtual-desktop/toc.json&bc=/azure/virtual-desktop/breadcrumb/toc.json">Thin client support</a></li>
</ul>
</li>
<li>If you want to configure Start VM on Connect using PowerShell, you’ll need to have <a target="_blank" rel="noopener" href="https://www.powershellgallery.com/packages/Az.DesktopVirtualization">the Az.DesktopVirtualization PowerShell module</a> (version 2.1.0 or later) installed on the device you use to run the commands.</li>
<li>You must grant Azure Virtual Desktop access to power on session host VMs, check their status, and report diagnostic information. You must have the <code>Microsoft.Authorization/roleAssignments/write</code> permission on your subscriptions in order to assign the role-based access control (RBAC) role for the Azure Virtual Desktop service principal on those subscriptions. This is part of <strong>User Access Administrator</strong> and <strong>Owner</strong> built in roles.</li>
</ul>
<h2 id="Assign-the-Desktop-Virtualization-Power-On-Contributor-role-with-the-Azure-portal"><a href="#Assign-the-Desktop-Virtualization-Power-On-Contributor-role-with-the-Azure-portal" class="headerlink" title="Assign the Desktop Virtualization Power On Contributor role with the Azure portal"></a>Assign the Desktop Virtualization Power On Contributor role with the Azure portal</h2><p>Before you can configure Start VM on Connect, you’ll need to assign the <em>Desktop Virtualization Power On Contributor</em> role-based access control (RBAC) role with your Azure subscription as the assignable scope. Assigning this role at any level lower than your subscription, such as the resource group, host pool, or VM, will prevent Start VM on Connect from working properly. You’ll need to add each Azure subscription as an assignable scope that contains host pools and session host VMs you want to use with Start VM on Connect. This role and assignment will allow Azure Virtual Desktop to power on VMs, check their status, and report diagnostic information in those subscriptions.</p>
<p>To assign the <em>Desktop Virtualization Power On Contributor</em> role with the Azure portal to the Azure Virtual Desktop service principal on the subscription your host pool is deployed to:</p>
<ol>
<li>Open the Azure portal and go to <strong>Subscriptions</strong>. Select a subscription that contains a host pool and session host VMs you want to use with Start VM on Connect.</li>
<li>Select <strong>Access control (IAM)</strong>.</li>
<li>Select the <strong>+ Add</strong> button, then select <strong>Add role assignment</strong> from the drop-down menu.</li>
<li>Select the <strong>Desktop Virtualization Power On Contributor</strong> role and select <strong>Next</strong>.</li>
<li>On the <strong>Members</strong> tab, select <strong>User, group, or service principal</strong>, then select <strong>+Select members</strong>. In the search bar, enter and select either <strong>Azure Virtual Desktop</strong> or <strong>Windows Virtual Desktop</strong>. Which value you have depends on when the <em>Microsoft.DesktopVirtualization</em> resource provider was first registered in your Azure tenant. If you see two entries titled Windows Virtual Desktop, please see the tip below.</li>
<li>Select <strong>Review + assign</strong> to complete the assignment. Repeat this for any other subscriptions that contain host pools and session host VMs you want to use with Start VM on Connect.</li>
</ol>
<p> Tip</p>
<p>The application ID for the service principal is <strong>9cdead84-a844-4324-93f2-b2e6bb768d07</strong>.</p>
<p>If you have an Azure Virtual Desktop (classic) deployment and an Azure Virtual Desktop (Azure Resource Manager) deployment where the <em>Microsoft.DesktopVirtualization</em> resource provider was registered before the display name changed, you will see two apps with the same name of <em>Windows Virtual Desktop</em>. To add the role assignment to the correct service principal, <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-powershell">you can use PowerShell</a> which enables you to specify the application ID:</p>
<p>To assign the <em>Desktop Virtualization Power On Contributor</em> role with PowerShell to the Azure Virtual Desktop service principal on the subscription your host pool is deployed to:</p>
<ol>
<li><p>Open <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/cloud-shell/overview">Azure Cloud Shell</a> with PowerShell as the shell type.</p>
</li>
<li><p>Get the object ID for the service principal (which is unique in each Azure tenant) and store it in a variable:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$objId</span> = (<span class="built_in">Get-AzADServicePrincipal</span> <span class="literal">-AppId</span> <span class="string">&quot;9cdead84-a844-4324-93f2-b2e6bb768d07&quot;</span>).Id</span><br></pre></td></tr></table></figure>
</li>
<li><p>Find the name of the subscription you want to add the role assignment to by listing all that are available to you:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AzSubscription</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Get the subscription ID and store it in a variable, replacing the value for <code>-SubscriptionName</code> with the name of the subscription from the previous step:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$subId</span> = (<span class="built_in">Get-AzSubscription</span> <span class="literal">-SubscriptionName</span> <span class="string">&quot;Microsoft Azure Enterprise&quot;</span>).Id</span><br></pre></td></tr></table></figure>
</li>
<li><p>Add the role assignment:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">New-AzRoleAssignment</span> <span class="literal">-RoleDefinitionName</span> <span class="string">&quot;Desktop Virtualization Power On Contributor&quot;</span> <span class="literal">-ObjectId</span> <span class="variable">$objId</span> <span class="literal">-Scope</span> /subscriptions/<span class="variable">$subId</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Enable-or-disable-Start-VM-on-Connect-1"><a href="#Enable-or-disable-Start-VM-on-Connect-1" class="headerlink" title="Enable or disable Start VM on Connect"></a>Enable or disable Start VM on Connect</h2><p>Now that you’ve assigned the <em>Desktop Virtualization Power On Contributor</em> role to the service principal on your subscriptions, you can configure Start VM on Connect using the Azure portal or PowerShell.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/start-virtual-machine-connect?tabs=azure-portal#tabpanel_1_azure-portal">Portal</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/start-virtual-machine-connect?tabs=azure-portal#tabpanel_1_azure-powershell">PowerShell</a></li>
</ul>
<p>To configure Start VM on Connect using the Azure portal:</p>
<ol>
<li>Sign in to the <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure portal</a>.</li>
<li>In the search bar, enter <em>Azure Virtual Desktop</em> and select the matching service entry.</li>
<li>Select <strong>Host pools</strong>, then select the name of the host pool where you want to enable the setting.</li>
<li>Select <strong>Properties</strong>.</li>
<li>In the configuration section, you’ll see <strong>Start VM on connect</strong>. Select <strong>Yes</strong> to enable it, or <strong>No</strong> to disable it.</li>
<li>Select <strong>Save</strong> to apply the settings.</li>
</ol>
<p> Note</p>
<p>In pooled host pools, Start VM on Connect will start a VM every five minutes at most. If other users try to sign in during this five-minute period while there aren’t any available resources, Start VM on Connect won’t start a new VM. Instead, the users trying to sign in will receive an error message that says, “No resources available.”</p>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><p>If you run into any issues with Start VM On Connect, we recommend you use the Azure Virtual Desktop <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/diagnostics-log-analytics">diagnostics feature</a> to check for problems. If you receive an error message, make sure to pay close attention to the message content and make a note of the error name for reference. You can also use <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/azure-monitor">Azure Monitor for Azure Virtual Desktop</a> to get suggestions for how to resolve issues.</p>
<p>If the session host VM doesn’t turn on, you’ll need to check the health of the VM you tried to turn on as a first step.</p>
<p>For other questions, check out the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/start-virtual-machine-connect-faq">Start VM on Connect FAQ</a>.</p>
<h1 id="Configure-the-personal-desktop-host-pool-assignment-type"><a href="#Configure-the-personal-desktop-host-pool-assignment-type" class="headerlink" title="Configure the personal desktop host pool assignment type"></a>Configure the personal desktop host pool assignment type</h1><p> Important</p>
<p>This content applies to Azure Virtual Desktop with Azure Resource Manager Azure Virtual Desktop objects. If you’re using Azure Virtual Desktop (classic) without Azure Resource Manager objects, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/virtual-desktop-fall-2019/configure-host-pool-personal-desktop-assignment-type-2019">this article</a>.</p>
<p>You can configure the assignment type of your personal desktop host pool to adjust your Azure Virtual Desktop environment to better suit your needs. In this topic, we’ll show you how to configure automatic or direct assignment for your users.</p>
<p> Note</p>
<p>The instructions in this article only apply to personal desktop host pools, not pooled host pools, since users in pooled host pools aren’t assigned to specific session hosts.</p>
<h2 id="Prerequisites-1"><a href="#Prerequisites-1" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>This article assumes you’ve already downloaded and installed the Azure Virtual Desktop PowerShell module. If you haven’t, follow the instructions in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/powershell-module">Set up the PowerShell module</a>.</p>
<h2 id="Personal-host-pools-overview"><a href="#Personal-host-pools-overview" class="headerlink" title="Personal host pools overview"></a>Personal host pools overview</h2><p>A personal host pool is a type of host pool that has personal desktops. Personal desktops have one-to-one mapping, which means a single user can only be assigned to a single personal desktop. Every time the user signs in, their user session is directed to their assigned personal desktop session host. This host pool type is ideal for customers with resource-intensive workloads because user experience and session performance will improve if there’s only one session on the session host. Another benefit of this host pool type is that user activities, files, and settings persist on the virtual machine operating system (VM OS) disk after the user signs out.</p>
<p>Users must be assigned to a personal desktop to start their session. There are two types of assignments in a personal host pool: automatic assignment and direct assignment.</p>
<h2 id="Configure-automatic-assignment"><a href="#Configure-automatic-assignment" class="headerlink" title="Configure automatic assignment"></a>Configure automatic assignment</h2><p>Automatic assignment is the default assignment type for new personal desktop host pools created in your Azure Virtual Desktop environment. Automatically assigning users doesn’t require a specific session host.</p>
<p>To automatically assign users, first assign them to the personal desktop host pool so that they can see the desktop in their feed. When an assigned user launches the desktop in their feed, their user session will be load-balanced to an available session host if they haven’t already connected to the host pool.</p>
<p>To configure a host pool to automatically assign users to VMs, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-AzWvdHostPool</span> <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-Name</span> &lt;hostpoolname&gt; <span class="literal">-PersonalDesktopAssignmentType</span> Automatic</span><br></pre></td></tr></table></figure>

<p>To assign a user to the personal desktop host pool, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">New-AzRoleAssignment</span> <span class="literal">-SignInName</span> &lt;userupn&gt; <span class="literal">-RoleDefinitionName</span> <span class="string">&quot;Desktop Virtualization User&quot;</span> <span class="literal">-ResourceName</span> &lt;appgroupname&gt; <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-ResourceType</span> <span class="string">&#x27;Microsoft.DesktopVirtualization/applicationGroups&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Configure-direct-assignment"><a href="#Configure-direct-assignment" class="headerlink" title="Configure direct assignment"></a>Configure direct assignment</h2><p>Unlike automatic assignment, when you use direct assignment, you must assign the user to both the personal desktop host pool and a specific session host before they can connect to their personal desktop. If the user is only assigned to a host pool without a session host assignment, they won’t be able to access resources and will see an error message that says, “No resources available.”</p>
<p>To configure a host pool to require direct assignment of users to session hosts, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-AzWvdHostPool</span> <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-Name</span> &lt;hostpoolname&gt; <span class="literal">-PersonalDesktopAssignmentType</span> Direct</span><br></pre></td></tr></table></figure>

<p>To assign a user to the personal desktop host pool, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">New-AzRoleAssignment</span> <span class="literal">-SignInName</span> &lt;userupn&gt; <span class="literal">-RoleDefinitionName</span> <span class="string">&quot;Desktop Virtualization User&quot;</span> <span class="literal">-ResourceName</span> &lt;appgroupname&gt; <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-ResourceType</span> <span class="string">&#x27;Microsoft.DesktopVirtualization/applicationGroups&#x27;</span></span><br></pre></td></tr></table></figure>

<p>To assign a user to a specific session host, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-AzWvdSessionHost</span> <span class="literal">-HostPoolName</span> &lt;hostpoolname&gt; <span class="literal">-Name</span> &lt;sessionhostname&gt; <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-AssignedUser</span> &lt;userupn&gt;</span><br></pre></td></tr></table></figure>

<p>To directly assign a user to a session host in the Azure portal:</p>
<ol>
<li>Sign in to the <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure portal</a>.</li>
<li>Enter <strong>Azure Virtual Desktop</strong> into the search bar.</li>
<li>Under <strong>Services</strong>, select <strong>Azure Virtual Desktop</strong>.</li>
<li>At the Azure Virtual Desktop page, go the menu on the left side of the window and select <strong>Host pools</strong>.</li>
<li>Select the host pool you want to assign users to.</li>
<li>Next, go to the menu on the left side of the window and select <strong>Application groups</strong>.</li>
<li>Select the name of the app group you want to assign users to, then select <strong>Assignments</strong> in the menu on the left side of the window.</li>
<li>Select <strong>+ Add</strong>, then select the users or user groups you want to assign to this app group.</li>
<li>Select <strong>Assign VM</strong> in the Information bar to assign a session host to a user.</li>
<li>Select the session host you want to assign to the user, then select <strong>Assign</strong>. You can also select <strong>Assignment</strong> &gt; <strong>Assign user</strong>.</li>
<li>Select the user you want to assign the session host to from the list of available users.</li>
<li>When you’re done, select <strong>Select</strong>.</li>
</ol>
<h2 id="How-to-unassign-a-personal-desktop"><a href="#How-to-unassign-a-personal-desktop" class="headerlink" title="How to unassign a personal desktop"></a>How to unassign a personal desktop</h2><p>To unassign a personal desktop, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-AzWvdSessionHost</span> <span class="literal">-HostPoolName</span> &lt;hostpoolname&gt; <span class="literal">-Name</span> &lt;sessionhostname&gt; <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-AssignedUser</span> <span class="string">&quot;&quot;</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure>

<p> Important</p>
<ul>
<li>Azure Virtual Desktop will not delete any VHD or profile data for unassigned personal desktops.</li>
<li>You must include the <em>-Force</em> parameter when running the PowerShell cmdlet to unassign a personal desktop. If you don’t include the <em>-Force</em> parameter, you’ll receive an error message.</li>
<li>There must be no existing user sessions on the session host when you unassign the user from the personal desktop. If there’s an existing user session on the session host while you’re unassigning it, you won’t be able to unassign the personal desktop successfully.</li>
<li>If the session host has no user assignment, nothing will happen when you run this cmdlet.</li>
</ul>
<p>To unassign a personal desktop in the Azure portal:</p>
<ol>
<li><p>Sign in to the <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure portal</a>.</p>
</li>
<li><p>Enter <strong>Azure Virtual Desktop</strong> into the search bar.</p>
</li>
<li><p>Under <strong>Services</strong>, select <strong>Azure Virtual Desktop</strong>.</p>
</li>
<li><p>At the Azure Virtual Desktop page, go the menu on the left side of the window and select <strong>Host pools</strong>.</p>
</li>
<li><p>Select the host pool you want to modify user assignment for.</p>
</li>
<li><p>Next, go to the menu on the left side of the window and select <strong>Session hosts</strong>.</p>
</li>
<li><p>Select the checkbox next to the session host you want to unassign a user from, select the ellipses at the end of the row, and then select <strong>Unassign user</strong>. You can also select <strong>Assignment</strong> &gt; <strong>Unassign user</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/unassign.png" alt="A screenshot of the unassign user menu option from the ellipses menu for unassigning a personal desktop."></p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/unassign-2.png" alt="A screenshot of the unassign user menu option from the assignment menu for unassigning a personal desktop."></p>
</li>
<li><p>Select <strong>Unassign</strong> when prompted with the warning.</p>
</li>
</ol>
<h2 id="How-to-reassign-a-personal-desktop"><a href="#How-to-reassign-a-personal-desktop" class="headerlink" title="How to reassign a personal desktop"></a>How to reassign a personal desktop</h2><p>To reassign a personal desktop, run the following PowerShell cmdlet:</p>
<p>PowerShellCopy</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-AzWvdSessionHost</span> <span class="literal">-HostPoolName</span> &lt;hostpoolname&gt; <span class="literal">-Name</span> &lt;sessionhostname&gt; <span class="literal">-ResourceGroupName</span> &lt;resourcegroupname&gt; <span class="literal">-AssignedUser</span> &lt;userupn&gt; <span class="literal">-Force</span></span><br></pre></td></tr></table></figure>

<p> Important</p>
<ul>
<li>Azure Virtual Desktop will not delete any VHD or profile data for reassigned personal desktops.</li>
<li>You must include the <em>-Force</em> parameter when running the PowerShell cmdlet to reassign a personal desktop. If you don’t include the <em>-Force</em> parameter, you’ll receive an error message.</li>
<li>There must be no existing user sessions on the session host when you reassign a personal desktop. If there’s an existing user session on the session host while you’re reassigning it, you won’t be able to reassign the personal desktop successfully.</li>
<li>If the user principal name (UPN) you enter for the <em>-AssignedUser</em> parameter is the same as the UPN currently assigned to the personal desktop, the cmdlet won’t do anything.</li>
<li>If the session host currently has no user assignment, the personal desktop will be assigned to the provided UPN.</li>
</ul>
<p>To reassign a personal desktop in the Azure portal:</p>
<ol>
<li><p>Sign in to the <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure portal</a>.</p>
</li>
<li><p>Enter <strong>Azure Virtual Desktop</strong> into the search bar.</p>
</li>
<li><p>Under <strong>Services</strong>, select <strong>Azure Virtual Desktop</strong>.</p>
</li>
<li><p>At the Azure Virtual Desktop page, go the menu on the left side of the window and select <strong>Host pools</strong>.</p>
</li>
<li><p>Select the host pool you want to modify user assignment for.</p>
</li>
<li><p>Next, go to the menu on the left side of the window and select <strong>Session hosts</strong>.</p>
</li>
<li><p>Select the checkbox next to the session host you want to reassign to a different user, select the ellipses at the end of the row, and then select <strong>Assign to a different user</strong>. You can also select <strong>Assignment</strong> &gt; <strong>Assign to a different user</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/reassign-doc.png" alt="A screenshot of the assign to a different user menu option from the ellipses menu for reassigning a personal desktop."></p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/reassign.png" alt="A screenshot of the assign to a different user menu option from the assignment menu for reassigning a personal desktop."></p>
</li>
<li><p>Select the user you want to assign the session host to from the list of available users.</p>
</li>
<li><p>When you’re done, select <strong>Select</strong>.</p>
</li>
</ol>
<h1 id="Use-Log-Analytics-for-the-diagnostics-feature"><a href="#Use-Log-Analytics-for-the-diagnostics-feature" class="headerlink" title="Use Log Analytics for the diagnostics feature"></a>Use Log Analytics for the diagnostics feature</h1><p> Important</p>
<p>This content applies to Azure Virtual Desktop with Azure Resource Manager Azure Virtual Desktop objects. If you’re using Azure Virtual Desktop (classic) without Azure Resource Manager objects, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/virtual-desktop-fall-2019/diagnostics-log-analytics-2019">this article</a>.</p>
<p>Azure Virtual Desktop uses <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/overview">Azure Monitor</a> for monitoring and alerts like many other Azure services. This lets admins identify issues through a single interface. The service creates activity logs for both user and administrative actions. Each activity log falls under the following categories:</p>
<ul>
<li>Management Activities:<ul>
<li>Track whether attempts to change Azure Virtual Desktop objects using APIs or PowerShell are successful. For example, can someone successfully create a host pool using PowerShell?</li>
</ul>
</li>
<li>Feed:<ul>
<li>Can users successfully subscribe to workspaces?</li>
<li>Do users see all resources published in the Remote Desktop client?</li>
</ul>
</li>
<li>Connections:<ul>
<li>When users initiate and complete connections to the service.</li>
</ul>
</li>
<li>Host registration:<ul>
<li>Was the session host successfully registered with the service upon connecting?</li>
</ul>
</li>
<li>Errors:<ul>
<li>Are users encountering any issues with specific activities? This feature can generate a table that tracks activity data for you as long as the information is joined with the activities.</li>
</ul>
</li>
<li>Checkpoints:<ul>
<li>Specific steps in the lifetime of an activity that were reached. For example, during a session, a user was load balanced to a particular host, then the user was signed on during a connection, and so on.</li>
</ul>
</li>
<li>Agent Health Status:<ul>
<li>Monitor the health and status of the Azure Virtual Desktop agent installed on each session host. For example, verify that the agents are up to date, or whether the agent is in a healthy state and ready to accept new user sessions.</li>
</ul>
</li>
<li>Connection Network Data:<ul>
<li>Track the average network data for user sessions to monitor for details including the estimated round trip time and available bandwidth throughout their connection.</li>
</ul>
</li>
</ul>
<p>Connections that don’t reach Azure Virtual Desktop won’t show up in diagnostics results because the diagnostics role service itself is part of Azure Virtual Desktop. Azure Virtual Desktop connection issues can happen when the user is experiencing network connectivity issues.</p>
<p>Azure Monitor lets you analyze Azure Virtual Desktop data and review virtual machine (VM) performance counters, all within the same tool. This article will tell you more about how to enable diagnostics for your Azure Virtual Desktop environment.</p>
<p> Note</p>
<p>To learn how to monitor your VMs in Azure, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/vm/monitor-vm-azure">Monitoring Azure virtual machines with Azure Monitor</a>. Also, make sure to review the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/azure-monitor-glossary">Azure Monitor glossary</a> for a better understanding of your user experience on the session host.</p>
<h2 id="Before-you-get-started"><a href="#Before-you-get-started" class="headerlink" title="Before you get started"></a>Before you get started</h2><p>Before you can use Log Analytics, you’ll need to create a workspace. To do that, follow the instructions in one of the following two articles:</p>
<ul>
<li>If you prefer using Azure portal, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/quick-create-workspace">Create a Log Analytics workspace in Azure portal</a>.</li>
<li>If you prefer PowerShell, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/powershell-workspace-configuration">Create a Log Analytics workspace with PowerShell</a>.</li>
</ul>
<p>After you’ve created your workspace, follow the instructions in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/agents/agent-windows#workspace-id-and-key">Connect Windows computers to Azure Monitor</a> to get the following information:</p>
<ul>
<li>The workspace ID</li>
<li>The primary key of your workspace</li>
</ul>
<p>You’ll need this information later in the setup process.</p>
<p>Make sure to review permission management for Azure Monitor to enable data access for those who monitor and maintain your Azure Virtual Desktop environment. For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/roles-permissions-security">Get started with roles, permissions, and security with Azure Monitor</a>.</p>
<h2 id="Push-diagnostics-data-to-your-workspace"><a href="#Push-diagnostics-data-to-your-workspace" class="headerlink" title="Push diagnostics data to your workspace"></a>Push diagnostics data to your workspace</h2><p>You can push diagnostics data from your Azure Virtual Desktop objects into the Log Analytics for your workspace. You can set up this feature right away when you first create your objects.</p>
<p>To set up Log Analytics for a new object:</p>
<ol>
<li><p>Sign in to the Azure portal and go to <strong>Azure Virtual Desktop</strong>.</p>
</li>
<li><p>Navigate to the object (such as a host pool, app group, or workspace) that you want to capture logs and events for.</p>
</li>
<li><p>Select <strong>Diagnostic settings</strong> in the menu on the left side of the screen.</p>
</li>
<li><p>Select <strong>Add diagnostic setting</strong> in the menu that appears on the right side of the screen.</p>
<p>The options shown in the Diagnostic Settings page will vary depending on what kind of object you’re editing.</p>
<p>For example, when you’re enabling diagnostics for an app group, you’ll see options to configure checkpoints, errors, and management. For workspaces, these categories configure a feed to track when users subscribe to the list of apps. To learn more about diagnostic settings see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings">Create diagnostic setting to collect resource logs and metrics in Azure</a>.</p>
<p> Important</p>
<p>Remember to enable diagnostics for each Azure Resource Manager object that you want to monitor. Data will be available for activities after diagnostics has been enabled. It might take a few hours after first set-up.</p>
</li>
<li><p>Enter a name for your settings configuration, then select <strong>Send to Log Analytics</strong>. The name you use shouldn’t have spaces and should conform to <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/resource-name-rules">Azure naming conventions</a>. As part of the logs, you can select all the options that you want added to your Log Analytics, such as Checkpoint, Error, Management, and so on.</p>
</li>
<li><p>Select <strong>Save</strong>.</p>
</li>
</ol>
<p> Note</p>
<p>Log Analytics gives you the option to stream data to <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/event-hubs/event-hubs-about">Event Hubs</a> or archive it in a storage account. To learn more about this feature, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/stream-monitoring-data-event-hubs">Stream Azure monitoring data to an event hub</a> and <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/resource-logs#send-to-azure-storage">Archive Azure resource logs to storage account</a>.</p>
<h2 id="How-to-access-Log-Analytics"><a href="#How-to-access-Log-Analytics" class="headerlink" title="How to access Log Analytics"></a>How to access Log Analytics</h2><p>You can access Log Analytics workspaces on the Azure portal or Azure Monitor.</p>
<h3 id="Access-Log-Analytics-on-a-Log-Analytics-workspace"><a href="#Access-Log-Analytics-on-a-Log-Analytics-workspace" class="headerlink" title="Access Log Analytics on a Log Analytics workspace"></a>Access Log Analytics on a Log Analytics workspace</h3><ol>
<li>Sign in to the Azure portal.</li>
<li>Search for <strong>Log Analytics workspace</strong>.</li>
<li>Under Services, select <strong>Log Analytics workspaces</strong>.</li>
<li>From the list, select the workspace you configured for your Azure Virtual Desktop object.</li>
<li>Once in your workspace, select <strong>Logs</strong>. You can filter out your menu list with the <strong>Search</strong> function.</li>
</ol>
<h3 id="Access-Log-Analytics-on-Azure-Monitor"><a href="#Access-Log-Analytics-on-Azure-Monitor" class="headerlink" title="Access Log Analytics on Azure Monitor"></a>Access Log Analytics on Azure Monitor</h3><ol>
<li>Sign into the Azure portal</li>
<li>Search for and select <strong>Monitor</strong>.</li>
<li>Select <strong>Logs</strong>.</li>
<li>Follow the instructions in the logging page to set the scope of your query.</li>
<li>You are ready to query diagnostics. All diagnostics tables have a “WVD” prefix.</li>
</ol>
<p> Note</p>
<p>For more detailed information about the tables stored in Azure Monitor Logs, see the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/tables-category#azure-virtual-desktop">Azure Monitor data reference</a>. All tables related to Azure Virtual Desktop are prefixed with “WVD.”</p>
<h2 id="Cadence-for-sending-diagnostic-events"><a href="#Cadence-for-sending-diagnostic-events" class="headerlink" title="Cadence for sending diagnostic events"></a>Cadence for sending diagnostic events</h2><p>Diagnostic events are sent to Log Analytics when completed.</p>
<p>Log Analytics only reports in these intermediate states for connection activities:</p>
<ul>
<li>Started: when a user selects and connects to an app or desktop in the Remote Desktop client.</li>
<li>Connected: when the user successfully connects to the VM where the app or desktop is hosted.</li>
<li>Completed: when the user or server disconnects the session the activity took place in.</li>
</ul>
<h2 id="Example-queries"><a href="#Example-queries" class="headerlink" title="Example queries"></a>Example queries</h2><p>Access example queries through the Azure Monitor Log Analytics UI:</p>
<ol>
<li>Go to your Log Analytics workspace, and then select <strong>Logs</strong>. The example query UI is shown automatically.</li>
<li>Change the filter to <strong>Category</strong>.</li>
<li>Select <strong>Azure Virtual Desktop</strong> to review available queries.</li>
<li>Select <strong>Run</strong> to run the selected query.</li>
</ol>
<p>Learn more about the sample query interface in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/queries">Saved queries in Azure Monitor Log Analytics</a>.</p>
<p>The following query list lets you review connection information or issues for a single user. You can run these queries in the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-tutorial#write-a-query">Log Analytics query editor</a>. For each query, replace <code>userupn</code> with the UPN of the user you want to look up.</p>
<p>To find all connections for a single user:</p>
<p>KustoCopy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WVDConnections</span><br><span class="line">|where UserName == &quot;userupn&quot;</span><br><span class="line">|take 100</span><br><span class="line">|sort by TimeGenerated asc, CorrelationId</span><br></pre></td></tr></table></figure>

<p>To find the number of times a user connected per day:</p>
<p>KustoCopy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WVDConnections</span><br><span class="line">|where UserName == &quot;userupn&quot;</span><br><span class="line">|take 100</span><br><span class="line">|sort by TimeGenerated asc, CorrelationId</span><br><span class="line">|summarize dcount(CorrelationId) by bin(TimeGenerated, 1d)</span><br></pre></td></tr></table></figure>

<p>To find session duration by user:</p>
<p>KustoCopy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">let Events = WVDConnections | where UserName == &quot;userupn&quot; ;</span><br><span class="line">Events</span><br><span class="line">| where State == &quot;Connected&quot;</span><br><span class="line">| project CorrelationId , UserName, ResourceAlias , StartTime=TimeGenerated</span><br><span class="line">| join (Events</span><br><span class="line">| where State == &quot;Completed&quot;</span><br><span class="line">| project EndTime=TimeGenerated, CorrelationId)</span><br><span class="line">on CorrelationId</span><br><span class="line">| project Duration = EndTime - StartTime, ResourceAlias</span><br><span class="line">| sort by Duration asc</span><br></pre></td></tr></table></figure>

<p>To find errors for a specific user:</p>
<p>KustoCopy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WVDErrors</span><br><span class="line">| where UserName == &quot;userupn&quot;</span><br><span class="line">|take 100</span><br></pre></td></tr></table></figure>

<p>To find out whether a specific error occurred for other users:</p>
<p>KustoCopy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WVDErrors</span><br><span class="line">| where CodeSymbolic ==&quot;ErrorSymbolicCode&quot;</span><br><span class="line">| summarize count(UserName) by CodeSymbolic</span><br></pre></td></tr></table></figure>

<p> Note</p>
<ul>
<li>When a user launches a full desktop session, their app usage in the session isn’t tracked as checkpoints in the <code>WVDCheckpoints</code> table.</li>
<li>The <code>ResourcesAlias</code> column in the <code>WVDConnections</code> table shows whether a user has connected to a full desktop or a published app. The column only shows the first app they open during the connection. Any published apps the user opens are tracked in <code>WVDCheckpoints</code>.</li>
<li>The <code>WVDErrors</code> table shows you management errors, host registration issues, and other issues that happen while the user subscribes to a list of apps or desktops.</li>
<li>The <code>WVDErrors</code> table also helps you to identify issues that can be resolved by admin tasks. The value on <code>ServiceError</code> should always equal <code>false</code> for these types of issues. If <code>ServiceError</code> equals <code>true</code>, you’ll need to escalate the issue to Microsoft. Ensure you provide the <em>CorrelationID</em> for errors you escalate.</li>
<li>When debugging connectivity issues, in some cases client information might be missing even if the connection events completes. This applies to the <code>WVDConnections</code> and <code>WVDCheckpoints</code> tables.</li>
</ul>
<h1 id="Use-Azure-Monitor-for-Azure-Virtual-Desktop-to-monitor-your-deployment"><a href="#Use-Azure-Monitor-for-Azure-Virtual-Desktop-to-monitor-your-deployment" class="headerlink" title="Use Azure Monitor for Azure Virtual Desktop to monitor your deployment"></a>Use Azure Monitor for Azure Virtual Desktop to monitor your deployment</h1><p>Azure Monitor for Azure Virtual Desktop is a dashboard built on Azure Monitor Workbooks that helps IT professionals understand their Azure Virtual Desktop environments. This topic will walk you through how to set up Azure Monitor for Azure Virtual Desktop to monitor your Azure Virtual Desktop environments.</p>
<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><p>Before you start using Azure Monitor for Azure Virtual Desktop, you’ll need to set up the following things:</p>
<ul>
<li>All Azure Virtual Desktop environments you monitor must be based on the latest release of Azure Virtual Desktop that’s compatible with Azure Resource Manager.</li>
<li>At least one configured Log Analytics Workspace. Use a designated Log Analytics workspace for your Azure Virtual Desktop session hosts to ensure that performance counters and events are only collected from session hosts in your Azure Virtual Desktop deployment.</li>
<li>Enable data collection for the following things in your Log Analytics workspace:<ul>
<li>Diagnostics from your Azure Virtual Desktop environment</li>
<li>Recommended performance counters from your Azure Virtual Desktop session hosts</li>
<li>Recommended Windows Event Logs from your Azure Virtual Desktop session hosts</li>
</ul>
</li>
</ul>
<p>The data setup process described in this article is the only one you’ll need to monitor Azure Virtual Desktop. You can disable all other items sending data to your Log Analytics workspace to save costs.</p>
<p>Anyone monitoring Azure Monitor for Azure Virtual Desktop for your environment will also need the following read-access permissions:</p>
<ul>
<li>Read-access to the Azure resource groups that hold your Azure Virtual Desktop resources.</li>
<li>Read-access to the subscription’s resource groups that hold your Azure Virtual Desktop session hosts.</li>
<li>Read access to the Log Analytics workspace. In the case that multiple Log Analytics workspaces are used, read access should be granted to each to allow viewing data.</li>
</ul>
<p> Note</p>
<p>Read access only lets admins view data. They’ll need different permissions to manage resources in the Azure Virtual Desktop portal.</p>
<h2 id="Open-Azure-Monitor-for-Azure-Virtual-Desktop"><a href="#Open-Azure-Monitor-for-Azure-Virtual-Desktop" class="headerlink" title="Open Azure Monitor for Azure Virtual Desktop"></a>Open Azure Monitor for Azure Virtual Desktop</h2><p>You can open Azure Monitor for Azure Virtual Desktop with one of the following methods:</p>
<ul>
<li>Go to <a target="_blank" rel="noopener" href="https://aka.ms/avdi">aka.ms&#x2F;avdi</a>.</li>
<li>Search for and select <strong>Azure Virtual Desktop</strong> from the Azure portal, then select <strong>Insights</strong>.</li>
<li>Search for and select <strong>Azure Monitor</strong> from the Azure portal. Select <strong>Insights Hub</strong> under <strong>Insights</strong>, then select <strong>Azure Virtual Desktop</strong>. Once you have the page open, enter the <strong>Subscription</strong>, <strong>Resource group</strong>, <strong>Host pool</strong>, and <strong>Time range</strong> of the environment you want to monitor.</li>
</ul>
<p> Note</p>
<p>Azure Virtual Desktop currently only supports monitoring one subscription, resource group, and host pool at a time. If you can’t find the environment you want to monitor, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/troubleshoot-azure-monitor">our troubleshooting documentation</a> for known feature requests and issues.</p>
<h2 id="Log-Analytics-settings"><a href="#Log-Analytics-settings" class="headerlink" title="Log Analytics settings"></a>Log Analytics settings</h2><p>To start using Azure Monitor for Azure Virtual Desktop, you’ll need at least one Log Analytics workspace. Use a designated Log Analytics workspace for your Azure Virtual Desktop session hosts to ensure that performance counters and events are only collected form session hosts in your Azure Virtual Desktop deployment. If you already have a workspace set up, skip ahead to <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/azure-monitor#set-up-using-the-configuration-workbook">Set up using the configuration workbook</a>. To set one up, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/quick-create-workspace">Create a Log Analytics workspace in the Azure portal</a>.</p>
<p> Note</p>
<p>Standard data storage charges for Log Analytics will apply. To start, we recommend you choose the pay-as-you-go model and adjust as you scale your deployment and take in more data. To learn more, see <a target="_blank" rel="noopener" href="https://azure.microsoft.com/pricing/details/monitor/">Azure Monitor pricing</a>.</p>
<h2 id="Set-up-using-the-configuration-workbook"><a href="#Set-up-using-the-configuration-workbook" class="headerlink" title="Set up using the configuration workbook"></a>Set up using the configuration workbook</h2><p>If it’s your first time opening Azure Monitor for Azure Virtual Desktop, you’ll need set up Azure Monitor for your Azure Virtual Desktop environment. To configure your resources:</p>
<ol>
<li>Open Azure Monitor for Azure Virtual Desktop in the Azure portal at <a target="_blank" rel="noopener" href="https://aka.ms/avdi">aka.ms&#x2F;avdi</a>, then select <strong>configuration workbook</strong>.</li>
<li>Select an environment to configure under <strong>Subscription</strong>, <strong>Resource Group</strong>, and <strong>Host Pool</strong>.</li>
</ol>
<p>The configuration workbook sets up your monitoring environment and lets you check the configuration after you’ve finished the setup process. It’s important to check your configuration if items in the dashboard aren’t displaying correctly, or when the product group publishes updates that require new settings.</p>
<h3 id="Resource-diagnostic-settings"><a href="#Resource-diagnostic-settings" class="headerlink" title="Resource diagnostic settings"></a>Resource diagnostic settings</h3><p>To collect information on your Azure Virtual Desktop infrastructure, you’ll need to enable several diagnostic settings on your Azure Virtual Desktop host pools and workspaces (this is your Azure Virtual Desktop workspace, not your Log Analytics workspace). To learn more about host pools, workspaces, and other Azure Virtual Desktop resource objects, see our <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/environment-setup">environment guide</a>.</p>
<p>You can learn more about Azure Virtual Desktop diagnostics and the supported diagnostic tables at <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/diagnostics-log-analytics">Send Azure Virtual Desktop diagnostics to Log Analytics</a>.</p>
<p>To set your resource diagnostic settings in the configuration workbook:</p>
<ol>
<li>Select the <strong>Resource diagnostic settings</strong> tab in the configuration workbook.</li>
<li>Select <strong>Log Analytics workspace</strong> to send Azure Virtual Desktop diagnostics.</li>
</ol>
<h4 id="Host-pool-diagnostic-settings"><a href="#Host-pool-diagnostic-settings" class="headerlink" title="Host pool diagnostic settings"></a>Host pool diagnostic settings</h4><p>To set up host pool diagnostics using the resource diagnostic settings section in the configuration workbook:</p>
<ol>
<li><p>Under <strong>Host pool</strong>, check to see whether Azure Virtual Desktop diagnostics are enabled. If they aren’t, an error message will appear that says “No existing diagnostic configuration was found for the selected host pool.” You’ll need to enable the following supported diagnostic tables:</p>
<ul>
<li>Checkpoint</li>
<li>Error</li>
<li>Management</li>
<li>Connection</li>
<li>HostRegistration</li>
<li>AgentHealthStatus</li>
</ul>
<p> Note</p>
<p>If you don’t see the error message, you don’t need to do steps 2 through 4.</p>
</li>
<li><p>Select <strong>Configure host pool</strong>.</p>
</li>
<li><p>Select <strong>Deploy</strong>.</p>
</li>
<li><p>Refresh the configuration workbook.</p>
</li>
</ol>
<h4 id="Workspace-diagnostic-settings"><a href="#Workspace-diagnostic-settings" class="headerlink" title="Workspace diagnostic settings"></a>Workspace diagnostic settings</h4><p>To set up workspace diagnostics using the resource diagnostic settings section in the configuration workbook:</p>
<ol>
<li><p>Under <strong>Workspace</strong>, check to see whether Azure Virtual Desktop diagnostics are enabled for the Azure Virtual Desktop workspace. If they aren’t, an error message will appear that says “No existing diagnostic configuration was found for the selected workspace.” You’ll need to enable the following supported diagnostics tables:</p>
<ul>
<li>Checkpoint</li>
<li>Error</li>
<li>Management</li>
<li>Feed</li>
</ul>
<p> Note</p>
<p>If you don’t see the error message, you don’t need to do steps 2-4.</p>
</li>
<li><p>Select <strong>Configure workspace</strong>.</p>
</li>
<li><p>Select <strong>Deploy</strong>.</p>
</li>
<li><p>Refresh the configuration workbook.</p>
</li>
</ol>
<h3 id="Session-host-data-settings"><a href="#Session-host-data-settings" class="headerlink" title="Session host data settings"></a>Session host data settings</h3><p>To collect information on your Azure Virtual Desktop session hosts, you’ll need to install the Log Analytics agent on all session hosts in the host pool, make sure the session hosts are sending to a Log Analytics workspace, and configure your Log Analytics agent settings to collect performance data and Windows Event Logs.</p>
<p>The Log Analytics workspace you send session host data to doesn’t have to be the same one you send diagnostic data to. If you have Azure session hosts outside of your Azure Virtual Desktop environment, we recommend having a designated Log Analytics workspace for the Azure Virtual Desktop session hosts.</p>
<p>To set the Log Analytics workspace where you want to collect session host data:</p>
<ol>
<li>Select the <strong>Session host data settings</strong> tab in the configuration workbook.</li>
<li>Select the <strong>Log Analytics workspace</strong> you want to send session host data to.</li>
</ol>
<h4 id="Session-hosts"><a href="#Session-hosts" class="headerlink" title="Session hosts"></a>Session hosts</h4><p>You’ll need to install the Log Analytics agent on all session hosts in the host pool and send data from those hosts to your selected Log Analytics workspace. If Log Analytics isn’t configured for all the session hosts in the host pool, you’ll see a <strong>Session hosts</strong> section at the top of <strong>Session host data settings</strong> with the message “Some hosts in the host pool are not sending data to the selected Log Analytics workspace.”</p>
<p> Note</p>
<p>If you don’t see the <strong>Session hosts</strong> section or error message, all session hosts are set up correctly. Skip ahead to set up instructions for <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/azure-monitor#workspace-performance-counters">Workspace performance counters</a>. Currently automated deployment is limited to 1000 session hosts or fewer.</p>
<p>To set up your remaining session hosts using the configuration workbook:</p>
<ol>
<li>Select <strong>Add hosts to workspace</strong>.</li>
<li>Refresh the configuration workbook.</li>
</ol>
<p> Note</p>
<p>For larger host pools (&gt; 1000 session hosts), or if there are deployment issues, it is recommended to install the Log Analytics agent at <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-machines/extensions/oms-windows#extension-schema">time of session host creation</a> through the use of an ARM template.</p>
<h4 id="Workspace-performance-counters"><a href="#Workspace-performance-counters" class="headerlink" title="Workspace performance counters"></a>Workspace performance counters</h4><p>You’ll need to enable specific performance counters to collect performance information from your session hosts and send it to the Log Analytics workspace.</p>
<p>If you already have performance counters enabled and want to remove them, follow the instructions in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-sources-performance-counters">Configuring performance counters</a>. You can add and remove performance counters in the same location.</p>
<p>To set up performance counters using the configuration workbook:</p>
<ol>
<li>Under <strong>Workspace performance counters</strong> in the configuration workbook, check <strong>Configured counters</strong> to see the counters you’ve already enabled to send to the Log Analytics workspace. Check <strong>Missing counters</strong> to make sure you’ve enabled all required counters.</li>
<li>If you have missing counters, select <strong>Configure performance counters</strong>.</li>
<li>Select <strong>Apply Config</strong>.</li>
<li>Refresh the configuration workbook.</li>
<li>Make sure all the required counters are enabled by checking the <strong>Missing counters</strong> list.</li>
</ol>
<h4 id="Configure-Windows-Event-Logs"><a href="#Configure-Windows-Event-Logs" class="headerlink" title="Configure Windows Event Logs"></a>Configure Windows Event Logs</h4><p>You’ll also need to enable specific Windows Event Logs to collect errors, warnings, and information from the session hosts and send them to the Log Analytics workspace.</p>
<p>If you’ve already enabled Windows Event Logs and want to remove them, follow the instructions in <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-sources-windows-events#configure-windows-event-logs">Configuring Windows Event Logs</a>. You can add and remove Windows Event Logs in the same location.</p>
<p>To set up Windows Event Logs using the configuration workbook:</p>
<ol>
<li>Under <strong>Windows Event Logs configuration</strong>, check <strong>Configured Event Logs</strong> to see the Event Logs you’ve already enabled to send to the Log Analytics workspace. Check <strong>Missing Event Logs</strong> to make sure you’ve enabled all Windows Event Logs.</li>
<li>If you have missing Windows Event Logs, select <strong>Configure Events</strong>.</li>
<li>Select <strong>Deploy</strong>.</li>
<li>Refresh the configuration workbook.</li>
<li>Make sure all the required Windows Event Logs are enabled by checking the <strong>Missing Event Logs</strong> list.</li>
</ol>
<p> Note</p>
<p>If automatic event deployment fails, select <strong>Open agent configuration</strong> in the configuration workbook to manually add any missing Windows Event Logs.</p>
<h2 id="Optional-configure-alerts"><a href="#Optional-configure-alerts" class="headerlink" title="Optional: configure alerts"></a>Optional: configure alerts</h2><p>Azure Monitor for Azure Virtual Desktop allows you to monitor Azure Monitor alerts happening within your selected subscription in the context of your Azure Virtual Desktop data. Azure Monitor alerts are an optional feature on your Azure subscriptions, and you need to set them up separately from Azure Monitor for Azure Virtual Desktop. You can use the Azure Monitor alerts framework to set custom alerts on Azure Virtual Desktop events, diagnostics, and resources. To learn more about Azure Monitor alerts, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-log">Azure Monitor Log Alerts</a>.</p>
<h2 id="Diagnostic-and-usage-data"><a href="#Diagnostic-and-usage-data" class="headerlink" title="Diagnostic and usage data"></a>Diagnostic and usage data</h2><p>Microsoft automatically collects usage and performance data through your use of the Azure Monitor service. Microsoft uses this data to improve the quality, security, and integrity of the service.</p>
<p>To provide accurate and efficient troubleshooting capabilities, the collected data includes the portal session ID, Azure Active Directory user ID, and the name of the portal tab where the event occurred. Microsoft doesn’t collect names, addresses, or other contact information.</p>
<p>For more information about data collection and usage, see the <a target="_blank" rel="noopener" href="https://privacy.microsoft.com/privacystatement">Microsoft Online Services Privacy Statement</a>.</p>
<p> Note</p>
<p>To learn about viewing or deleting your personal data collected by the service, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/microsoft-365/compliance/gdpr-dsr-azure">Azure Data Subject Requests for the GDPR</a>. For more information about GDPR, see <a target="_blank" rel="noopener" href="https://servicetrust.microsoft.com/ViewPage/GDPRGetStarted">the GDPR section of the Service Trust portal</a>.</p>
<h2 id="Next-steps"><a href="#Next-steps" class="headerlink" title="Next steps"></a>Next steps</h2><p>Now that you’ve configured Azure Monitor for your Azure Virtual Desktop environment, here are some resources that might help you start monitoring your environment:</p>
<ul>
<li>Check out our <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/azure-monitor-glossary">glossary</a> to learn more about terms and concepts related to Azure Monitor for Azure Virtual Desktop.</li>
<li>To estimate, measure, and manage your data storage costs, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/azure-monitor-costs">Estimate Azure Monitor costs</a>.</li>
<li>If you encounter a problem, check out our <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/troubleshoot-azure-monitor">troubleshooting guide</a> for help and known issues.</li>
<li>To see what’s new in each version update, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/whats-new-azure-monitor">What’s new in Azure Monitor for Azure Virtual Desktop</a>.</li>
</ul>
<h1 id="How-to-resolve-Azure-Advisor-recommendations"><a href="#How-to-resolve-Azure-Advisor-recommendations" class="headerlink" title="How to resolve Azure Advisor recommendations"></a>How to resolve Azure Advisor recommendations</h1><p>This article describes how you can resolve recommendations that appear in Azure Advisor for Azure Virtual Desktop.</p>
<h2 id="“No-validation-environment-enabled”"><a href="#“No-validation-environment-enabled”" class="headerlink" title="“No validation environment enabled”"></a>“No validation environment enabled”</h2><p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/no-validation-environment.png" alt="A screenshot of the Azure Advisor Operational Excellence page. The &quot;no validation environment enabled&quot; recommendation is highlighted in red."></p>
<p>This recommendation appears under Operational Excellence. The recommendation should also show you a warning message like this:</p>
<p>“You don’t have a validation environment enabled in this subscription. When you made your host pools, you selected <strong>No</strong> for “Validation environment” in the Properties tab. To ensure business continuity through Azure Virtual Desktop service deployments, make sure you have at least one host pool with a validation environment where you can test for potential issues.”</p>
<p>You can make this warning message go away by enabling a validation environment in one of your host pools.</p>
<p>To enable a validation environment:</p>
<ol>
<li>Go to your Azure portal home page and select the host pool you want to change.</li>
<li>Next, select the host pool you want to change from a production environment to a validation environment.</li>
<li>In your host pool, select <strong>Properties</strong> on the left column. Next, scroll down until you see “Validation environment.” Select <strong>Yes</strong>, then select <strong>Apply</strong>.</li>
</ol>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/validation-yes.png" alt="A screenshot of the Properties menu. &quot;Validation environment&quot; is highlighted in red, and the &quot;Yes&quot; bubble is selected."></p>
<p>These changes won’t make the warning go away immediately, but it should disappear eventually. Azure Advisor updates twice a day. Until then, you can postpone or dismiss the recommendation manually. We recommend you let the recommendation go away on its own. That way, Azure Advisor can let you know if it comes across any problems as the settings change.</p>
<h2 id="“Not-enough-production-non-validation-environments-enabled”"><a href="#“Not-enough-production-non-validation-environments-enabled”" class="headerlink" title="“Not enough production (non-validation) environments enabled”"></a>“Not enough production (non-validation) environments enabled”</h2><p>This recommendation appears under Operational Excellence.</p>
<p>For this recommendation, the warning message appears for one of these reasons:</p>
<ul>
<li>You have too many host pools in your validation environment.</li>
<li>You don’t have any production host pools.</li>
</ul>
<p>We recommend users have fewer than half of their host pools in a validation environment.</p>
<p>To resolve this warning:</p>
<ol>
<li>Go to your Azure portal home page.</li>
<li>Select the host pools you want either want to change from validation to production.</li>
<li>In your host pool, select the <strong>Properties</strong> tab in the column on the right side of the screen. Next, scroll down until you see “Validation environment.” Select <strong>No</strong>, then select <strong>Apply</strong>.</li>
</ol>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/validation-no.png" alt="A screenshot of the Properties menu. &quot;Validation environment&quot; is highlighted in red, and the &quot;No&quot; bubble is selected."></p>
<p>These changes won’t make the warning go away immediately, but it should disappear eventually. Azure Advisor updates twice a day. Until then, you can postpone or dismiss the recommendation manually. We recommend you let the recommendation go away on its own. That way, Azure Advisor can let you know if it comes across any problems as the settings change.</p>
<h2 id="“Not-enough-links-are-unblocked-to-successfully-implement-your-VM”"><a href="#“Not-enough-links-are-unblocked-to-successfully-implement-your-VM”" class="headerlink" title="“Not enough links are unblocked to successfully implement your VM”"></a>“Not enough links are unblocked to successfully implement your VM”</h2><p>This recommendation appears under Operational Excellence.</p>
<p>You need to unblock specific URLs to make sure that your virtual machine (VM) functions properly. You can see the list at <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/safe-url-list">Safe URL list</a>. If the URLs aren’t unblocked, then your VM won’t work properly.</p>
<p>To solve this recommendation, make sure you unblock all the URLs on the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/safe-url-list">Safe URL list</a>. You can use Service Tag or FQDN tags to unblock URLs, too.</p>
<h2 id="Next-steps-1"><a href="#Next-steps-1" class="headerlink" title="Next steps"></a>Next steps</h2><p>If you’re looking for more in-depth guides about how to resolve common issues, check out <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/troubleshoot-set-up-overview">Troubleshooting overview, feedback, and support for Azure Virtual Desktop</a>.</p>
<h1 id="Session-host-virtual-machine-sizing-guidelines"><a href="#Session-host-virtual-machine-sizing-guidelines" class="headerlink" title="Session host virtual machine sizing guidelines"></a>Session host virtual machine sizing guidelines</h1><p>Whether you’re running your session host virtual machines (VM) on Remote Desktop Services or Azure Virtual Desktop, different types of workloads require different VM configurations. The examples in this article are generic guidelines and you should only use them for initial performance estimates. For the best possible experience, you will need to scale your deployment depending on your users’ needs.</p>
<h2 id="Workloads"><a href="#Workloads" class="headerlink" title="Workloads"></a>Workloads</h2><p>Users can run different types of workloads on the session host virtual machines. The following table provides examples of a range of workload types to help you estimate what size your virtual machines need to be. After you set up your virtual machines, you should continually monitor their actual usage and adjust their size accordingly. If you end up needing a bigger or smaller virtual machine, you can easily scale your existing deployment up or down in Azure.</p>
<p>The following table describes each workload. <em>Example users</em> are the types of users that might find each workload most helpful. <em>Example apps</em> are the kinds of apps that work best for each workload.</p>
<table>
<thead>
<tr>
<th align="left">Workload type</th>
<th align="left">Example users</th>
<th align="left">Example apps</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Light</td>
<td align="left">Users doing basic data entry tasks</td>
<td align="left">Database entry applications, command-line interfaces</td>
</tr>
<tr>
<td align="left">Medium</td>
<td align="left">Consultants and market researchers</td>
<td align="left">Database entry applications, command-line interfaces, Microsoft Word, static web pages</td>
</tr>
<tr>
<td align="left">Heavy</td>
<td align="left">Software engineers, content creators</td>
<td align="left">Database entry applications, command-line interfaces, Microsoft Word, static web pages, Microsoft Outlook, Microsoft PowerPoint, dynamic web pages, software development</td>
</tr>
<tr>
<td align="left">Power</td>
<td align="left">Graphic designers, 3D model makers, machine learning researchers</td>
<td align="left">Database entry applications, command-line interfaces, Microsoft Word, static web pages, Microsoft Outlook, Microsoft PowerPoint, dynamic web pages, photo and video editing, computer-aided design (CAD), computer-aided manufacturing (CAM)</td>
</tr>
</tbody></table>
<h2 id="Single-session-recommendations"><a href="#Single-session-recommendations" class="headerlink" title="Single-session recommendations"></a>Single-session recommendations</h2><p>Single-session refers to when there is only one user logged on to a session host virtual machine at any one time, such as when using personal host pools in Azure Virtual Desktop. For VM sizing recommendations for single-session scenarios, we recommend at least two physical CPU cores per VM (typically four vCPUs with hyper-threading). If you need more specific VM sizing recommendations for single-session scenarios, ask the software vendors specific to your workload. VM sizing for single-session VMs will likely align with physical device guidelines.</p>
<p>The following table shows examples of typical workloads:</p>
<table>
<thead>
<tr>
<th align="left">Workload type</th>
<th align="left">vCPU&#x2F;RAM&#x2F;OS storage minimum</th>
<th align="left">Example Azure instances</th>
<th align="left">Profile container storage minimum</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Light</td>
<td align="left">2 vCPUs, 8 GB RAM, 32 GB storage</td>
<td align="left">D2s_v5, D2s_v4</td>
<td align="left">30 GB</td>
</tr>
<tr>
<td align="left">Medium</td>
<td align="left">4 vCPUs, 16 GB RAM, 32 GB storage</td>
<td align="left">D4s_v5, D4s_v4</td>
<td align="left">30 GB</td>
</tr>
<tr>
<td align="left">Heavy</td>
<td align="left">8 vCPUs, 32 GB RAM, 32 GB storage</td>
<td align="left">D8s_v5, D8s_v4</td>
<td align="left">30 GB</td>
</tr>
</tbody></table>
<h2 id="Multi-session-recommendations"><a href="#Multi-session-recommendations" class="headerlink" title="Multi-session recommendations"></a>Multi-session recommendations</h2><p>Multi-session refers to when there is more than one user logged on to a session host virtual machine at any one time, such as when using pooled host pools in Azure Virtual Desktop with the Windows 11 Enterprise multi-session operating system (OS). The following tables list the maximum suggested number of users per virtual central processing unit (vCPU) and the minimum VM configuration for each workload. If you need more specific VM sizing recommendations for single-session scenarios, ask the software vendors specific to your workload.</p>
<p>The following table shows examples of standard or larger user workloads:</p>
<table>
<thead>
<tr>
<th align="left">Workload type</th>
<th align="left">Maximum users per vCPU</th>
<th align="left">Minimum vCPU&#x2F;RAM&#x2F;OS storage</th>
<th align="left">Example Azure instances</th>
<th align="left">Minimum profile storage</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Light</td>
<td align="left">6</td>
<td align="left">8 vCPUs, 16 GB RAM, 32 GB storage</td>
<td align="left">D8s_v5, D8s_v4, F8s_v2, D8as_v4, D16s_v5, D16s_v4, F16s_v2, D16as_v4</td>
<td align="left">30 GB</td>
</tr>
<tr>
<td align="left">Medium</td>
<td align="left">4</td>
<td align="left">8 vCPUs, 16 GB RAM, 32 GB storage</td>
<td align="left">D8s_v5, D8s_v4, F8s_v2, D8as_v4, D16s_v5, D16s_v4, F16s_v2, D16as_v4</td>
<td align="left">30 GB</td>
</tr>
<tr>
<td align="left">Heavy</td>
<td align="left">2</td>
<td align="left">8 vCPUs, 16 GB RAM, 32 GB storage</td>
<td align="left">D8s_v5, D8s_v4, F8s_v2, D8as_v4, D16s_v5, D16s_v4, F16s_v2, D16as_v4</td>
<td align="left">30 GB</td>
</tr>
<tr>
<td align="left">Power</td>
<td align="left">1</td>
<td align="left">6 vCPUs, 56 GB RAM, 340 GB storage</td>
<td align="left">D16ds_v5, D16s_v4, D16as_v4, NV6, NV16as_v4</td>
<td align="left">30 GB</td>
</tr>
</tbody></table>
<p>For multi-session, we recommend limiting VM size to between 4 vCPUs and 24 vCPUs for the following reasons:</p>
<ul>
<li><strong>All VMs should have more than two cores</strong>: the UI components in Windows rely on using at least two parallel threads for some of the heavier rendering operations. For multi-session, having multiple users on a two-core VM will lead to the UI and apps becoming unstable, which lowers the quality of user experience. Four cores is the lowest recommended number of cores that a stable multi-session VM should have.</li>
<li><strong>VMs should not have more than 32 cores</strong>: as the number of cores increase, the system’s synchronization overhead also increases. For most workloads, at around 16 cores the return on investment gets lower, with most of the extra capacity being offset by synchronization overhead. You are likely to have more users from two 16 core VMs as opposed to one 32 core one.</li>
</ul>
<p>The recommended range between 4 and 24 cores will generally provide better capacity returns for your users as you increase the number of cores. For example, let’s say you have 12 users sign in at the same time to a VM with four cores. The ratio is three users per core. Meanwhile, on a VM with eight cores and 14 users, the ratio is 1.75 users per core. In this scenario, the latter configuration with a ratio of 1.75 offers greater burst capacity for your applications that have short-term CPU demand.</p>
<p>This recommendation is true at a larger scale. For scenarios with 20 or more users connected to a single VM, several smaller VMs would perform better than one or two large VMs. For example, if you’re expecting 30 or more users to simultaneously sign in within 10 minutes on the same session host with 16 cores, two eight-core VMs will handle the workload better. You can also use breadth-first load balancing to evenly distribute users across different VMs, rather than depth-first where a session host is saturated before using another one.</p>
<p>It’s also better to use a large number of smaller VMs instead of a few large VMs because it’s easier to shut down VMs that need to be updated or aren’t currently in use. With larger VMs, you’re more likely to have at least one user signed in at any time, which prevents you from shutting down the VM. When you have many smaller VMs, it’s more likely you’ll have some that don’t have any users signed in. You can safely shut these unused VMs to conserve resources (either automatically using autoscale in Azure Virtual Desktop, or manually), making your deployment more resilient, easier to maintain, and less expensive.</p>
<h2 id="General-virtual-machine-recommendations"><a href="#General-virtual-machine-recommendations" class="headerlink" title="General virtual machine recommendations"></a>General virtual machine recommendations</h2><p>In addition to the base requirements to run your chosen OS, in Azure we recommend you use Premium SSD storage for your OS disk for production workloads that require a service level agreement (SLA). For more details, see the <a target="_blank" rel="noopener" href="https://azure.microsoft.com/support/legal/sla/virtual-machines/v1_8/">SLA for virtual machines</a>.</p>
<p>Graphics processing units (GPUs) are a good choice for users who regularly use graphics-intensive programs for video rendering, 3D design, and simulations.. Azure has several graphics acceleration deployment options and multiple available GPU VM sizes. Learn more at <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/sizes-gpu">GPU optimized virtual machine sizes</a>. For more general information about graphics acceleration in Remote Desktop Services, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds-graphics-virtualization">Choose your graphics rendering technology</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/b-series-burstable">B-series burstable VMs</a> in Azure are a good choice for users who don’t always need maximum CPU performance. For more information about VM types and sizes, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/sizes">Sizes for Windows virtual machines in Azure</a> and the pricing information on <a target="_blank" rel="noopener" href="https://azure.microsoft.com/pricing/details/virtual-machines/series/">our Virtual Machine series page</a>.</p>
<h2 id="Test-your-workload"><a href="#Test-your-workload" class="headerlink" title="Test your workload"></a>Test your workload</h2><p>Finally, we recommend you use simulation tools to test your deployment with both stress tests and real-life usage simulations. Make sure your system is responsive and resilient enough to meet user needs, and remember to vary the load size to avoid surprises.</p>
<h1 id="Autoscale-for-Pooled-Host-Pools-on-Azure-Virtual-Desktop"><a href="#Autoscale-for-Pooled-Host-Pools-on-Azure-Virtual-Desktop" class="headerlink" title="Autoscale for Pooled Host Pools on Azure Virtual Desktop"></a>Autoscale for Pooled Host Pools on Azure Virtual Desktop</h1><p>We shared at Microsoft Inspire that one of our most anticipated features, Autoscale for pooled host pools, will soon be Generally Available on Azure Virtual Desktop. Today, we are happy to announce that Autoscale for pooled host pools is officially Generally Available!</p>
<p><strong>Autoscale for Pooled Host Pools</strong></p>
<p>Autoscale on Azure Virtual Desktop is a native automated scaling solution that automatically turns session host virtual machines on and off according to the schedule and capacity thresholds that you define to fit your workload. With Autoscale, you can save costs by shutting down idle session hosts during off-peak hours while ensuring there’s enough capacity to meet your users’ needs during peak hours. </p>
<p>The following capabilities are now generally available with Autoscale for pooled host pools: </p>
<ul>
<li>You can now use the Desktop Virtualization Power On Off Contributor built in RBAC role instead of a custom RBAC role to grant permissions to Azure Virtual Desktop to scale the session hosts in your host pool.</li>
<li>Scaling plans are now available in almost all regions where Azure Virtual Desktop host pool objects are, including Australia East and all US and Canada regions.</li>
</ul>
<p>In addition, stay tuned for announcements on the following capabilities that are coming soon:</p>
<ul>
<li>Scaling plans in UK and Japan regions.</li>
<li>The ability to port Autoscale diagnostics logs to Log Analytics for analysis and parsing.</li>
<li>The ability to create schedules as proxy resources in PowerShell for easier configuration.</li>
</ul>
<p><strong>Getting Started</strong></p>
<p>To enable this feature, simply create a scaling plan, define schedules for when virtual machines should be turned on or off, and assign the scaling plan to one or more host pools.</p>
<p><img src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/393421iA84288292EE6B510/image-size/medium?v=v2&px=400" alt="thumbnail image 1 of blog post titled  	 	 	  	 	 	 				 		 			 				 						 							Announcing General Availability of Autoscale for Pooled Host Pools on Azure Virtual Desktop 							 						 					 			 		 	 			 	 	 	 	 	 "></p>
<h1 id="Manage-app-groups-with-the-Azure-portal"><a href="#Manage-app-groups-with-the-Azure-portal" class="headerlink" title="Manage app groups with the Azure portal"></a>Manage app groups with the Azure portal</h1><p>This content applies to Azure Virtual Desktop with Azure Resource Manager Azure Virtual Desktop objects. If you’re using Azure Virtual Desktop (classic) without Azure Resource Manager objects, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/virtual-desktop-fall-2019/manage-app-groups-2019">this article</a>.</p>
<p>The default app group created for a new Azure Virtual Desktop host pool also publishes the full desktop. In addition, you can create one or more RemoteApp application groups for the host pool. Follow this tutorial to create a RemoteApp app group and publish individual Start menu apps.</p>
<p> Note</p>
<p>You can dynamically attach MSIX apps to user sessions or add your app packages to a custom virtual machine (VM) image to publish your organization’s apps. Learn more at <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/virtual-desktop/remote-app-streaming/custom-apps">How to host custom apps with Azure Virtual Desktop</a>.</p>
<p>In this tutorial, learn how to:</p>
<ul>
<li>Create a RemoteApp group.</li>
<li>Grant access to RemoteApp programs.</li>
</ul>
<h2 id="Create-a-RemoteApp-group"><a href="#Create-a-RemoteApp-group" class="headerlink" title="Create a RemoteApp group"></a>Create a RemoteApp group</h2><p>If you’ve already created a host pool and session host VMs using the Azure portal or PowerShell, you can add application groups from the Azure portal with the following process:</p>
<ol>
<li><p>Sign in to the <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure portal</a>.</p>
<p> Note</p>
<p>If you’re signing in to the US Gov portal, go to <a target="_blank" rel="noopener" href="https://portal.azure.us/">https://portal.azure.us/</a> instead.</p>
<p>If you’re accessing the Azure China portal, go to <a target="_blank" rel="noopener" href="https://portal.azure.cn/">https://portal.azure.cn/</a>.</p>
</li>
<li><p>Search for and select <strong>Azure Virtual Desktop</strong>.</p>
</li>
<li><p>You can add an application group directly or you can add it from an existing host pool. Choose an option below:</p>
<ul>
<li>Select <strong>Application groups</strong> in the menu on the left side of the page, then select <strong>+ Add</strong>.</li>
<li>Select <strong>Host pools</strong> in the menu on the left side of the screen, select the name of the host pool, select <strong>Application groups</strong> from the menu on the left side, then select <strong>+ Add</strong>. In this case, the host pool will already be selected on the Basics tab.</li>
</ul>
</li>
<li><p>On the <strong>Basics</strong> tab, select the <strong>Subscription</strong> and <strong>Resource group</strong> you want to create the app group for. You can also choose to create a new resource group instead of selecting an existing one.</p>
</li>
<li><p>Select the <strong>Host pool</strong> that will be associated with the application group from the drop-down menu.</p>
<p> Note</p>
<p>You must select the host pool associated with the application group. App groups have apps or desktops that are served from a session host and session hosts are part of host pools. The app group needs to be associated with a host pool during creation.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/basics-tab.png" alt="A screenshot of the Basics tab in the Azure portal."></p>
</li>
<li><p>Select <strong>RemoteApp</strong> under <strong>Application group type</strong>, then enter a name for your RemoteApp.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/remoteapp-button.png" alt="A screenshot of the Application group type fields. &quot;RemoteApp&quot; is highlighted."></p>
</li>
<li><p>Select <strong>Next: Assignments &gt;</strong> tab.</p>
</li>
<li><p>To assign individual users or user groups to the app group, select <strong>+Add Azure AD users or user groups</strong>.</p>
</li>
<li><p>Select the users you want to have access to the apps. You can select single or multiple users and user groups.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/select-users.png" alt="A screenshot of the user selection menu."></p>
</li>
<li><p>Select <strong>Select</strong>.</p>
</li>
<li><p>Select <strong>Next: Applications &gt;</strong>, then select <strong>+Add applications</strong>.</p>
</li>
<li><p>To add an application from the start menu:</p>
<ul>
<li>Under <strong>Application source</strong>, select <strong>Start menu</strong> from the drop-down menu. Next, under <strong>Application</strong>, choose the application from the drop-down menu.</li>
</ul>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/add-app-start.png" alt="A screenshot of the add application screen. The user has selected the Character Map as the application source and entered Character Map in the display name field."></p>
<ul>
<li>In <strong>Display name</strong>, enter the name for the application that will be shown to the user on their client.</li>
<li>Leave the other options as-is and select <strong>Save</strong>.</li>
</ul>
</li>
<li><p>To add an application from a specific file path:</p>
<ul>
<li>Under <strong>Application source</strong>, select <strong>File path</strong> from the drop-down menu.</li>
<li>In <strong>Application path</strong>, enter the path to the application on the session host registered with the associated host pool.</li>
<li>Enter the application’s details in the <strong>Application name</strong>, <strong>Display name</strong>, <strong>Icon path</strong>, and <strong>Icon index</strong> fields.</li>
<li>Select <strong>Save</strong>.</li>
</ul>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/add-app-file.png" alt="A screenshot of the add application page. The user has entered the file path to the 7-Zip File Manager app."></p>
</li>
<li><p>Repeat this process for every application you want to add to the application group.</p>
</li>
<li><p>Next, select <strong>Next: Workspace &gt;</strong>.</p>
</li>
<li><p>If you want to register the app group to a workspace, select <strong>Yes</strong> for <strong>Register application group</strong>. If you’d rather register the app group at a later time, select <strong>No</strong>.</p>
</li>
<li><p>If you select <strong>Yes</strong>, you can select an existing workspace to register your app group to.</p>
<p> Note</p>
<p>You can only register the app group to workspaces created in the same location as the host pool. Also. if you’ve previously registered another app group from the same host pool as your new app group to a workspace, it will be selected and you can’t edit it. All app groups from a host pool must be registered to the same workspace.</p>
<p><img src="https://learn.microsoft.com/en-us/azure/virtual-desktop/media/register-existing.png" alt="A screenshot of the register application group page for an already existing workspace. The host pool is preselected."></p>
</li>
<li><p>Optionally, if you want to create tags to make your workspace easy to organize, select <strong>Next: Tags &gt;</strong> and enter your tag names.</p>
</li>
<li><p>When you’re done, select <strong>Review + create</strong>.</p>
</li>
<li><p>Wait a bit for the validation process to complete. When it’s done, select <strong>Create</strong> to deploy your app group.</p>
</li>
</ol>
<p>The deployment process will do the following things for you:</p>
<ul>
<li>Create the RemoteApp app group.</li>
<li>Add your selected apps to the app group.</li>
<li>Publish the app group published to users and user groups you selected.</li>
<li>Register the app group, if you chose to do so.</li>
<li>Create a link to an Azure Resource Manager template based on your configuration that you can download and save for later.</li>
</ul>
<p> Important</p>
<p>You can only create 500 application groups for each Azure Active Directory tenant. We added this limit because of service limitations for retrieving feeds for our users. This limit doesn’t apply to app groups created in Azure Virtual Desktop (classic).</p>
<h2 id="Edit-or-remove-an-app"><a href="#Edit-or-remove-an-app" class="headerlink" title="Edit or remove an app"></a>Edit or remove an app</h2><p>To edit or remove an app from an app group:</p>
<ol>
<li><p>Sign in to the <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure portal</a>.</p>
<p> Note</p>
<p>If you’re signing in to the US Gov portal, go to <a target="_blank" rel="noopener" href="https://portal.azure.us/">https://portal.azure.us/</a> instead.</p>
</li>
<li><p>Search for and select <strong>Azure Virtual Desktop</strong>.</p>
</li>
<li><p>You can either add an application group directly or from an existing host pool by choosing one of the following options:</p>
<ul>
<li>To add a new application group directly, select <strong>Application groups</strong> in the menu on the left side of the page, then select the app group you want to edit.</li>
<li>To edit an app group in an existing host pool, select <strong>Host pools</strong> in the menu on the left side of the screen, select the name of the host pool, then select <strong>Application groups</strong> in the menu that appears on the left side of the screen, and then select the app group you want to edit.</li>
</ul>
</li>
<li><p>Select <strong>Applications</strong> in the menu on the left side of the page.</p>
</li>
<li><p>If you want to remove an application, select the check box next to the application, then select <strong>Remove</strong> from the menu on the top of the page.</p>
</li>
<li><p>If you want to edit the details of an application, select the application name. This will open up the editing menu.</p>
</li>
<li><p>When you’re done making changes, select <strong>Save</strong>.</p>
</li>
</ol>
<h2 id="Next-steps-2"><a href="#Next-steps-2" class="headerlink" title="Next steps"></a>Next steps</h2><p>In this tutorial, you learned how to create an app group, populate it with RemoteApp programs, and assign users to the app group. To learn how to create a validation host pool, see the following tutorial. You can use a validation host pool to monitor service updates before rolling them out to your production environment.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Automating-Azure-Virtual-Desktop-Management-Tasks-24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Automating-Azure-Virtual-Desktop-Management-Tasks-24/" class="post-title-link" itemprop="url">AZ-140-Automating-Azure-Virtual-Desktop-Management-Tasks-24</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 19:11:46" itemprop="dateCreated datePublished" datetime="2022-11-13T19:11:46-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:32:32" itemprop="dateModified" datetime="2022-11-14T06:32:32-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Automating-Azure-Virtual-Desktop-Management-Tasks-24/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Automating-Azure-Virtual-Desktop-Management-Tasks-24/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course on Automating Azure Virtual Desktop Management Tasks</p>
<p>My name is Shabaz Darr and I’ll be your instructor for this course. I am an Azure Virtual Desktop Specialist and have been working in the Microsoft cloud services for several years, specifically with Azure Virtual Desktop since its inception, and have multiple Azure-focused certifications.</p>
<p>My contact information is available on the screen. Please feel free to reach out to me with any questions, comments, or concerns and I will be happy to discuss these with you. </p>
<p>For any other issues, you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:&#115;&#117;&#112;&#x70;&#111;&#114;&#x74;&#x40;&#x63;&#x6c;&#x6f;&#117;&#100;&#x61;&#x63;&#x61;&#x64;&#x65;&#x6d;&#x79;&#46;&#x63;&#x6f;&#x6d;">&#115;&#117;&#112;&#x70;&#111;&#114;&#x74;&#x40;&#x63;&#x6c;&#x6f;&#117;&#100;&#x61;&#x63;&#x61;&#x64;&#x65;&#x6d;&#x79;&#46;&#x63;&#x6f;&#x6d;</a> and one of our cloud experts will follow up with you.</p>
<p>This course is intended for anyone planning to take the Azure Virtual Desktop Specialty exam and anyone interested in learning how to deploy an Azure Virtual Desktop environment</p>
<p>By the end of this course, you will have knowledge on:</p>
<ul>
<li>Configuring Automation for Azure Virtual Desktop</li>
<li>Automating Management of host pools, session hosts, and user sessions by using PowerShell and Azure Command-Line interface (CLI)</li>
<li>Implementing Autoscaling in host pools</li>
</ul>
<p>To get the most from this course you should have an Administrator-level understanding of Azure Cloud services</p>
<p>When I created this course, all information was current. Feedback on course content hosted by Cloud Academy is always appreciated and encouraged, as it allows us as trainers to improve which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>If you notice any updates or corrections, please reach out to us. Thank you!</p>
<h1 id="Configuring-Automation-for-Azure-Virtual-Desktop"><a href="#Configuring-Automation-for-Azure-Virtual-Desktop" class="headerlink" title="Configuring Automation for Azure Virtual Desktop"></a>Configuring Automation for Azure Virtual Desktop</h1><p>Welcome to this module on configuring automation for Azure Virtual Desktop. In this module, we will cover the following:</p>
<ul>
<li>We will look at how scaling works</li>
<li>Prerequisites for Automation with Azure Virtual Desktop</li>
<li>Finally, we will look at the high-level steps you need to complete when configuring Azure Automation for AVD</li>
</ul>
<p>Let’s start this module off by discussing how scaling works. There are different ways in which you can utilize scaling within Azure Virtual Desktop. You can start and stop virtual machines during peak and off-peak usage hours. You can Scale out virtual machines based on the number of sessions per CPU core. Finally, you can scale in virtual machines during off-peak hours so only a few VMs are running.</p>
<p>We are now going to move on to looking at the prerequisites you need to complete before you can integrate automation with Azure Virtual Desktop.</p>
<p>You need to have a functioning Azure Virtual Desktop host pool within your environment. Your session hosts need to be registered with the Azure Virtual Desktop Service. You then need to ensure the account you are using to configure automation has at least contributor access to the entire subscription.</p>
<p>Finally, you need to ensure the management machine you are using to complete this deployment has the relevant tools on. Ensure PowerShell 5.1 or later is installed on this management machine, and you will need to install the Azure Az PowerShell module to be able to complete the configuration.</p>
<p>In the final lecture of this module, we will look at the high-level steps you need to complete in order to configure Azure Automation for Azure Virtual Desktop.</p>
<p>The first step is to create an Azure Automation account which can be completed via PowerShell. If you have an existing automation account you can also utilize this, however, you will need to follow a specific process to update this account if required.</p>
<p>The next step is to create an Azure Automation run as account. This provides authentication for managing resources in Azure with Azure cmdlets. Once you have created the relevant automation accounts you then need to create an Azure Logic App. You will need to download and import the Desktop Virtualization PowerShell module to use within your PowerShell session for this step.</p>
<p>Finally, you will need to create the execution schedule for the new scaling tool. The PowerShell script will need to be run for each host pool you want to autoscale, but you only need on Azure Automation account.</p>
<h1 id="Automating-Management-of-Host-Pools-Session-Hosts-and-User-Sessions-by-Using-PowerShell-and-Azure-Command-Line-Interface-CLI"><a href="#Automating-Management-of-Host-Pools-Session-Hosts-and-User-Sessions-by-Using-PowerShell-and-Azure-Command-Line-Interface-CLI" class="headerlink" title="Automating Management of Host Pools, Session Hosts, and User Sessions by Using PowerShell and Azure Command-Line Interface (CLI)"></a>Automating Management of Host Pools, Session Hosts, and User Sessions by Using PowerShell and Azure Command-Line Interface (CLI)</h1><p>Welcome to this module on automating management of host pools, session hosts, and user sessions by using PowerShell, and Azure Command-Line Interface (CLI). In this module, we will cover the following topics:</p>
<ul>
<li>Automating host pools, session hosts, and user sessions with PowerShell</li>
<li>Automating host pools, session hosts, and user sessions with Azure Command-line interface (CLI)</li>
</ul>
<p>Let’s start off by doing a walk-through demo of configuring automation tasks with PowerShell.</p>
<p>Here we have PowerShell open with Administrative privileges. The first step we need to complete is to ensure we have the relevant module installed to allow us to run the AVD Powershell cmdlets. In our case, we need to install the ‘Az.DesktopVirtualization’ module. We can select Yes for the warnings that appear, and then we are ready to connect and authenticate to the Azure portal.</p>
<p>We use the ‘Connect-AzAccount’ cmdlet to initiate the connection, and then enter our global administrative credentials in the pop-up box to authenticate. We are now logged into our tenant and ready to manage the AVD environment.</p>
<p>The first command we will look at is ‘Get-AzWvdHostPool’ which outputs relevant information regarding our AVD host pool. We need to specify the host pool name and the resource group it is stored in. The output then shows you all the relevant information about that specific host pool, including location, an Identity Type if you have set one, and any plan details if you are using one. The Get cmdlet will always retrieve information about the relevant resource you have specified and will not make any changes.</p>
<p>Another Get cmdlet we can use when managing AVD is ‘Get-AzWvdDesktop’ which will show us relevant information about a specific desktop application we have set up. You need to specify the resource group, application group name, and the name of the desktop application you need information about.</p>
<p>Let’s now look at a cmdlet that will make an actual change to our environment. In this cmdlet we are going to remove an application group, so we use the cmdlet called ‘Remove-AzWvdApplicaitonGroup’. As you can see we need to specify the resource group again, and the name of the application group we want to remove. </p>
<p>The final cmdlet I want to show is one to update an existing resource within AVD. We need to use an update cmdlet, in our case we are going to utilize the ‘Update-AzWvdHostPool’ cmdlet to update an existing host pool. As you can see there are a number of settings we can update. In our case, the only one that will be different is that we are changing the MaxSessionLimit from 5 to 6.</p>
<p>We are now going to do a walk-through demo of configuring automation tasks with Azure CLI.</p>
<p>We are launching the Azure CLI from the Azure portal, therefore need to navigate to the portal.azure.com&#x2F;Cloudshell URL. As we are already authenticated from logging into the Azure portal we do not need to authenticate again when launching the Azure CLI.</p>
<p>The first command type we are going to use is one that lists specific resources within our AVD environment. List commands are very similar to ‘Get’ cmdlets in PowerShell. As you can see in this command, we want to list all the information about our application group called ‘Desktop’ within our resource group. There is a whole host of details that are shown as part of the output, including the application group type, location, and the object ID.</p>
<p>So we can get a clear view of the output, I have re-launched the Azure CLI. The next command I want to look at is similar to the list command, in that it does not make any changes and simply outputs information about a specific resource. It is the ‘show’ command. In our example, we want to show information regarding the application group called ‘ITGEEK-DT01’. Again as you can see a number of details are shown in the output, very similar to the list command output.</p>
<p>One clever feature of the Azure CLI is that it will not let you delete resources if other resources already exist within it. In this example we are trying to delete a host pool, however, because an application group exists within that which needs to be deleted first, we get an error giving us that information.</p>
<h1 id="Implementing-Autoscaling-in-Host-Pools"><a href="#Implementing-Autoscaling-in-Host-Pools" class="headerlink" title="Implementing Autoscaling in Host Pools"></a>Implementing Autoscaling in Host Pools</h1><p>Welcome to this module on implementing autoscaling in host pools. In this module we will cover the following topics:</p>
<ul>
<li>Azure Virtual Desktop Scaling plans</li>
<li>Requirements for auto-scaling in AVD</li>
<li>A demo where I will configure an auto-scaling plan for Azure Virtual Desktop</li>
</ul>
<p>Let’s start off by discussing scaling plans. Traditionally, scaling was implemented within Azure using either Powershell scripts or Azure Automation, however, you can utilize a feature called scaling plans.</p>
<p>Scaling plans allows you to define ramp-up hours which is the time you want to increase resources when the usage increases. </p>
<p>Peak hours which is the time of day when usage is at its highest.</p>
<p>Ramp-down hours when usage starts to drop off.</p>
<p>You can then configure associated triggers which will kick off your scaling plan if those triggers are met, for example, a certain percentage of CPU usage. Finally, your scaling plan must include an associated schedule for at least one day of the week.</p>
<p>Let’s now move on to discussing requirements for autoscaling in Azure Virtual Desktop. There are two main items that need to be in place before you can start implementing autoscaling. The first is that you need to create a custom role-based access control, better known as RBAC, role. Once this role has been created, the second item that needs to be in place is that you need to assign this role to the Azure Virtual Desktop application. </p>
<p>Once these two requirements are fulfilled, you can start configuring autoscaling in Azure Virtual Desktop</p>
<p>To finish off this module we are going to complete a demo of implementing a scaling plan in Azure that you can utilize with your AVD environment</p>
<p>Here we are in the Azure Portal. We need to navigate to the scaling plans section of the portal. We do not currently have any existing scaling plans, so let’s select ‘Create’. We now need to ensure we select the relevant subscription, resource group and give the scaling plan a name. You will need to be careful when selecting the location as not all locations support scaling plans. In our example, I am selecting Canada East as I know this region is supported. Finally, I am giving it a friendly name and moving on to the schedule plan.</p>
<p>We need to select ‘Add schedule’. We now have a number of different panes we need to complete. First, let’s enter general information like the schedule name. We then need to select which days we want the schedule to repeat on, in our case, we select each weekday.</p>
<p>For ‘ramp-up’ hours, the repeat on days and time zone are already entered by default, so we need to enter the start time. Please note this utilizes the 24-hour clock system. We then need to specify the load balancing algorithm. I am going to leave this on bread-first. We then need to specify the minimum percentage of session host virtual machines to start for ramp-up and peak hours. I will leave this on the default of 20%. Finally, on this pane, we need to enter the percentage of used host pool capacity that will be considered to evaluate whether to turn on or off virtual machines during ramp-up and peak hours.</p>
<p>If we now move onto the ‘Peak Hours’ pane, again the days and time zone are already selected and we need to specify the start time and load balancing algorithm which I am going to change to bread-first. The threshold capacity is grayed out and set to 60%, therefore we cannot edit this.</p>
<p>Now we move on to the ‘ramp-down’ pane. The first value we need to set is the start time, then the load balancing algorithm, which I am again going to set as breadth-first. We now need to set the minimum percentage of session host virtual machines that you would like to get to for ramp-down and off-peak hours.</p>
<p>Next, we need to select the percentage of used host pool capacity that will be considered to evaluate whether to turn on or off virtual machines during ramp-down and off-peak hours. We can then specify if we want to force users to log off or not, set a delay time before forcing the users to log off and customize a notification message.</p>
<p>The final pane to complete the schedule configuration is the ‘off-peak hours’ pane. Here we need to specify the start time, and load balancing algorithm. Again I am changing this to bread-first. Please note we cannot edit the capacity threshold again.</p>
<p>Now the schedule is configured we need to select the host pool we want this to apply to. In our case, we do not have an active host pool in this tenant. Finally, we can enter any tags we want to set, before reviewing and creating our scaling plan.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We covered a lot of important topics in this module. The first lecture was on configuring automation for Azure Virtual Desktop, where we talked about how scaling works and some of its configurable values. We then looked at the prerequisites for automation, and finally the high-level steps you need to complete when configuring automation with Azure Virtual Desktop.</p>
<p>In the second lecture, we dived into automating management of host pools, session hosts, and user sessions by using both PowerShell and Azure Command Line Interface (CLI). This was a demo-heavy lecture where I did a demo using PowerShell and then a demo using Azure CLI for automation tasks for AVD.</p>
<p>In the final lecture of this module, we looked at implementing autoscaling in a host pool. Here, we looked at AVD scaling plans in more detail, followed by the requirements for autoscaling in AVD, and finished off with a demo of configuring a scaling plan.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Implementing-Business-Continuity-for-Azure-Virtual-Desktop-23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Implementing-Business-Continuity-for-Azure-Virtual-Desktop-23/" class="post-title-link" itemprop="url">AZ-140-Implementing-Business-Continuity-for-Azure-Virtual-Desktop-23</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 19:10:49" itemprop="dateCreated datePublished" datetime="2022-11-13T19:10:49-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:32:40" itemprop="dateModified" datetime="2022-11-14T06:32:40-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Implementing-Business-Continuity-for-Azure-Virtual-Desktop-23/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Implementing-Business-Continuity-for-Azure-Virtual-Desktop-23/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course on Planning and Implementing Business Continuity in Azure Virtual Desktop</p>
<p>My name is Shabaz Darr and I’ll be your instructor for this course. I am an Azure Virtual Desktop Specialist and have been working in the Microsoft cloud services for several years, specifically with Azure Virtual Desktop since its inception, and have multiple Azure-focused certifications.</p>
<p>My contact information is available on the screen. Please feel free to reach out to me with any questions, comments, or concerns and I will be happy to discuss these with you. </p>
<p>For any other issues, you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:&#115;&#x75;&#x70;&#112;&#x6f;&#x72;&#x74;&#x40;&#99;&#108;&#x6f;&#x75;&#100;&#x61;&#x63;&#x61;&#100;&#101;&#109;&#121;&#x2e;&#99;&#x6f;&#109;">&#115;&#x75;&#x70;&#112;&#x6f;&#x72;&#x74;&#x40;&#99;&#108;&#x6f;&#x75;&#100;&#x61;&#x63;&#x61;&#100;&#101;&#109;&#121;&#x2e;&#99;&#x6f;&#109;</a> and one of our cloud experts will follow up with you.</p>
<p>This course is intended for anyone planning to take the Azure Virtual Desktop Specialty exam and anyone interested in learning how to deploy an Azure Virtual Desktop environment</p>
<p> By the end of this course, you will have knowledge on:</p>
<p>•  Planning and Implementing a disaster recovery plan for Azure Virtual Desktop</p>
<p>•  Designing a backup strategy for Azure Virtual Desktop</p>
<p>•  Configuring backup and restore for FSLogix user profiles, personal virtual desktop infrastructures (VDI), and golden images</p>
<p>To get the most from this course you should have an Administrator-level understanding of Azure Cloud services</p>
<p>When I created this course, all information was current. Feedback on course content hosted by Cloud Academy is always appreciated and encouraged, as it allows us as trainers to improve which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:&#115;&#x75;&#112;&#112;&#111;&#x72;&#116;&#64;&#99;&#108;&#111;&#x75;&#100;&#x61;&#99;&#97;&#x64;&#x65;&#109;&#121;&#46;&#99;&#111;&#x6d;">&#115;&#x75;&#112;&#112;&#111;&#x72;&#116;&#64;&#99;&#108;&#111;&#x75;&#100;&#x61;&#99;&#97;&#x64;&#x65;&#109;&#121;&#46;&#99;&#111;&#x6d;</a>.</p>
<p>If you notice any updates or corrections, please reach out to us.</p>
<p>Thank you!</p>
<h1 id="Planning-and-Implementing-a-Disaster-Recovery-Plan-for-Azure-Virtual-Desktop"><a href="#Planning-and-Implementing-a-Disaster-Recovery-Plan-for-Azure-Virtual-Desktop" class="headerlink" title="Planning and Implementing a Disaster Recovery Plan for Azure Virtual Desktop"></a>Planning and Implementing a Disaster Recovery Plan for Azure Virtual Desktop</h1><p>Welcome to this module on planning and implementing a disaster recovery plan for Azure Virtual Desktop. In this module, we will cover the following:</p>
<ul>
<li>Disaster Recovery for Azure Virtual Desktop</li>
<li>Virtual Machine Replication</li>
<li>And finally, FSLogix Replication</li>
</ul>
<p>Let’s start by discussing disaster recovery in Azure Virtual Desktop. Azure Virtual Desktop offers business continuity disaster recovery for the AVD service to preserve customer metadata during outages.</p>
<p>When setting up disaster recovery, you initially need to replicate your virtual machines to a secondary location. We will discuss this in more detail shortly. If you are using profile containers, you should also set up data replication in the same secondary location.</p>
<p>It is vitally important that user identities that are set up in the primary location are also made available in the secondary location. Finally, make sure any line-of-business applications which use the data in your primary location are also failed over to the secondary location.</p>
<p>Let’s now discuss virtual machine replication. As part of your disaster recovery plan for Azure Virtual Desktop, VMs need to be replicated to the secondary zone. It is recommended to use Azure Site Recovery to manage replication VMs to other Azure locations.</p>
<p>Once the VMs are replicated, you should turn them off to ensure you can save on cost. One of the benefits of using Azure Site Recovery to replicate the VMs to another location is that you will not need to register the VMs manually as the Azure Virtual Desktop agent in the secondary VM will automatically use the latest security token to connect to the service instance closest to it.</p>
<p>Something to note is that if there are existing user connections during any type of outage, you will be required to end the user connections in the current region before you can start the failover to the secondary location.</p>
<p>In the final lecture of this module, we will talk about FSLogix replication. When setting up disaster recovery for profiles, which uses FSLogix there are some configuration steps you need to follow. FSLogix supports multiple profile locations, so can enter the secondary location within the same registry entry you configure for the primary.</p>
<p>You will be required to provision an additional Azure file share in the second location to facilitate disaster recovery for the FSLogix user profile service.</p>
<p>In the event that the primary FSLogix profile path is unavailable, the FSLogix agent will automatically failover to the secondary, therefore it is recommended that the FSLogix agent be configured with a path to the secondary location.</p>
<h1 id="Designing-a-Backup-Strategy-for-Azure-Virtual-Desktop"><a href="#Designing-a-Backup-Strategy-for-Azure-Virtual-Desktop" class="headerlink" title="Designing a Backup Strategy for Azure Virtual Desktop"></a>Designing a Backup Strategy for Azure Virtual Desktop</h1><p>Welcome to this module on designing a backup strategy for Azure Virtual Desktop. In this module, we will cover the following topics:</p>
<ul>
<li>We will walk through a demo of how to back up VMs with Azure Backup</li>
<li>Next, we will walk through a demo of how to back up VMs with site recovery</li>
<li>And finally, we will look at how to back up VMs with snapshots</li>
</ul>
<p>Let’s start this module with walking through a demo of backing up a virtual machine by using the Azure Native service called Azure Backup.</p>
<p>Here we are logged into our Azure Portal. We need to navigate to the virtual machine we want to backup first so we click on virtual machines. We have two VMs here, so let’s click on ‘Demo VM’. Here we now see the overview page, but we need to navigate down the multiple options on this VM until we see backup.</p>
<p>Now as we can see we have not set any backups for this VM yet, so we first need to select the recovery services vault. We can either select an existing one or create a new one. For the purpose of this demo let’s create a new one. We then need to give the backup vault a name which we are going to leave as the default value which is automatically set. Ensure you have the correct resource group selected for where you want the recovery vault to reside which in our case we do. </p>
<p>Now we need to set our backup policy so we will click on edit this policy. We are going to leave the policy name, then we can move down to ‘backup schedule’. Here we can select the frequency of the backup, so daily or weekly. We can then set the time we want the backup to start and then make sure we set the relevant time zone. We then select the number of instance recovery snapshots, in our example, we will leave this set as two, however, you can set this to whatever your backup policy requires. Finally, we need to set the number of weekly, monthly and yearly backup retentions we want as part of our schedule. Once we are happy with the settings we can have a final quick review of our settings before creating the backup.</p>
<p>Let’s just take a look at the backup blade on the VM again. Now you can see our options are different. We can see the number of restore points and now at the top we can see an option to run a backup now, restore a VM once we have some backups, do a file recovery and stop the backup.</p>
<p>Now let’s do a walk-through demo of configuring Azure Site recovery for a virtual machine. Here we are again in the Azure portal. We navigate to the virtual machine we want to set up with replication, and whereas before we selected the backup pane, we are now going to select the Disaster recovery pane.</p>
<p>The first item we need to configure is the target zone. There are a whole host of supported geographical regions which support replication. With our primary location being UK South, we are going to leave the default region of the East US. Let’s click on Advanced settings at the top now. Here we have a few different values we need to configure, including the target subscription, VM resource group, virtual network, availability group, and proximity placement if applicable. Due to me having no resources in the East US region, most of these resources are all going to be new. </p>
<p>We then need to look at the capacity reservation group which allows you to reserve compute resources in the target region. Finally, we can specify any storage settings like the disk type, replication settings or extension update settings. We can then review our final configuration and start the replication process</p>
<p>For this final demo in this module, we are going to show how we can snapshot virtual machines and use this as a backup. We are back in the Azure portal for the final time in this module and once again navigating to the virtual machine we want to snapshot. Now we are actually going to snapshot the OS disk, so we select disks and then the OS disk.</p>
<p>Here we see the Create Snapshot option so we select this. Now we need to enter all the relevant values like a name, subscription, and resource group. We also need to decide on the snapshot type, do we want a full read-only copy, or do we want to use an incremental snapshot and save on disk space.</p>
<p>The rest of the settings are locked in and grayed out so we cannot change them. Let’s move on to the encryption options, and here we can either use encryption at-rest with a platform-managed key, which is default. Or we can use encryption at-rest with a customer-managed key, or finally, we can use double encryption with platform-managed and customer-managed keys. We will leave it the default setting and move into networking.</p>
<p>With network connectivity, we can either allow Public endpoints which are all networks, Private endpoints which are through disk access, or deny all network connectivity. We are going to leave it in public and move on to tags. Here, as with most Azure resources, you can set any tags you may be required to set, then finally you can review and create your snapshot backup</p>
<h1 id="Configure-Backup-and-Restore-for-FSLogix-User-Profiles-Personal-Virtual-Desktop-Infrastructure-VDI-and-Golden-Images"><a href="#Configure-Backup-and-Restore-for-FSLogix-User-Profiles-Personal-Virtual-Desktop-Infrastructure-VDI-and-Golden-Images" class="headerlink" title="Configure Backup and Restore for FSLogix User Profiles, Personal Virtual Desktop Infrastructure (VDI), and Golden Images"></a>Configure Backup and Restore for FSLogix User Profiles, Personal Virtual Desktop Infrastructure (VDI), and Golden Images</h1><p>Welcome to this module on configuring backup and restore for FSLogix user profiles, personal virtual desktop infrastructure (VDI), and golden images. In this module we will cover the following topics:</p>
<ul>
<li>How to backup Azure File shares</li>
<li>Golden Image backup options</li>
</ul>
<p>Let’s start off by discussing how we can backup the Azure File share that we utilize for our FSLogix user profiles. The first step is that we need to create a recovery services vault. This is a management entity that stores recovery points that have been created over time.</p>
<p>It provides an interface to perform backup-related operations These include taking on-demand backups, performing restores, and creating backup policies.</p>
<p>We can configure a backup in a few different ways. For multiple file shares we can use the recovery services vault. This is done from the recovery services vault pane within the Azure Backup service. Another option is to configure a backup from the Azure file share pane.</p>
<p>Let’s finish off this module by discussing golden image backup options. When creating the golden image from within the Azure portal, you can snapshot the VM which will store the image and will form your backup for the golden image.</p>
<p>You need to ensure you snapshot the VM image after all the patching is completed, after all the apps are installed, but before you run the sysprep. Then when it comes to updating the golden image with future patching and app updates, you boot to the snapshot, update the image and follow the same process to back this up again.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We have covered several important topics in this course. First, we looked at planning and implementing a disaster recovery plan for Azure Virtual Desktop. In this module we discussed disaster recovery in AVD and how you can utilize a second region to failover to, we then discussed Azure virtual machine replication, and finally looked at how we can facilitate FSLogix replication.</p>
<p>In the second module, we looked at designing a backup strategy for Azure Virtual Desktop, and this was very demo-heavy. We ran through three demos, including backing up a VM using Azure Backup, a demo to configure Azure Site Recovery for a VM, and finally how to snapshot an Azure VM for backups.</p>
<p>In the final module of this course, we took a dive into configuring backup and restore for FSLogix user profiles, personal virtual desktop infrastructure (VDI), and golden images. In this module, we talked about backing up Azure file shares and the backup option for golden images.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Configuring-Apps-on-a-Session-Host-in-Azure-Virtual-Desktop-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Configuring-Apps-on-a-Session-Host-in-Azure-Virtual-Desktop-22/" class="post-title-link" itemprop="url">AZ-140-Configuring-Apps-on-a-Session-Host-in-Azure-Virtual-Desktop-22</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 19:09:55" itemprop="dateCreated datePublished" datetime="2022-11-13T19:09:55-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:32:46" itemprop="dateModified" datetime="2022-11-14T06:32:46-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Configuring-Apps-on-a-Session-Host-in-Azure-Virtual-Desktop-22/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Configuring-Apps-on-a-Session-Host-in-Azure-Virtual-Desktop-22/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course on installing and configuring applications on a session host. My name is Shabba Azdah and I’ll be your instructor for this course. I am an Azure Virtual Desktop specialist and I’ve been working in the Microsoft Cloud services for several years. Specifically with Azure Virtual Desktop since its inception and multiple Azure-focused certifications. My contact information is available on the screen. Please feel free to reach out to me with any questions, comments or concerns, and I’ll be happy to discuss these with you. For any other issues, you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:&#115;&#117;&#112;&#112;&#x6f;&#114;&#116;&#x40;&#99;&#108;&#x6f;&#x75;&#x64;&#97;&#99;&#97;&#x64;&#101;&#x6d;&#x79;&#x2e;&#x63;&#111;&#109;">&#115;&#117;&#112;&#112;&#x6f;&#114;&#116;&#x40;&#99;&#108;&#x6f;&#x75;&#x64;&#97;&#99;&#97;&#x64;&#101;&#x6d;&#x79;&#x2e;&#x63;&#111;&#109;</a>. One of our Cloud experts will follow up with you.</p>
<p>This course is intended for anyone planning to take the Azure Virtual Desktop specialty exam and anyone interested in learning how to deploy an Azure Virtual Desktop environment. By the end of this course, you will have knowledge on configuring dynamic application delivery by using MSIX app attach, implementing application masking, deploying an application as a remote app, implementing and managing One Drive for business for a multi-session environment, implementing and managing Microsoft teams AV redirect, implementing and managing browsers and internet access for Azure Virtual Desktop, creating and configuring an application group, troubleshooting application issues related to Azure Virtual Desktop.</p>
<p>To get the most from this course, you should have an administrator-level understanding of Azure Cloud services. When I created this course, all information was current. Feedback on course content hosted by Cloud Academy is always appreciated and encouraged as it allows us as trainers to improve, which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact supportcloudacademy.com. If you notice any updates or corrections, please reach out to us. Thank you.</p>
<h1 id="Configuring-Dynamic-Application-Delivery-with-MSIX-App-Attach"><a href="#Configuring-Dynamic-Application-Delivery-with-MSIX-App-Attach" class="headerlink" title="Configuring Dynamic Application Delivery with MSIX App Attach"></a>Configuring Dynamic Application Delivery with MSIX App Attach</h1><p>Welcome to this module on configuring dynamic application delivery by using MSIX App Attach. We’ll cover the following topics. We’ll start off by discussing what is MSIX App Attach. Next, how does MSIX App Attach work.</p>
<p>We’ll finish off with a demo of setting up a file share for MSIX App Attach. Let’s start off by discussing what MSIX App Attach is. MSIX is a Windows app package format that provides modern packaging experience to all Windows applications. It allows you to create a separation between the user’s data, the operating system, and the applications. MSIX removes the need for repackaging when delivering the applications dynamically. It also allows you to reduce the amount of time it takes users to log into the AVD session, but also reduces the amount of infrastructure required, which also lowers cost. Now we know what MSIX App Attach is.</p>
<p>Let’s discuss how it works. It follows the following steps&#x2F;stages. First we have the stage step, which is when the MSIX App Attach notifies the OS file application is available and that the virtual disk that contains the MSIX package is available. Next, we have the registration step. This is when the MSIX App Attach uses a per user process to make the application available to users. Moving on, we have the delayed registration step. This is when the complete registration of the app is delayed until the user decides to run it. Once you have used the app and have finished, we then have the deregistration step, where the application is no longer available to the user after you sign out.</p>
<p>Finally, we have the D stage step. In this, the application is no longer available from the session host after a shutdown or restart of the VM. The steps we have just discussed all happen in the background, and the user does not experience this. As a user, you sign into the AVD remote desktop application as normal and select the hotspot you want to utilize. The user profile is unloaded from an Azure file share and then the MSIX App Attach applications are registered to the session host VM for the user. To complete this module, we’re going to complete a walk-through demo of setting up a file share, specifically an Azure file share for MSIX App Attach.</p>
<p>Here we are logged into our AD DS server and we need to create a new security group for our session host. We need to create a new security group in this domain, which will need to be synchronized to as Azure AD. Once we have created this group, in our case we call it session host, we then need to add the session host object into this group. Once we have finished this task, we need to complete an Azure AD connect sync, so we can have a way or we can force the sync with PowerShell. We are now in the Azure portal and have navigated to the storage account.</p>
<p>If you have not already done so, you will need to create the storage account or even Azure file share. And if you have followed previous Cloud Academy modules on then AZ-140 certification path, you have already completed this when creating the user profile share, including joining the storage account to your AD DS domain. We already have the storage account and I’ve created a new file share called MSIX. However, we need to assign the relevant storage roles to the session host security group, admins, and to the users who will be accessing the applications. We click on ‘Add Role Assignment’ and first assign the storage file data SMB share contributor role to the session host security group.</p>
<p>You’ll need to follow the same process, but assign the users the storage file data SMB share contributor role and the storage file data SMB share elevated contributor role to the administrators. We now need to mount the share to a VM so we can assign the relevant NTFS permissions. If you never get to this Azure storage account and the MSIX share you created, click on ‘Connect’ and then select the Active Directory authentication method.</p>
<p>Finally, copy the script to a notepad as we are going to run this in our VM to mount the share. The final step in this demo is to mount the share to our domain joined VM and add the NTFS permissions. We run the PowerShell script we copied earlier and run this with elevated privileges. Once this has run successfully, we navigate to Windows Explorer and go to the Map Drive. We can then go to the properties of the share and add the relevant NTFS permissions, including granting full control of the share to admins and read, execute, read on this folder content access to the session host group and the users.</p>
<h1 id="Deploying-an-Application-as-a-RemoteApp"><a href="#Deploying-an-Application-as-a-RemoteApp" class="headerlink" title="Deploying an Application as a RemoteApp"></a>Deploying an Application as a RemoteApp</h1><p>Welcome to this module on deploying an application as a Remote App. We will cover the following topics in this module. We’ll explain what remote app is from an Azure virtual desktop perspective. We’ll then explain the requirements we need to be met before you can deploy a remote app. We will complete this module by doing a demo of deploying a remote app in AVD. Let’s start this module by discussing what a remote app actually is. It’s essentially application streaming as a service, which means you are using as your virtual desktop to deliver apps to your customers over a secure network via virtual machines.</p>
<p>Although you are streaming the apps via virtual machine, you do need to grant the user access to the desktop by the specific remote app you are streaming. The custom app is streamed from a session host, meaning you need to ensure that app is installed on the golden image you have utilized for the existing session host. Now we understand what a remote app is, let’s talk about some of the requirements you need to have in place before deploying it. You need to have your custom app in place. This includes MSIX space applications, something we already discussed in this module, or an application that is already installed on your deployed session host. You need to ensure you have an identity, so credentials to your domain. This will be used to grant access to the host pool that is hosting the remote app within your AVD environment.</p>
<p>Finally, we need to ensure you have an Azure subscription. It will not be possible to deploy an AVD resource without this. So, it is the most vital requirement. In the final lecture of this module, we’ll complete a walk-through demo of deploying an application as a remote app. Here we are back in the Azure portal and we are going to navigate to the Azure virtual desktop service and click on application groups. We already have an existing application group for our AVD pooled host pool, but we’ll create a new one for our remote app. We need to enter all the relevant details like subscription, resource group, and the host pool you want to associate with this remote app. We then give it an appropriate name and click on ‘Next’. Here, we want to select the application which is installed on the session host that we want to create as a remote app. In our case, it’s his notepad. We have to save this and add the users who need to have access to this remote app. We then associate it with an existing or new workspace. Configure any advanced settings or tags. In our case, we do not, and then review and create.</p>
<h1 id="Implementing-and-Managing-OneDrive-for-Business-for-a-Multi-Session-Environment"><a href="#Implementing-and-Managing-OneDrive-for-Business-for-a-Multi-Session-Environment" class="headerlink" title="Implementing and Managing OneDrive for Business for a Multi-Session Environment"></a>Implementing and Managing OneDrive for Business for a Multi-Session Environment</h1><p>Welcome to this module on implementing and managing OneDrive for business for a multi-session environment. We’ll cover the following topics in this module. We’ll first do an overview of OneDrive for business with AVD. We’ll end this module with demo of installing and deploying OneDrive sync app per machine. Let’s start off by looking at an overview of OneDrive for business. It is supported in the following environments: Windows 10, both 32 bit and 64 bit architecture, where it supports VHDX files, Windows 7, both 32 and 64 bit architecture, where it supports VHD files. It is also supported on Windows Server OS versions 2008 R2 through to 2019, excluding Windows 7 2012. It supports VHDX files with all the Windows Server OS apart from service files on a R2, where it supports VHD files. It also supports non-persistent environments that have FSLogix apps or FSLogix office content.</p>
<p>Finally, you need to ensure you have a Microsoft 365 subscription that supports operating system we mentioned earlier in this lecture. In the final lecture of this module, we’ll complete a walkthrough demo of installing the OneDrive sync app per machine. Here we are logged into our session host and we are going to use PowerShell to install OneDrive per machine. We have already downloaded the onedrive.exe file, so that’s from PowerShell as admin, and change the directory to the folder where the install file is stored. We then need to run the command with the all users parameter, so OneDrive installs for all users, not just the one we are logged in with. Once the install is completed, we can browse to the start menu and see if OneDrive for business is installed. And browse to program files (x86)\Microsoft OneDrive directory, which confirms this has been installed on the virtual machine, rather than the user’s local profile.</p>
<h1 id="Implementing-and-Managing-Microsoft-Teams-AV-Redirect"><a href="#Implementing-and-Managing-Microsoft-Teams-AV-Redirect" class="headerlink" title="Implementing and Managing Microsoft Teams AV Redirect"></a>Implementing and Managing Microsoft Teams AV Redirect</h1><p>Welcome to this module on implementing and managing Microsoft Teams AV. In this module, we’ll cover the following topics: We’ll discuss the RDP redirection properties that need to be in place for Microsoft Teams, we’ll finish this module by doing a run through demo of installing and configuring the Microsoft Teams desktop app.</p>
<p>Let’s start this module by discussing the RDP redirection properties that need to be in place to enable Microsoft Teams to work within the AVD environment. RDP redirection is not needed if you are utilizing media optimization within your Azure Virtual Desktop environment. If you are using media optimization, then there are three redirection properties you need to set. You first need to enable audio capture from the RDP properties. We need to ensure you set the audio mode to one if it is not already done so.</p>
<p>Finally, you need to redirect the local device’s camera via RDP properties. In the final lecture of this module, we’ll complete a walk through demo of installing the Microsoft Teams desktop app. Here we are logging to our session host and before we install anything, we need to configure a registry entry. Let’s open the registry editor and navigate to HKEY_local_machine software Microsoft Teams. If a team key is not there, you can create this. We then want to create a D word key with the name is AVD environment. I will set value to one. Once we have set this we need to download and install the Teams WebSocket service.</p>
<p>As you can see, we have already downloaded the install file along with the Teams install package for later. We follow the instructions on Teams WebSocket service install until this is completed. The final part of this demo is to install the Microsoft Teams MSI package which we are going to do via PowerShell. There are two types of install method, either per user install or the per machine install. We are going to complete the per machine install commander, which is MSIexec&#x2F;I and then the path to the MSI&#x2F;L*V. And then the file path to the install log file. All user equals one. We have saved our MSL file to the C temp directory, which is the same location we will start our installation log file. Once this is completed, we are ready to use Microsoft Teams.</p>
<h1 id="Implementing-and-Managing-Browsers-and-Internet-Access-for-AVD-Sessions"><a href="#Implementing-and-Managing-Browsers-and-Internet-Access-for-AVD-Sessions" class="headerlink" title="Implementing and Managing Browsers and Internet Access for AVD Sessions"></a>Implementing and Managing Browsers and Internet Access for AVD Sessions</h1><p>Welcome to this module on implementing and managing browsers and internet access for Azure Virtual Desktop sessions. We will cover the following topics in this module. We’ll discuss managing internet access for AVD. We’ll finish this module by talking about managing browsers on a session host.</p>
<p>Let’s start off by talking about managing internet access for Azure Virtual Desktop. There are multiple methods in which you can control and manage into the access from Azure Virtual Desktop. You can implement network security groups, NSG, to create inbound and outbound rules on what parts are able to route out to the internet. You can implement an Azure firewall within your AVD environment to filter traffic inbound and outbound to the internet. This allows you more flexibility and control than an LSG, as well as additional security measures for internet access, like web filtering.</p>
<p>You can also implement a network virtual appliance, NVA, which includes third-party firewalls have the same control and flexibility as an Azure firewall for internet access. Depending on your requirements, you can block or allow access to the internet from your AVD session host. Finally, as we touched on earlier, you can filter access to the internet from AVD by using features like web filtering to block certain categories of websites like gambling.</p>
<p>In the final section of this module, we are going to discuss managing browsers on a session host. There are multiple methods you can utilize to deploy browsers within a session host. You can publish an application using MSIX App Attach or a Remote app. You can facilitate this by using the New-AzWvdApplication commander in PowerShell. If the browser needs to be standard for all users, you can include it as part of your golden image, which ensures it is applied to all session hosts. Finally, Azure Virtual Desktop Windows 10 session hosts support multiple browsers, including Google Chrome, Mozilla Firefox, and Edge Chromium.</p>
<h1 id="Creating-and-Configuring-an-Application-Group"><a href="#Creating-and-Configuring-an-Application-Group" class="headerlink" title="Creating and Configuring an Application Group"></a>Creating and Configuring an Application Group</h1><p>Welcome to this module on creating and configuring an application group. We will look at the following topics in this module. We’ll explain what application group is within an AVD environment. In the final lecture of this module, we’ll complete a walk-through demo of creating, configuring an application group. Let’s start this module by explaining what an application group is. It is a collection of remote applications that you published within the Azure Virtual Desktop environment. You must associate the application group with a pooled host pool only, not a personal host pool. You can publish both Windows desktop and remote app within an application group. Finally, you can create an application group using the Azure portal, PowerShell, and Azure CLI.</p>
<p>In the demo at the end of this module, we’ll show how to create an application group via the Azure portal. In the final lecture of this module, we’ll complete a demo walk-through of configuring an application group for your PowerShell. We saw in the remote app module, how to create an application group via that Azure portal earlier. In this demo we’re going to create an application group as a remote app with PowerShell. Here we are in the Azure portal and we are going to use the Azure Cloud Shell with PowerShell to run our commanders.</p>
<p>First command that we want to run is the new AZ WVD application group. Well, we need to specify the name we want to give the new application group, the name of our resource group, the type of application group we want to create, in our case this is a remote app, and then the host pool Arm path. At the end, we need to specify the region we want the application group to exist in. Next, we need to find the name of the app earliest we want to configure as our remote app. So, to get this information we run the get dash is at WVD start menu item, where we specify our application group name, and resource group name. This will output all the apps on the start menu and the alias name. So, we can specify this in the next command that we need to run.</p>
<p>Finally, we run the new AZ WVD application commander where we can specify that app alias we documented from the commander before as well as our group name; name we want to give the app and the resource group name. Once these three commanders are completed, we have provisioned our application group.</p>
<h1 id="Troubleshooting-Application-Issues-Related-to-AVD"><a href="#Troubleshooting-Application-Issues-Related-to-AVD" class="headerlink" title="Troubleshooting Application Issues Related to AVD"></a>Troubleshooting Application Issues Related to AVD</h1><p>Welcome to this module on troubleshooting application issues related to Azure Virtual Desktop. We will discuss the following topics in this module. We’ll discuss information gathering and about application issues related to AVD. We’ll finish off the module by looking at performance counters. Let’s start this module by discussing information gathering when troubleshooting application issues in AVD.</p>
<p>Generally, poor application performance is very hard to diagnose. You need to start this process by first collecting information on CPU usage, memory usage, and storage disk input&#x2F;output metric. However, the data alone is not enough to find root cause issues with application performance. We need to use performance counters if we want to use the information you have gathered to find the root cause of an application performance issue.</p>
<p>The user input delay counter can help you quickly identify the root cause for bad end-user RDP experiences including poor application performance. This count measures how long any user input stays in the queue before it’s picked up by a process. It works both locally and in remote sessions. You need to enable a register key under HK Local Machine, System, CurrentControlSet, Control, Terminal Server, and create a REG_DWORD key called EnableLagCounter, then set it to the value of one. Finally, you need to use the Performance Monitor Windows application to review the performance counters once you have enabled them and restarted your session host.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We covered a lot of ground in this course, including several important topics around installing and configuring apps on a session host. We started the course by discussing Configuring Dynamic Application delivery by using MSIX App Attach.</p>
<p>In this section, we explained what MSIX app attach is, how it works, and finished off with a demo of setting up a file share for MSIX App Attach. We then moved on to the topic of implementing app masking, where we explained what FSLogix Application Masking is and then completed the section with the demo of implementing FSLogix App masking on a session host. The third section of this course saw us cover Deploying an Application as a RemoteApp, in which we focused initially on explaining what RemoteApp is, what its requirements are, and again finished up with the demo of deploying a RemoteApp via the Azure Portal.</p>
<p>Next, we moved on to discussing, implementing, and managing OneDrive for Business for Multi-Session Environments. In this section, we discussed an overview of OneDrive for Business and finished off with a demo of installing OneDrive sync app per machine version. Following on from here, we tackled the topic Implementing and Managing Microsoft Teams AV. We initially focused on talking about RDP redirection properties within AVD that needs to be in place before implementing Microsoft Teams. We finished the section off by completing a walk-through demo of installing Microsoft Teams desktop app. We continued with the course and moved on to the topic of implementing and managing browsers and Internet access for Azure Virtual desktop.</p>
<p>In this short section, we discussed managing Internet access and managing browsers on a session host. In the penultimate section of this course, we discussed creating and configuring application group. Here, we explained what an application group is, followed by a demo of configuring application group via Azure PowerShell in the Azure Portal. In the final section of this course, we had a closer look at troubleshooting application issues related to Azure Virtual Desktop. Here, we covered information gathering and finally discussed performance counters.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Knowledge-Check-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Knowledge-Check-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-21/" class="post-title-link" itemprop="url">AZ-140-Knowledge-Check-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-21</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-11-13 19:05:02 / Modified: 20:01:00" itemprop="dateCreated datePublished" datetime="2022-11-13T19:05:02-04:00">2022-11-13</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Knowledge-Check-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-21/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Knowledge-Check-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-21/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><object data="8.pdf" type="application/pdf" width="100%" height="600"></object></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-20/" class="post-title-link" itemprop="url">AZ-140-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-20</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 19:00:45" itemprop="dateCreated datePublished" datetime="2022-11-13T19:00:45-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:32:54" itemprop="dateModified" datetime="2022-11-14T06:32:54-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-20/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Configuring-User-Experience-Settings-in-Azure-Virtual-Desktop-20/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course on Configuring User Experience in Azure Virtual Desktop. My name is Shabaz Darr and I’ll be your instructor for this course. I am an Azure Virtual Desktop Specialist and have been working in the Microsoft cloud services for several years, specifically with Azure Virtual Desktop since its inception, and have multiple Azure-focused certifications. My contact information is available on the screen. </p>
<p>Please feel free to reach out to me with any questions, comments, or concerns and I will be happy to discuss these with you. For any other issues, you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:&#115;&#x75;&#112;&#x70;&#111;&#x72;&#x74;&#64;&#x63;&#x6c;&#111;&#117;&#x64;&#x61;&#x63;&#x61;&#x64;&#x65;&#x6d;&#121;&#x2e;&#99;&#111;&#109;">&#115;&#x75;&#112;&#x70;&#111;&#x72;&#x74;&#64;&#x63;&#x6c;&#111;&#117;&#x64;&#x61;&#x63;&#x61;&#x64;&#x65;&#x6d;&#121;&#x2e;&#99;&#111;&#109;</a> and one of our cloud experts will follow up with you. This course is intended for anyone planning to take the Azure Virtual Desktop Specialty exam and anyone interested in learning how to deploy an Azure Virtual Desktop environment</p>
<p> By the end of this course, you will have knowledge on:</p>
<ul>
<li>Configuring Universal print</li>
<li>Configuring user settings through group policies and Endpoint Manager policies</li>
<li>Configuring persistent and non-persistent desktop environments</li>
<li>Configuring Remote desktop Protocol (RDP) properties on a host pool</li>
<li>Configuring session timeout properties</li>
<li>Troubleshooting user profile issues</li>
<li>Troubleshooting Azure Virtual Desktop clients</li>
</ul>
<p>To get the most from this course you should have an Administrator-level understanding of Azure Cloud services. When I created this course, all information was current. Feedback on course content hosted by Cloud Academy is always appreciated and encouraged, as it allows us as trainers to improve which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:&#115;&#117;&#x70;&#x70;&#x6f;&#114;&#116;&#x40;&#99;&#x6c;&#x6f;&#117;&#100;&#x61;&#99;&#x61;&#100;&#x65;&#109;&#x79;&#x2e;&#99;&#111;&#109;">&#115;&#117;&#x70;&#x70;&#x6f;&#114;&#116;&#x40;&#99;&#x6c;&#x6f;&#117;&#100;&#x61;&#99;&#x61;&#100;&#x65;&#109;&#x79;&#x2e;&#99;&#111;&#109;</a>.</p>
<p>If you notice any updates or corrections, please reach out to us. Thank you!</p>
<h1 id="Configuring-Universal-Print"><a href="#Configuring-Universal-Print" class="headerlink" title="Configuring Universal Print"></a>Configuring Universal Print</h1><p>Welcome to this module on configuring Universal Print. In this module we will discuss the following topics:</p>
<ul>
<li>We will first explain exactly what the Universal Print service is</li>
<li>Next, we will look at some of the prerequisites that need to be implemented before you can deploy the Universal Print service.</li>
<li>Finally, we will explain the four steps you need to complete when setting up Universal Print</li>
</ul>
<p>Let’s start off by explaining exactly what the Universal Print service is. It is a modern print solution that you can utilize to manage your print infrastructure. It runs completely in Azure and require zero on-premises infrastructure.</p>
<p>From a license perspective, it is a Microsoft 365 subscription-based service, so there is no need to purchase any extra license. Finally, it is fully integrated with Azure AD and supports single sign-on (SSO).</p>
<p>Now we know what the Universal Print service is, let’s move on to looking at prerequisites. As with most cloud-based services, you need to ensure you complete certain tasks before you can start to deploy or implement it.</p>
<p>For the Universal Print service, you need to ensure that an eligible license has been assigned to the admin user who will be configuring the deployment. You then need to ensure the user has either the Printer Administrator role or the Global Administrator role. Keep in mind that it is best practice to follow least privilege access when assigning admin roles.</p>
<p>Finally, you need to ensure you have a Windows 10 client device running version 1903 and above. Using the latest OS release will provide a much richer user experience. In this final lecture of this module, let’s look at the 4 steps that need to be completed to deploy the Universal Print Service. </p>
<p>Step 1 is to set up the Universal Print connector. This is the component that you can utilize to make a printer work with Universal Print. You use this connector when you do not have a printer that directly connects to the Universal Print Service.</p>
<p>Step 2: You need to register the printers by using the Universal printer connector. This is similar to installing a printer on a print server. Once it is registered it will be accessible to add to devices for users with the relevant permissions.</p>
<p>This leads us well to Step 3, which is to assign permissions and share the printer. You can assign permissions to Azure AD users and security groups. Once the permissions are granted, it then needs to be shared.</p>
<p>Step 4, the final step, is to add the Universal printer to the end-users Windows device. You need to ensure the device is connected to the Internet and that it is either Azure AD joined, Azure AD registered, or Hybrid Azure AD joined before adding the printer. </p>
<h1 id="Configure-User-Settings-through-Group-Policies-and-Endpoint-Policies"><a href="#Configure-User-Settings-through-Group-Policies-and-Endpoint-Policies" class="headerlink" title="Configure User Settings through Group Policies and Endpoint Policies"></a>Configure User Settings through Group Policies and Endpoint Policies</h1><p>Welcome to this module on configuring user settings through group policy and endpoint manager policies. In this module we will cover the following topics:</p>
<ul>
<li>Configuring Azure Virtual Desktop via Group Policy, including a walkthrough demo</li>
<li>Configuring Azure Virtual Desktop via Endpoint Manager, including a walkthrough demo</li>
</ul>
<p>Let’s start this module by looking at configuring AVD via Group Policy. In order to allow Group Policy to be able to access Azure Virtual Desktop, you need to ensure your session hosts are either Active Directory Domain joined, or Hybrid joined.</p>
<p>You can then deploy group policies the same way you would in an on-premises environment, including being able to configure both computer configuration policies and user configuration policies. Let’s do a demo configuration of a group policy for Azure Virtual Desktop.</p>
<p>Here we are logged into one of our Azure virtual machines that we are preparing as a golden image for our AVD deployment. We need to navigate to the local group policy app from the Start menu. As you can see here we have both Computer and User configuration. </p>
<p>We will now browse to the Windows settings under Computer configuration, then Security settings then click on the Network List Manager Policies. We have 4 options here, but we want to choose All networks. This policy Is going to allow us to control permissions for if users can change the network name, location, or icon from within the session. We are going to change each option so the user cannot change any of them and click on OK.</p>
<p>Let’s check out some additional settings we can configure via Group Policy. This time, under computer configuration, let’s select administrative templates and then expand network. Here we have a whole host of settings we can configure, including Background Intelligent Transfer Service (BITS) and DirectAccess Client Experience Settings. </p>
<p>Let’s select the BITS settings and again we have a whole list of settings we can configure. For example, if we double click ‘Do not allow the computer to act as a BITS processing server’ if we enable this then the session hosts will no longer cache downloaded files and offer them to its peers.</p>
<p>Let’s now check out the network settings we can configure, specifically the ‘Prohibit use of Internet Connection Sharing on you DNS Domain network’. By enabling this setting, ICS cannot be enabled or configured by an administrator and the service cannot be run on this session host. We have multiple policies we can configure but this very much depends on your organization’s requirements. Now we have looked at configuring Group policy for Azure Virtual Desktop, let’s look at configuring AVD via Endpoint Manager.</p>
<p>In order to allow Endpoint Manager to be able to access Azure Virtual Desktop, you need to ensure your session hosts are either Azure AD joined, or Hybrid joined. However, there are some limitations, for example, it is not possible to deploy a configuration policy to configure Wi-Fi settings on a Windows 10 device. Additionally, Autopilot reset is not currently supported with Endpoint Manager integration. Another limitation example is that it is not currently possible to remotely wipe an Azure Virtual Desktop session host via Endpoint Manager. </p>
<p>We will finish this module with a demo of configuring Azure Virtual Desktop via Endpoint Manager.</p>
<p>Here we are logged into the Endpoint Manager portal. Let’s navigate to our session host which is Azure AD enrolled which we can see if currently fully compliant and managed by Intune. If we click on it we can see we have multiple options we can manage, but if we go back a step we can see the different types of policies and profiles we can configure, including Compliance policies, configuration profiles, and Windows 10 update rings.</p>
<p>If we go back into the device again, we can see the options that are support and not supported as they are greyed out, and if needed, we can obtain information from the left-hand side menu regarding device compliance and configuration.</p>
<h1 id="Configuring-Persistent-and-Non-Persistent-Desktops"><a href="#Configuring-Persistent-and-Non-Persistent-Desktops" class="headerlink" title="Configuring Persistent and Non-Persistent Desktops"></a>Configuring Persistent and Non-Persistent Desktops</h1><p>Welcome to this module on configuring persistent and non-persistent desktop environments. We will cover the following topics:</p>
<ul>
<li>Configuring persistent desktop environments including a walkthrough demo</li>
<li>Configuring non-persistent desktop environments including a walkthrough demo</li>
</ul>
<p>Let’s first look at configuring persistent environments. The definition of a persistent VDI environment is when the user has the same experience each time they login. This means they can access saved files and any specific customizations to the desktop are still intact every time they login, even after reboots.</p>
<p>There are two types of persistent environments available with Azure Virtual Desktop. The first is pooled host pools where users share the resources on the session hosts. We then have personal host pools which is a 1 to 1 ratio, so when the user logs in they are assigned the same session host with the same settings and files they saved the last time they logged in. FSLogix profile containers are utilized to facilitate user profiles which helps give the users a more persistent experience.</p>
<p>Let’s now do a quick demo of how to provision a persistent desktop in Azure Virtual Desktop via the Azure Portal. Here we are in the Azure Portal in the AVD blade and to create a persistent environment we need to create a new host pool. Let’s click on Create under the host pool blade and enter all the required details such as subscription, resource group, host pool name, and location.</p>
<p>As mentioned earlier in this section we have two types of persistent environments, pooled and personal host pools. If we click on pooled host pools we then need to set the load balancing algorithm. We again have two options, breadth-first or depth-first. Breadth-first is when all user connections are randomly sent to any available session host within the environment. Depth-first is when all new connections are sent to a single session host until it hits a limit that you set, after which any new connections are sent to the next available session host. Before we move on we set a connection limit and then move on to configuring the virtual machine settings for the host pool.</p>
<p>We enter all the required settings again like resource group, name prefix, location, availability zone, and Image. You can then select the VM size you wish to have as part of the your deployment. Once all the settings have been specified and you have entered all the relevant credentials, we can move on to configuring the workspace, then the advanced settings and tags. Finally, you can create your persistent desktop environment. Now we understand configuring persistent environments, let’s move onto looking at configuring non-persistent environments.</p>
<p>Non-persistent environments within Azure Virtual desktop are based on ephemeral disk, which is like a temporary disk. From a user experience perspective in a non-persistent environment, users essentially see a new desktop every time they log back in, they will not see any files that have been saved locally on the disk and any customizations that are made will also not be saved. Non-persistent environments using Ephemeral disks are ideal for stateless applications which are tolerant of individual virtual machine failures. </p>
<p>Let’s now do a quick demo of how to provision a non-persistent desktop in Azure by looking at how to provision an Ephemeral disk on an Azure VM. To configure our non-persistent desktop environment, we need to create the session hosts with Ephemeral disks. In this demo, I will walk through how to configure one with an Azure virtual machine. Here we are in the Azure portal in the virtual machine blade. We want to create an Azure virtual machine. We then need to configure all the standard basic settings, including subscription, resource group, VM name, region, and image.</p>
<p>Now we need to ensure we select VM size that is supported as not all sizes support Ephemeral disks. You need to ensure you select one with a large enough Temp disk cache. Once all the basic settings are configured, we then move onto the Disks tab. If you navigate to the bottom of the page under ‘Advanced’ you have the option for the Ephemeral disk which by default is set to none. We can either select OS cache placement or Temp disk placement depending on what our requirement is. We can then move onto the complete the rest of the VM configuration, including Networking, Management, Advanced, and Tags before finally creating the VM.</p>
<h1 id="Configuring-RDP-Properties-on-a-Host-Pool"><a href="#Configuring-RDP-Properties-on-a-Host-Pool" class="headerlink" title="Configuring RDP Properties on a Host Pool"></a>Configuring RDP Properties on a Host Pool</h1><p>Welcome to this module on configuring Remote Desktop properties (RDP) on a host pool. We will cover the following topics in this module:</p>
<ul>
<li>We will explain what the RDP properties are</li>
<li>Look at some examples of the RDP properties that can be configured</li>
<li>Finally, we will complete a walk-through demo of configuring some RDP properties in the Azure Portal</li>
</ul>
<p>Let’s start off by discussing what RDP properties are. RDP properties are a method for administrators to customize host pool features to meet your organizations’ requirements. The customizations you make can enhance the user experience as it gives them a more local desktop feel to the environment. There are two ways in which you can configure the RDP properties. First, you can make configuration changes via the Azure Portal, something we will explore in the demo at the end of this module. Secondly, you can use PowerShell with the Azure module to make changes to the RDP properties.</p>
<p>Now let’s move on to looking at some examples of RDP properties you can customize before we dive into the demo. Firstly, we have connection information. Here, for example, you can configure whether Remote Desktop will use CredSSP for authentication if it is available as well as specifying a program to automatically start when the remote computer is started.</p>
<p>Next, we have Session behavior. In this section, we can configure reconnection settings, compression settings, and video playback settings as a few examples. We then have a device redirection section. Here, we have a few customizations we can make, including Audio and Video redirection settings, and local devices and resource redirection including printers, drives, and USB devices.</p>
<p>Another important feature is being able to configure display settings for our Azure Virtual Desktop environment. This includes multiple monitors, resolution, and Desktop size as a few examples. The final customization is the Advance section. Here we can set custom RDP properties but in script form. We will take a closer look at this in the demo. In the final lecture of this module, we are going to complete a walk-through demo of configuring some of the RDP properties via the Azure Portal.</p>
<p>Here we are in the Azure Portal, specifically the Azure Virtual Desktop blade. To configure the RDP properties, we need to navigate to the Host pool and then under settings, we will find RDP properties. You can now see all the customizations options we mentioned earlier in this lecture. For the purpose of this demo, we are going to configure only a few of these settings.</p>
<p>Let’s start with Session Behavior. Here we are going to set the Reconnection option to automatically try and reconnect and the video playback setting to Use RDP-efficient multimedia streaming for the video playback when possible. </p>
<p>Moving onto the Device Redirection tab, we have a number of customizations we are going to set. We are going to start with setting the Microphone redirection, Redirect video encoding, and Audio output location. Under Local devices and resources, we will set the camera redirection, clipboard redirection, smart card redirection, and finally disable the USB redirection.</p>
<p>We are going to make a few changes to the display settings to finish off, including enabling multiple displays, setting the screen mode to full screen, and setting the desktop size. The final item I wanted to highlight in this demo is the Advanced tab, where you can set custom RDP properties in script form and separate them by semicolons.</p>
<h1 id="Configuring-Session-Timeout-Properties"><a href="#Configuring-Session-Timeout-Properties" class="headerlink" title="Configuring Session Timeout Properties"></a>Configuring Session Timeout Properties</h1><p>Welcome to this module on configuring session timeout properties. We will cover the following topics in this module:</p>
<ul>
<li>We will explain what session timeout properties are</li>
<li>We will finish off with a demo walkthrough of configuring session timeout properties for Azure Virtual Desktop</li>
</ul>
<p>Let’s start off by looking at exactly what session timeout properties are. The session timeout feature allows you to log off user sessions that have been inactive for a specified amount of time. It is configured via the local group policy on a session host, so it would be recommended to implement this during the golden image creation. This way it is deployed to all session hosts.</p>
<p>The session timeout properties configuration includes setting time limits for, disconnected sessions, active but idle remote desktop services sessions, active remote desktop services sessions, and finally, you can configure the ability to end sessions when time limits are reached. We will set all these properties in the demo which is next.</p>
<p>Now we understand what session timeout properties are, let’s complete a walkthrough demo of configuring them via the local group policy on a session host. Here we are in our virtual machine which we are going to use for our session host golden image. We need to open the local group policy editor. Once it is opened, we navigate to ‘Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Remote Desktop Services &gt; Remote Desktop Session Host &gt; Session Time Limits. Here we have all the session time-out policies we discussed earlier in this module.</p>
<p>Let’s first edit ‘Set time limit for disconnected sessions’, enable it, and set this to 30 minutes. Next, let’s edit the ‘Set time limit for active but idle Remote Desktop services sessions’ but set this to a little sooner at 10 minutes. Next, let’s edit ‘Set time limit for active Remote Desktop Services sessions’, enable it, but leave it set to never. We are now going to enable the policy called ‘End session when time limits are reached’, in the event we set time limits within our AVD environment. The final policy we want to configure is the ‘Set time limit for logoff of RemoteApp sessions’ and after enabling this we will set it to 30 minutes. This completes the configuring session timeout demo.</p>
<h1 id="Troubleshooting-User-Profile-Issues"><a href="#Troubleshooting-User-Profile-Issues" class="headerlink" title="Troubleshooting User Profile Issues"></a>Troubleshooting User Profile Issues</h1><p>Welcome to this module on troubleshooting user profile issues. In this module we will cover the following topics:</p>
<ul>
<li>We will look at the tracks you can utilize to escalate issues with Microsoft</li>
<li>We will then discuss the different methods of reporting issues</li>
<li>Finally, we will touch on some common user profile related issues you might come across</li>
</ul>
<p>Let’s start by discussing Escalation tracks. When you are faced with an issue including profile-related ones and you are struggling to find a solution, you can escalate the issue directly to Microsoft. Before doing this however you can take a look at the Azure Status page and the Azure Service health page in the portal to check if there are any known issues or outages that might be the root of your problem. If that is not the case, you can move forward with opening an Azure support request so you can troubleshoot the issue with the Microsoft Engineer.</p>
<p>Let’s now discuss Reporting issues. There are many different places you can find help for all types of Azure Virtual Desktop issues, including profile-related problems. To start with you can create a thread within the AVD Tech community site where you can potentially receive help and advice from other Tech professionals who may have had similar issues and recommend a solution.</p>
<p>As we mentioned earlier, you can report issues directly to Microsoft by creating a support ticket. As well as problems you can also suggest new features you might want to see within the AVD environment and Microsoft can take this into consideration. In the final section of this module, let’s discuss some common user profile-related issues you may come across when managing and implementing Azure Virtual Desktop.</p>
<p>Some common user profile issues include the user profile failing to attach to the session. In this case, you will get an error and are unable to sign in. This can be caused by communication issues between the session hosts and the profile containers, and a reboot of the session can resolve this. Another issue may be that you could be logged in with a local profile, rather than your network profile. This can be caused by permissions or a corrupt profile. Finally, a common issue you might find is that the FSLogix profile container has not been correctly configured in the Image so all the session hosts will have the incorrect user profile path.</p>
<h1 id="Troubleshooting-Azure-Virtual-Desktop-Clients"><a href="#Troubleshooting-Azure-Virtual-Desktop-Clients" class="headerlink" title="Troubleshooting Azure Virtual Desktop Clients"></a>Troubleshooting Azure Virtual Desktop Clients</h1><p>Welcome to this module on Troubleshooting Azure Virtual Desktop clients. We will cover the following topics in this module:</p>
<ul>
<li>We explain what the Remote Desktop Client is</li>
<li>We will finish off the module by discussion some common issues with the Remote Desktop client</li>
</ul>
<p>Let’s start by explaining what the Remote Desktop client is. This is an application that is utilized by your end users to connect into your Azure Virtual Desktop environment. It is supported on multiple platforms and operating systems, including Windows, Android, iOS, MacOS, and a web client version.</p>
<p>Let’s finish off this short module by discussion some of the common issues you may come across with the Remote Desktop client. You may come across an issue where the client app has stopped responding. In this scenario, you can reset the user data by using the command called msrdcm.exe which will remove user data, restore default settings, and unsubscribe from all workspaces. Another common issue you may come across is that the web client will not open. With this type of issue, you need to do a DNS check to ensure your internet connection is working as expected. If this is the case, then restart your web browser or try a different browser.</p>
<p>You might come across a problem where the client has opened and logged in correctly, however you see no resources. For this type of issue, ensure the user is logged in to the app from the correct Azure AD account. If these checks are ok and you need to ensure your app group is associated with a workspace. The final common issue I want to touch on is when your web client stops responding or continually disconnects. In this type of scenario, you should try reconnecting using a different browser or different client.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We have covered several important topics in this course. We started off by discussing the Universal Print service, where we explained what this service was, some of the prerequisites that need to be in place before we can use it, and four high-level steps you need to complete to implement this service. We then moved on to talking about configuring user settings through Group Policy and Endpoint Manager. In this lecture, we looked at configuring the user settings via Group Policy, including a walkthrough demo of how to implement this. We then discussed configuring AVD via Endpoint Manager which also included a demo.</p>
<p>Moving on, we looked at persistent and non-persistent desktop environments where we initially discussed what persistent desktops are including a walkthrough demo of how to configure a pooled host pool. We then did the same with looking at non-persistent desktops, which included a walkthrough demo of implementing an Ephemeral disk to an Azure Virtual machine. We continued on in this module to talk about configuring Remote Desktop Protocol (RDP) properties on a host pool. This lecture included discussing what the RDP properties were, then looking at examples of the RDP properties, finishing off with a walkthrough demo of configuring the RDP properties in the Azure portal.</p>
<p>Next, we took a closer look at Session timeout properties. We touched on two topics in this lecture. First, we discussed what session timeout properties are, and second, we did a walkthrough demo of configuring session timeout properties via the local group policy settings. In the penultimate lecture in this module, we took a closer look at Troubleshooting user profile issues. We initially discussed options around escalating issues to Microsoft, then the different methods in which you can report issues, and finally some common user profile issues you may come across with AVD.</p>
<p>In the final lecture in this module, we talked about Troubleshooting Azure Virtual Desktop clients. We covered two topics in this lecture. First, we explained what the Remote Desktop client is and then discussed some common issues that you may encounter with the Remote Desktop client app.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/13/AZ-140-Managing-Access-to-Azure-Virtual-Desktop-14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/AZ-140-Managing-Access-to-Azure-Virtual-Desktop-14/" class="post-title-link" itemprop="url">AZ-140-Managing-Access-to-Azure-Virtual-Desktop-19</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-13 18:59:14" itemprop="dateCreated datePublished" datetime="2022-11-13T18:59:14-04:00">2022-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 06:33:08" itemprop="dateModified" datetime="2022-11-14T06:33:08-04:00">2022-11-14</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/13/AZ-140-Managing-Access-to-Azure-Virtual-Desktop-14/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/13/AZ-140-Managing-Access-to-Azure-Virtual-Desktop-14/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course on Managing Access to Azure Virtual Desktop. My name is Shabaz Darr and I’ll be your instructor for this course. I am an Azure Virtual Desktop Specialist and have been working in the Microsoft cloud analogics for several years, specifically with Azure Virtual Desktop since its inception and have multiple Azure-focused certifications. My contact information is available on screen. Please feel free to reach out to me with any questions, comments, or concerns, and I will be happy to discuss these with you. For any other issues you can always get in touch with us here at Cloud Academy by sending an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>, and one of our cloud experts will follow up with you.</p>
<p>This course is intended for people that are planning on taking the Azure Virtual Desktop Specialty exam and anyone who is interested in learning how to deploy an Azure Virtual Desktop environment. By the end of this course, you will have knowledge on:</p>
<ul>
<li>Planning and implementing Azure roles and role-based access control for Azure Virtual Desktop</li>
<li>Managing roles, groups, and rights assignment on Azure Virtual Desktop session hosts</li>
<li>Configuring user restrictions by using AD group policies and Azure policies</li>
</ul>
<p>To get the most from this course, you should have an Administrator-level understanding of Azure Cloud services.</p>
<p>Feedback on course content hosted by Cloud Academy is always appreciated and encouraged, as it allows us as trainers to improve which helps all of our students taking courses in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>Please note, at the time of writing this content, all course information was accurate. To accommodate new features and services, Microsoft regularly update exam guidelines and measured skills. This may result in certain elements of discrepancy appearing in the content over time. Please contact us if you find any outdated content at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. This will allow us to update the course during its next release cycle. Thank you.</p>
<h1 id="Planning-and-Implementing-Azure-Roles-and-Role-Based-Access-Control-RBAC-for-Azure-Virtual-Desktop"><a href="#Planning-and-Implementing-Azure-Roles-and-Role-Based-Access-Control-RBAC-for-Azure-Virtual-Desktop" class="headerlink" title="Planning and Implementing Azure Roles and Role-Based Access Control (RBAC) for Azure Virtual Desktop"></a>Planning and Implementing Azure Roles and Role-Based Access Control (RBAC) for Azure Virtual Desktop</h1><p>Welcome to this module on Planning and Implementing Azure Roles and Role-Based Access Control or RBAC for Azure Virtual Desktop. In this module, we’ll cover the following topics, what is role-based access control or RBAC? We’ll discuss some of the Azure Virtual Desktop specific built-in roles. Finally, we’ll talk about delegated access in Azure Virtual Desktop.</p>
<p>Let’s start by discussing what role-based access control, better known as RBAC, is. It allows you to manage who has access to resources within Azure. It is an authorization mechanism that is built on Azure Resource Manager, better known as ARM, that allows administrators to configure fine-grained access management to resources.</p>
<p>There are three elements to role-based access control. The first is a security principle, which represents some type of object, for example, a user or a group. The second type of element, is role definition, which is a collection or a set of permissions. Essentially a role definition lists the actions. For example, read, write or delete, that can be performed. The final element is a scope. This is a set of resources to which the access is applying to. There are different levels of scope, including management groups, subscriptions and resource groups.</p>
<p>In the next part of this course, we are going to look at some of the built-in roles that are relevant to Azure Virtual Desktop. We start off with desktop virtualization role, which has a reader role and a contributor role. The reader role allows you to view all aspects of the deployment, but not make any changes. The contributor role enables you to manage all parts of the deployment, however, it does not allow you to access to any of the compute resources.</p>
<p>The next relevant role is the desktop virtualization host pool role, which again, has a reader and contributor level access. The reader level allows you to view all aspects of the host pool only and not modify any settings, whereas a contributor role allows you to manage everything within the host pool. However, you do need an additional contributor role for the virtual machine, if you wish to create any VMs. The desktop application group role, is similar to the host pool role, in that it has both reader and contributor levels. With the reader level role, it allows you to view everything within the application group and the contributor level, allow you to manage everything within the application groups. However, if you wish to publish apps, you need to have the user access administrator role.</p>
<p>Next, we have the desktop virtualization workspace role, which again has two levels, reader and contributor. The reader level role allows you to view all aspects of the workspace but not adding anything. The contributor level role allows you to manage everything within the workspace. However, to obtain information on applications within that app group, you need to be assigned the application group reader role. There are two more roles that are relevant to Azure Virtual Desktop. The first is the desktop virtualization user session operator. This role allows you to manage user logins and to do tasks such as sending messages, disconnecting sessions, and remotely logging users off by sessions.</p>
<p>The final role is called desktop virtualization session host operator. This role will enable you to change drain mode and view and remove session hosts from a host pool. This level of access does not have right permissions, however, so you cannot add session host into the host pool. In the final section of this module, we are going to view delegated access with Azure Virtual Desktop.</p>
<p>Like role-based access control, delegated access has the same three elements, which are security principles, role definitions, and scope. Security principles have three values, which are all objects, including users, groups, and service principles. Role definitions have two type of roles. Either built-in roles, which we discussed in the previous section of this module and custom roles. These are roles you can customize with different permissions. Finally, we have the scope elements of delegated access. As mentioned earlier, this is the resources you assign the roles and permissions to, which include host pools, app groups, and workspaces.</p>
<h1 id="Managing-Roles-Groups-and-Rights-Assignment-on-Azure-Virtual-Desktop-Session-Hosts"><a href="#Managing-Roles-Groups-and-Rights-Assignment-on-Azure-Virtual-Desktop-Session-Hosts" class="headerlink" title="Managing Roles, Groups, and Rights Assignment on Azure Virtual Desktop Session Hosts"></a>Managing Roles, Groups, and Rights Assignment on Azure Virtual Desktop Session Hosts</h1><p>Welcome to this module on managing roles, groups, and rights assignment on Azure Virtual Desktop. In this module, we’ll cover the following topics, which will both be demo-focused. We will look at how to add users to the Azure Virtual Desktop-specific roles. Finally, we’ll walk through how to add users and groups to Azure Virtual Desktop host pools, to allow access to session hosts.</p>
<p>In this first section, we are going to show how to add users to the Azure Virtual desktop specific groups we have discussed in the planning and implementing Azure roles and role-based access control, RBAC, for Azure Virtual Desktop module. Here we are in the Azure portal. We first need to navigate to the Azure Virtual Desktop service. We have two options, we can either user search at the top, where we can type Azure Virtual Desktop, like this, and click on the service. Or, like me, if you have it as a shortcut on the dashboard, you can just click this, and it’ll take you to the service as well.</p>
<p>Next, we’ll click on Host pools in the left-hand pane. Now we can see our host pools in the center. In this case, we have a single host pool, click on the host pool, and we now see the overview for this resource. On the left-hand pane, we need to look for access control, IAM, to the access control service for this host pool.</p>
<p>Now we want to try and add a user to one of the desktop virtualization role assignments we discussed in an earlier module, so we will select Add, and then Add role assignment. We are now on the Add role assignment menu, and we can see all the available roles here, including the desktop virtualization roles. Let’s select one at random. Let’s say, the host pool reader role, then click on Next. We now have the option of either adding users, groups, or service principle to this role, or we can add a managed identity. In our case, we want to add a user, so we’ll click on Select members and add our user. We then click on the Review and assign button, and the same again. We can now see the desktop virtualization host pool reader role has appeared with a user we added.</p>
<p>This user now has read-only access to all the host pool resources. In this section, we are going to look at how we add a group to the host pool assignment, which will allow them access to log into the relevant session hosts. We first need to make sure we have created a security group, either on on-premises active directory, that I synchronized with Azure AD, or a cloud-based security group in Azure AD In our example, we have created a cloud security group in Azure AD, called AVD Users. We need to browse to the Azure Virtual Desktop service, as we did previously.</p>
<p>From here, we select the Application group. On the left-hand pane of our application group, we’ll navigate down to Assignments, where we can now click on Add. We now find the security group called AVD Users and select this. You should know that you can assign users to the application group directly, as well. However, it is a best practice recommendation to your security groups, as it is a less administrative overhead.</p>
<h1 id="Configuring-User-Restrictions-by-Using-AD-Group-Policies-and-Azure-Policies"><a href="#Configuring-User-Restrictions-by-Using-AD-Group-Policies-and-Azure-Policies" class="headerlink" title="Configuring User Restrictions by Using AD Group Policies and Azure Policies"></a>Configuring User Restrictions by Using AD Group Policies and Azure Policies</h1><p>Welcome to this module on configuring user restrictions by using AD group policies and Azure policies. In this module, we’ll cover the following topics: We’ll discuss how to manage Azure Virtual Desktop with Group Policy. Finally, we’ll take a look at the features available when managing Azure Virtual Desktop with Endpoint Manager.</p>
<p>Let’s start by looking at managing Azure Virtual Desktop with Group Policy. The policies available depend on what domain the session hosts are joined to. You can join session hosts to either Active Directory or Azure Active Directory Domain services. Both allow you to use the Group policy management tool to manage the various policies. If you use Azure AD Domain Services, you need to ensure your administrator account is a member of the Azure AD DC administrators group.</p>
<p>If the session hosts are joined to an Azure AD Domain Services tenant, you have two main policies called AADDC Computers and AADDC Users which you can edit and use to manage the Azure Virtual Desktop environment. If the session hosts are joined to an Active Directory Domain, either on-premises or a VM in Azure, then you can utilize all the standard GPOs that are available with a Domain Controller to manage the Azure Virtual Desktop environment. Let’s now move on to discussing managing Azure Virtual Desktop with Endpoint Manager.</p>
<p>Session hosts need to not only be domain joined but also enrolled into Intune to enable management, which is better known as Hybrid join. Once your session hosts are hybrid joined, you can start to manage them and take advantage of Endpoint Management features, such as compliance policies, which allow you to set baseline compliance the sessions hosts must meet. Configuration profiles, which allow you to configure settings including control panel access and desktop background on the session hosts. You can also utilize Windows Update for Business to manage update patching on the session hosts.</p>
<p>Finally, you can deploy applications to the session hosts including Office, other Win32 apps, and also, apps via the Windows Store.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>In this short module, we covered two main areas around management of Azure Virtual Desktop environment. First, we discussed managing Azure Virtual Desktop with Group Policy, and depending on how the session hosts are domain joined, you have different options. You can either use the limited policies available where the session hosts are joined to an Azure AD Domain Services tenant, or you can use the traditional more granular policies that are available when the session hosts are joined to an active directory domain.</p>
<p>In the final part of the module, we discussed how to manage Azure Virtual Desktop with Endpoint Manager. We discussed the requirement to hybrid join the session hosts, which then opened up the many features of Endpoint Manager, including compliance policies to set compliance policy baselines on the session host, configuration profiles to control settings on Windows 10, including control panel access and desktop background to name a few. You can then manage session host updates and patching via the Windows Update for Business service and to ensure that OS stays secure. Finally, you can deploy applications, including Office suite Win32 apps and apps from the Windows store.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/67/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/67/">67</a><span class="page-number current">68</span><a class="page-number" href="/page/69/">69</a><span class="space">&hellip;</span><a class="page-number" href="/page/199/">199</a><a class="extend next" rel="next" href="/page/69/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">1986</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
