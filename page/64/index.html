<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hang&#39;s Blog">
<meta property="og:url" content="https://example.com/page/64/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/page/64/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Hang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Practice-Effective-DevOps-with-Azure-DevOps-24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Practice-Effective-DevOps-with-Azure-DevOps-24/" class="post-title-link" itemprop="url">AZ-400-Practice-Effective-DevOps-with-Azure-DevOps-24</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:38:03" itemprop="dateCreated datePublished" datetime="2022-11-18T20:38:03-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-24 00:52:38" itemprop="dateModified" datetime="2022-11-24T00:52:38-04:00">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Practice-Effective-DevOps-with-Azure-DevOps-24/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Practice-Effective-DevOps-with-Azure-DevOps-24/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Implementing-Azure-Active-Directory-Privileged-Identity-Management-23/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Implementing-Azure-Active-Directory-Privileged-Identity-Management-23/" class="post-title-link" itemprop="url">AZ-400-Implementing-Azure-Active-Directory-Privileged-Identity-Management-23</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:38:01" itemprop="dateCreated datePublished" datetime="2022-11-18T20:38:01-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 14:30:02" itemprop="dateModified" datetime="2022-11-27T14:30:02-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Implementing-Azure-Active-Directory-Privileged-Identity-Management-23/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Implementing-Azure-Active-Directory-Privileged-Identity-Management-23/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to Azure AD Privileged Identity Management. My name is Thomas Mitchell, and I’ll be taking you through this course on <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">Privileged Identity Management</a>. Otherwise known as PIM. I’m an Azure content author at Cloud Academy, and I have over 25 years of deep IT experience. Several of those years with cloud technologies. If you have any questions, feel free to connect with me on LinkedIn or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course is intended for IT professionals who need or want to attain Azure certification, those who wish to become Azure architects, and those who are simply tasked with managing and supporting Microsoft Azure. To get the most from this course, you should have a moderate understanding of Microsoft Azure and of security concepts and admin role management. We’ll start the course by touching on an overview of what Azure AD Privileged Identity Management is and what it offers. We will then work through the deployment of PIM, and how it works with multi-factor authentication.</p>
<p>As we work through some demos, you will also learn how to enable PIM and how to navigate tasks in PIM. Next, we’ll cover the activation of roles and the assignment of those roles to users through lectures and some demos. We’ll cover the concepts of updating and removing role assignments, reinforcing these concepts through more demonstrations. We’ll round out the course with supported management scenarios, configuring PIM management access, and how to process requests. These concepts will be reinforced with a few demonstrations as well, so you can see how these tasks are completed.</p>
<p>By the end of this course, you should be able to deploy Azure AD Privileged Identity Management and use it to manage access to roles and resources in Azure and in Azure Active Directory. You will also understand how just-in-time access is configured and how it mitigates threats to stolen admin credentials. We’d love to get your feedback on this course, so please give it a rating when you’re finished. If you’re ready to learn about Azure AD Privileged Identity Management and how to set it up, let’s get started.</p>
<h1 id="PIM-Overview"><a href="#PIM-Overview" class="headerlink" title="PIM Overview"></a>PIM Overview</h1><p>Azure Active Directory Privileged Identity Management, otherwise known as PIM, is an <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> offering that allows you to manage and control access to resources within Azure and Azure AD as well as within other services such as Intune and Office 365. A valid Azure AD Premium P2 license is required for all users that will interact with or benefit from Privileged Identity Management before enabling the service on a tenant. Alternatively, you can assign an Enterprise Mobility + Security E5 license for each user that interacts with Privileged Identity Management. Generally speaking, licensing is required for users that are assigned to the Privileged Role Administrator role or who are assigned as eligible to other directory roles that are manageable through Privileged Identity Management. If a user can approve or reject requests in PIM, that user also requires a license. Users assigned to a role with time-based assignments such as just in time or direct or those assigned to an access review role also require licensing. With Azure AD Privileged Identity Management, an organization can see which users are assigned privileged roles that are used to manage Azure resources. </p>
<p>Organizations can also see which users are assigned administrative roles within Azure Active Directory. PIM also offers the ability to enable on-demand or just in time administrative access to services such as Office 365 and Intune as well as to Azure resources, Azure subscriptions, resource groups and even individual Azure resources like virtual machines and such. Azure AD Privileged Identity Management offers the ability to view a history of administrator activation, along with a history of changes that administrators have made to Azure resources. Alerts can also be configured to notify you about changes in administrator assignments. PIM also allows you to require approval for activation of Azure AD privileged admin roles to review membership of such administrative roles and to force users to provide justification for ongoing membership in these roles. In Azure Active Directory, PIM can be used to manage users that are assigned to built-in Azure AD roles, such as global admin. In Azure itself, PIM can manage users and groups assigned via Azure RBAC roles such as the owner and contributor roles.</p>
<h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><p>Azure AD Privileged Identity Management is included with Azure AD Premium P2 edition. While in the preview, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure Active Directory Privileged Identity Management</a> provided no license checks. It allowed a tenant to try the service. With Azure AD PIM now in general availability, a trial or paid subscription must be present to continue using <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a>. The first person using PIM in a directory is automatically assigned two directory roles. The security administrator role and the privileged role administrator role. Only privileged role admins can manage the assignment of <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> AD directory roles for users. Additionally, you can run the security wizard which will walk you through the initial discovery process as well as the assignment process.</p>
<h1 id="MFA"><a href="#MFA" class="headerlink" title="MFA"></a>MFA</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft</a> recommends that multi-factor authentication, also known as MFA, be required and enforced for all administrators. By leveraging multi-factor authentication, the risk of an attack due to a stolen password is mitigated. As such, you can force users to complete an MFA challenge whenever they log in. You can and should also require users to complete an MFA challenge whenever they activate a role in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">PIM</a>. Doing so ensures that even if a user doesn’t complete an MFA challenge when he logs in, he will still be prompted to do so by PIM. When a user activates a privileged role, there are two options for validating MFA for the user. The first option is to rely on Azure MFA for the user who activates the role. To leverage this first option for validating MFA, first ensure that the user is licensed if necessary and has registered for Azure MFA.</p>
<p>Although it’s not required, it is recommended that Azure AD be configured to enforce MFA for the user when he logs in. This is because PIM itself will make the MFA check. If your users authenticate on-prem, you can leverage the second option by having the current identity provider be responsible for MFA. For example, let’s assume you’ve configured AD Federation Services or ADFS to require smart card-based authentication before accessing Azure AD. You could configure ADFS to send claims to Azure AD. In this scenario, whenever a user tries to activate a role, PIM will see that MFA has already been validated for the user and allow access.</p>
<h1 id="Enable-PIM"><a href="#Enable-PIM" class="headerlink" title="Enable PIM"></a>Enable PIM</h1><p>To start using <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a>, login to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal as a global admin with an organizational account. An example of an organizational account would be something like <a href="mailto:&#x59;&#111;&#x75;&#114;&#78;&#x61;&#x6d;&#101;&#64;&#x59;&#x6f;&#x75;&#114;&#68;&#111;&#x6d;&#97;&#x69;&#x6e;&#46;&#x63;&#111;&#109;">&#x59;&#111;&#x75;&#114;&#78;&#x61;&#x6d;&#101;&#64;&#x59;&#x6f;&#x75;&#114;&#68;&#111;&#x6d;&#97;&#x69;&#x6e;&#46;&#x63;&#111;&#109;</a>. An organizational account is necessary to enable PIM for directory. As such, a Microsoft account, such as an Outlook.com account will not work, you must be a global administrator with an organizational account to enable PIM for directory. Once you’re signed into the portal as a global administrator for your directory, click all services and then find the Azure AD Privileged Identity Management Service. Click to open the PIM quick start and then in the list click consent to PIM. Go ahead and click verify my identity so that you can verify your identity with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/mfa/">Azure MFA</a>. You’ll be asked to pick an account. If more information is requested for verification, you’ll be guided through the process of supplying such info. In our case here, we were asked to provide phone verification. Follow the wizard to provide the information that is requested. </p>
<p>Once you’ve completed the verification process, click the consent button. In the message that appears, click yes to complete the consent process. Once you’ve enabled PIM for your directory, you’ll need to sign up for PIM to manage Azure AD roles. To do so, switch back over to the Azure AD Privileged Identity Management quick start dashboard and then click Azure AD roles. Click sign up PIM for Azure AD roles in the left pane and then click sign up in the top menu. In the message that appears, click yes to sign up for PIM to manage Azure AD roles. When the process completes, the Azure AD options will be enabled. However, you may need to refresh the portal to see these changes.</p>
<h1 id="Onboarding-Resources"><a href="#Onboarding-Resources" class="headerlink" title="Onboarding Resources"></a>Onboarding Resources</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a> offers the ability to vastly improve the protection of <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources. For organizations that already use <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/enable-pim/">PIM</a> to protect Azure AD directory roles and to manage group and subscription owners, Azure AD Privileged Identity Management is also a great way to secure production resources. Before using PIM to protect resources in Azure, you first need to discover and select those resources that you wish to protect with PIM. Although there’s no limit to the number of resources that PIM can manage, Microsoft recommends starting with your most critical resources first.</p>
<h1 id="Onboarding-a-Resource-in-PIM"><a href="#Onboarding-a-Resource-in-PIM" class="headerlink" title="Onboarding a Resource in PIM"></a>Onboarding a Resource in PIM</h1><p>To protect resources with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/enable-pim/">PIM</a>, you first need to discover them. To do so, sign into the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal and open the Azure AD Privileged Identity Management dashboard. From here, click Azure resources. Now if this is the first time you’re using PIM to manage Azure resources, you’ll see a discover resources pane. However, if another resource or directory admin in your organization has already started managing Azure resources in PIM, you’ll see a list of the resources that are currently being managed by PIM. Click Discover resources to launch the discovery experience. Add a check mark next to any unmanaged resources you want to manage. To begin managing the resource, simply click Manage resource. One thing to note is that once a management group or subscription has been set to managed, it can no longer be unmanaged. This is in place to prevent another resource admin from removing PIM settings for it.</p>
<h1 id="Viewing-and-Managing-Assignments"><a href="#Viewing-and-Managing-Assignments" class="headerlink" title="Viewing and Managing Assignments"></a>Viewing and Managing Assignments</h1><p>When it comes to Azure AD roles, the only user that can manage assignments for other administrators in Azure AD PIM, is a user who is in the Privileged Role Administrator role. I know that sounds redundant but the role is actually called Privileged Role Administrator. That said, it’s possible to provide other users in the directory the ability to manage directory roles in PIM. There are three groups that can view assignments to Azure AD roles in Azure AD PIM. These groups include Global Administrators, Security Administrators and Security Readers. </p>
<p>As far as RBAC roles go, only certain users can manage assignments for other administrators in Azure AD PIM. They include any user that is a subscription administrator, any user that is a resource owner or any user who is a resource user access administrator. Privileged Role Administrators, Security Administrators and Security Readers do not have the necessary access, by default, to view assignments to Azure RBAC roles in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a>.</p>
<h1 id="Navigating-Tasks-in-PIM"><a href="#Navigating-Tasks-in-PIM" class="headerlink" title="Navigating Tasks in PIM"></a>Navigating Tasks in PIM</h1><p>After <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/enable-pim/">setting up Privileged Identity Management</a>, use the PIM Quick start blade to perform identity management tasks. For example, the My roles pane provides a list of all eligible and active roles that are assigned to you. Use this pane to activate any assigned eligible roles. The My requests pane is used to display any of your pending requests and is also used to activate eligible role assignments. The Application access pane allows you to limit possible delays and use a role immediately after activation. Approve requests provides a list of requests that have been made to activate eligible roles by users in the directory. In the Review access pane, you are provided with a list of active access reviews that you are assigned to complete. Azure AD directory roles presents a dashboard and settings that are used by privileged role administrators for managing Azure AD directory role assignments. The Azure AD directory roles dashboard is disabled for users who are not a privileged role administrator.</p>
<p>However, these users do have access instead to another dashboard called My view which only displays information about the user who is accessing the dashboard. It does not provide info for the entire tenant. The <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources dashboard displays settings for privileged role administrators so that they can manage Azure resource role assignments. In this case, as is the case with the Azure AD directory roles pane, this dashboard is also disabled for anyone who isn’t a privileged role administrator. However, as was the case with the Azure AD directory roles dashboard, users are offered a different dashboard again called My view. The My view dashboard only displays information about the user accessing the dashboard, not the entire tenant.</p>
<h1 id="Assigning-Roles"><a href="#Assigning-Roles" class="headerlink" title="Assigning Roles"></a>Assigning Roles</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a> can manage built-in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resource roles, along with custom roles, such as Owner, User Access Administrator, Contributor, Security Admin, and Security Manager. Users who have been assigned Owner or User Access Administrator roles, either directly or via group membership, as well as Global Admins, are also Resource Administrators. These administrators can assign roles, configure role settings, and review access using PIM for Azure resources.</p>
<h1 id="Assign-a-Role-in-PIM"><a href="#Assign-a-Role-in-PIM" class="headerlink" title="Assign a Role in PIM"></a>Assign a Role in PIM</h1><p>Making a user eligible for an Azure resource role requires just a few steps. To make a user eligible for an Azure resource role, make sure that you are logged in to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal with an account that is already a member of the Privileged Role Administrator role. Open the Azure AD Privileged Identity Management Console. Click on Azure Resources and use the Resource Filter to filter the list of managed resources. From here, click on the resource that you want to manage. In this demonstration, we’ll select the entire subscription. Click Roles which can be found under Manage to view the list of roles for Azure Resources. Next, open the New Assignment pane by clicking Add member and then click Select a Role to open the Select a Role pane. Click on the role that you want to assign and then click Select. At this point, the Select a Member or Group pane will open.</p>
<p> Click on the user or group that you want to assign to the role and then click Select. When the Membership Settings pane opens, go to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/assignment-types/">Assignment Type</a> list and then click either Eligible or Active. An Eligible assignment will require the user who has been assigned the role to perform an action to actually use the role. Such actions might typically include successfully performing an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/mfa/">MFA</a> check or simply providing a business justification. The user might also need to request approval from a designated approver before using the role. That said, an active assignment won’t require the user to perform any action to use the role. In our demo here, we’re going to make the user eligible and we are going to accept the default timeframe. Click Done. And to complete creation of the new role assignment, click Add.</p>
<h1 id="Activating-Roles"><a href="#Activating-Roles" class="headerlink" title="Activating Roles"></a>Activating Roles</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure Active Directory Privileged Identity Management</a> simplifies management of privileged access to resources in Azure AD and other services such as Office 365 and Intune. A user that has been made eligible for an administrative role can activate that role when he or she needs to perform privileged actions controlled by the role. A good example would be a user who on occasion manages Office 365 features. In such a case, the organization’s privileged role administrator, instead of making that user a permanent global admin, could opt to instead make the user eligible for an Azure AD role like Exchange Online Administrator. This user could then request to activate the role only when he or she needs its privileges. The administrative control would then last for a predetermined period of time.</p>
<h1 id="Activate-a-PIM-Role"><a href="#Activate-a-PIM-Role" class="headerlink" title="Activate a PIM Role"></a>Activate a PIM Role</h1><p>When a user needs to take on an Azure AD PIM role that he has been made eligible for, that user can request activation via the my roles navigation option in PIM. The process is pretty straight forward. First, sign into the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal. As you can see on the screen here, I’ve logged into the Azure portal as Steve, whom we’ve just made eligible for a few roles. Next, open Azure AD Privileged Identity Management. In our example here, Steve can click on My roles, and then either Azure AD roles or Azure resource roles to see the list of his eligible roles. For this exercise, Steve wants to activate the BizTalk role. We can go ahead and click Activate, which opens the role activation details pane. Enter the reason for the activation request into the activation reason box. To activate, simply click Activate.</p>
<h1 id="Assignment-Types"><a href="#Assignment-Types" class="headerlink" title="Assignment Types"></a>Assignment Types</h1><p>Privileged Identity Management for Azure offers the ability to create enhanced security for businesses with critical <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources in production. Leveraging PIM, resource admins can assign members as eligible for certain resource roles. The two assignment types available in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a> for Azure resources are eligible and active. The eligible assignment type requires members of a particular role to perform an action before using the role. Actions that a user can perform in order to use a role include things like performing a successful <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/mfa/">MFA</a> check, requesting approval from an approver, or providing a business justification for the access being requested. The active assignment type does not require members to perform any sort of action to use the role. Essentially, users that are assigned active will have their assigned privileges at all times.</p>
<h1 id="Assignment-Durations"><a href="#Assignment-Durations" class="headerlink" title="Assignment Durations"></a>Assignment Durations</h1><p>A resource administrator has two options to choose from for each <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/assignment-types/">assignment type</a> when configuring PIM settings for a role. For permanent assignment types, the admin can choose either Allow permanent eligible assignment or Allow permanent active assignment. For assignment types with an expiration, the administrator can choose either Expire eligible assignments after or Expire active assignments after. These options become the default maximum duration when a member is assigned to the role in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a>. When a resource admin chooses either Allow permanent eligible assignment or Allow permanent active assignment, all administrators that subsequently assign users to the protected resource can assign permanent memberships. When a resource admin chooses either Expire eligible assignments after or Expire active assignments after, the resource admin controls the assignment lifecycle. This is because, by choosing one of the expire options, all assignments will require a specified start and end date. It’s important to note that assignments with a specified end date can be renewed by a resource admin as well as via a self-service request from the users with those assignments.</p>
<h1 id="Assignment-States"><a href="#Assignment-States" class="headerlink" title="Assignment States"></a>Assignment States</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Privileged Identity Management for Azure Resources</a> offers two different assignment states which appear on the active roles tab in the my roles, roles, and member views of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a>. These two states include Assigned and Activated. When viewing a membership in Active roles, use the value in the State column to separate users that are assigned as active from those users that are now active after having activated an eligible assignment.</p>
<h1 id="Approval-Workflow"><a href="#Approval-Workflow" class="headerlink" title="Approval Workflow"></a>Approval Workflow</h1><p>Approval workflow in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a> for Azure resource roles offers administrators the ability to protect and restrict access to critical <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources by allowing them to require approval to activate <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/updating-and-removing-existing-role-assignments/">role assignments</a>. Resource hierarchy, which is unique to Azure resource roles, allows for the inheritance of role assignments from parent resources and objects down to child resources within the parent container. To illustrate the approval workflow process in PIM, I’ll use the following example. Let’s assume Steve is a resource administrator. Steve uses PIM to assign Jen as an eligible member to the owner role in the subscription for Blue Widget Co. Through this assignment, Steve makes Jen an eligible owner of all resource group containers within the Blue Widget Co Azure subscription. Because Jen is an eligible owner of all resource group containers, she is also an eligible owner of all resources residing within each resource group contained in the subscription. Now remember PIM settings, unlike assignments, are configured for each role of a resource. As such, the PIM settings that are configured for a resource are not inherited. They are applied strictly to the resource role. In our example, let’s imagine that there are three resource groups called finance test, finance dev, and finance prod, all located in the Azure subscription. </p>
<p>Each resource group contains two virtual machines. Imagine that Steve uses PIM so that he can require that all owner role members of the Blue Widget Co subscription request approval to be activated. To further protect the resources in the finance prod resource group however, Steve also requires approval for members of the owner role of this resource. Steve is less worried about security on the finance test and finance dev resource groups so he does not require the owner roles in either to require approval for activation. Given the approval flow and hierarchy in our example, if Jen requests activation of her owner role for the Blue Widget Co subscription, she’s going to need an approver to either approve or deny her request before she becomes active in the role. Similarly, if Jen scopes her activation to just the finance prod resource group, an approver again will need to approve or deny this request. However, if Jen were to scope her activation to just finance test, just finance dev, or both, approval would not be required. This is because Steve did not require approval for members of the owner role for any of these two resource groups. So as our example demonstrates, Azure AD Privileged Identity Management provides a means of configuring granular and hierarchical security that can protect resources by limiting unnecessary administrative access while also allowing for consistent admin access when it’s required.</p>
<h1 id="Updating-and-Removing-Existing-Role-Assignments"><a href="#Updating-and-Removing-Existing-Role-Assignments" class="headerlink" title="Updating and Removing Existing Role Assignments"></a>Updating and Removing Existing Role Assignments</h1><p>To update or remove an existing role assignment, open Azure AD Privileged Identity Management and then click Azure resources. Click a resource that you wish to manage and then under manage, click roles, so you can see a list of roles for Azure resources. Select a role that you wish to update or remove and then find the role assignment on the eligible roles tab or on the active roles tab. From here, click update or remove to either update the role assignment or to remove the role assignment altogether.</p>
<h1 id="Supported-Management-Scenarios"><a href="#Supported-Management-Scenarios" class="headerlink" title="Supported Management Scenarios"></a>Supported Management Scenarios</h1><p>Until now, a user would typically be assigned to an admin role through the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal, some other Microsoft Online Service portal, or through Azure AD PowerShell cmdlets. Doing so would make the user a permanent administrator, which in turn meant that the user was always active in the assigned admin role. With <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a> comes the idea of the Eligible admin. An Eligible admin is a user that needs some sort of privileged or admin-level access every now and again, but not all the time. In this scenario, the privileged role is inactive until the user needs the privileged access that it provides. The user then completes an activation process to become an admin for a preconfigured time frame. Many organizations prefer the strategy of granting admin access because it reduces or even eliminates permanent admin access to privileged roles. Some key terms to understand are eligible role user and delegated approver. An eligible role user is a user that’s been assigned as eligible to an Azure AD role. This requires the role to be activated when needed. </p>
<p>A delegated approver is a user, or maybe even multiple users or groups, within Azure AD who is responsible for approving requests to activate such roles. An example of these roles in action would be a case where John is designated as a privileged role administrator. In such a case, John would have the ability to enable approval for specific roles, and he could also specify approver users and groups to approve requests. John would also be able to view the request and approval history for all privileged roles. In another scenario, Jen might be a designated approver. As a designated approver, Jen would be able to view pending requests and approvals, and she would also be able to approve and reject role elevation requests. She would also be responsible for providing justification for approvals and rejections. An example of an eligible role user would be Dave. As an eligible role user, Dave would be able to request activation of a role that requires approval. After the role activation is approved by Jen, he would then be able to complete his tasks in Azure AD. As you can probably tell by now, Privileged Identity Management offers streamlined, yet granular management scenario support.</p>
<h1 id="Configuring-Management-Access"><a href="#Configuring-Management-Access" class="headerlink" title="Configuring Management Access"></a>Configuring Management Access</h1><p>A global admin who enables <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a> for the organization automatically gets <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/assigning-roles/">role assignments</a> as well as access to PIM. Nobody else, by default, gets write access, and this even includes other global admins. Other global admins, security admins, and security readers all receive read-only access to Privileged Identity Management. To grant access to Privileged Identity Management, the first user can simply assign other users to the privileged role administrator role. Keep in mind that managing PIM requires <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/mfa/">Azure MFA</a>. As such, because Microsoft accounts can’t register for Azure MFA, any user that logs in with a Microsoft account will not be able to access PIM. Additionally, it’s best practice to ensure that there are always at least two different users assigned a privileged role administrator role. Doing so avoids the calamity in the event one user gets locked out or if an account is accidentally deleted.</p>
<h1 id="Configuring-Permanent-PIM-Management-Access"><a href="#Configuring-Permanent-PIM-Management-Access" class="headerlink" title="Configuring Permanent PIM Management Access"></a>Configuring Permanent PIM Management Access</h1><p>There will be times when you need to grant access to someone so they can manage <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a>. To do this, sign into the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal and open the Azure AD Privileged Identity Management dashboard. Click Azure AD directory roles and then click Roles. Click on the privileged role administrator role to view the member’s page. Open the add managed members pane by clicking Add member. And then click Select members. Choose a member, and then click Select. From here, you make the member eligible for the privileged role administrator role by clicking OK. It’s important to note that when you assign a new role to someone in PIM, that person is automatically configured as eligible to activate the role. You can make the member permanent by clicking the user in the privileged role administrator member list, then clicking More, and then Make permanent. Doing so makes the assignment permanent. Removing access to manage PIM is an easy process. However, before removing someone from the privileged role administrator role, ensure that there will still be at least two users assigned to the role. To remove access, add a check mark next to the user you want to remove, and then click Remove member. You will typically see a message asking for confirmation. Click Yes, and with that, you have removed access from the user for managing PIM.</p>
<h1 id="Process-Pending-Approval-Requests"><a href="#Process-Pending-Approval-Requests" class="headerlink" title="Process Pending Approval Requests"></a>Process Pending Approval Requests</h1><p>A strength of Azure AD Privileged Identity Management is the fact that it offers you the ability to configure roles so that they require approval for activation. You can then configure one or more users or groups as delegated approvers. In this demonstration, I’m going to show you how to view, approve and deny requests for <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resource roles. If you are a delegated approver, you will receive an email notification whenever an Azure resource role request is pending your approval. To view pending requests in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a>, sign into the Azure portal, and open the Azure AD Privileged Identity Management dashboard. From the PIM dashboard, click Approve Requests. Click on either Azure AD roles or on Azure resources to view requests for each. You’ll see a list of pending requests that need your approval. To approve a request, click the request that you want to approve so that the Approval pane opens. Provide justification in the Justification box and then click Approve. To deny a request, click the request that you want to deny. As was the case previously, the Approval pane opens. Provide justification in the Justification box and then click Deny instead. As you can see, the process for approving and denying requests is quite simple.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>I hope you’ve enjoyed learning about <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/introduction/">Azure AD Privileged Identity Management</a>. Let’s review what you’ve learned. Azure AD Privileged Identity Management or <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/pim-overview/">PIM</a> for short is an <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> offering that allows you to manage and control access to resources within Azure and within Azure AD as well as within other services such as Intune and Office 365. To leverage PIM, a valid Azure AD Premium P2 license is required for all users that will interact with the service or benefit from it. However, you can instead assign an Enterprise Mobility + Security E5 license for each user that interacts with Privileged Identity Management. In this course, you learned how to enable PIM for an Azure subscription and how to configure it to use multi-factor authentication. You learned how to view and manage assignments using PIM and how to navigate the PIM console to manage tasks. During the course, you also saw how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-active-directory-privileged-identity-management/activating-roles/">leverage PIM to activate roles</a> that provide administrative access to certain resources for only a predetermined amount of time. </p>
<p>You also learned during this course about the differences between the eligible assignment type and the active assignment type. After covering assignment types, we looked at what assignment duration is used for and how they are used to provide limited admin access. We also touched on the two different assignment states that are available. Later in the course, we covered approval workflow in PIM as well as the role assignment process. You learned how Azure AD Privileged Identity Management can manage built-in Azure resource roles along with custom roles such as owner, user access administrator, contributor, security admin and security manager. You also learned how to make a user eligible for an Azure resource role and how to remove access. Closing out the course, you learned about supported management scenarios through various examples and how to configure management access in PIM. To learn more about Azure AD Privileged Identity Management you can and should review Microsoft’s published documentation on the topic. Be sure to also watch for new Microsoft Azure courses on Cloud Academy because we’re always publishing new courses. Please give this course a rating and if you have any questions or comments, please let us know. Thanks for watching and happy learning.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Implementing-Continuous-Feedback-with-Azure-DevOps-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Implementing-Continuous-Feedback-with-Azure-DevOps-22/" class="post-title-link" itemprop="url">AZ-400-Implementing-Continuous-Feedback-with-Azure-DevOps-22</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:38:00" itemprop="dateCreated datePublished" datetime="2022-11-18T20:38:00-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 14:16:50" itemprop="dateModified" datetime="2022-11-27T14:16:50-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Implementing-Continuous-Feedback-with-Azure-DevOps-22/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Implementing-Continuous-Feedback-with-Azure-DevOps-22/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Course-Introduction"><a href="#Course-Introduction" class="headerlink" title="Course Introduction"></a>Course Introduction</h1><p>Hi and welcome to this Implementing Continuous Feedback with Azure DevOps Course. This is an Intermediate level course suited to project managers and developers or anyone wanting to learn how to make use of feedback mechanisms to improve application reliability, performance and user satisfaction. </p>
<p>It will help having a basic understanding of application design and the software development lifecycle. </p>
<p>In this course, we will start by describing what feedback is, and then types of feedback that are of most use in improving application performance and usability. We will then move on to how we can integrate feedback into the software development lifecycle and what tools we can use to simplify that task. Finally, we will look at optimizing feedback mechanisms to get meaningful data from feedback noise.</p>
<p>My name is Hallam Webber and I’ll be your instructor for this course. We welcome all comments and feedback, no pun intended, so please feel free to reach out to us at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a> with any questions or comments. Let’s begin!</p>
<h1 id="What-is-Feedback"><a href="#What-is-Feedback" class="headerlink" title="What is Feedback?"></a>What is Feedback?</h1><p>What is feedback?</p>
<p>When people think of feedback generally one of two types come to mind, and which one of those will depend largely on how old you are. In the modern consumer marketing world, the younger audience might first think of customer feedback in the form of ratings or surveys. This has become pervasive in our social media-driven society where continuous improvement and customer satisfaction have become corporate clichés. We will look at this later. Older people might first think of audio feedback as first popularized by the likes of Jimi Hendrix. While both of these are examples of feedback, I want to start by looking at feedback loops.</p>
<p>At the elementary level, a feedback loop is where the output of a system is fed back as input into itself. Positive feedback loops tend to amplify a system’s output, as in audio feedback while negative feedback loops tend to make a system more stable, directing it towards an average output. Self-drive cars and machine learning systems are good examples of feedback loops. In the context of application software, we want feedback from the code that will allow us to improve reliability and performance. We take the output metrics from the code and feed it back as input into the development system. In theory, very simple. In practice not so much. I hear you ask “what are these output metrics, and where do they come from?”</p>
<h1 id="Error-Feedback"><a href="#Error-Feedback" class="headerlink" title="Error Feedback"></a>Error Feedback</h1><p>Let’s start with something we are all familiar with, exceptions, errors and crashes. I think it’s fair to say that making your app bug, or at least crash free would be the number one priority. Not to state the obvious, but its very bad manners to have your app crash with an unhandled exception. While on the face of it, exception handling may seem binary – the app had an exception or it didn’t, this is not how it goes. I’m sure most of you are aware of the undocumented feature meme, making fun of an application’s unexpected behavior. This type of error or misbehavior is subtle, and its capture is accordingly more complex so I will tackle it after addressing crashes and exceptions.</p>
<p>At the very least your app should have some general exception handler to allow it to exit gracefully. While not crashing out, exiting with some generic error message isn’t much better and will leave users frustrated. Like any product, if it breaks people won’t buy it. If you are developing for an enterprise environment where staff are forced to use your app, users will bad mouth it and it will take some time to regain their trust even when the bugs are fixed. Most, as in 99.9% of users will not report a bug with any kind of useful information about what function they were performing at the time and the application state at the time, assuming that they could. In an ideal world we would have tested the app and it would be deployed bug free. As this almost never happens the next best thing, is that we, the developers are informed of these exception situations with relevant application state data so that they can be addressed and remedied as quickly as possible.</p>
<p>If we were going to design an error feedback, or bug tracking solution from scratch what would it look like? This solution needs to work on 2 levels. From a project perspective there needs to be a bird’s eye view of the current state, global reporting and monitoring at a glance. Enter the project dashboard. We need to easily see the number of outstanding issues, work in progress and completed tickets. What bugs those issues relate to, and where those issues are in relation to resolution. A good comprehension of the current state of play allows for effective project management in terms of directing resources to where they are most needed. Without this information any predictions in delivery times range from less than optimal to arbitrary. The other level a bug tracking solution works at is ticket level, managing and monitoring individual issues. We need to capture the bug with as much diagnostic information as possible. Then enter the bug into a workflow. This should involve an initial categorization, which at a bare minimum, should discriminate between crashes and non-fatal errors using a priority rating. Then there should be the ability to assign the bug to a development resource, with that resource updating the current status of the bug and the resolution process. Once the bug issue has been resolved or fixed, then the bug status can be set to closed.</p>
<p>For a start we would need to capture the exception in the application. This would involve recording the location of the exception, like the function and library, perhaps with the input parameters. Ideally you would want to know what operating system and version the app was running on, and even the device. Once the critical data has been collected it needs to be transmitted to an error log external to the application. Once the error data has been received it would be nice if it was automatically classified and prioritized. For example, an exception that caused the app to crash would be marked as critical, while a null object exception that was caught, handled and not visible to the user maybe giving a lower priority. The exception priority will influence whether a special release is urgently needed, or the fix can be incorporated into the next planned release. The fix is implemented, and the new release is deployed, closing the feedback loop.</p>
<h1 id="Capturing-Errors-with-App-Center"><a href="#Capturing-Errors-with-App-Center" class="headerlink" title="Capturing Errors with App Center"></a>Capturing Errors with App Center</h1><p>This all makes sense and is logical, but there is a lot going on here. To build and implement an error capturing framework yourself would be a significant undertaking, perhaps more involved than the application it’s supposed to monitor. As this scenario is common to all software projects its not surprising that there is a raft of products designed to help developers integrate exception capture and bug tracking with development workflow. </p>
<p>Products like Raygun will collect exception data from your application, help you prioritize and diagnose the issue, and then link to a development workflow system like Jira or Zendesk. </p>
<p>As it happens, Azure’s relatively new App Centre has just the features you need to capture and analyze exception data with very little effort.</p>
<p>Setting up an app for error tracking in App Center is easy. Navigate to appcenter.ms. Click Add new app. In the Add new app dialog give your app a name and select the Release Type. Release types are what you might expect. Alpha, beta, enterprise, production and store, or you can create your own custom release name. Then select the OS and platform. There is a wide range of OS and platform support, although there is currently no support for JavaScript based SPA apps which does seem like quite an oversight. There is a link at the bottom of the dialog to tell Microsoft if you are using another platform, and I would encourage you to do so.</p>
<p>Integrating basic error detection into your application is quick and simple. Start by installing the Microsoft AppCenter Crashes package into your project. Add the using statement to your source code. Before you can use AppCenter Crashes you must start the SDK with AppCenter start. You need to supply the app secret you obtained when registering your application with App Center, and the type of services you want to use. In this case, that parameter will be typeof crashes. We are going to record exceptions and crashes, that is an exception that causes the application to crash, as oppose to a caught exception. </p>
<p>Looking first at a typical try catch scenario, we can call the Crashes TrackError method of the SDK within the catch block. TrackError takes an exception as its parameter. The Crashes SDK also has callbacks that can be used for processing error reports from a previously crashed session or getting user feedback from the UI. The callbacks need to be set up before calling App Center start. Conversely you need to start the App Center SDK before calling any of its methods.</p>
<p>This ErrorInitialization function illustrates how you might put these features together on app startup. Firstly, we setup our callback saying we only want to process an error report if it isn’t a blue screen of death. Next, we start the App Center. Then we find out if the application crashed out the last time it ran. If it did, we get the crash report from the last session and display a message to the user. This last session functionality is very useful as it allows us to easily figure out if the last session went badly and let the user know, that we know all is not well and action will be taken to remedy the problem.</p>
<p>As a side note, Microsoft say, “By default, an unhandled exception in a WinForms application does not trigger a crash (the application does not exit) if the debugger is not attached.” One way around this situation is to call Application SetUnhandledExceptionMode to ThrowException. This will get Winform applications to correctly display crashes in App Center..</p>
<p>User privacy is another factor to keep in mind and the Crashes SDK does provide a call back feature, ShouldAwaitUserConfirmation, where you can ask the user to confirm whether or not they consent to sending error data. This simple example does not cater for the AlwaysSend option that is available with the NotifyUserConfirmation method. You also have the ability to attach files to your error report. This would be useful for sending detailed application state in data driven or highly configurable apps. At the moment the maximum size of attachments per error report is 7 megabytes.</p>
<p>In your project’s App Center go to diagnostics to see a dashboard of all issues. This is where you see the crashes and exceptions separated into groups. A group is all the instances of a particular crash or exceptions. I did find it interesting that the grouping is based on the location within the code as a whole rather than the location within a function as identified by it’s signature. The Main_FORM Tables_LB_Click crash is exactly the same exception, but the one that occurred most recently on line 153, was after I added the ErrorInitialization function above it. Clicking on a group will take through to a detail view.</p>
<p>Here we can see the stack trace plus the number of times the crash has occurred and the number of impacted users. What’s particularly useful for mobile developers is a breakdown of devices and OSes that the crash has occurred on. On the top right you can change the status of the crash group from open to closed or ignored. Clicking on the Reports tab will display all the instances of the crash.</p>
<p>Clicking on a report or instance will display additional information like country and language, and also how far into the session or after app startup did the crash occur under the heading Crashed after. The threads tab shows the stack trace data, while attachments will display any data files that have been uploaded with the error report. Events are analytic events that were recorded just prior to the crash – we’ll have a look at those later.</p>
<p>Ideally, we want to be notified A.S.A.P when our app has crashed. This can be easily set up by going into settings and selecting email notifications. Then under crashes select when you want to be emailed about a crash event. Your choices are immediately, daily or never. On the right is an example of crash group email. It has basic information with a link to the crash group.</p>
<h1 id="Integrating-App-Center-with-Workflows"><a href="#Integrating-App-Center-with-Workflows" class="headerlink" title="Integrating App Center with Workflows"></a>Integrating App Center with Workflows</h1><p>While an email is great at telling you when something has happened, you could hardly say it’s closing the error feedback loop. What we need now is to integrate the error reports with our development workflow or bug tracking software. Once again go into settings and this time select services. Select the bug tracker service you would like to integrate with. In keeping with the Azure theme, I selected Azure DevOps. The other out of the box alternatives are GitHub and Jira. After authenticating, select the project from DevOps and click add. Now if you go into your Azure DevOps subscription and navigate to service hooks within project settings you can see App Center added as a service hook.</p>
<p>If you are using GitHub, integration is just as easy. It’s the same process as for Azure DevOps with the hopefully obvious difference of selecting GitHub from the add bug tracker selection list. As you can see when a crash comes through to App Center it will get pushed into the GitHub issue queue. Once again, basic details are supplied with a link to the App Center error report. Changing an error report’s status in App Center will update the status in GitHub.</p>
<h1 id="Applications-Misbehaving"><a href="#Applications-Misbehaving" class="headerlink" title="Applications Misbehaving"></a>Applications Misbehaving</h1><p>Now let’s have a look at when an application or system, doesn’t produce any exceptions, but at the same time doesn’t behave as intended. There are potentially 2 ways to detect this situation, but it really depends on your application. The easiest to implement and most proactive is to regularly validate the state of the app’s data. At a very simple level for example, you might have an incoming message queue to a call center growing without those messages being responded to in a timely fashion. Now there could be lots of reasons why this might happen. Everyone in the call center has gone on holiday, the messages have unknown data in them, a database or server is off-line, or an unanticipated situation has occurred that has put the application into and endless loop. Basically, for a particular set of inputs you expect a related set of outputs. If this is not the case, then an alert should be raised with a corresponding bug tracking ticket, to at the very least investigate and decide if this is an issue requiring a bug fix.</p>
<p>What if a user is experiencing abnormal application behavior that isn’t resulting in exceptions or crashes? You would hope that the user will contact your help desk either through a facility in the application, via a web page or email. If they do, then this is easy enough to push the issue into the existing workflow. You can use the Crashes TrackError method with error report attachments to push all relevant user supplied data into the App Center when the user submits their help desk ticket. You can access App Center directly using it’s API to upload a crash or error report. The API even allows you to upload an Apple crash log. The API also supports calls to interrogate App Center data and delete instances of errors. As so many services and social and technical media platforms like Twitter, Facebook and Stackoverflow have APIs it is possible to build integrations for many different sources. The major problem will be filtering meaningful data from the noise. Personally, in terms of an error feedback loop, I would draw the line at social media and say that social media integration or monitoring falls more under the domain of user satisfaction and feedback that we shall look into later.</p>
<h1 id="Application-Insights-Telemetry"><a href="#Application-Insights-Telemetry" class="headerlink" title="Application Insights Telemetry"></a>Application Insights Telemetry</h1><p>While the App Center is great there is one glaring omission at the moment. It doesn’t cater for traditional web apps. But before there was the App Center there was, and still is, Application Insights Telemetry. Adding telemetry is very easy. From within Visual Studio select Add Application Insights Telemetry from the project menu and follow the wizard. When installed you’ll find a connection to Application Insights services, the insights package added, and an instrumentationKey added to appsettings.json. If your web app happens to be an MVC app you’ll find a reference to Application Insights Javascript snippet added to Layout.cshtml. The caveat with this very simple set up is that your Visual Studio subscription credentials are the same as, or linked with your Azure subscription. If not you will be prompted to supply them. If you are using a JavaScript framework like Angular or VueJs there are Application Insights NPM packages you can install. So, what does the telemetry tell us?</p>
<p>If we go to Azure and then select application insights and then pick our telemetry app which has been automatically created based on our Visual Studio project, we will get an overview dashboard. This shows us failed requests, server requests, server response time and availability. </p>
<p>Now if we go to our app and do some navigating and then select live metrics stream. Let’s just wait for that to boot up - here we go. If we click on a few links we can see the live data coming through. This is all well and good but what about if we have a failure. So, I’ll initiate a failed page request by asking for a non-existent path. We can see the failures coming through both graphically, and on the far right we can see the requested path that is causing the failure.</p>
<p>To get notified of failures we must create an alert. We do this by go down to the alerts menu item and then click create new alert. We must start with a condition which is going to trigger the alert. As you can see there’s plenty of options here to choose from, but I’m interested in failed requests so I’m going to select that. We can see the number of failed requests so far. I’ll set the threshold to one and change the granularity to one minute for the purposes of demonstration. The next thing I need to do is create an Action Group. I’ll name the group email failed requests, with short name email 404. You have a lot of action types to choose from, which is great from an integration point of view, but I’m just going to stick with an email message just to begin with. I’ll just enter the email details. OK and we’ll just give that group a name. I need to select the group that I’ve just created this is a very important step, and if you don’t the alerts won’t work. And give the alert rule a name. I should point out that just below the description field there is a drop-down list where you can set the severity level. As you can see there have been 4 alerts in total.</p>
<p>Here we have an example of the email alert that gets sent by the telemetry service. On the right is the action type drop down list showing the other integrations you can enable. Let’s look at how you can turn Application Insight alerts into issues within Azure DevOps.</p>
<h1 id="Integrating-Application-Insights-with-Workflows"><a href="#Integrating-Application-Insights-with-Workflows" class="headerlink" title="Integrating Application Insights with Workflows"></a>Integrating Application Insights with Workflows</h1><p>To enable integration between Application Insights and Azure DevOps we must setup work items. Select work items from the Configure menu. Make sure Azure DevOps Services is selected as the tracking system and then enter you domain.visualstudio.com url. As an aside, if you have switched over to the new dev.azure.com domain, use that. You switch to the new domain by going into overview within Organization settings on your DevOps site and simply flick the use new url switch. Microsoft says not all requests will be redirected to the new domain, so some planning will be required before making this move. Back to work items and enter the project name. The area, which for default project setups will be the same as the project name. I’ve seen in forums that a few people have trouble with the authorization, and I believe this is due to the fact that they are not using an active directory identity. The problem arises as you can login to visual studio, Azure DevOps and the Azure portal with the same email, that is not necessarily an active directory identity. If you find yourself getting an OAuth authorization error after clicking the authorize button, ten to one that will be the problem.</p>
<p>Now that I’ve authorized with the correct identity, I can create a ticket in Azure DevOps from an Application Insights exception. If I go into failures under the investigate menu and drill into the operations a select one, I can create a work item from one of the instances. After opening the instance just click create work item at the top. Under new work item you can edit the fields if needed and assign the work item. Click ok and the item will appear in your work items board within your Azure DevOps project. Click on the item to enter values such effort required and any additional information or related work items.</p>
<p>When a work item ticket is created and assigned through your Azure DevOps project an email notification is sent. Within Visual Studio’s team explorer, you can select work items to view. Clicking on a work item will open it in a browser, although selecting Complete work item from the context menu will change the status to closed, directly from visual studio.</p>
<p>Work item flow is not a one-way street and work items, be they bugs, issues, features, tasks or user stories, can be created in Visual Studio team explorer and flow through to Azure DevOps for workflow management.</p>
<h1 id="Making-Sense-of-Insights-Data"><a href="#Making-Sense-of-Insights-Data" class="headerlink" title="Making Sense of Insights Data"></a>Making Sense of Insights Data</h1><p>Azure DevOps provides a customizable dashboard that lets you see many of your project’s metrics at a glance. You customize the dashboard by adding graphical widgets from a palette. Select the widget you want and drag it onto the dashboard surface. As you can see there is a large selection of preinstalled workflow metrics to choose from. I’m just going to add a couple to give you an idea. Assigned to me is an obvious choice and requires no explanation or configuration. Chart for work items is a generic work items graph that you populate with a custom query. After dropping the widget, you need to create your query by going into queries under the Boards menu. Query creation is reasonably straight forward. There are conditional statements where you set the variables and operators from drop down lists. The conditions are combined with “and” and “or” operators. Save your query. Go back to the dashboard and click on the upper right corner of the widget to configure it. Select your query from the drop-down list and specify the chart type. Next select the “group by” variable and customize the series colors if desired. Save the configuration. The widgets are interactive, if you click on the metric you can drill down to the underlying data and tasks.</p>
<h1 id="Integrations-Built-into-Application-Insights"><a href="#Integrations-Built-into-Application-Insights" class="headerlink" title="Integrations Built into Application Insights"></a>Integrations Built into Application Insights</h1><p>Within Azure you also have the ability to connect to a variety of third-party IT service management systems or services. This is achieved using a generic IT service management connector. You may recall ITSM as one of the options in the action type drop-down list from Application Insights alert notifications. To set this up create a new IT service Management connector from the marketplace. Within the management connector resource create a new log analytics resource if none exists. Go into the ITSM Connections resource and under workspace data sources click ITSM Connections. Give your connection a name and select one of the third-party partner type services. Fill in the relevant connection parameters and click OK to complete the connection setup.</p>
<h1 id="Feature-and-Usage-Feedback-Loop"><a href="#Feature-and-Usage-Feedback-Loop" class="headerlink" title="Feature and Usage Feedback Loop"></a>Feature and Usage Feedback Loop</h1><p>Designing a feature and usage feedback system is in principle not dissimilar to an error feedback loop, however it is more nuanced and complex. For a start, there is no right or wrong. Improving is more subtle than fixing, which translates into not all changes are improvements. There are more data sources, in this case metrics, and they require analysis and interpretation to be most useful. We will see how you can gain insight, excuse the pun, with Azure, and also with App Centre.</p>
<p>While we were looking at Application Insights you might have noticed that most of the metrics weren’t related to just errors, but to system and application performance, such as server response time and page load time. Knowing about system metrics is almost as important as knowing about exceptions. A user could easily mistake very slow page loading for an error, especially if they give up waiting. Whatever the reason for slow performance, be that page loading or server response time we want our applications to be a pleasure to use, not a chore.</p>
<p>We can drill down into performance or system metrics by clicking metrics under the monitoring menu. In here we can add charts with multiple metrics. You might want to have chart of client or browser side performance showing page load time and client processing time. Just create a new chart and begin adding metrics. Another chart might focus on server and network performance. One thing to keep in mind when combining metrics is not to have too many on one chart and make sure they are of a similar scale so one metric doesn’t turn the others into a flat line at the bottom of the graph.</p>
<p>We can go to performance under the investigate menu and look at load times and number of page hits. Click on a page for load times specific to that page. By clicking on the overall load time and then the drill into examples button we get a list of the individual asset load times. You can use this to get an idea of the loading time impact of the asset and if necessary, create a work item to look at speeding it up.</p>
<p>Not only is it important to know how your app is operating from an internal code and system perspective, but it is very useful to know how your users are, or are not interacting with it. Are users finding it intuitive to use? Are there features that users will like, but can not find them? If your app is a shopping platform your need to know if there is some technical or navigational issue why views aren’t being converted into sales. </p>
<p>A good place to start is knowing who your uses are, in terms of location. There is no denying that culture does play a part in user behavior and attitudes. This can relate to supported languages and time zones your users are in, through to what kind of icons you are using to represent features or actions. You want the icons to be self-explanatory and not offensive to a particular cultural group. The user’s insight also tells you which browsers and operating systems you need to support, or which new browser features you may be able to take advantage of.</p>
<p>The user flows feature under usage is quite a dramatic graphical illustration of how users navigate through your application. In a large application this is a useful tool for discovering feature usage. It may help you determine where to concentrate development efforts to expand features or remove options to simplify the application. If you have a flow or path that you want users to follow to a purchase, for example, this tool will help you understand if that process is working and how it could be improved.</p>
<p>Application Insights has also introduced the concept of impact, which is a graphical representation of page conversion rates relative to page load times. Impact is in essence a correlation between one action leading to another. For example, what is the correlation between a user being on the “special deal page” and then navigating to the checkout. For those of you with a statistical bent the impact figure is based on the time tested Pearson correlation coefficient. As with all statistical measures sample size is extremely important, that is the larger the better. If your dataset is statistically robust then impact will provide an objective and unambiguous picture of user behavior.</p>
<h1 id="App-Center-Analytics"><a href="#App-Center-Analytics" class="headerlink" title="App Center Analytics"></a>App Center Analytics</h1><p>Let’s now go back to the App Center and see how we can incorporate analytics into a mobile or desktop application. Adding analytics is pretty much the same procedure as for crashes. Install the analytics package and add the using statement. Then add the typeof analytics parameter to the AppCenter start statement. You need to put the Analytics TrackEvent statement everywhere in your code where you want to log events. That could be in user interface events, navigation or API calls.</p>
<p>The overview page gives you basic user session data over time. The number of users and the duration of their sessions. You also get a breakdown of devices and operating systems running your app, as well as countries and languages. The countries display relies on a devices SIM card, so this won’t work for desktop applications. You are able to filter the overview and events by version and time frame. While you can integrate App Center data with Application Insights, from my experience there appears little to be gained from it at this time.</p>
<p>The events page is where we can see all the TrackEvent calls we set up within the application. There is a raw count figure, number of users and per user count. Clicking on an event will display event detail which is basically those same metrics but presented graphically over time. Unlike Application Insights the usefulness of event tracking is very dependent on the placement of TrackEvent calls and what data you choose to send back. My feeling is that this service is a long way from maturity and we will see is capabilities grow over time.</p>
<p>Log flow is App Center’s version of Application Insights live metric stream. This displays calls to TrackEvent in real time, give or take latency delays. You could think of it as being akin to a live stream of debug statements. </p>
<h1 id="Customer-Feedback-Loop"><a href="#Customer-Feedback-Loop" class="headerlink" title="Customer Feedback Loop"></a>Customer Feedback Loop</h1><p>So far, we have looked at purely technical and system-oriented feedback. While system feedback is objective and relatively easy to collect, it by no means tells the whole story from a product development perspective. If your users are also your customers then making sure they are at least satisfied, if not happy, is important. This is especially true in the context of the widely adopted subscription model. Even if your users aren’t paying for your software you want to know if it is meeting their needs as best it can, enabling them to do their jobs efficiently. Ideally you would want this feedback to be integrated into your system and usage feedback loop. This serves to have one repository of issues that can feed into the development workflow system and allows you to easily relate user feedback with automatically collected system issues.</p>
<p>Let’s look at the types of user feedback we might want to analyze. Issues that come through the help desk fall into 2 basic categories, bugs or non-conforming behavior and incorrect usage. In a help desk situation, you have the ability to perform manual triage and create work items. The user issues can be grouped with related metrics or exception data.</p>
<p>You can build user feed back systems within the app like send a smile, or even put feature specific feedback at critical points like star ratings or binary answer questions. This is a double-edged sword. It allows you to target specific aspects of the app’s behavior, but you don’t want to annoy or inconvenience the user. An obvious candidate for a single question is the staple of the Net Promoter Score. On a scale of 0 to 10 how likely are you to recommend this product, service or company. Middle to low scores can be followed up with a more in-depth questionnaire to drill down to specific issues.</p>
<p>Surveys are another way to garner customer feedback. These could be through the app or delivered separately via email. Once again you are treading a fine line between gathering information and annoying the user. Survey design is a science in its own right, but generally speaking, questions that are multi-choice are easy to analyze, whereas free text answers, are where all the nuggets of knowledge, or the “unknown unknowns” reside. Another thing to keep in mind is that surveys where participants self-select tend to get responders who have a specific problem, so while good for finding issues may not reflect overall customer satisfaction.</p>
<p>Forums or user groups are another source of good customer feedback where a thread is dedicated to a particular topic. This is one place where the issues are already categorized, but still require you to pull the information from text or dialogue.</p>
<p>Finally, social media. In terms of how your app is truly perceived this where the gold is, but it is gold that is difficult to mine. You don’t know exactly where it is, and when you find it, it isn’t usually in an easily digestible form. This is definitely a situation where you don’t want to reinvent the wheel. There are plenty of services that monitor social media that you can subscribe to. When collecting the mentions it is usual procedure is to code the verbatim, that is categorize the data so it can be more easily analyzed.</p>
<p>There are several ways you can record your user feedback ranging from spreadsheets to dedicated project management tools such as JIRA, Basecamp or DevOps. The central goal is to have indicative examples of feedback in one place that can be directly related to work items. I say indicative examples because you don’t need every instance, just the ones that best illustrate the issue the work item ticket addresses. As for survey, questionnaire and rating data, this needs to be distilled down to essential and actionable facts that are correlated with user attributes such experience or time using the app.</p>
<h1 id="Baselines-and-Noise"><a href="#Baselines-and-Noise" class="headerlink" title="Baselines and Noise"></a>Baselines and Noise</h1><p>I’m sure you are aware of the concept of baselines. A known state, preferably good, that we can measure against to decide if system performance is optimal. In the case of Application Insights alerts we can view a summary of generated alerts over a specified time span within alert monitoring. There is a breakdown of alerts by severity. Clicking on a severity line will take you to a detail screen showing individual alert instances. Within this page there are various drop-down lists to filter the alert list. Smart alert groups have recently been introduced where machine learning algorithms are used to group alerts by similarity or correlated occurrence</p>
<p>To establish a baseline of your telemetry data you can review the apps analytics log. Under monitoring click Logs Analytics. Raw log data is vast and descriptive, basically there is a lot of it, and with that in mind Azure provides the Kusto query language to interrogate the logs. I can hear you, not another syntax to learn. Good news is that it’s really simple and the intellisense within the browser works a treat. In the left schema pane there are your tables, and if you expand one, as I have done here for requests you see the fields. A query starts with the table name – like a from clause without the from. You add additional clauses with the pipe character. Each clause pipes into the next one so their order is important. You can have multiple where clauses or join conditions with ands and ors as you would in SQL. The project clause is analogous to select in SQL – I guess these are the fields you are projecting into the result set. Finally, in this example we have a summarize clause which is analogous to a group by statement. So, this query is a count of requests to urls by result code where I’ve excluded urls that have ‘lib’, ‘css’ and ‘js’ in the path, and have occurred in the last 14 days. The results can be viewed as a table or a graph. These queries can be saved and easily executed at a latter date, making this an excellent tool for telemetry comparison over time.</p>
<p>Depending on the size of your application you could be looking at quite a lot of feedback data coming in, but hopefully not too many crash reports. There is definitely the possibility of being swamped by data resulting in paralysis by indecision or hyper responsiveness and consequential fatigue - the boy who cried wolf scenario. To avoid this, you need to establish baselines where you can decide what is real and what is just noise.</p>
<p>Within Application Insights you have several options for filtering alert messages. Firstly, there is the basic static alert that I demonstrated earlier where you can set the threshold value. This is fine when dealing with absolutes or critical events, but for most cases has limited usefulness. For more complex and changeable situations we can set dynamic alerts. These alerts are dynamic on several levels. There is the obvious scalability factor as your user base grows. In many cases there will be a seasonal component, whether that is that the app is used inside or outside of business hours, or usage patterns change as your primary markets get up or go to bed. According to Microsoft none of these things matter as, and I paraphrase “Thresholds detection leverages advanced machine learning from historical data”. They do mention the word deviation more than once in their literature, which leads one to think of standard deviations from normally distributed data. However, in my experience not all data comes in the form of a bell curve, so it must be a bit more sophisticated than that. Instead of setting a threshold value you set a threshold sensitivity. High sensitivity will give the most alerts as the smallest departure from historical behavior will trigger an alert. Medium sensitivity, which is the default is more balanced. While low sensitivity will require more and larger deviations from past data to trigger an alert. </p>
<p>When you select dynamic logic, you get the ability to set the number of violations that occur within a time frame before an alert is triggered. I recently had a situation with a service communicating with a supplier’s service every minute. If the communications went down, it was critical for operational staff to know. But for whatever, probably network related, reason there were occasional glitches, resulting in sporadic outage alerts. By setting the aggregation type to count, the sensitivity to high, and in Advanced settings, the number of violations to 6 in the last 10 minutes, an alert will be sent when communication has really gone down and not just spurious failures. </p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>In this course we started by looking at what feedback is, and the types of feedback that can be useful for refining your application once it’s been deployed. Starting with exception or error feedback we saw how a loop should be designed to integrate with development workflows. We then learned how diagnostic feedback could be incorporated into mobile and desktop apps using App Center. Then we analyzed those exceptions and saw how to use those exception events to send notifications and create work items that were integrated with Azure DevOps and GitHub. For web applications we saw how exception data could be pulled from Application Insights telemetry metrics. We set up alert rules that would send notifications via email or integrate directly with third party systems. Again, we learned how work items created in Application Insights could be fed through into Azure DevOps and then appear in Visual Studio Team Explorer for actioning.</p>
<p>We need a way to easily assess the state of our development workflow and with Azure DevOps we can use the dashboard facility to create a custom dashboard with a variety of graphical widgets. </p>
<p>Feature and usage is the next feedback element we examined. Using Application Insights, we can monitor the performance of an application not only in system performance terms, but also how users interact with it. The live metrics feature let us see real time usage. This is valuable information from a UI perspective. It allows to see whether the app is fulfilling its objectives in terms of conversion, and also is the application intuitive to use. This is valuable information for assessing efficacy of features, or whether those features need to be made more prominent within the application, or perhaps removed as they are redundant. Application Insights tells us where in the world and what operating system and browser is running our app.</p>
<p>Next, we went back to the App Center to see how we could implement event tracking and analytics in non-browser applications. Using the TrackEvent statement sprinkled liberally through an application you can see events being logged, and the log flow lets you see those events being triggered in real time.</p>
<p>User feedback is the final element in the feedback trio. This ranges from help desk contacts which are easy to categorize and integrate with workflows, through in app ratings and questionnaires, to forums and social media. Each of types of feedback have their pros and cons which more or less lie along the dimension of information accessibility versus information richness. Ratings are easy to deal with but are one dimensional. Questionnaires and surveys have more information, but the participants are self-selecting and normally have an axe to grind. Social media is where the unvarnished truth lies, but that is the most difficult to extract and integrate.</p>
<p>To make really good use of all this feedback data we need to know how it relates to our baseline state. We can use the feedback tools to arrive at baselines by analyzing historical data and monitoring changes over time. In the context of alerts the data coming in is dense and it will contain a fair amount of noise, so we saw how set up filtering to be notified of real events.</p>
<p>Using a combination of App Center, Application Insight and Azure DevOps you can build feedback collection and workflow integration solutions that will help you implement continuous feedback with relative ease.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Using-PowerShell-DSC-on-Windows-21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Using-PowerShell-DSC-on-Windows-21/" class="post-title-link" itemprop="url">AZ-400-Using-PowerShell-DSC-on-Windows-21</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:58" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:58-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-24 00:53:38" itemprop="dateModified" datetime="2022-11-24T00:53:38-04:00">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Using-PowerShell-DSC-on-Windows-21/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Using-PowerShell-DSC-on-Windows-21/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Implementing-Azure-Infrastructure-Compliance-and-Security-20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Implementing-Azure-Infrastructure-Compliance-and-Security-20/" class="post-title-link" itemprop="url">AZ-400-Implementing-Azure-Infrastructure-Compliance-and-Security-20</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:57" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:57-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 13:29:56" itemprop="dateModified" datetime="2022-11-27T13:29:56-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Implementing-Azure-Infrastructure-Compliance-and-Security-20/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Implementing-Azure-Infrastructure-Compliance-and-Security-20/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Course-Introduction"><a href="#Course-Introduction" class="headerlink" title="Course Introduction"></a>Course Introduction</h1><p>Greetings, welcome to Cloud Academy’s course on implementing Azure infrastructure compliance and security. I’m glad to have you along on what is bound to be an exciting and enlightening journey into the world of the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft Azure cloud</a>. But before we begin, I will briefly introduce myself since it’s the polite thing to do. My name is Jonathan Bethune. I am a course developer with Cloud Academy. For many years I have worked as a software developer and consultant but long before that I was actually a high school teacher. I must say it’s a lot of fun getting back into teaching, only now I get to teach technology.</p>
<p>This course is meant to help you better understand Microsoft Azure, specifically those features related to security and compliance. The course should be helpful both for people aiming to pass a certification exam and for folks already out in the field just looking for some practical help.</p>
<p>So you’re probably wondering, you know, what are the prerequisites for a course like this? What exactly do we expect you to already know? Well, just a few things. For one, you should be familiar with cloud providers generally. You should already have some basic knowledge of Azure. We’re not gonna teach you how to set up an account or anything like that. Secondly, you should have some basic understanding of programming and cloud infrastructure. We will be looking at PowerShell scripts and working with virtual instances. If this is your first time seeing either of those things you might wanna consider a more rudimentary class.</p>
<p>So let’s get more specific. Learning objectives. This course has three. One, students will learn how to scan infrastructure using Azure tools to prevent drift leading to compliance violations. Two, students will learn how to automate configuration using Azure Automation and Desired State Configuration. And three, students will learn how to create secure and compliant software pipelines in Azure. Now, these three objectives map to the three sections of the course. Each section will include explanations and video demonstrations to ensure you learn everything.</p>
<p>And lastly, I would like to also invite folks to send us feedback: questions, concerns, suggestions. We always appreciate people taking the time to do that. So thank you in advance for that. And without further ado, let’s dig in and start learning.</p>
<h3 id="Lectures"><a href="#Lectures" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Compliance-amp-Security-Scanning"><a href="#Compliance-amp-Security-Scanning" class="headerlink" title="Compliance &amp; Security Scanning"></a>Compliance &amp; Security Scanning</h1><p>Compliance and security are two critical concepts in the world of cloud software systems. They reinforce each other in important ways, so I would like to start by making sure you understand the distinction early and clearly. Security refers specifically to how well-protected our system is from threats. And by threats we might mean external agents and bad actors like hackers, and also how well protected we are from internal actors like careless employees, any other thing that might compromise our systems. So that’s security. Compliance refers to the degree to which our architecture conforms to a specific standard. So we may have defined an amazing security standard to protect for everything. However, our system is not really safe unless it is also compliant with that standard. So by the same token, being compliant is not helpful if our standard is too weak.</p>
<p>I’m going to reiterate this for emphasis ‘cause it’s important. The state of having a secure software environment comes from both having a solid security standard and ensuring that your system is compliant with that standard. In practice, it’s very difficult to ensure security without thinking about compliance. Security just on its own is very abstract and nebulous, am I secure or not? Compliance gives us a framework for defining threats and prioritizing solutions for hardening our systems.</p>
<p>In this first lesson as part of section one, we’re going to demonstrate how we can define security standards in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> and gain confidence that we are compliant with those standards.</p>
<p>So let’s start by talking about Azure Security Center and policies. So Azure Security Center, or ASC as we can call it, is Azure’s comprehensive platform-wide infrastructure security tool set. ASC is deeply integrated with all Azure services and does not require any additional deployment. It can be used with other clouds or on-prem solutions, it is at its most intuitive, though, in an Azure environment. ASC includes scanning tools for general vulnerability assessment. There’s a VM scanning tool for checking Azure instances as well as a newer container image scanner that will identify known vulnerabilities within containers, software containers, in your Azure Registry. Scans occur automatically when containers are uploaded and run continuously on a schedule. Note that these features are part of the standard tier price, not the free tier. So you do have to enable that in your subscription.</p>
<p>A basic construct of Azure Security Center is the policy. ASC policies are what define the security standards used for measuring compliance. ASC includes dozens of pre-defined industry standards such as SOC TSP, ISO 27001, PCI. These standards are widely used and exhaustively studied and audited. They cover things like access control, incident response, encryption, and a host of other security concerns. Some will apply to specific Azure services. ASC also has support for defining custom policies if you have needs specific to your organization.</p>
<p>The ASC dashboard lets us see all of our policies in one place and map them to specific resource groups and subscriptions. Of particular use is the Regulatory Compliance dashboard which lets us see precisely how compliant our system is with industry and org-specific standards. What’s more, ASC also gives an overall security score with severity rankings. Thanks to this in practice, you really don’t need to spend a lot of time actually creating original policies from scratch and updating them. With the built-in industry security standards, the compliance dashboard, and the security score, you have all the tools you need to lock down your environment just by following Security Center’s lead.</p>
<p>Compliance with ASC security policies is tracked automatically over time in the dashboard. We can easily see which subscriptions are covered by specific ASC policies and which resources are compliant. This is all just extremely helpful for auditing purposes, particularly for businesses that are in industries with very strict regulations regarding data security. The dashboard will give us an audit trail should something go wrong and should there be a need for forensic investigation.</p>
<p>So that’s basically it for ASC. We will go deeper into the actual dashboard in the demo. In the next lesson, we’re gonna talk about drift which is a phenomena of systems that may be compliant but they don’t always stay compliant. So we’ll see ya there, thanks for listening.</p>
<h3 id="Lectures-1"><a href="#Lectures-1" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Security-Center-Demo"><a href="#Security-Center-Demo" class="headerlink" title="Security Center Demo"></a>Security Center Demo</h1><p>Howdy friends. So in this demo, we’re going to do a brief introduction to Azure Security Center. We’ll show how to navigate the ASC dashboard in the browser, check out our security scores, show where the security policies are defined, and talk about how we can improve compliance. The whole demo is only a couple of minutes so just sit back and enjoy.</p>
<p>So let’s start with the Azure portal. We’re going to assume you already have or know how to set up an <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> account. This isn’t a beginner tutorial so if you have an account, Security Center is enabled by default. It will have the basic functionality for free tier accounts. But for this class, we are going to assume that you have upgraded, that you’re using the standard tier features because we do cover some standard tier features in this class. So let’s first take a look at the dashboard.</p>
<p>So right away, the overview here gives us a nice little snapshot of the world basically. This particular Azure account is just a dummy account. It’s very small, it’s just running a single VM. However, what’s cool is we can see right away how compliant our system is with various regulatory standards, things like PCI DSS or SOC TSP. So, let’s think about this though. Let’s dig a little bit deeper into what the score means, 295 out of 530.</p>
<p>What exactly is this score? In the Secure Score dashboard here, we can see exactly which areas of our system need attention with regards to security. Here we can see sections for Identity and access management, Networking, Compute, Data and storage, etc, etc. And we can drill down into specific tasks. You can click on one and see here, there should be more than one owner assigned to your subscription. All right, pretty straightforward. It’ll guide us toward solving that. So these are tasks that will harden our system. Oh, it’s saying Security Center. Okay, so that’s just the security score.</p>
<p>But let’s be a little more specific here. Let’s talk about compliance, let’s talk policies here. In the Security Policy section here, we can drill down into our subscription which is a free trial and we can see exactly which policies are in effect. In here, we can see a few. There’s the default ASC here, Security Center Policy. And then these policies here, these are industry and regulatory standards, all right. So these are compliance policies that again, deals with things like PCI DSS, SOC, and then here, we see Azure’s own standard Azure CIS 1.1.0 and ISO 27001. These are out-of-the-box industry policies that you get and add more if you want. You can click here and add additional policies like Swift and NIST. And then, what’s cool is we can also define custom policies here in the custom initiatives section. There’s one here I’ve created called Block VMs and you can see in its description, No public IPs, which actually is not a very good description. But if we drill down on that, we click on it and we can see that it has two policies with distinct effects, built-in effects. Network interfaces should not have public IPs and then also Internet-facing virtual machines should be protected in network security groups. So this is our own custom policy.</p>
<p>So, going from there, as we’ve said in the earlier lessons, you know, it’s one thing to have good policies. The most important thing though is compliance with those policies. That’s really what we care about. So, what we’re gonna do is look at the Regulatory Compliance dashboard. This is really one of my favorite things about Azure. The Compliance dashboard is a tool for tracking compliance and we get in one neat place a very clear picture of our cloud environment’s compliance with multiple industry standards. As a former network security engineer, this is one of my favorite things if I’m working in an Azure environment. We can see here exactly what’s failing, what’s passing. We can look at specific standards, again, PCI and SOC. Probably one of the coolest things about it is that we can get very granular. We can select individual standards here, like ISO 27001. And then we can see exactly where we have gaps in those standards and drill down to specific issues here like Network Security Management, all the way down to Controls and then, that’ll get us down to the exact requirements and recommendations. And click on that and get solutions and advice for solving those issues right away. So here we’ve drilled down to just in time network access should be applied at virtual machines, right? And then, we can go straight into solving that issue.</p>
<p>So, there you have it really, at a high-level. That is ASC. It’s one of Azure’s most compelling solutions I think when compared to other cloud providers. There are many helpful features here we didn’t even go into. File Integrity Monitoring. You have Adaptive network hardening. You have various other management dashboards and tools. It’s just a nice single source of truth for all things security in Azure cloud. And hopefully now with this walkthrough, you have some confidence in managing security policies and compliance in an Azure context. Thanks for watching.</p>
<h3 id="Useful-Links"><a href="#Useful-Links" class="headerlink" title="Useful Links"></a>Useful Links</h3><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/security-center/security-center-compliance-dashboard">https://docs.microsoft.com/en-us/azure/security-center/security-center-compliance-dashboard</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/security-center/security-center-vulnerability-assessment-recommendations">https://docs.microsoft.com/en-us/azure/security-center/security-center-vulnerability-assessment-recommendations</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/blog/integrated-vulnerability-assessment-with-azure-security-center/">https://azure.microsoft.com/en-us/blog/integrated-vulnerability-assessment-with-azure-security-center/</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/updates/scan-container-images-for-vulnerabilities-in-azure-security-center/">https://azure.microsoft.com/en-us/updates/scan-container-images-for-vulnerabilities-in-azure-security-center/</a></p>
<h3 id="Lectures-2"><a href="#Lectures-2" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Preventing-Drift"><a href="#Preventing-Drift" class="headerlink" title="Preventing Drift"></a>Preventing Drift</h1><p>Now that you are grounded in Azure’s toolset for getting your systems compliant, we now are going to learn how to keep them that way. Drift is the bane of many a systems engineer. By drift we mean configuration drift, not the cool racing technique. The reality of drift, the reality that over time software systems tend to become less compliant and more chaotic. Now this happens a thousand different ways. A hotfix will get deployed and it updates a yaml file but doesn’t put the change into version control. Or a firewall is opened up during a maintenance window but the port and protocol rules are not returned to their strict settings afterward. Or a server gets rebooted, blowing away some critical in-memory credential. The older our infrastructure is, the more likely we will have all sorts of lore and history and drift building up and making it less stable. Configuration drift is a very serious security threat.</p>
<p>Fortunately <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> gives us some helpful tools for detecting drift in our configuration. Now your first line of defense is the Azure Resource Manager or ARM. This is the logical grouping of resources in Azure, and it’s frankly one of the most helpful features when compared to other cloud providers. ARM deployment templates allow you to define a discrete set of resources, as well as their configuration in one easy to monitor, monitor and update place. These templates can be treated as infrastructure as code and checked into version control. The infrastructure as code is a really important concept.</p>
<p>If you’ve ever worked with Terraform or Cloudformation, you may be familiar with the concept already. But the basic idea of infrastructure as code is that you don’t want to make any ad hoc changes to your environment, by clicking around in the web console or manually running scripts. You don’t wanna do arbitrary changes this way. As systems engineers, we’re often tempted to just SSH to a server, edit some file, restart the service and then be on our way, right? It fixes the problem, right? Wrong, it creates technical debt. We absolutely must avoid this type of approach. Using our resource manager, and ARM templates, every change can be version controlled, public, transparent, and easily undone.</p>
<p>Now the second line of defense is the activity log. This is your one stop shop in Azure for seeing changes to Azure resources. Now, this won’t catch everything necessarily, if you SSH to a server, but most changes whether it’s done with a CLI tool or script or using the console. If anyone has made that change to Azure resources, that change should be reflected in the activity log. It’s a good idea to backup these logs and to audit them regularly.</p>
<p>Now, your third line of defense is at the VM level, the level of virtual machines and it’s a nifty little tool called change tracking. And this is a slightly newer feature. And it works with Windows hosts and many Linux distributions, but not all. See the documentation <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/change-tracking">link</a> for the full list of supported Linux distros.</p>
<p>Now, you enable this feature by turning on inventory and change tracking from your Azure automation account, or from the virtual machine UI in the web. The video demo we’ll go over will show you how to do it. Once it’s enabled, Azure will identify changes to running software, such as Linux daemons and Windows services. And what’s really cool there’s also a built in FIM, File Integrity Monitoring, FIM solution, and this FIM solution lets you define specific files that you want to track for changes as well as the content of the files themselves. So you can see if some config file or credential has been changed and you can even see a diff of those changes.</p>
<p>So our goal in this section was detecting drift, and to maintain compliance with security policies. I hope you’ve got some good ideas. Now we went through our main lines of defense. In section two we’ll go one better and learn how to prevent drift by using a really cool service known as Desired State Configuration or DSC. Be sure to check out the video demos to lock in your understanding of compliance and ASC before moving on to the next section where we will learn how to automate much of that cumbersome compliance and security policy work. See you there!</p>
<h3 id="Lectures-3"><a href="#Lectures-3" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="ARM-Activity-Log-amp-Track-Changes-Demo"><a href="#ARM-Activity-Log-amp-Track-Changes-Demo" class="headerlink" title="ARM, Activity Log &amp; Track Changes Demo"></a>ARM, Activity Log &amp; Track Changes Demo</h1><p>Greetings, welcome to the second demo for our course on Azure security and compliance. This demo will be pretty short, we’re just going to review the “three lines of defense” for detecting drift in an <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> cloud environment. We’ll be showing off the Azure Resource Manager portal, the activity log, and how to enable the track changes feature. So let’s dive right in.</p>
<p>First of all, we’ll start off in our portal, and we’ll go to the Resource Groups section. Now, in our test account here we only have a few small groups, in two geographic regions here, US east one and two. To see our config, we’ll just click on our group that’s interesting to us. So for us let’s try “TestGroup1.” And right away we can get a lay of the land, we can see in the menu that there is an overview here which is where we start. We have a number of additional things like access control, and the activity log up here, which we’ll come back to. As we mentioned in the lesson one of this section, one of the key things in the Resource Manager, in ARM is the concept of deployment templates.</p>
<p>So let’s take a quick look at that. We can just click on “deployments” actually. Then select the one that we care about, it will take a second to load. Okay, so once those are loaded, we can see our deployments. And we can select any of the ones we care about. There’s not a lot of deployments here ‘cause we’ve just done a few basic VM’s, but if we click on any one at random, we can see, for example, this one, creation of a server. And if we go into this server creation, cool thing is we can actually click on the template and we get this big JSON file that describes everything about the deployment, about the resource. So this is human readable and parseable, which is pretty cool. So it’s very easy to manage this kind of thing in version control if you wanted to. They have an infrastructure’s code paradigm. In the web portal, we get nice time stamps and status reports on every deployment, and we can check the parameters as well, and scripts. Really it’s a great first source of truth for identifying drift. So we’ll go back to our resource group.</p>
<p>And now, we’re gonna take a look at the activity log. Now, the activity log we can also get from the Resource Group menu. The log will just give us information about Azure environment events detectable by the API. So this is an important thing to note. If you SSH to a server and edit a file or do some other more surgical operation, it won’t necessarily be reflected here unless you have detailed change tracking enabled which we will talk about. But keep that in mind.</p>
<p>The activity log is for things recognizable by the Azure API. And it’s still very easy as a high level source of truth to parse when it comes to resources. So we can see a few events here. One of the nice things is that we can change the timeframe, this is really only the last six hours. So we can change it to the last week, and we can see how much broader range of options here, of output, right? And we can also add additional filters here aside from time span. So, this is another really easy way to catch drift, by going through and parsing this log. Okay, so now the last thing we’re gonna do is we’re going to show off the track changes feature. And this is not difficult to do but there are a few prerequisites.</p>
<p>Now, first of all, one thing you need is you have to enable an Azure Automation account, which is not enabled by default. So, you just go to that item in your portal, and you’ll have to enable it, you have to select it. And you can enable it even with a free tier account. If that is done, if you have an Azure Automation account, here you see there’s two. Then, all you need is a Log Analytics work space. To define that, you can see the item here in Azure services or you can search for it. You can literally just type Azure log analytics, or just log analytics and it’ll just pop up, if you can’t find it. And then you need to define a workspace, and when you create new, you’ll have to give it a name and a location. Now, the location is actually really important. One note here is that the regions do not have a one to one mapping, the Log Analytics workspace and your Automation account. So for example, if your Log Analytics account is in US region east one, US east one, you’ll actually need an Azure Automation account in east two. So, that mapping is a little bit annoying, we’ll give you a <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/how-to/region-mappings">link</a> to the documentation to see those mappings.</p>
<p>But anyway, as far as enabling it, you go into your Automation account, this is one basic account. This account does not have change tracking enabled, but to actually enable it, basically we just go in to our Automation account, and we click on the change tracking here, and we will pick the workspace we care about.</p>
<p>The Automation account has a lot of different features. I’m gonna actually go to an account that has it enabled. I could actually do a whole lesson on just Azure Automation account because honestly as a DevOps guy it’s really a dream tool set, all of the stuff they have here. But this is a security-focused class so we’ll focus in on that. Once you have change tracking here enabled, you’ll see here that you have a few different options here.</p>
<p>So, we have options for files, for daemons, for events, registry, software window services. There’s no changes in this account because it’s a pretty empty account, but the cool thing is you can do diffs by clicking on individual things here. And I think from here it’s fairly intuitive, but this is our final point for this demo. That about does it. Resource Manager, activity log, and change tracking. Three ways to preempt and stop drift in your environment. All pretty easy to see in the web, and easy to work with at the API level. So, hopefully this is helpful. Cheers.</p>
<h3 id="Useful-Links-1"><a href="#Useful-Links-1" class="headerlink" title="Useful Links"></a>Useful Links</h3><p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/da-dk/blog/tracking-configuration-changes-for-your-azure-vm/">https://azure.microsoft.com/da-dk/blog/tracking-configuration-changes-for-your-azure-vm/</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/updates/azure-stack-security-drift-detection/">https://azure.microsoft.com/en-us/updates/azure-stack-security-drift-detection/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.auditwolf.com/blog/configuration-drift">https://www.auditwolf.com/blog/configuration-drift</a></p>
<h3 id="Lectures-4"><a href="#Lectures-4" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Desired-State-Configuration-DSC"><a href="#Desired-State-Configuration-DSC" class="headerlink" title="Desired State Configuration (DSC)"></a>Desired State Configuration (DSC)</h1><p>If you are an infrastructure engineer responsible for managing an <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> environment, Azure Desired State Configuration is your friend. Desired State Configuration, or DSC for short, is a declarative PowerShell platform that lets you turn infrastructure into code.</p>
<p>Infrastructure as code is not really a new concept, but it is a powerful one. Cloud infrastructure has to be managed and accounted for somewhere. When it isn’t in code, it usually ends up in a dozen other places, scripts, developer laptop BASH history, Chef server logs, and data bags, and YAML files on a forgotten server. The table in an SQL database, a product manager’s email, a post-it note on someone’s monitor, etc, etc. Managing infrastructure configuration is very hard when it isn’t transparently all in one place. This is the problem the whole infrastructure as code thing is meant to solve. Ideally, our infrastructure is defined in a shared audited version-controlled repository in GitHub or somewhere like it.</p>
<p>DSC lets us do exactly that using Powershell. If you’ve ever worked with tools like Chef or Puppet or Terraform, then you can start to get a mental picture. In DSC there are three basic concepts: resources, configurations, and the local confirmation manager, or LCM. Resources are the things: Azure VMs, individual files, processes, and other Azure assets. Think of them as our nouns, the object of our configurations. Configurations then, as you may have guessed, are like verbs. They describe the desired state of our resources. Configurations can incorporate a wide variety of parameters. We will dive into an example in a moment. But let’s go to lastly, the LCM, the local configuration manager. This is the brain of the operation, responsible for ensuring our resources are in sync with our configuration. The LCM continuously pulls the state of our infrastructure to ensure everything is running as defined.</p>
<p>Now here’s a very simple example. Take a look at this. This includes a single named configuration referencing a single node called TEST-PC1. Node resources are our Azure VMs. These are Windows host and the configuration type here is a Windows feature. Each gets its own block and we’re defining a parameter for that feature. Here specifically a flag, ensuring a named feature is present.</p>
<p>So how do we actually use this configuration code? There are two prerequisites both of which, thankfully, can be done right from the web browser. First of all, the VMs needs to be connected to DSC. This just requires going into your automation account, clicking on DSC, and then selecting add to connect the node to DSC. Secondly, you need to upload and compile the configuration code. So you have your .ps1 config text file locally on your laptop and what you can do from the dashboard is upload it or copy paste it using the configuration editor. You can also do this using CLI tools. Once the config is uploaded you need to compile it. </p>
<p>Now, this just makes sure that there are no syntax errors or problems before the config is applied. Once these two steps are done, connecting the VM to DSC and then compiling the config after uploading it, you can just apply the config to the desired node right in the web portal with a simple point and click. Now, this should give you a sense of how configurations and resources look in actual code.</p>
<p>But we can’t forget about the third element, the LCM. The local configuration manager actually has its own configuration. We can adjust how frequently the LCM executes configurations and we can toggle the LCM back and forth between the push and pull model. The push model is the default, where the LCM server will just regularly push configurations out to all designated resources. The latter pull model allows for more flexibility as this requires you to define some form of pull service. This lets you specify for individual resources exactly which pull service endpoint to use for config or resources.</p>
<p>And then finally we should mention that DSC has support for partial configurations. That is pulling configuration from multiple sources and then combining them into one complete config. This might sound strange but there is a reason for this use case. It can be done in both a push model and a pull model. Now this more complex use case, what it does actually is it adds a really interesting flexibility to your configuration management paradigm.</p>
<p>So here’s an example scenario where this might be helpful. Imagine you’re in a larger team with different groups of developers and these different groups of developers have specific responsibilities. So for example one team is responsible for the database config and another team is responsible for app config. Using partial configurations, each team can define their own part of the system and then use DSC to assemble it all come deployment time.</p>
<p>Okay, so now we have some basic understanding of Azure DSC. This is crucial before we move on into the next level of automation. DSC is really just a subset of our Azure Automation Account. Before we can see how it relates to security compliance we’ll need to explain how we can effectively administrate DSC infrastructure, how we can manage it. The next lesson will cover that and include a demo showing how to actually utilize DSC scripts. See you there.</p>
<h3 id="Useful-Links-2"><a href="#Useful-Links-2" class="headerlink" title="Useful Links"></a>Useful Links</h3><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/automation-dsc-overview">https://docs.microsoft.com/en-us/azure/automation/automation-dsc-overview</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/scripting/dsc/managing-nodes/metaconfig?view=powershell-7">https://docs.microsoft.com/en-us/powershell/scripting/dsc/managing-nodes/metaconfig?view=powershell-7</a></p>
<h3 id="Lectures-5"><a href="#Lectures-5" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Azure-Desired-State-Configuration-Demo"><a href="#Azure-Desired-State-Configuration-Demo" class="headerlink" title="Azure Desired State Configuration Demo"></a>Azure Desired State Configuration Demo</h1><p>Okay, howdy and welcome to the first video demo for section two in our course on Azure security and compliance. In this video, we’re going to do a brief introduction to Azure Desired State Configuration in the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> web portal. We’re going to show how to first import a node into our DSC system so that it can be assigned configurations. Then we’ll create a very simple DSC script so you can see some code. And then finally, we’ll upload our DSC code, we’ll compile it and we’ll assign it to a node at which point we can see the node become compliant.</p>
<p>So we’ll start by importing a node into our DSC account. So, we’ll assume you already have a node ready to go that you know how to launch a node. So one thing to be aware of is the region mapping between nodes in Azure Automation services. We’ll have links about that in the lesson. But basically, to import nodes, there’s a couple of ways you can do it. You can use the CLI tools or the API or you can use the Web Console. Now for this demo, we’re gonna use the Web Console because it makes it easier to see exactly what’s happening. But of course, do be aware everything we do here can be readily scripted, using PowerShell.</p>
<p>If you have to do, do it at a larger scale, pointing and clicking around for lots of nodes can be kind of painful. So to actually import the node, we’ll just go into our automation account for this will use this basicAccount2 and we can look and see information about nodes in DSC portal in the state configuration DSC section.</p>
<p>Now, when we go here, we can see that initially, there are no nodes available. So we wanna add a node, we’re gonna click on Add. And this will show us the nodes are available here we can see there’s only one. So we click on that node and to connect we just click Connect. And there’s some default configuration here, we can change if you want but for our purposes, the default is fine. And this will take a second. Now be aware that if your node is not in the right region, you’ll probably get an error in this connection period. It’ll bubble up. So do be aware of that issue make sure that the account and the nodes are in the right regions.</p>
<p>Okay, so once the node connects and it might take a little while for the connection to finish, you’ll be able to see the node in your state configuration portal. You’ll see it here. So once we have that, we want to next assign some DSC configuration to it and before that, we have to create the code of that configuration. So we can do this a couple of ways. We can write the script and in a file and upload it. We can also use the built in text editor here, we can go to compose configuration, and write the script right there. We’re going to use the former method, we’re gonna write a configuration file and upload it, so to do that, we click on configurations, and we click on Add. Now, I’m not gonna edit a whole thing from scratch. I actually have some basic config from Microsoft documentation, which I can show you right here. Very short, simple file. So what we’re gonna do is upload this file. We’ll go to our uploader here, here we can see it, we can add a description we’ll say, some test config, obviously you wanna do a better screen description than that and then just click OK. And your that file, that TestConfig.ps1 file, it will be uploaded into the dashboard. So we can see it right there.</p>
<p>Now, once that’s done and saved, we now have the configuration ready to go in our account, but we can’t assign it to the node as is, before we can assign it to our node we need to compile it. This is also pretty simple to do. We just go select the configuration that we’re interested in and we’re gonna select compile. Yes, we’re sure we wanna compile it. Now, if there is an error in the config, it will show up here. The compilation will fail if there’s a syntax error, for example. And it takes a second to run this compilation, but once it’s done, we’ll be able to actually use it.</p>
<p>Okay, and once again, once the compilation is done and it might take a little bit, we should see in the compiled configuration section, we should see that test config is available, it’s now usable. So we can actually assign this to a node, which is pretty straightforward. We click on our nodes, and we go to assign node configuration. And then we should see the available compiled configurations. There’s one here, we’ll select that and it’ll assign it to a node and what’s really cool is that once it is assigned, DSC will automatically check to see that the node is compliant with that configuration. So we can go back and we can refresh. And we can see we have one node here. And it’s pending to check if it is compliant and once that check is finished, it will go green here, we’ll see that it’s compliant. So you can see why we would want our security policies incorporated into DSC. We effectively automate security compliance by having it all in this one place.</p>
<p>So that’s it for this demo. You should now have a basic understanding of Azure DSC and how to use it in the Azure portal. So thank you for watching. And here it is now, it’s green, it’s compliant.</p>
<h3 id="Lectures-6"><a href="#Lectures-6" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Azure-Automation-State-Configuration"><a href="#Azure-Automation-State-Configuration" class="headerlink" title="Azure Automation State Configuration"></a>Azure Automation State Configuration</h1><p>In the previous lesson, we learned all about the magic of DSC. A PowerShell toolset of declaring configuration state. This is great for getting everything nearly defined and establishing a proper infrastructure as code paradigm. But how do we keep things in a good state? Aside from obsessively refreshing the dashboard every 20 seconds. How can we add a layer of automation and management above DSC to guarantee compliance with all of the level of configuration we have defined in DSC?</p>
<p>Outside of <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>, there are a lot of different tools and frameworks. We mentioned a few such as Chef and Puppet, Ansible, Terraform. However, within Azure, we have a very powerful service that integrates quite neatly with PowerShell DSC. It is known as Azure Automation Configuration State and if you’re a DevOps engineer using Azure, this too will become your best friend.</p>
<p>We will refer to Azure Automation State Configuration as AASC for simplicity’s sake because it’s a long name. And we want to differentiate it from Azure Security Center, ASC. So AASC, Azure Automation State Configuration, works on top of DSC. It is built right into the Azure automation dashboard as state configuration with DSC in parentheses in the left-hand menu basically. So recall that DSC is comprised of resources and configurations and the LCM. By itself, we would need to think of a way to manage all of these artifacts generated and referenced by the various PowerShell scripts. Comprising our overall DSC infrastructure. What AASC does is it gives us a centralized system for managing all of our DSC artifacts with an intuitive pull-based deployment model.</p>
<p>AASC lets you manage not only DSC artifacts but the target nodes and the reporting settings. The pole server collects state data from all target nodes automatically and can be configured to send reports to the log analytics service if you want reports to be more actionable. We will come back to that in a bit. AASC works with both Windows and Linux operating systems and can be configured to work within private networks and proxies. The only prerequisites for actually using Azure state configuration is that you have an Azure automation account and are using a Standard Azure Resource Manager VM since the classic VM version isn’t supported yet but that may change.</p>
<p>So that’s enough about the high-level features in specs. Let’s actually talk through a practical example so you can understand how AASC will make your life easier. So let’s start with a basic example of DSC configuration. Here we have a pretty basic script that’s meant to ensure a specific config based on whether or not a node is a web server. So we’re just you know in confirming a specific setting based on the node. So we can check this code into a git repo and we can run it manually from a terminal if we want. But what do we gain if we integrate it with AASC?</p>
<p>With the whole dashboard and Azure report. From the Azure portal, we can import this script with just a few clicks. We go into Azure automation section, we click on state configuration, the DSC page, we click into configurations and then we select add. And from there, we upload our config file. There’s also a text box to add a description which I strongly recommend doing. You wanna know some info about the scripts you’ll thank your future self. Now as before once you upload that config, you have to compile it into the node configuration before it can be applied to the pull server and actually run on machines. And this is again just a few clicks in the UI, we did that last lesson.</p>
<p>So once compilation succeeds, the new configuration can be applied to one or more node groups. Now, this may not seem like a big deal applying to node groups from the portal, you know. It may not seem all that important when you’re just dealing with a single, simple PowerShell script. However, remember that a more realistic application architecture is gonna have far more moving parts than this. We might have a queuing system, we might have a caching layer, we might have multiple front ends, we could have proxies and authentication systems and different databases, etc. We could need dozens of PowerShell scripts of varying sizes to keep everything in a healthy state and avoid drift. Managing all of that is no easy task. AASC makes it a lot easier and the even cooler thing about AASC is that it not only manages our DSC code but it let us manage the VMs themselves.</p>
<p>AASC supports adding Azure nodes both under the standard resource management and even VMs and other clouds and it lets us manage classic nodes, classic nodes not the classic resource manager but classic nodes themselves. So we’ll add a link to the documentation about this. This kind of multi-cloud functionality but what this means is that AASC lets us manage for example AWS EC2 nodes. This is a bit of out of scope, for this class to go into detail on that but it’s nice to know that if you do have or if you need to set up a multi-cloud infrastructure Azure does give you the tools to at least manage much of your config in one place. </p>
<p>Now one best practice we want to mention here for scenarios where you need quick response times to compliance failure, is that you should forward AASC reporting data to Azure Monitor logs. As mentioned AASC readily integrates with your Azure log analytics account. With a few PowerShell commands you can configure Azure Monitoring to aggregate AASC data so that it is viewable in the Monitoring section of the AASC dashboard. So you can look at the logs and monitor all of the reporting data going on in your automation state dashboard. You can then set up queries to trigger emails or alerts or other actions if a monitor detects a compliance failure in the logs. So this is really important for cases where compliance failures are very dangerous. So for the exact walkthrough on this, see the documentation link to show exactly how to set that up, if it’s an interest to you.</p>
<p>So that about wraps up Azure Automation State Configuration as we can see it is one of the best solutions for automating compliance by managing DSC infrastructure in an Azure cloud. It takes practice to really understand it always a lot of moving parts, so be sure to watch our demos and play around with it on your own. In the next lesson, we go one step further by introducing VM agents and extensions. It will be a blast, see you there.</p>
<h3 id="Useful-Links-3"><a href="#Useful-Links-3" class="headerlink" title="Useful Links"></a>Useful Links</h3><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/tutorial-configure-servers-desired-state">https://docs.microsoft.com/en-us/azure/automation/tutorial-configure-servers-desired-state</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/automation-dsc-overview">https://docs.microsoft.com/en-us/azure/automation/automation-dsc-overview</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/automation-quickstart-dsc-configuration">https://docs.microsoft.com/en-us/azure/automation/automation-quickstart-dsc-configuration</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/scripting/dsc/overview/overview?view=powershell-7">https://docs.microsoft.com/en-us/powershell/scripting/dsc/overview/overview?view=powershell-7</a></p>
<h3 id="Lectures-7"><a href="#Lectures-7" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="VM-Agents-amp-Extensions"><a href="#VM-Agents-amp-Extensions" class="headerlink" title="VM Agents &amp; Extensions"></a>VM Agents &amp; Extensions</h1><p>We can see that Azure Automation State Configuration, AASC, and DSC work together as a unit to help manage state changes in our system in an automated and transparent manner. The tool set we have covered is quite solid for defining, deploying, and updating <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources, particularly VMs, in exactly the form we want. But what about post-deployment configuration on actual running virtual machines? DSC is great for onboarding nodes and has some support for updating config, particularly Windows nodes if we have commands to force poll the latest configuration. However, if we have more precise configuration to do on various running instances, we need something more surgical.</p>
<p>This is the use case that the Azure custom script extension was meant to solve. It is designed specifically for post-deployment actions.</p>
<p>Note that the custom script extension is not the only extension available to Azure VMs. There are lots other useful extensions such as the VM access extension and the diagnostics extension. These may be helpful for access control and monitoring respectively. The custom script extension, as the name implies, is designed purely for running any sort of arbitrary script on target instances. It gives you the flexibility to handle any sort of administrative, monitoring, software installation, or maintenance task.</p>
<p>So let’s talk a little bit about extensions generally. How do these extensions work? Do we just copy&#x2F;paste code snippets somewhere? Not exactly, Azure utilizes lightweight processes in their VM’s known as agents to manage extensions. An Azure VM agent is a small background application that lets you run various extensions and interact with Azure APIs. VM agents are installed and running by default in any Windows marketplace VM in Azure. You can install VM agents on Linux servers as well very easily. There are official RPM and DEB packages available on most popular Linux flavors. See the documentation <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows">link</a> and <a target="_blank" rel="noopener" href="https://github.com/Azure/WALinuxAgent">GitHub page</a> for specifics.</p>
<p>VM agents give us a flexible way of interacting with running servers without having to worry about firewalls and ssh sessions. If a VM has an agent running, executing a custom script is as easy as a CLI command. We use the <code>Set-AzVMExtension</code> command and set the ExtensionType flag to CustomScriptExtension. There is another flag for the actual terminal command to run on the VM which may just be a random shell command or a call to some other script on the server</p>
<p>So how exactly do custom scripts fit into our overall compliance and security model? Being able to run arbitrary scripts thanks to the VM agent is nice and all, but engineers randomly running scripts is not a hallmark of a stable system. As with any tool if we are not mindful about how we use it we could end up only creating new problems.</p>
<p>We saw in the previous two lessons that Azure ASC security center and automation state configuration, and DSC, they allow us to centralize our configuration and track compliance automatically. However, we may not be able to prevent all types of configuration drift. There may be low-level environment settings we need to tune that are not exposed by the DSC API. In such a scenario we might want to update config on live servers without editing our DSC code. We may even want to do this while simultaneously adding or updating cronjobs. Well, custom scripts are perfect for this sort of maintenance.</p>
<p>We will conclude this section with a brief demo so that you can actually see how custom scripts work in the real world. Otherwise, this is probably gonna seem too abstract. Once you get through that demo about agents and extensions, you’ll be ready for the final section of this course on pipelines. It’s gonna be a blast, see you there.</p>
<h3 id="Lectures-8"><a href="#Lectures-8" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="VM-Agents-amp-Extensions-Demo"><a href="#VM-Agents-amp-Extensions-Demo" class="headerlink" title="VM Agents &amp; Extensions Demo"></a>VM Agents &amp; Extensions Demo</h1><p>Okay, greetings again friends. Welcome to the fourth video demo in our course on Azure Security and Compliance. In this video, we’re gonna learn all about VM agents and extensions. We’ll do a brief review of Azure Automation State Configuration in the dashboard. We’ll then show you how to install extensions on Windows VMs and we’ll review the steps for a Linux VM agent installation. And we will then show how to execute arbitrary commands from the console. And lastly, we will demonstrate how to use the CLI to execute commands and scripts. So by the end of this, you should have a solid understanding of the VM agent and custom script tool set.</p>
<p>Okay, so let’s start by going back to our Automation account and we’ll take a look at the State configuration dashboard that’s… right here. And we can do a quick check up on our node of last time. We’re in nodes here. And we can see that it is still indeed compliant with our DSC config. Again, this is a great way to automate security compliance in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. We can actually review the DSC config source code if we want. We can go into configurations and just click on it and we can view the source. And there’s the code right there. Now from this dashboard, we can also add configurations to the node if we want manually. We can click here and go to assign node configuration. So we can do a lot of updating and adding manually through the web portal here. Ideally, we would script a lot of this. Remember, we can do all of this stuff using Powershell and that’s how we’re gonna wanna do it if we wanna maintain an infrastructure as code paradigm.</p>
<p>Okay, so now let’s talk a bit about Azure VM extensions. And so to do that, first, you need to go our virtual machine dashboard. So, we’ll just click on the virtual machine and then we can see here there’s a lot of info about the virtual machines and monitoring here. But what we’re interested in on the left side we can see there’s a menu item here called extensions. So we click here and we can see that our little test node already has two extensions installed. We have… one here for DSC and we have here the custom script extension. So as we mentioned all of the official Azure Windows VMs automatically have the custom script extension installed by default. The DSC extension was installed when we connected our node to the Azure Automation State Configuration account. So that’s why we see these two here.</p>
<p>Now for Linux virtual machines, we’ll have to install the VM agent and the extensions ourselves. And there are a lot of different versions of Linux with their own little details and installation requirements that will impact just how we set things up. So instead of running through a demo which might only apply to a small set of people, I’m just gonna show you the GitHub code and repos for the VM agents and the extensions and you take it from there by just following their read me. So here we have the repo for the Linux agent. It’s pretty straightforward. We can see the setup scripts here in Python and there’s read-mes for different versions of Linux installation commands. So for the extensions themselves, we can see here is the code base. We can see here is DSC. We can see again all in Python the testing code here. We also can see the custom script extension here.</p>
<p>Okay so if you want to look through the actual code base, this is the place. We’ll include links and installation is really just from following the read me files. For our video demo, for the rest of this demo, we’re gonna still to Windows server, to Windows VMs as they work right out of the box. So going back to the VM here, we can see that we have the custom script extension installed right out of the box. And this is very cool. This means we can evoke the extension from Powershell and run arbitrary commands and those commands could call other scripts if necessary.</p>
<p>Now from the web console, we do have a very simpler way of running a one-of command. In the operation section, if we go down here in the menu, we can see there’s an item here called run command. And if we click on that, it’ll talk us to this menu. And what’s really cool about this, is that… it actually comes with a number of predefined commands for common use cases here. So for example, if we click on it we can see… For example, this IP config command. This is a good one. We can run this with no parameters. We’ll just click run. And it’ll come up with this little console here for the output and it will give us the output here. It takes a few minutes to run because it needs to connect to the VM and run the command through the VM agent.</p>
<p>Okay so once that’s done here we can see the output of the IP config command. So, we have some information here. So, we can see it successfully ran the command. So that’s pretty cool. We have these predefined commands that we can just run. These are helpful for common use cases. But if we want to run an arbitrary command or script, we click here on the run Powershell script command. This will give us a text box and here we can just paste in the command we want to run. Now another option is we can run… Powershell from a terminal either on our local development machine or laptop or we can run it from the Azure web portal using the Azure Cloud Shell.</p>
<p>So let’s try that. Let’s try using the cloud shell. We just click up here and it’ll kick off a shell environment which will connect and once that’s ready to go we will attempt to running a script. Okay, that’s looking good. Authenticating and we should be good to go. There we are. Okay so now that we have the shell running what we’re gonna do is run a command from the shell environment. And I have a couple here saved in my notepad here. We’re going to run a command to instantiate a very basic web server so that we can see the VM name from the public IP. And that’s a very basic thing that I just basically copied from the documentation.</p>
<p>Here’s the command. We can see that we’re evoking the extension type here, custom script extension, and the Powershell command is adding WindowsFeature Web-Server. And we’re just setting it some default output for when we go to it. So we hit enter and we click run. It will take a second to finish. Okay, we’ll just wait for that. Okay, once that’s done we can see that we a status code okay. The command ran successfully.</p>
<p>So now we’re just gonna run another command to get our public IP. We can actually get this from the console if we want but just for fun we’ll do it from the command line. So we’ll paste this and that should give us our IP address. That one ran a lot faster. So we should be able… If this worked we should be able to go into the browser, go to this IP address and see our VM name. So let’s give that a try and it looks like it worked. </p>
<p>So there’s our VM name coming TestWindowsVM and it should work the same for you as long as you don’t have any security rules blocking public IPs. Make sure that’s not an issue. So that’s basically it. We have covered how to… check extensions. We’ve gone over the ASC portal, running custom scripts both from the web portal and from the CLI. I mean this is a really powerful feature set. If you can think about how’d scale this, it’s absolutely critical for maintaining a compliant system without incurring too many disruptions. So I hope this has been helpful and thanks for watching. Cheers.</p>
<h3 id="Useful-Links-4"><a href="#Useful-Links-4" class="headerlink" title="Useful Links"></a>Useful Links</h3><p>VM Agent: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows">https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows</a></p>
<p>Custom Script Extension: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-linux">https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-linux</a></p>
<p>DEMO: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/tutorial-automate-vm-deployment?toc=https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/toc.json&amp;bc=https://docs.microsoft.com/en-us/azure/bread/toc.json">https://docs.microsoft.com/en-us/azure/virtual-machines/windows/tutorial-automate-vm-deployment?toc=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Fvirtual-machines%2Fextensions%2Ftoc.json&amp;bc=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json</a></p>
<h3 id="Lectures-9"><a href="#Lectures-9" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Security-amp-Compliance-Pipelines"><a href="#Security-amp-Compliance-Pipelines" class="headerlink" title="Security &amp; Compliance Pipelines"></a>Security &amp; Compliance Pipelines</h1><p>Through sections one and two of this class, we have gradually ascended a ladder of automation, if you will. We started by talking about compliance and creating policies to ensure our system is secure. Then we figured out how to transparently automate much of that configuration using DSC. And then we automated even further by using Azure Automation State Configuration and VM agents with custom scripts to ensure things stay compliant. Now it’s time to assume our ultimate form of automation: Using secure pipelines to guarantee that every code or config change deployed to our system is automatically checked, tested, and released with full compliance and security totally assured.</p>
<p>This is where the fun begins. So let’s start by talking about pipelines. A software pipeline is a process for getting a code change from a developer’s laptop out into the real world with end users. Obviously we don’t want to do this in a cavalier fashion. We don’t want to just SCP a script up to a server and restart it and call it a day. We want to test things out. We want to check code quality. We want to make sure everything is reviewed and compliant and safe before finally deploying to our production environment.</p>
<p>So the modern paradigm for this is known as CI&#x2F;CD, or, continuous integration and continuous delivery. In the DevOps world we use tools like Github, Jenkins, Gitlab, CircleCI to automate a lot of this work. <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft Azure</a> offers its own very robust solution in the form of Azure Pipelines.</p>
<p>Azure Pipelines are much like other CI&#x2F;CD services. They let you automate building, testing, deployment of software. And the set up is very simple. All you need to do is define an organization in the Azure DevOps portal and make sure that your code is hosted in some version control system like Github. You can create and configure your pipeline from the browser. However, to keep a proper infrastructure as code methodology, you will want to put all of your pipeline configuration in a yaml file, something named azure-pipelines.yml. This is the file Azure will care about, and this is where you will define your pipeline steps and tasks.</p>
<p>Now, there’s many different stages, you know, test stage, deployment stage, within a pipeline. One of the most important features though specific to Azure Pipelines is the gate. Gates are very important. Our release pipeline has these different steps and between these steps we can define gates. Gates are basically conditions or checks that ensure our software meets some standard before moving on to the next step. If our release fails the check performed by the gate, it will stop the CI&#x2F;CD process and give us an error message. This is an essential component of automating security compliance in our software delivery process.</p>
<p>Now there are many kinds of gates that we can select. In the web UI in the DevOps dashboard we can see the different options. There are delay gates that simply pause the pipeline for some amount of time, as well as manual intervention gates that stop everything until a human performs some action, perhaps a check or something. There are also gates that run Azure Functions. There are gates that check Azure monitor alerts. There are gates that invoke REST APIs. But perhaps most importantly, there are gates that check compliance with security policies. Now that last one we’ll come back to in a bit.</p>
<p>So now, a secure software pipeline does not start with security policies and checks and gates or test environments running a build of the app. Really, the pipeline starts with a solid code review process. And that process should incorporate automated code quality checks, Linters, manual reviews by other engineers. This is really where you start. And we can kick off this process for a specific branch, if we’re using git, and a code hosting service like Github, and then have merge requests that launch deeper tests. Code that passes initial checks and manual review should undergo static analysis.</p>
<p>Now, ideally you also are checking OSS licenses and third party dependencies as well. But this can be a big pain, but there are some tools that can help, tools like WhiteSource software. They can help you with it. Code that has made it this far, where you’re at least checking the third party dependencies and open sourced licenses. Once it’s gotten past all of that analysis, you wanna deploy to a test environment. What that deploy looks like exactly will depend on your application. It will depend on your specific architecture. It might entail spinning up a virtual machine, or deploying a container, or updating a storage bucket, or something else. Since our focus is on security we won’t delve too deeply into that, into infrastructure minutiae. We will instead walk through a simple example of that in our demo anyway. And what we wanna focus on is that once our software is in a test environment, we need to do some form of security scanning. Scanning is really critical and there are a lot of tools.</p>
<p>Microsoft, in their documentation, they recommend using OWASP ZAP for handling automated penetration testing. Now, what is OWASP ZAP? Okay, OWASP, O-W-A-S-P, stands for Open Web Application Security Project, and ZAP is one of their tools, it stands for Zed Attack Proxy tool. The OWASP group does a lot of great work in security. It’s a big, long-lived international group. They work with an open source tool set, so very easy to audit and look at and configure. OWASP ZAP is one of their most popular tools for web application security scanning. And it’s readily integrated into an Azure pipeline process as part of your gates, if you will.</p>
<p>The challenge that we face with CI&#x2F;CD pipeline, in a CI&#x2F;CD pipeline context, with this tool, is that really thorough scans that crawl through an entire website and attempt a wide variety of attacks, these take a long time to run. It’s really common for these scans to run anywhere from tens of minutes to several hours for a more complex app. So therefore, if you make these tests into a gate for any and all code changes, it will slow your development cycle down to a crawl. And so, for this reason, it’s recommended that you have a more simple automated scan for CI&#x2F;CD. And again, OWASP ZAP, they have tools for this, simple test scans. And then, separately, you have a nightly full active scan that does a comprehensive test in a QA or a dev environment. So this is kind of a split approach.</p>
<p>Penetration testing is really important for application security, however we have to also ensure that our infrastructure meets compliance standards. And fortunately this is readily handled by using gates in our pipelines. As we mentioned, in the Azure DevOps dashboard we can create pre-deployment conditions as gates. And as mentioned, there are many types, but the one that’s really interesting to us here is the Security and Compliance Assessment type of gate. This type of gate ensures that a release in our pipeline will fail if it violates a policy defined in Azure Security Center.</p>
<p>Now, this feature lets us incorporate compliance and security right in our release process. It relies on us first selecting the right security policies defined in Azure Security Center. Now remember, good policies alone don’t make us secure; compliance with good policies are what make us secure. And therefore, if we can make the check for the compliance automatic, then we can make security automatic. And fortunately, Azure Security Center includes several industry standards right out of the box, so you can just select the one that best matches your product without actually having to define an entire set of security standards and policies from scratch.</p>
<p>So, there you have it, whew! This was a doozy of a lesson, a lot of material, but hopefully chock-full of useful stuff. If we can put all or most of this into practice, we can sleep comfortably knowing that our Azure infrastructure is as secure as can be. Check out the demo for this section for a walkthrough of how to set up a pipeline and use gates. And, once you’re done with that, you’re finished with all of our lesson content, so, see you there. Thank you.</p>
<h3 id="Lectures-10"><a href="#Lectures-10" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Azure-Pipelines-amp-Gates-Demo"><a href="#Azure-Pipelines-amp-Gates-Demo" class="headerlink" title="Azure Pipelines &amp; Gates Demo"></a>Azure Pipelines &amp; Gates Demo</h1><p>Okay, greetings once again, friends. Welcome to the fifth and final demo for our course on Azure Security and Compliance. This will be a very DevOps-focused video as we dig into Azure Pipelines. We’ll learn how to set up a basic pipeline for CI&#x2F;CD using the Pipeline service, and then we’ll then add a gate to demonstrate how we can automate security compliance checks. So without further ado, let’s dive right in.</p>
<p>So first off, we need to go into Azure DevOps. That’s where the Pipeline service is set up. And like a lot of other <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> components, it’s not enabled by default. You have to enable Azure DevOps. You’ll go into your DevOps organization after you create it and you’ll need to set up a project. This is also very simple, just point and click through. You can create a project. Here we have something called TestProject7. This will be our basic test project for this demo.</p>
<p>Now, when you first set up a pipeline, Azure DevOps is going to need to know where the source code is hosted. So for example, if we go to Pipelines and we click New Pipeline, very first thing it says is, “Where is your code?” So we have some options here for popular services like GitHub and BitBucket, but be aware, we have this really cool option Other Git, any generic Git repository. This is very helpful if you’re using a less popular service. As of the creation of this course there’s no option here for GitLab. And I hope they add that because I’m a big fan of GitLab. I love GitLab. So if you’re using GitLab or if you’re just hosting your Git repo at some random location, as long as you have the URL and its open, you can get to it using this Other Git option. Be aware that also if you are using BitBucket or GitHub or something like that, you have to authorize it. So if you click on GitHub, it’s gonna ask for permission to pull code from the repository. So assuming you’re logged in, it’ll find your GitHub, it’ll try to access it and it will request permission. You just have to click to grab that permission. It’s just one click.</p>
<p>So we can actually see this in GitHub. We can go to our test project here and we can see this is our TestProject40. This is what we’re connecting to Azure Pipelines. And to see the connection actually, we can go into settings and if we go to Integrations and Services we can see that Azure Pipelines is listed. That is connected to this repository and it has permission to pull from the repo. Now the actual pipeline configuration is defined in a file called azure-pipelines.yml. That’s where we were a second ago. We can see that this config is actually really, really simple. All it’s doing is printing to the console. It’s doing an echo “Hello world” in an environment called QA. So not really doing a lot of work.</p>
<p>Now, the standard way to configure a build job like this is to have it run whenever a change is merged into a particular branch in our git repository. Now we can do that by either editing our YAML or editing the job in the console. And when we edit the YAML, we care about this word trigger here, by default it’s set to master but we can actually customize the behavior to have it do pull request triggers or even scheduled triggers if we just want a job to run at specific intervals. So we go back to our pipeline here, we can see the amount of times it’s run. And we can also run the pipeline manually by just clicking run pipeline here without having to worry about any triggers.</p>
<p>So let’s give this a click. Let’s see if it works. It’s gonna by default work off of masters. We’ll just click run. And it’ll take a few seconds but it’s a pretty simple build job. So we let it go through its deployment. And it should just be a second to finish. Let’s try giving that a refresh. Ah, here we go. We can see the duration. We can see it’s actually running. But it’s just echoing output to the console so it should be pretty quick. And there we go, done, successful. We could actually see the logs of the deploy here as well.</p>
<p>Now from looking at this, as I’m sure you can tell, we could go into a lot more depth with Azure DevOps, the portal and the pipelines. It really is an incredible tool set, especially as a DevOps engineer. I really appreciate it so I do recommend checking out other courses on DevOps specifically. Since this is a security course though, we’re gonna skip digging into all the YAML config and all of that and we’re gonna focus on the most critical security feature in Pipelines, and that is automating security compliance checks. And in order to do that, we’re gonna need to create a gate.</p>
<p>Gates are connected to releases in Azure DevOps. Thus far we’ve been working with a generic build pipeline with no real concept of releases and only one environment really to worry about. To show off how gates work, let’s create a brand new release pipeline from scratch, right from the portal. And again, this all can be done with the CLI and scripting but we’re gonna go from the portal here. We’re just gonna click on the releases section and we’ll do new pipeline. And what we do for our pipeline, we have to define stages. So you can see there’s many different deployment types. We’re gonna just do an empty job for stage one and then we’ll add a new stage two, which’ll also be an empty job. So you can note, we’re not actually deploying any code anywhere. There’s really no tasks to worry about but one thing that’s worth noting is the variety of deployment types. So deploy to Kubernetes cluster, deploy to Azure Apps Service, Job App, Azure Functions, if we scroll down, there’s a lot of deployment types here. But we’ll leave this as empty for right now. Our interest is not on the specific content of the deployment job. Our interest is in what happens in between two stages. And that’s really where we’re gonna have a gate. So to create the gate, we’re gonna click on this little icon here next to the stage with the little guy on it where it says pre-deployment conditions.</p>
<p>So we’re gonna click on that. And what you’ll see there are a few options here as well, triggers, after stage, after release. Our interest, again, is gates. So we’re gonna click on gates. You have to enable it. So you click enable and then you’re gonna click add. And so here we can see a few different types of gates show up. We can invoke an Azure Function between stages. We can query monitor alerts here. We can invoke a REST API. These are the ones that pop up right away. But here’s the one we really care about, check Azure policy compliance. So we click on that and in order to make that work, we have to select our Azure subscription. So this our free trial subscription here. And then once that comes up, you have to authorize it usually. When you authorize it, be aware that it might have a pop-up block. I had to turn off my pop-up blocker for the authorization to work. So be aware of that. You can also select resource groups, to restrict it a little bit. It’s not a requirement but once you have that done, you can just close this dialogue and now you have a pre-deployment condition defined for this stage. So you can click save. You can save it in a folder. We don’t have to have any comment. And now we have a pipeline with automated security compliance checking. Now you might be wondering, what does compliant mean here exactly? If a release violates one of our policies it will throw an error and fail.</p>
<p>So really what compliant means is determined by your security center account. Whatever you have defined in your security setting, this is where you define your policies and so if you have a policy for some network rule or something like that and if it violates that in the pipeline, this is where it’ll fail. So there you have it. We now have some understanding of how to work with Azure Pipelines to create CI&#x2F;CD pipelines and most importantly, how to define security compliance gates for deployment. This is definitely something you’re gonna want to play around with and experiment with on your own to understand the behavior. Check the Azure documentation links (below) for more info and some nice how-to guides. And thank you for making it this far in the class and good luck.</p>
<h3 id="Useful-Links-5"><a href="#Useful-Links-5" class="headerlink" title="Useful Links"></a>Useful Links</h3><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/devops/migrate/security-validation-cicd-pipeline?view=azure-devops">https://docs.microsoft.com/en-us/azure/devops/migrate/security-validation-cicd-pipeline?view=azure-devops</a></p>
<p>Pipelines: <a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/services/devops/pipelines/">https://azure.microsoft.com/en-us/services/devops/pipelines/</a></p>
<p>Gates: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/devops/pipelines/policies/azure-policy?view=azure-devops">https://docs.microsoft.com/en-us/azure/devops/pipelines/policies/azure-policy?view=azure-devops</a></p>
<h3 id="Lectures-11"><a href="#Lectures-11" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-summary/">Course Summary</a></p>
<h1 id="Course-Summary"><a href="#Course-Summary" class="headerlink" title="Course Summary"></a>Course Summary</h1><p>Congratulations, you’ve done it. You’ve really done it. You have made it to the end of Cloud Academy’s course on Azure Infrastructure Compliance and Security. Nice job.</p>
<p>Before we pop the champagne though, let’s take a moment to briefly review our learning objectives. There were three. First, we taught you how to scan infrastructure and prevent drift leading to compliance violations. That was in section one where we went over Azure Security Center in detail and showed off some other management tools. Secondly, we taught you how to automate configuration management. Tools are great, but even greater is getting them to work on their own. In section two, we showed you how to do that with Azure Automation State Configuration, DSC, and VM agents in custom scripts. Finally, we showed how to create secured software pipelines. This is really the end goal of our compliance work, getting to a point where end-to-end we have full assurance that our system is up to strict standards. Section three covered that.</p>
<p>You should now be more confident taking responsibility for compliance in an <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> cloud environment. With this skill set, you can help teams get peace of mind about whether or not their Azure infrastructure meets the highest standards for security. Where you go from here is up to you. We wish luck to those of you going on to take certification exams or continue their studies or pursue work on a software team.</p>
<p>Lastly, once again, I’d really like to invite folks to send us feedback about the course. We are always looking to improve any way we can. We thank all of our students, past, present, and future for helping us to get better. Thanks again, and good luck, and congratulations!</p>
<h3 id="Lectures-12"><a href="#Lectures-12" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/compliance-security-scanning/">Compliance &amp; Security Scanning</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-center-demo/">Security Center Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/preventing-drift/">Preventing Drift</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/arm-activity-log-track-changes-demo/">ARM, Activity Log &amp; Track Changes Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/desired-state-configuration-dsc/">Desired State Configuration (DSC)</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-desired-state-configuration-demo/">Azure Desired State Configuration Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-automation-state-configuration/">Azure Automation State Configuration</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions/">VM Agents &amp; Extensions</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/vm-agents-extensions-demo/">VM Agents &amp; Extensions Demo</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/security-compliance-pipelines/">Security &amp; Compliance Pipelines</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-infrastructure-compliance-and-security/azure-pipelines-gates-demo/">Azure Pipelines &amp; Gates Demo</a></p>
<h1 id="3Security-Center-Demo"><a href="#3Security-Center-Demo" class="headerlink" title="3Security Center Demo"></a>3<strong>Security Center Demo</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/security-center/security-center-compliance-dashboard">Security Center Compliance Dashboard</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/security-center/security-center-vulnerability-assessment-recommendations">Security Center Vulnerability Assessment Recommendations</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/blog/integrated-vulnerability-assessment-with-azure-security-center/">Integrated Vulnerability Assessment Blog Post</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/updates/scan-container-images-for-vulnerabilities-in-azure-security-center/">Scan Container Images for Vulnerabilities</a></p>
<h1 id="5ARM-Activity-Log-amp-Track-Changes-Demo"><a href="#5ARM-Activity-Log-amp-Track-Changes-Demo" class="headerlink" title="5ARM, Activity Log &amp; Track Changes Demo"></a>5<strong>ARM, Activity Log &amp; Track Changes Demo</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/how-to/region-mappings%C2%A7">Region Mappings</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/da-dk/blog/tracking-configuration-changes-for-your-azure-vm/">Tracking Configuration Changes</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/updates/azure-stack-security-drift-detection/">Azure Stack Security Drift Detection</a></p>
<p><a target="_blank" rel="noopener" href="https://www.auditwolf.com/blog/configuration-drift">Configuration Drift Blog Post</a></p>
<h1 id="6Desired-State-Configuration-DSC"><a href="#6Desired-State-Configuration-DSC" class="headerlink" title="6Desired State Configuration (DSC)"></a>6<strong>Desired State Configuration (DSC)</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/automation-dsc-overview">Automation DSC Overview</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/scripting/dsc/managing-nodes/metaconfig?view=powershell-7">Configuring the Local Configuration Manager</a></p>
<h1 id="8Azure-Automation-State-Configuration"><a href="#8Azure-Automation-State-Configuration" class="headerlink" title="8Azure Automation State Configuration"></a>8<strong>Azure Automation State Configuration</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/tutorial-configure-servers-desired-state">Configuring Servers Desired State</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/automation-dsc-overview">Automation DSC Overview</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/automation/automation-quickstart-dsc-configuration">Automation Quickstart DSC Configuration</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/scripting/dsc/overview/overview?view=powershell-7">Windows PowerShell Desired State Configuration Overview</a></p>
<h1 id="10VM-Agents-amp-Extensions-Demo"><a href="#10VM-Agents-amp-Extensions-Demo" class="headerlink" title="10VM Agents &amp; Extensions Demo"></a>10<strong>VM Agents &amp; Extensions Demo</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows">VM Agent</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-linux">Custom Script Extension</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/tutorial-automate-vm-deployment?toc=https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/toc.json&bc=https">DEMO</a></p>
<h1 id="12Azure-Pipelines-amp-Gates-Demo"><a href="#12Azure-Pipelines-amp-Gates-Demo" class="headerlink" title="12Azure Pipelines &amp; Gates Demo"></a>12<strong>Azure Pipelines &amp; Gates Demo</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/devops/migrate/security-validation-cicd-pipeline?view=azure-devops">Securing Azure Pipelines</a></p>
<p><a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/services/devops/pipelines/">Pipelines</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/devops/pipelines/policies/azure-policy?view=azure-devops">Gates</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Introduction-to-Azure-Resource-Manager-19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Introduction-to-Azure-Resource-Manager-19/" class="post-title-link" itemprop="url">AZ-400-Introduction-to-Azure-Resource-Manager-19</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:55" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:55-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 13:23:04" itemprop="dateModified" datetime="2022-11-27T13:23:04-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Introduction-to-Azure-Resource-Manager-19/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Introduction-to-Azure-Resource-Manager-19/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Course-Introduction"><a href="#Course-Introduction" class="headerlink" title="Course Introduction"></a>Course Introduction</h1><p>Hi, and welcome to this introduction to this Azure Resource Manager course. My name is Hallam Webber and I will be your instructor for this course. This is a beginner’s course that’s aimed at those who want to know more about managing and configuring their Azure environment. So whether you’re in DevOps, IT support, or a developer that wants to get a better understanding of fast-tracking deployments, there is something in this course for you.</p>
<p>In this course, we will start with an overview of what Azure Resource Manager is and where it fits into the overall Azure picture. Then, we’ll get an understanding of why it’s important. and then, we will delve into some hands-on demonstrations of how you can use it to simplify what would otherwise be quite labor-intensive tasks. </p>
<p>As an introductory course, we will be learning by doing, to give you a basic “how-to” foundation in ARM templates. When we’re not in the Azure portal I’ll be using Visual Code with the ARM template extension which provides IntelliSense for Azure Resource Manager syntax. This is a very helpful tool if you’re not familiar with ARM instructions.</p>
<p>We welcome all comments and feedback, so please feel free to reach out to us at <a href="mailto:&#x73;&#x75;&#x70;&#112;&#x6f;&#x72;&#x74;&#x40;&#99;&#x6c;&#111;&#x75;&#x64;&#x61;&#99;&#x61;&#x64;&#x65;&#109;&#121;&#46;&#99;&#111;&#x6d;">&#x73;&#x75;&#x70;&#112;&#x6f;&#x72;&#x74;&#x40;&#99;&#x6c;&#111;&#x75;&#x64;&#x61;&#99;&#x61;&#x64;&#x65;&#109;&#121;&#46;&#99;&#111;&#x6d;</a> with any questions or comments. Let’s get started.</p>
<h1 id="Azure-ARM-Intro-Overview"><a href="#Azure-ARM-Intro-Overview" class="headerlink" title="Azure ARM Intro Overview"></a>Azure ARM Intro Overview</h1><p>So, what is Azure resource manager? Well, it is what it says it is. For a lot of people when they think of Azure they think of the complete Microsoft cloud product and all that it entails. But in reality, Azure is a collection of services or resources. When you sign up to Azure for the very first time as an organization with a new subscription and you log in to the portal there is nothing there. As you require services whether that’s a virtual machine, a web app, or database server you create instances of those resources. Azure resource manager is the glue behind-the-scenes that makes it substantially easier for you to deploy and manage all those different resources. </p>
<p>ARM in Context</p>
<p>You might think that the portal is Azure, but the portal is one of several interfaces to Azure resource manager. The portal is merely a graphical interface over the resource manager, which in itself is an interface to the various resources, especially in terms of deployment, and managing the order and dependencies involved in deploying various resources. Apart from the portal, there is also an API interface to Azure resource manager and more importantly for us, an SDK interface.</p>
<p>Command Line Interface</p>
<p>PowerShell for Windows and the Azure command-line interface are the preferred methods for interacting with Azure resource manager when it comes to large, complex, and repeated deployments. One thing I want you to take notice of on the slide is where authentication fits into the scheme. Because there are multiple ways to interact with resource manager authentication is handled directly by it. This is demonstrated by the fact that when you log into Azure through PowerShell or the Azure CLI a browser window will pop up and you can authenticate through that when using two-step authentication or a Microsoft account.</p>
<h2 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h2><p>As we can see here Azure resource manager is mostly used when managing resources within a resource group. All resources are created within a group even if they are spread over multiple geographical regions. By grouping resources, you can perform actions on all the resources in that group at one time. A simple example would be creating a database server with databases and a web app service for some testing and then deleting all of them at one time by deleting the resource group that contains them. Having said that depending on the type of billing account you have with Microsoft you can also create subscriptions and management groups through resource manager.</p>
<p>Why You Need to Know ARM</p>
<p>But why do you need to know about Azure resource manager? After all, the portal works just fine and is easy enough to use. Infrastructure as code is the reason. In the cloud, hardware does not exist; everything is virtual and can be defined by code. It’s fine for you to deploy a simple resource or even a couple of simple resources using the portal in a one-off situation. But having to set up by hand multiple and complex resources, perhaps several times for different environments, like development test and production, would not only be tedious and time-consuming but also prone to error. You can create resource deployments with scripts and run them through the Azure CLI or PowerShell. As resource creation and deployment are so important Azure has developed templates for defining your resources.</p>
<p>A template is a JSON formatted text specification of a resource. The JSON template file contains all the information about a resource necessary for Azure to create it. It contains vital information like the type of resource, for example, virtual machine, database or storage, and the resource’s name. What resource group, and where the resource should be deployed, as in the geographic region are other configurable attributes in the JSON definition. The template specifies the size of the resource, whether that is disk space for a database or compute power for a virtual machine. As I said, every detail about the resource you want to create, including other resources that the target resource will depend on. A template won’t be that useful if it just specifies exactly the same resource. What I mean by that, is you can’t have resources with identical names. The template architecture allows you to use input parameters to reuse a template to deploy the same type of resource, with a different name and attributes. We will see that all the attributes we choose from drop-down lists, radio buttons, and checkboxes as well as text we enter during the resource creation process in the portal become template parameters.</p>
<p>I’m going to introduce you to templates by creating a virtual machine resource in the portal and then saving the template. We will look at the elements of the template like how a resource is defined and how parameters are used to modify a resource deployment. Creating a VM will also demonstrate how one resource is dependent on other resources. A virtual machine doesn’t exist in isolation, it requires a network and storage in the form of a disk. Don’t worry if you don’t get resource templates after the first demonstration. I will examine the different elements of a template in more detail later. The first demo is to show you the relationship between a resource created in the portal and the corresponding template that gets produced.</p>
<h1 id="DEMO-Modifying-Existing-Templates"><a href="#DEMO-Modifying-Existing-Templates" class="headerlink" title="DEMO: Modifying Existing Templates"></a>DEMO: Modifying Existing Templates</h1><p>Without a doubt, the easiest way to get started with templates is to go to a current resource and download the deployment as an ARM template. This process can be likened to recording an Excel macro and then inspecting the code to see how it works. </p>
<p>I’ll start by creating a virtual machine resource. Let’s just fast forward through the portal process by going with most of the defaults. It’s not important what we choose here as template creation will work for any resource. I’ll go with premium SSD and the standard networking setup. I will turn on OS guest diagnostics, take the advanced defaults, and not bother with tags. We can see before we hit the create button, we have the opportunity to download the template before getting the portal to deploy the VM. I’m going to download the template now for use later on.</p>
<p>Having a look at the template we can see it is made up of 22 input parameters that can be changed or substituted to alter how the resources are created. The parameters have a name and a data type. There are 3 variables that are used within the template, and of course, there are the 6 resources being created in the deployment. The parameters file contains the values that are currently used for the resource deployments. These are default values, or values manually entered in the portal when creating the VM resource, like location, machine name, and resource group. Scripts just links you to Azure documentation. The same information is accessible while the deployment is happening. For an existing resource, you can download the template or deploy from the Export Template page. Some of you might be thinking, “hang on, now there are only 3 parameters and 1 resource”. That’s because this template is just the virtual machine component and doesn’t include the supporting network infrastructure resources. If you need to get the templates for all resources in a deployment after the fact, you can go to the resource group and select the resources and click export template.</p>
<p>Back at our VM resource, Azure lets you save templates to an online library, which is what I’ll do now by giving the template a name and simple description. You can view templates saved to the library through More Services, then All Services, and then select Templates. With a template, you can redeploy the resource or make a similar resource with different attributes by changing some of the input parameters.</p>
<p>We’ve got the template what now? The usual method for deploying resources using templates is to use a command-line interface, either PowerShell or Azure CLI. We will look at both of these later, but initially let’s create the VM resource through the portal using the downloaded template.</p>
<p>Search for deploy on the home page of the portal and select Deploy a custom template. Under common templates, there are templates for creating common resources that you can adapt and modify. We want to build our own template in the editor. Here we have a blank boilerplate template, which I’m going to replace with the template I previously downloaded. I’ll upload the file and save it. Once that’s been loaded, we can see that there are 6 resources in our template – correct. Now we have an interface for entering the parameters for the resource creation. Typing in all those values does seem a bit painful, but if I click edit parameters, I can upload the associated parameters.json file with all the values in it and click save. Boom, and there we go, the values that are entered as part of the resource creation wizard are filled in as parameters. We can do a side by side comparison of the parameters as they relate to the manual portal process Resource Group, virtual machine name, region, VM size, user name, disk type, and networking. I’ll fill in the password and agree to the terms and conditions. The purchase button is a bit misleading, and I assume I won’t be charged for my own template. Anyway, the template validates correctly as I would expect, and the deployment successfully completes.</p>
<p>As with most things Azure, there is a marketplace for templates where you can browse or search for a template that meets, or closely meets your requirements at Azure quick-start templates. I’ll search for something a little bit interesting involving Cosmos, like Create an Azure Cosmos account for MongoDB API autoscale. Clicking on the link takes us to a description of the template and its parameters, along with instructions on how to deploy the template using either PowerShell or Azure command-line interface. Browse on GitHub will take you to the template’s repo where you can download the template JSON files.</p>
<p>Clicking Deploy to Azure takes back to the same Deploy Custom Template page where you can enter the missing parameters using the GUI interface.</p>
<h1 id="ARM-Templates"><a href="#ARM-Templates" class="headerlink" title="ARM Templates"></a>ARM Templates</h1><p>An ARM template is a JSON file describing the resources or services that you want to deploy and it has many advantages. Templates are idempotent. This means changes are applied only once, which is exactly what we want. Associated with this is repeatability, and that each time we apply the template we get the same result. Unlike a procedural script where the order of commands is crucial, the template is submitted as one object and Azure Resource Manager works out the order that resources should be created in. So dependency management and orchestration of deployment operations are carried out correctly. That JSON format also allows for nested and hierarchical resources and you can divide up a deployment into multiple linked files to make complex deployments modular and easier to manage. Azure Resource Manager includes commands for testing templates, and Azure DevOps has a task for including ARM templates in pipelines.</p>
<p>A template file is made up of five sections. There are parameters that can be passed into the template. A parameter has a name and a type, for example, string or int for integer, so like programming data types. There is a functions section, this is where you define your own functions. This is in addition to the ARM template built-in functions. Any values you want to use within the template are defined in the variables section. So not variables in the traditional programming sense, but more like constants. Of course, we have a resources section which is obviously the most important part of the template as this is where we define the resources or services we want to deploy. Finally, we have an outputs section that could be used for displaying information or daisy-chaining templates. Also at the root of the template, we have the JSON schema, which we shall see is very important when building a template and also the content version.</p>
<p>Parameters allow you to pass variables into the template to make its functionality more dynamic. Each parameter object starts with its name. A parameter has a type that can be an int, bool, array, object, string, secure object, or secure string. You can also define a default value, allowed values and minimum and maximum lengths or values. Within the metadata section, you can give your parameter a description.</p>
<p>Before I move on to the function section, I just briefly want to touch on the built-in functions that are available within ARM templates. As you can see from this table, there are quite an extensive array of built-in functions, ranging from array functions through to string, although not all of the string functions have been listed here. Many of the functions are what you would expect to find in most programming languages and definitely in the .NET environment. Resource functions are there to provide access to your Azure resources and account settings, while the deployment value functions allow you to access different sections of the template.</p>
<p>User-defined functions are more like formulas or expressions rather than functions that you might find in a procedural programming language. They do take parameters that are defined with a name and a data type and the return type called output also has a defined data type. Template variables and parameters are global and can be used within user-defined functions. While you can use built-in logical functions within your user-defined function, there is no facility for iterations or for-loops. Essentially user-defined functions are a way of separating out complex or compound functionality that you want to use more than once into a separate piece of template code.</p>
<p>Variables are key-value pairs that are defined once and can be used throughout the template. As I said earlier, they are more like constant values as they can’t be assigned to once defined. Variables don’t have to be simple data types, they can be nested and complex JSON objects. The resource section is the main event, if you will. This is where we define the resources or services that we want to deploy. For obvious reasons, different resources will have different properties but there are some properties that all resources must contain. Every resource needs a name and every resource is of a type and is located somewhere. The resource shown here is an app service and depends on another resource of the type app service plan.</p>
<p>Output values are essentially the inverse of parameters. They enable you to output values from your template for either informational purposes or as inputs to linked templates, that we shall look at later, or to be used in scripts that executing the template.</p>
<h1 id="DEMO-Virtual-Machine-Template"><a href="#DEMO-Virtual-Machine-Template" class="headerlink" title="DEMO: Virtual Machine Template"></a>DEMO: Virtual Machine Template</h1><p>Let’s look at how the template structure relates to the virtual machine template we previously downloaded. I’m using Visual Studio Code to view the JSON files. Here we have those 22 parameters, followed by the three variables, and then the 6 resources. A virtual machine deployment involves more than just the machine. There is all the supporting network and security infrastructure that allows you to safely connect to and use the VM. Here we have a resource name which is one of the parameters that we input to this template. That’s the parameter definition specifying its data type. If I go over to parameters.json I can see the value that is being inserted for network interface name. Going back to template.json we can see each resource has a type, that is what resource is created. This is a network interface which is defined in the region specified by the location parameter. We have a security group name, virtual network resource, a public IP address resource, the actual virtual machine itself with the various nested properties that define that machine like its size, which is also retrieved from the machine size parameter. Here we have the virtual machine’s dependsOn section specifying that the VM requires the network interface and storage resources.</p>
<h1 id="DEMO-Simple-Template"><a href="#DEMO-Simple-Template" class="headerlink" title="DEMO: Simple Template"></a>DEMO: Simple Template</h1><p>I know what you’re thinking, this is very complex, and where do I start? Well, as luck would have it, Visual Studio has some fantastic features for creating and editing ARM templates. To access the ARM template intellisense, you need to have the Azure Resource Manager Tools extension installed in VS Code.</p>
<p>First thing I’m going to do is create a new file, and save it with the JSON extension. Straightaway, we can see that VS Code recognizes this as a JSON file. This is where the magic starts, or more correctly intellisense, when I type ARM for Azure Resource Management. We can see I have code auto-complete here with some prompts. I’m just going to select the top one, which is a resource group template and there we have all the sections that we have talked about earlier. So if I want to create a simple web app deployment, all I have to do is go into resources and once again type ARM, and we can see here we have a lot of resources to choose from.</p>
<p>Now this is all context-based, and I’m going to select web app, and there we have all the properties that we need to create a web app deployment. Obviously, I don’t want my app to be called webApp1. So I’m going to create a parameter of type string, called appname. We can see here with the yellow squiggly line that part of the template functionality is that it recognizes that I haven’t used that parameter yet. So, I’ll go down here and type open square bracket P and you see the auto-complete prompts with parameters. I’ll pick parameters and type open bracket and I’m prompted with the parameter appname. I can then go and I can just replace all the instances of webApp1 with my appname parameter. Every resource has a type and in this case it’s a web site and it’s already put in the ARM tags and properties for us.</p>
<p>In the dependsOn section, we can see a service plan. But before I define that I’m going to show you how we can test our template before deploying it. If I go to my PowerShell window, which I’ve already logged into Azure and enter Test AzResourceGroupDeployment, I’m prompted for the parameter appname, which I’ll supply, called howdeploywebapp. It’s returned with an invalid template error. It’s complaining that it doesn’t have an appServicePlan1.</p>
<p>Okay, so I need to back in the resources section and I will add a service plan and I will also add another parameter called planname. I can use that parameter everywhere I’ve got appServicePlan1, and that is even within the app service itself, like in this concat function. As you can see, functions, parameters and variables are used within square brackets. The error in the concat function indicates a missing comma. Right, so I’ll save that. Just notice here that the location is picked up from the resource group.</p>
<p>So when we are testing, we are testing it with AzResourceGroupDeployment, and that relies on the fact that it belongs to an existing resource group as opposed to using the Test-AzDeployment command. I’ll go back here and re-run this, howdeploywebbapp and the plan name is howdeployplan and we can see that has been successful. So let’s go ahead and deploy that. I’ll just go back here and change my test to new. Now we can go over to the portal and see what’s happening. If I refresh deployments, we can see we’ve got a deployment happening. Let’s click on that and go into it, and it’s complete. I’ll navigate back to the resource group home page so we can see the newly created resources.</p>
<p>Right, so here we have the plan and the app, and as you would expect. Clicking on the app service resource takes us to the app service, where we can click on the app service URL to see it deployed.</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;$schema&quot;: &quot;https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#&quot;,</span><br><span class="line">  &quot;contentVersion&quot;: &quot;1.0.0.0&quot;,</span><br><span class="line">  &quot;parameters&quot;: &#123;</span><br><span class="line">    &quot;appname&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;description&quot;: &quot;description&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;planname&quot;: &#123;</span><br><span class="line">      &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;description&quot;: &quot;description&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;functions&quot;: [],</span><br><span class="line">  &quot;variables&quot;: &#123;&#125;,</span><br><span class="line">  &quot;resources&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;[parameters(&#x27;planname&#x27;)]&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;Microsoft.Web/serverfarms&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;2018-02-01&quot;,</span><br><span class="line">      &quot;location&quot;: &quot;[resourceGroup().location]&quot;,</span><br><span class="line">      &quot;sku&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;F1&quot;,</span><br><span class="line">        &quot;capacity&quot;: 1</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;tags&quot;: &#123;</span><br><span class="line">        &quot;displayName&quot;: &quot;[parameters(&#x27;planname&#x27;)]&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;properties&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;[parameters(&#x27;planname&#x27;)]&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;[parameters(&#x27;appname&#x27;)]&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;Microsoft.Web/sites&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;2018-11-01&quot;,</span><br><span class="line">      &quot;location&quot;: &quot;[resourceGroup().location]&quot;,</span><br><span class="line">      &quot;tags&quot;: &#123;</span><br><span class="line">        &quot;[concat(&#x27;hidden-related:&#x27;, resourceGroup().id, &#x27;/providers/Microsoft.Web/serverfarms/&#x27;, parameters(&#x27;planname&#x27;))]&quot;: &quot;Resource&quot;,</span><br><span class="line">        &quot;displayName&quot;: &quot;[parameters(&#x27;appname&#x27;)]&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;dependsOn&quot;: [</span><br><span class="line">        &quot;[resourceId(&#x27;Microsoft.Web/serverfarms&#x27;, parameters(&#x27;planname&#x27;))]&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;properties&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;[parameters(&#x27;appname&#x27;)]&quot;,</span><br><span class="line">        &quot;serverFarmId&quot;: &quot;[resourceId(&#x27;Microsoft.Web/serverfarms&#x27;, parameters(&#x27;planname&#x27;))]&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;outputs&quot;: &#123;&#125;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="DEMO-Linked-Template"><a href="#DEMO-Linked-Template" class="headerlink" title="DEMO: Linked Template"></a>DEMO: Linked Template</h1><p>In this demonstration, I want to show you how to use linked templates. That’s how you can separate resources into separate template files to make management easier and to reuse resources and deployments. This is a little bit of a contrived example but what I’m going to do is separate out the app plan resource from the app service deployment. </p>
<p>First of all, create a new file that I will save as appsplandeploy.json and start with the ARM template boilerplate structure. Then move the plan name parameter along with the plan resource from the existing template file to the new one. </p>
<p>In the appsplandeploy template, I will need to define an output parameter that will pass the planname to the parent or calling template. That output parameter will be the plan name and will be of type String and the value is simply going to be the parameter planname that is being passed in. </p>
<p>I’m going to create a new file for my web app deployment called websitedeploy. This will be the parent or master template. It will just be the content from the original template, so yes I could have just renamed the file.</p>
<p>We can see here that we already have some issues with our missing parameter and service plan, so I will need to add a link to the appsplandeploy template, and I will do that by creating a nested resource. </p>
<p>While link and nested might not be intuitive, I guess that is exactly what we are doing; we are nesting this linked resource within our main resource template. One thing to be aware of is that the template file cannot be accessed locally, you must have that file accessible by HTTP, which means storing it somewhere on the Internet, and in my case, I’ve created container storage where I will upload that template file to. I’ll just upload that file to my storage container templates inside the howarmtemplate storage account. I’ll grab the link to the file and I will paste it into the URI property of the template link section. Obviously the other issue we need to address is the now redundant planname parameter and we do that by using a reference function to reference the output value from our linked template. So the reference name is the name of my linked template resource. I’ll just change the name of that resource from nested deployment to linkedTemplate. </p>
<p>We reference our outputs with the word outputs, then it picks up the name of the output, which is planname, and then we want to use the keyword value to get its value.</p>
<p>We no longer need the dependsOn section, so I will get rid of that. Another thing you need to be aware of is that the reference function does not work as a parameter within another function, that is, you cannot nest it with another function. Replacing the planname parameters within the linked template reference inside the concat function will throw a template error.</p>
<p>One thing I forgot to mention was that in the app service plan template as it is being linked from our website deploy template we will not be prompted for our plan name parameter. Just for the purposes of demonstration, and it is definitely not best practice, I will use the default parameter to specify a plan name. Later on we will look at a much better option. I’ll just save appsplandeploy and refresh it to my blob storage. Before we continue I’ll demonstrate how that reference function within the concat function will give an invalid template error by running a Test-Az- ResourceGroupDeployment. Here we have the invalid template error’s telling us there is a problem at line 30 column 9 and the function reference is not expected at this location. Line 30 column 9 isn’t really accurate but the closest reference we have to that is within the tags property, but I know this to be the case and I will change it and we will retest. Having changed that tag property it passes the test deployment so I can now deploy for real using the new-azresourcegroupdeployment command. Going back to the portal and into deployments of the resource group, we can see the link template and the website deploy are both in action. If we go and have a look at the link template deployment and in outputs we can see the plan name output value and obviously that is also the input for the website deploy deployment.</p>
<p>Let’s recap what’s gone on here. We started with a resource template that had an app service plan and a website. Then we took the app service plan and we put it in another template file; this is called a linked or nested template. The app service plan template file is linked to the master template using a deployments resource. Values are passed from the master into the linked template with parameters, and values generated in the linked template can be passed back to the master with outputs. Input parameters take the same format as we’ve already seen, while outputs are analogous to return values of a programming function. Linked or nested templates must be stored on-line and referenced with a URL. Template deployments can be tested with the Azure CLI test-azresourcegroupdeployment command, taking the resource group and template file as parameters. Once successfully tested a template can be deployed to Azure with the new-azresourcegroupdeployment command.</p>
<h1 id="DEMO-Parameter-Template"><a href="#DEMO-Parameter-Template" class="headerlink" title="DEMO: Parameter Template"></a>DEMO: Parameter Template</h1><p>Obviously, using a default parameter in our linked template, which is essentially the same as hard coding, the value is completely unacceptable and almost pointless. Before I show you how to use a parameter file to dynamically change parameters, I’ll just delete the web app and plan. Let’s go back to visual studio code and create a new JSON file called deploy parameters, and from the autocomplete, I will choose the parameter template. We just need the app name and plan name parameters with values inside the parameter template and add the plan name parameter to the website deploy template. </p>
<p>With the parameters set up I’ll save and close the the template file, and go back to appsplandeploy.json and add the plan name parameter to the website deploy template. The plan name parameter in this template, website deploy is where the plan name comes in from externally. Then we will pass it to the linked or nested template via a parameter within the linked template resource below.</p>
<p>Now in the parameters section of the linked template resource I will just add the plan name parameter and pass it the parameters planname value. This is a completely ridiculous and circular scenario in reality as the plan name parameter is being passed to the link template and then subsequently retrieved through the outputs value. But this is just to give you an idea of how to use parameters in linked templates using the previous example. Now, to deploy the resources, we’ve got the parameters in a file. That file will be passed as a parameter to the new-azresourcegroupdeployment command. The parameter values get pulled out of the JSON file and matched by name to the parameters defined in the ARM template file. Those parameters, can in turn be passed to linked or nested templates, by matching on name.</p>
<p>Let’s switch over to the PowerShell command prompt. First I’ll test the deployment, specifying the resource group name, the ARM template file, and the parameters file. Okay having successfully tested that I will now redeploy by executing the new resource group deployment command with the template parameter. We can see in the PowerShell CLI and the portal that it has successfully executed.</p>
<h1 id="DEMO-Database-Deployment"><a href="#DEMO-Database-Deployment" class="headerlink" title="DEMO: Database Deployment"></a>DEMO: Database Deployment</h1><p>As I’ve said the demos so far have been a little contrived. Now I want to show you a few of the more advanced features of ARM templates like the use of user-defined functions and how to create multiple instances of a resource type using something that could be called a looping mechanism. We will then deploy that template via a PowerShell script which will involve creating a new resource group and then submitting the template parameters using a template object. Let’s begin by creating a new template. I’m going to call it arm deploy and once again that will be a resource group template. In terms of resources, we are going to need a database server and then obviously some databases to run on that server. From the ARM template autocomplete I’ll select arm-sql-server and then arm-sql-db for my resources.</p>
<p>For parameters, I will need a server name and because I am creating more than one database I’m going to need a parameter that lets me tell the template how I databases I want. I will call that dbcount. Because we are accessing Azure SQL I will also need to provide an IP address for the database firewall. That will be startip and endip to define the IP address range. In terms of naming the databases, I’m going to call them test_db and that name will have a number appended to it, and also define an admin name and password. I’m defining these as variables to demonstrate the variable use, but you could just as well pass them in as parameters. I’ll replace SqlServer1 with the servername parameter, which will have to be changed in several places. I’ll also replace the administrator login and password with my variables. Next, I’ll replace the firewall start IP and end IP addresses with the corresponding parameters.</p>
<p>When it comes to the database name this is where it all gets a little bit interesting. So the database name is made up of the server name&#x2F;followed by the database name so the first thing I’m going to have to do is concatenate my server name parameter with the database name. But of course, the database name is a compound of the DB prefix variable plus the database number. To make up this compound name I’m going to define a function that will return the name. Let’s go into the functions section and we’ll look for arm-user, which is for user-defined function. I’ll give my function a name of databasename, and like all functions it takes parameters. This is where the auto complete doesn’t fully meet expectations. The function section has to have a namespace property and all functions have to be defined within a members section of the functions section. I’ll need a parameter for my database name prefix and I will need an integer parameter for the number that will be appended to the name. The return value or output is a string and it is a concatenation of name prefix and index, which I’ll join together with the built-in conact function. Going back to the database name I will use the databasename function firstly by starting with the namespace and the function name. Then I will use the DB prefix variable as my first parameter and then a built-in function called copy index. I guess you could say copyindex is a little bit like the index of a for loop, although we have yet to tell the database template to make copies. I’ll just replace the SqlServer1 text with the server name parameter in the depends on section for my database, as obviously, a database does depend on a database server. Now I’ll add the copy section. So it has a name and it has a count and that count is the number of copies to make and I will get that from my dbcount parameter. I’ll just replace the display name and tags with my compound database name.</p>
<p>Now that we are done with the template let’s move on to the PowerShell script. So this is going to be called dbarmdeploy.ps1 and Visual Studio Code recognizes the file extension and that I’m working with a PowerShell script and it is doing a nice job of syntax highlighting for me. So I’ll start by declaring a resource group variable and I will give it a name and a location. The location is the Azure abbreviation for the West US region. Next, I want to issue the command to create a new resource group. So that’s New-AzResourceGroup with a name and the location, which is the location element of the resource group variable. Next, I’m going to create a compound template variable which will have the name of my template as file name and nested within it the parameters that I want to submit. So that will be server name dbcount, startip and endip. I’ll create a new deployment with New-AzResourceGroupDeployment and use the resource group variable to get the ResourceGroupName parameter. Then the template variable to get the file name for -TemplateFile and then the template parameters object will be for the -TemplateParameterObject parameter, my word that’s a mouthful of parameters. Just in case that wasn’t clear, the TemplateParameterObject is a compound parameter, whereas the other parameters are strings. Right, let’s save that and go to the PowerShell command prompt, and run the script. Straightaway we can see the resource group has been created so that’s a good start, and if we pop over to the portal we can see that the deployment is running. If I open up an Azure SDK command prompt I can issue a deployment group list command to see which deployments are running for my resource group. At the top, I can see the name of the deployment is armdeploy so using that I can issue and az deployment group show command with my resource group and then the name of the deployment. This will also return all the details of the deployment plus the provisioning state at the bottom which is currently showing it as running.</p>
<p>Okay, the server has been deployed and Azure resource manager has accepted the database deployments. Going back to the PowerShell window we can see that the whole deployment has finished successfully and it returns our input parameters. I’ll just open up SQL Server management and log into the database server and check out my to test databases. Finally, I will remove the resource group with the force parameter so I’m not prompted.</p>
<h1 id="Deploying-with-a-Script"><a href="#Deploying-with-a-Script" class="headerlink" title="Deploying with a Script"></a>Deploying with a Script</h1><p>As I said at the beginning of this course in the architecture section, Azure Resource Manager accepts commands from PowerShell and the Azure CLI. In a way, templates are a little bit like the portal in terms of providing an alternative interface. Everything that you can do with a template you can do with a script. Here is an example of what a script might look like for creating a resource group in an Azure SQL server with firewall rules and a database. In some ways, this does seem more concise and easy to understand what exactly is going on here, but in one crucial respect, templates have an advantage over scripts when it comes to deployment mode.</p>
<p>Azure Resource Manager has two deployment modes; the default, which is incremental, means that whatever is in your deployment is added to your resource group, whereas complete says the resource group will become whatever is in your deployment. This essentially means that the resource group is cleaned out before the deployment is applied or all resources that are not in your deployment are removed from the resource group.</p>
<h1 id="Course-Summary"><a href="#Course-Summary" class="headerlink" title="Course Summary"></a>Course Summary</h1><p>Let’s recap what we have learned about Azure Resource Manager. It’s not the Azure portal. It’s the behind-the-scenes process that’s mostly involved with managing the deployment of resources in the Azure cloud. There are multiple interfaces for interacting with Azure Resource Manager apart from the graphical interface of the portal.</p>
<p>You can issue commands through PowerShell and the Azure CLI, but the preferred method is to use ARM templates. Azure Resource Manager templates are JSON files with sections that allow you to specify parameters, variables, functions, and resources. There is also an outputs section so you can pass values from one template to another.</p>
<p>A template can specify multiple resources, and multiple resources can be specified in multiple template files that are linked to a master template deployment file. Visual Studio Code has an IntelliSense extension for creating ARM templates. This extension has auto-complete and syntax checking and greatly simplifies the creation of templates.</p>
<p>As well as defining your own functions, there are many built-in functions to work with strings, arrays, logical comparisons, and Azure resources. Once a template has been defined, it can be tested with the Test-AzResourceGroupDeployment command. The template can then be deployed to Azure using the New-AzResourceGroupDeployment command. Both of these commands can be actioned either through PowerShell or the Azure CLI.</p>
<p>When a deployment is in progress you can monitor it through the portal or by using the Az group deployment list and show commands. You don’t have to create your template from scratch. You can download deployments as templates that you have created previously through the portal. This reaffirms the architecture of the portal as an interface to the Azure Resource Manager.</p>
<p>There is also a marketplace of Quickstart templates that you can use as-is, or download and modify. ARM templates simplify deployment by taking care of dependency management and orchestration. Unlike deploying resources with a script, you don’t have to worry about the order you define your resources in. Testing a deployment will let you know if dependencies are missing, and if you deploy without testing either the whole template is successful or none of it succeeds. You won’t end up in a situation with half of your resources deployed due to missing dependencies.</p>
<p>When a new resource or service becomes available on Azure often deploying an instance is only available using ARM templates and commands. Quite often a resource is released and there may be some time before the portal is updated to support it. But the main reason to become familiar and experienced with Azure Resource Manager is that it is by far the easiest method to ensure that your deployments are consistent and repeatable. This is of particular importance when deploying infrastructure as code through a DevOps pipeline.</p>
<h1 id="1Course-Introduction"><a href="#1Course-Introduction" class="headerlink" title="1Course Introduction"></a>1<strong>Course Introduction</strong></h1><p><a target="_blank" rel="noopener" href="https://github.com/cloudacademy/intro-to-arm">Github Repo</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Implementing-Dependency-Management-With-Azure-DevOps-18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Implementing-Dependency-Management-With-Azure-DevOps-18/" class="post-title-link" itemprop="url">AZ-400-Implementing-Dependency-Management-With-Azure-DevOps-18</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:54" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:54-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 13:18:36" itemprop="dateModified" datetime="2022-11-27T13:18:36-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Implementing-Dependency-Management-With-Azure-DevOps-18/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Implementing-Dependency-Management-With-Azure-DevOps-18/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to implementing continuous delivery. My name is Matthew Quickenden and I’m going to be guiding you through how to implement <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/what-is-dependency-management/">dependency management</a>. If you have any questions, feel free to connect with me on LinkedIn or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course is intended for people who want to become Microsoft-certified <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> DevOps Engineers or who need to combine people, processes, and technologies to continuously deliver products and services to meet business objectives. This is focused on packages created and used during the development cycles. While you don’t need any specific coding knowledge, having some experience with Visual Studio or like development tooling and Azure DevOps will be useful. Students who may not have any experience or background in development and are just interested in learning will be able to benefit from this course.</p>
<p>By the end of this course, you should have a good understanding of how packages are managed within Azure DevOps and the implications of package management methodologies. Your feedback on this course is important, so please give it a rating when you’re finished. Let’s get started.</p>
<h1 id="What-is-Dependency-Management"><a href="#What-is-Dependency-Management" class="headerlink" title="What is Dependency Management?"></a>What is Dependency Management?</h1><p>What is dependency management? With modern software architectures and development methods, software dependencies can become intertwined quickly. With more online repositories like GitHub and Docker Hub, pre-built libraries and services can be easily published and leveraged. These projects can be managed by all sorts of individuals or groups, and have a wide range of work ethics from well-maintained solutions, with good community and multiple contributors, and release schedules, all the way to the other end of the spectrum. Code is also developed internally and is often reused. Wherever the source comes from the problem is the same. Once implemented, one project now has a dependency on another.</p>
<p>When a team comes together to build a solution, they may decide for various reasons to leverage code that already exists. Depending on the type and language used for the project, there are different sources that can be leveraged to accelerate development. For instance, let’s say you’re running a .NET application, that’s going to be processing JSON, that you retrieved from <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> to describe Azure resources.</p>
<p>Rather than having to write all the logic to handle the JSON, your team decides to leverage a popular package called Newtonsoft.Json, which is a publicly available package. You could leverage the NuGet package that’s already been built and published for consumption.</p>
<p>By leveraging this package in your code, you have created a dependency on the package for your solution.</p>
<p>A package is a standardized way of distributing codes that can be consumed by another application or solution. Metadata is used to help store and version, and identify these packages.</p>
<p>There are different types of packages, as shown here in the image, that can be retrieved from upstream sources, found in artifacts in Azure DevOps.</p>
<p>NuGet. NuGet is a free open source package manager, designed for the Microsoft development platform used in .Net, since its introduction in 2010. NuGet has evolved into a larger ecosystem of tools and services. NuGet is distributed as a Visual Studio extension. The NuGet package has a.nupkg suffix, and as a zip file with a specific folder structure.</p>
<p>Maven packages are often used for Java projects. Maven can also be used to build and manage projects written in C#, Ruby, Scala, and other languages. A Project Object model file describing the metadata of the project is stored within the package.</p>
<p>NPM is a package manager for JavaScript programming language. It’s primarily used for runtime environments with Node.js. An NPM package contains a package.json file, describing the metadata of the package.</p>
<p>The Python Package Index is a repository of software for the Python programming language. Python’s packaging is built for distributing reusable code, called libraries, between developers. These packages are libraries used as building blocks to create applications, and have a.tar.gz extension.</p>
<p>Azure DevOps also has the ability to store Universal Packages. A Universal Package installed one or more files together in a single package that have a name and version, which is useful for many ad hoc situations where you want diversion and track files.</p>
<p>Containerized workloads are becoming more popular as platforms like Kubernetes are becoming mainstream. Docker images are generally complete self-contained systems.</p>
<p>Azure artifacts is available in Azure DevOps, DevOps server, as well as in Team Foundation Server 2017, and 2018. The sources allow you to integrate packages seamlessly into your CI&#x2F;CD pipeline. There are three concepts you need to understand when managing Azure artifacts: feeds, views, and upstream sources.</p>
<p>Feeds are the primary method for delivering packages. Microsoft recommends one feed per project. To achieve this we can utilize the feature of upstream sources, which allows us to combine multiple sources into a single feed. Using this method allows us to control sources in your project in the various levels of access. Here we can see two options we have when adding upstream sources. A public source, and from an existing Azure Artifacts feed from within your Azure DevOps organization.</p>
<p>When adding a public source, the only supported package type is an NPM source as shown here.</p>
<p>When adding a source from within your Azure DevOps organization, you can target an Azure Artifacts feed. This allows you to use different package types, for example, NuGet, Python, and Maven.</p>
<p>You can scope the visibility of your package feed to your organizations, which is multiple projects. This is the default. To project that is, this project or one project, specific people, which is a target audience, or public use.</p>
<p>A benefit of bring all these packages together in one feed is the copies are made of the sources. If you’re using sources, and those sources go offline, you’ll be able to maintain your own version of this package.</p>
<p>Let’s take a look at views, and when and how you should use a view. For example, let’s Do you want to share a package feed with an external partner. With the scope, you could use a public scope. However, this would make the package available to the internet. Views are a good way to address this use case. Using views means the data is read only. To gain access to these views, the external partner needs to be part of your Azure AD.</p>
<p>Views provide way to have the same feed used for debug and release packages. By default, there are three views. The @Release view contains all the packages that are considered official releases. The @Prerelease view contains all the packages that have labels in the version numbers, and local, which contains all the releases and prereleases of packages as well as downloaded cached content from upstream sources.</p>
<p>By default, the published packages will all belong to the local view only.</p>
<p>You have the option to promote a version to a view. As we can see here the version 1.0.74.1 is published to the prerelease view.</p>
<p>Upstream sources enable you to manage your product’s dependencies in a single place. Using upstream sources makes it easy to use common packages in your solution. It has the added benefit, and gives you protection against outages and corrupted or compromised packages from upstream sources, as a copy of the packages stored locally.</p>
<p>There are many different tools and ways to manage your packages, depending on the type of packages you’re working with. We’re going to look briefly at some of the methods using NuGet package management. However, these concepts apply generally to all packages.</p>
<p>To publish a package into your feed, if you’re using the command line, you often need to use an API key. Here’s a brief example of using .NET NuGet push.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet nuget push MyApp.1.0.0.nupkg -k &lt;yourAPIKey&gt; -s https://repo.nuget.org/v3/index.json</span><br></pre></td></tr></table></figure>

<p>These are some other commands or methods to assist with managing your NuGet packages. This is not a complete list, but highlight some of the key functionality. Pack, it creates a NuGet package based on the specific nuspec spec file or project file. List displays a list of packages from a given source. Restore downloads and installs any missing packages from the packages folder. Install downloads and installs a specific package into your project. Delete deletes or unlists a package from a packet source.</p>
<p>This brings us to the end of the first section, looking at what <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/introduction/">dependency management</a> is, and what Azure Artifacts look like. We’re going to jump into a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-building-a-package/">demo</a> and work through <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-building-a-package/">creating a package</a>.</p>
<h1 id="Demo-Building-a-Package"><a href="#Demo-Building-a-Package" class="headerlink" title="Demo: Building a Package"></a>Demo: Building a Package</h1><p>Welcome to our first session. We’re sitting in the portal here at dev.azure.com and we’ve already got an organization created, we’re logged into. The goal of the session is we’re going to create a package in Visual Studio, and we’re gonna increment the versions, add some <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/introduction/">dependencies</a> and make sure that’s committed to an artifact repository in our project.</p>
<p>First, we need to create a project. We’re gonna call this the depend on project. If we go now down to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> repo, we are gonna use Visual Studio to create the code. We need to make sure that we create a gitignore file for Visual Studio. Otherwise, you’ll end up with errors to do with files in use. So we now need to clone that project. And we’re just gonna use the IDE and clone to Visual Studio. We’re gonna let the browser handle opening this for us and connecting us to the right project. We’ll just need to login with our credentials. Now this is going to connect to the dev.azure.com and to our organization in a particular azure git repo. Here, we can choose to leave all the defaults and clone the project.</p>
<p>So we can see now that that project is connected here depends on project we connected to the master branch, we go to the team explorer, we currently have no solutions. So we’re gonna do a new solution. And in this case, we’re gonna look for a class library for .NET Core. So we can do a cross platform build. We’re gonna call this, depends class, and create. For this exercise, we’re not going to write any code. And that’s fine. The principles of uploading the code and the dependencies will work as they should.</p>
<p>So we can see in the Solution Explorer, we have the class.cs file we have over here. And we also have dependencies for the project. If we look at the properties of this file, we can see we have the package over here and currently is version of 1.0.0. We’re gonna change this to 001. And if we just click off that, we can see we’ve got that change. We’re just gonna save that. And close that page.</p>
<p>Looking at Visual Studio, we now have three changes to push. So we’re gonna call this our first. And we’re gonna do a commit all and push. That’s initializing the push, we can see that working here, and successfully pushed origin master. If we return here and look at files, we can see in our project depend on project files that we have, class and class files in here.</p>
<p>The next thing we need to do is create a pipeline and make sure we can build this project. So we’re gonna come over to the Azure pipelines and create our first pipeline. We’re gonna use the classic editor down here, create a pipeline without writing YAML. We’re obviously going from an Azure Git repo. And by default, it’s connected to the repo of this project. Continue. </p>
<p>We’re gonna choose the .NET Desktop for our template and get ourselves some more screen real estate here. And we can see these jobs have been added to this project. So we get the NuGet installer, we currently restore a package, build a solution. We’ve got this test here for testing the libraries, we’re not gonna use that, we’re just gonna remove it. We also don’t need to publish any symbols for debugging here. And the rest of that is fine.</p>
<p>So let’s do our first save and queue. And we’re gonna call this build1, run. You can see that job has been queued. And if we jump in here, we’ll just watch this.\</p>
<p>That looks like it succeeded. If we go look at our artifacts, in our drop folder, we have dependency, class bin, release .Net Core, depclass.dll. If we download that file, choose to keep that we can see this file depclass which if we look in there are downloads and check the properties of this file, we can see we have the version 0.0.1 as we stated in the build.</p>
<p>So next we wanna go to our pipeline and add in the ability to versions automatically. And we wanna push that version into a NuGet repository into our artifacts feed.</p>
<p>Let’s go create our artifacts feed to begin with. So we go over here, create feed. We’re gonna leave these options as default including the upstream sources, and create.</p>
<p>When we look at this feed, there’s nothing in the feed ‘cause we haven’t published anything to it. We can look at the properties of the feed and we can see the description here for if we want to give a description. We need to just save that. And we can see we have some other options here for hide deleted packages, package sharing badges. So if you’re doing build badges, how successful packages retention policies.</p>
<p>We can also see there are permissions here. And why it was important to do that first build pipeline was that it actually adds the depends on build service as a contributor to this artifact feed. Otherwise, you have to add that manually if you don’t have the build service run once already. We can also see this the different views for local pre release and release we’ve looked at and also upstream sources.</p>
<p>So if you wanted to add another upstream source, for instance, you could click on the add and do a public source. In this case, I’ve already got a link for a repository. Its just a couch app. So we can just say it’s an NPM source. And NPM is the only option package type, custom NPM, give it a name and add. And now we have another repository available for us in this feed. </p>
<p>So now that we’ve created this feed, we wanna publish our own package into it. If you go back to build pipeline. And we’re gonna edit the pipeline. We need to increment the package version as we build it. So let’s add a task into this job. And we’re gonna look for assembly. Now, you may not have this installed, it may be in your marketplace, so you need to go and install it. In my case I already do. I’m just gonna add it. It’s fairly simple to install. If you just follow it to the website and publish it to your organization.</p>
<p>We move on to the second task in the list, and we can see, we’re using the project files it’s the source files directory. And what we wanna do is change the attributes of the assembly. It’s all the different things we can change in this task. In our case, we want to change the assembly version, file version, and package version. And here we’re going to put the build.buildnumber. And we’re gonna copy that to the correct places. In this case, the assembly version, file version and package version.</p>
<p>You might be asking where are we getting this build number from? That’s one of the options of the pipeline. We have build versions by default. We’re just gonna clean this up. And we’re gonna do version 1.0.$(dayofyear).$(rev:r). And that will give us the day of the year and the revision build for the day. So let’s save this.</p>
<p>If we go and look at our tasks, we now need to continue on and create a package that we’re gonna push into the artifact repository. So in this case, we’re not gonna use the drop folder anymore. So let’s delete this. And we’re gonna wanna add a task from the NuGet packager, add, pull, push.</p>
<p>If we go to the task we can see the command we wanna run is push. If we come down here, we can look for our project depend feed. And we just now need to make sure that we have that package created because of the version of .NET Core that we’re using, we need to use the build solution over here and &#x2F;t:pack and during the build that’ll create a package bin, in the bin folder.</p>
<p>Once that build is completed, we wanna copy those files. So if we look for the source folder here, we can see our path. And we’re gonna just pick this path here for the project. And we just want the files in the bin directory. So let’s save this and cue it.</p>
<p>So that looks like it succeeded. If we go to the artifacts and we choose project feed, we can see here is our depend class and it’s pushed into the repository. If we look in here we can see what part of the code bunch, there’s a bunch of information about the project.</p>
<p>The last piece of the session we wanna cover is adding other dependencies to this. So if we go back to our project, and our solution, so if we go over here and select manage NuGet packages on the dependencies, we can browse for the NuGet package source nuget.org. I’m gonna browse, and we’re gonna add, say this one here. This is a Newtonsoft JSON handler. And perhaps the Microsoft extensions for logging. So again, we’ll choose, you can choose different versions. We’re gonna choose the latest stable version and install. Accept the licenses and we can see this that change. So we’re gonna change this and we’re gonna call this dependencies, commit and push, synchronizing, and if we return to our pipeline.</p>
<p>Now, you could obviously have this pipeline, start running on a push, we’ve got it set up manually in this case, so we’re gonna need to run that pipeline. And we’ll just choose run.</p>
<p>So we can see that succeeded. If we go to the artifacts folder, and we look here we’ve got the new version .2 that’s the next run. And we scroll over here we can see there’s the additional dependencies as part of this package.</p>
<p>So in our <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/dependency-management-strategy/">next session</a>, we’re going to try and consume this package from this feed and install it in another project.</p>
<h1 id="Dependency-Management-Strategy"><a href="#Dependency-Management-Strategy" class="headerlink" title="Dependency Management Strategy"></a>Dependency Management Strategy</h1><p>Dependency management strategy. As the code base of your project grows, it can become complicated to track and manage changes for different aspects of your solution. The problem grows as more people and teams become involved. A standardized versioning system can be extremely useful to address this problem.</p>
<p>Versioning is a critical part of software development to help you track changes in your code over time. It allows us to know what features and what code is being deployed in various places, to know what we expect it to do, track bugs and issues, and ensure the right groups of people get the right versions of code.</p>
<p>Semantic versioning, also known as SemVer, is a versioning system that has become common practice to use over the last several years. A package version looks like this, 4.7.6. The first number is the major version.</p>
<p>The major denotes a significant change to the package. This could include a complete redesign, breaking changes and additional testing to ensure backwards compatibility still works.</p>
<p>The minor version. These changes are often used to increment towards a major change. These often include new features or functionality.</p>
<p>And the final number, patches. This is used to indicate that there are bug fixes.</p>
<p>Sometimes a qualifier is used such as alpha, beta, or RC1, RC2, for release candidate one and release candidate two. These help denote the quality of the package. It’s used for those consuming the package in the pre-release cycles to know that they may experience unexpected results.</p>
<p>As you develop your package and create features, you can create new versions. Each version represents a fixed version of the code at a point in time. Whenever a package is published it should not be allowed to change any more. If this package did change you could risk breaking other solutions that rely on this specific version. The term for this is called an immutable package.</p>
<p>Depending on your pipeline and what type of package you are developing, there are methods to automatically increment version numbers. In the screen shot, we can see the build number format is using a function, rev:.r. This will automatically increase the revision each time the pipeline is executed.</p>
<p>Another method for addressing the complexities of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/introduction/">managing dependencies</a> is componentization. Componentization is the act of separating and structuring your product or library into a set of components, discrete parts of your code that provide a set of features. There are two methods for this, source componentization and package componentization.</p>
<p>Source componentization. Components are broken up into different projects within the same source code. This can mean a component can have references to another complied component within the same source code. This is called binary composition. This can work as long as the source code is not shared outside of the project, however, it can increase build times and comes with added complexity. Once these separate components are leveraged by different teams or code is branched, it becomes difficult to track changes and ensure the consistency. This method becomes very cumbersome and difficult to manage.</p>
<p>Package componentization refers to using packages for distribution of software. Packaging code with structured methods means you can add metadata, like versioning, to your package to allow for reliable distribution needed for dependency management. When a component package is checked into a package source, other solutions can leverage the package and be developed independently of each other.</p>
<p>It is important to remember there is no one right answer. When looking at your code base and considering how to componentize and turn your code into packages there are different methods you can use to guide how and where to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-building-a-package/">create packages</a>.</p>
<p>You can look for duplicate code within your code base, group parts of your code with similar functionality, perhaps code with similar release cycles, leveraging existing organizational group structures, or stable code with very few changes to itself.</p>
<p>There is tooling available to help you find dependencies and duplicate code that may be good candidates for creating packages. Visual Studio Enterprise has a code clone analysis tool to search for duplicate code. There are other tools like Sonarqube, ReSharper, and Copy&#x2F;Paste Detector, depending on your needs. Many of these tools have other features to help you improve the general quality and detect dependencies.</p>
<p>This brings us to the end of this section. Now we’re going to look at a demo where we’ll <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-consuming-our-package/">consume the package</a> that we created previously.</p>
<h1 id="Demo-Consuming-Our-Package"><a href="#Demo-Consuming-Our-Package" class="headerlink" title="Demo: Consuming Our Package"></a>Demo: Consuming Our Package</h1><p>In the last session, we created this depclass in Visual Studio, and we use the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Pipeline to build that project and upload it into the artifacts.</p>
<p>This artifact here, if we look at it, happens to have the two dependencies we put in there, and it’s now published. In this session, we’re going to consume this package. We’re just gonna create a new project and connect up to this feed, and then install that <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/introduction/">dependency</a> within our environment.</p>
<p>Before we do that, we’re just going to take a look at the options here on the package feed. And we did talk about promoting packages into the different views. So, if we look here, we have prerelease, release and local, which is the feed we’re in at the moment. So, you can choose to promote any different version of a package into different feeds.</p>
<p>So, here we can choose the version one, and we can put that into prerelease. And we can see here that’s tagged with a different view. We’ll come back to our project here, and we gonna create a new project. And we’re gonna create a new console app. And we’re gonna choose a new folder for this, as if it was a new project, use dependency, and select Create.</p>
<p>Now, we have the dependencies over here, and what we wanna do is go to the Manage NuGet packages, and we’d like to install our current package. So, up here we’ve got package sources, and if we choose the drop-down, we can see we have nuget.org Visual Studio offline. And we select the gear. Here we can add a new package. So, if we choose Add new package, it’s looking for a name and a source.</p>
<p>We return to our view over here, and we choose to Connect to this feed. If we choose Visual Studio, it will give us some information on how to connect to these different feeds. So, in this case, we can see that prerelease feed. We wanna connect to the main feed. So, we come back here, connect to feed, Visual Studio, and there’s the feed name, and that’s the local feed link. Scroll across, copy that and paste that into the source. And we’ll give the same name for the package name. And if you select that from our source, and choose Browse, you can see the dependency class that we created, and the different versions there. We wanna use one for this instance. And if we expand this, we can see the dependency class, which was our module.</p>
<p>We come back to our menu here, the Artifacts. I’ve already deployed this once. So, I can say the downloads are counting up, the number of users that are consuming it. So, I get information here telling me that how many people are using this package. In this case, we want to now update to the latest version. So, here we can see update to latest version.</p>
<p>Now, when we update the latest version that included the extension and the Newtonsoft JSON dependencies, which the login came with these licenses. So, I’ve got to accept these licenses, and now they’re available in my dependencies. This brings the session to a conclusion. I hope you found this useful, in showing how to consume a dependency that we’ve created.</p>
<h1 id="Security-amp-Compliance"><a href="#Security-amp-Compliance" class="headerlink" title="Security &amp; Compliance"></a>Security &amp; Compliance</h1><p>Security and compliance. Trying to stay in control of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/introduction/">dependencies</a> that your project is consuming could be an overwhelming task if you had to do it manually. Luckily, there are numerous tools to enable good governance and security scanning of packages and can help you find and detect vulnerabilities or exploits.</p>
<p>If you’re publishing <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-consuming-our-package/">packages</a> to be consumed, security is important. If other companies, people or groups within your organization are going to trust software published by you it is important to ensure that only the people with the appropriate authority have the ability to publish packages. There are different roles for package feeds as shown here in this table.</p>
<p>In recent times, we have seen a number of companies in the news for a variety of reasons related to security and compliance. Often this has resulted in large fines or breach in security and customer information exposed. A company has a duty of care and responsibility to ensure their code is secure and adheres to licensing requirements.</p>
<p>Open source is becoming a much larger part of the IT world today. While it is great to be able to leverage the work done by the community or other vendors this comes with its own problems and at a cost.</p>
<p>You have to be aware of what you’re using and any bugs or vulnerabilities that come along with that package. The code may even contain malicious content which you do not want to introduce into your organization.</p>
<p>While these bugs and vulnerabilities may be known, there may be no regular cadence to code release, meaning you can’t be sure when or if it will be patched.</p>
<p>Some publicly available software comes along with certain license agreements. For instance, this package is not to be used for commercial use. In that situation you do not want to be caught out.</p>
<p>As we said earlier, trying to track and stay on top of licensing and code vulnerabilities is a challenge. There are tools you can use to integrate scanning for these things directly into your CI or CD pipelines. In addition, tools can be pointed at a repository and scan the artifacts of the repository directly. The benefit over scans done on the build pipeline is that sometimes vulnerabilities and exploits are found after code is released. If the code is only scanned during a build and an exploit was found months later, it could be missed.</p>
<p>One tool is WhiteSource Bolt. This tool will generate a report that can be found in the Pipeline section with three main areas:</p>
<ul>
<li>Security vulnerabilities which displays various levels of severity from low to medium and high.</li>
<li>License Risks and Compliance shows a list of license types that are used and makes an assessment of risk.</li>
<li>Outdated Libraries displays old versions of libraries. While these often have less immediate impact that can cause problems and introduce risks.</li>
</ul>
<p>We’re going to take a look at the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-whitesource-bolt/">WhiteSource Bolt</a> demo. WhiteSource have a quick start template that will create a pipeline and allow us to test the product and have a look at the report it generates.</p>
<h1 id="Demo-WhiteSource-Bolt"><a href="#Demo-WhiteSource-Bolt" class="headerlink" title="Demo: WhiteSource Bolt"></a>Demo: WhiteSource Bolt</h1><p>In this session, we’re going to look at scanning packages for license compliance. If you bring up a tab in your browser, we’re gonna search for a project which will help us quick start here. So I’ve just searched for managing open source <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/security-compliance/">security</a> and licenses with WhiteSource. We will get to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> DevOps lab here. And if you scroll down, explains how to go through the project, there’s basically a DevOps generator here, which will create the content for us.</p>
<p>So what we’ll do is sign in. And here’s our WhiteSource Bolt project. So you need to select your organization, give your project a name. We’ll call this WhiteSource and that’s fine. Create project.</p>
<p>So now that’s provisioned successfully, we can navigate to the next project. And we can see the WhiteSource project has been provisioned in our organization. We can go to pipelines, we now see the WhiteSource Bolt. If we select that we can see we’re using the free version, you will probably be asked to put in your email address and details, I’ve already entered those in. And that will allow you to use this pipeline.</p>
<p>So if we now go to the pipelines, select the pipeline, and run. Leave these things as default. See that’s now gone into phase one. And the tab now’s created WhiteSource Bolt build report. So we’ll just watch this job complete.</p>
<p>So we can see that job completed, took just under four minutes. If we go back to the job itself, we can see the WhiteSource Bolt build report. You can see here a number of tiles. This is the vulnerability score, vulnerability libraries, severity distribution, aging vulnerability libraries. And then there’s a detailed list of exactly what vulnerabilities there are and the severities and which libraries they affect. There’s also a link to help you look at those in more detail. You can go through that session yourself and look at what else WhiteSource Bolt can offer for you.</p>
<p>This concludes our session. I hope you found this useful.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>With the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/demo-whitesource-bolt/">White Bolt</a> demo complete, this brings us to the end of the course. I hope you have learned something about <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-dependency-management-with-azure-devops/introduction/">dependency management</a> and found these demos useful to understanding further what this means in practice.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Deploying-And-Monitoring-Azure-App-Service-Web-Apps-17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Deploying-And-Monitoring-Azure-App-Service-Web-Apps-17/" class="post-title-link" itemprop="url">AZ-400-Deploying-And-Monitoring-Azure-App-Service-Web-Apps-17</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:52" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:52-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-23 21:36:10" itemprop="dateModified" datetime="2022-11-23T21:36:10-04:00">2022-11-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Deploying-And-Monitoring-Azure-App-Service-Web-Apps-17/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Deploying-And-Monitoring-Azure-App-Service-Web-Apps-17/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Managing-Code-Quality-and-Security-Policies-with-Azure-DevOps-16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Managing-Code-Quality-and-Security-Policies-with-Azure-DevOps-16/" class="post-title-link" itemprop="url">AZ-400-Managing-Code-Quality-and-Security-Policies-with-Azure-DevOps-16</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:51" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:51-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 13:08:22" itemprop="dateModified" datetime="2022-11-27T13:08:22-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Managing-Code-Quality-and-Security-Policies-with-Azure-DevOps-16/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Managing-Code-Quality-and-Security-Policies-with-Azure-DevOps-16/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Course-Introduction"><a href="#Course-Introduction" class="headerlink" title="Course Introduction"></a>Course Introduction</h1><p>Hi there. Welcome to managing code quality and security policies with Azure DevOps. My name is Thomas Mitchell and I will be taking you through this course.</p>
<p>I am in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> instructor at Cloud Academy and I have over 25 years of IT experience, several of those with cloud technologies. If you have any questions about this course, feel free to connect with me on LinkedIn, or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>This course is intended for those who are preparing for the AZ-400 exam. To get the most from this course, you should have a basic understanding of Microsoft Azure and of DevOps concepts.</p>
<p>We will start things off by looking at the definition of code quality. After defining what code quality means, we’ll dive into what it takes to write high-quality code.</p>
<p>Next, we’ll look at what goes into code quality scanning and at how SonarCloud can help monitor code quality.</p>
<p>Once we’ve worked through code quality scanning and monitoring code quality, you’ll see a hands-on demonstration that shows you how to use SonarCloud in the pipeline.</p>
<p>As we progress, we’ll look at what code coverage means and how to use the “Publish Code Coverage Results” task to report on code coverage.</p>
<p>Later on, we’ll touch on security policies, where you’ll learn about the OWASP and its Top-10 list. We’ll take a look at 5 of the top entries in the OWASP Top-10.</p>
<p>We’ll round out the course by looking at a couple of popular security analysis tools.</p>
<p>By the time you finish this course, you should have the foundational knowledge that is required to effectively manage code quality and security policies.</p>
<p>We would love to get your feedback on this course, so please give it a rating when you’re finished. If you’re ready to learn about code quality and security policies, let’s get started!</p>
<h3 id="Lectures"><a href="#Lectures" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="Code-Quality-Defined"><a href="#Code-Quality-Defined" class="headerlink" title="Code Quality Defined"></a>Code Quality Defined</h1><p>Hello, and welcome to Code Quality Defined. In this lesson, we are going to take a look at what qualifies as quality code.</p>
<p>When you set out to write code that is required to perform a certain function, you will often find that there is not necessarily one right way to write the code. As they say, there is more than one way to skin a cat. Now, that being said, there ARE wrong ways to write code – and when you fall into bad habits, your code quality will suffer as a result. So, what do you have to do to maintain your code quality?</p>
<p>For starters, the code that you write needs to function as expected. That’s a given. If your code doesn’t do what you want it to do, it really doesn’t qualify as high-quality code, now does it? </p>
<p>Aside from ensuring that your code performs as expected, you must also ensure that your code is clear and readable. This is important because you are likely not going to be the only one reading your code and trying to modify or enhance it. If it isn’t clear, it’s going to be difficult for others to work with it. </p>
<p>Speaking of others working with your code, it’s also critical that your code be thoroughly documented. Your documentation should be clear enough that others can follow it. </p>
<p>While readability and documentation are critical to maintaining code quality, efficiency is also important. That being the case, it’s critical that your code runs efficiently. If your code can complete a task in 2 seconds instead of 10 seconds, make that happen – and make it happen without wasting resources – because resource waste isn’t all that efficient. </p>
<p>So, now that you have a clean set of code that’s documented, readable by others, and efficiently performs the task it was meant to perform, you have to ask yourself, “Is my code maintainable?”</p>
<p>While the previously mentioned characteristics are important to creating quality code, the maintainability of the code is also important. So, what this means is that you have to write your code in a manner that makes it easy for others to work with it. To do this, what you really want to do is eliminate overly long code modules. </p>
<p>There are several other characteristics of quality code. They include style, extensibility, and security.</p>
<p>When writing code, the code should always adhere to agreed-upon standards that might include specific coding standards, formatting standards, and naming standards. Every person that will be working on your code should recognize these standards and they should adhere to them. </p>
<p>Because code will often evolve over time – sometimes rapidly, the code that you write must be extensible. If it’s not, these evolutions over time can become painful and time-consuming.</p>
<p>Lastly, code must be secure. In today’s world, this is really the most important characteristic of quality code. Because security breaches and holes can be created through poor coding practices, it’s important that you keep security at the forefront when writing your code.</p>
<p>Now, in utopia, your code would meet all the qualifications that we previously touched on. But this isn’t utopia. In reality, your code isn’t going to rate highly for all of these qualifications. That’s just a fact of life. That being the case, you have to be aware of the technical debt that you incur whenever you write “less than stellar” code – because the more that your code fails in any one of these areas, the more technical debt it is going to incur.</p>
<p>So, if you know what it takes to write quality code, how does poorly written code happen? </p>
<p>Well, if you ask most coders, they will usually give you the same answer: tight deadlines. This is because when a developer is tasked with getting a project done quickly, they will usually be forced to take shortcuts. These shortcuts allow the developer to get the code written more quickly, but at a cost.</p>
<p>For example, instead of refactoring an existing method to include new functionality, the developer will often just copy the method to create a new version. Coding in this fashion is certainly faster than the refactoring and the testing that would otherwise be necessary. </p>
<p>An organization with no defined coding standards will also result in poor code quality because the organization’s developers won’t really know what they should be producing. </p>
<p>There are, in reality, all kinds of reasons for poor quality code development. But the ones I mentioned already, along with a simple lack of technical skills, are really the main reasons.</p>
<p>To help improve code quality, what you should do is implement automated code testing. This is because automated testing can help identify issues without manual work involved. </p>
<p>At the end of the day, it’s critical to maintain high-quality code, because regardless of how poor code comes to be, the end result is that the DevOps people wind up spending the majority of their time on fixing bugs, rather than delivering better functionality to your customers.</p>
<h3 id="Lectures-1"><a href="#Lectures-1" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="Monitoring-Code-Quality"><a href="#Monitoring-Code-Quality" class="headerlink" title="Monitoring Code Quality"></a>Monitoring Code Quality</h1><p>Hello, and welcome to Monitoring Code Quality.</p>
<p>Writing code can certainly be a chore. Quite often, developers are tasked with just getting code to work – often under tight deadlines. That being the case, code quality is often not really top of mind. That’s not good, because, in order to avoid technical debt, improved code quality and efficiency should always be one of the main goals in any DevOps project. Maintaining code quality requires that you ensure that your developers are writing quality code. Implementing code quality scanning, which is an automated system for providing code feedback, can be very useful for improving code quality.</p>
<p>Scanning your code quality like this is quite similar to grammar and spell-check in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft</a> Word. It allows you to improve the final product, because, code quality maintenance should be top of mind throughout a project’s lifecycle. The reasoning is pretty straightforward. Issues with code quality will usually accumulate if left unchecked. This leads to snowballing technical debt, which, in turn, results in difficult and time-consuming software maintenance.</p>
<p>One of the best ways to mitigate this technical debt is to address code quality issues as early as possible in the development process.</p>
<p>Tools and techniques that you can leverage to improve code quality include things like enforcement of coding standards, proper training, regular and ongoing code reviews, and automated quality analysis.</p>
<p>That automated quality analysis piece is what we are concerned about here. Automated quality analysis tools, or static code analysis tools, are used to help maintain high code quality. Such tools are immensely helpful to developers because they can scan code and flag vulnerabilities. These tools include things like SonarCloud.</p>
<p>What these tools do is identify code quality issues and track trends over time. Using these tools allows developers to view the current code health of a project along with historic code health of the project.</p>
<p>Let’s discuss how SonarCloud can be used to help with code quality monitoring.</p>
<p>To ensure high-quality code, you can use SonarCloud to automatically analyze your code by reading it right from your repository. You don’t need to configure a CI-based analysis.</p>
<p>To make this happen, you need to import a project that’s compatible with Automatic Analysis. Once you’ve imported your projects, SonarCloud will analyze the default branch. A new analysis will be triggered automatically after every new push on the default branch and after any pull request activity.</p>
<p>I should point out, however, that Automatic Analysis, at the time of this course publication, is only available for GitHub repositories – and can only be activated on projects bound to a repository. </p>
<p>To activate Automatic Analysis with SonarCloud for a new project, you need to import the project from GitHub. Once imported, SonarCloud automatically triggers a compatibility check to ensure that the project is compatible with Automatic Analysis. If it is, SonarCloud triggers an initial analysis. If it’s not compatible, SonarCloud will suggest other analysis methods. For example, it may recommend using a CI tool.</p>
<p>To use Automatic Analysis for an existing project, you would just browse to your project’s Analysis Method page in SonarCloud and turn Automatic Analysis on. Once the compatibility check finishes, SonarCloud will make recommendations for your specific project. </p>
<p>Later on, in this course, I’ll show you how to use SonarCloud in a build pipeline.</p>
<h3 id="Lectures-2"><a href="#Lectures-2" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="Reporting-on-Code-Coverage"><a href="#Reporting-on-Code-Coverage" class="headerlink" title="Reporting on Code Coverage"></a>Reporting on Code Coverage</h1><p>Hello and welcome to Reporting on Code Coverage. In this lesson, we are going take a look at how you can report on your code overage, using <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> DevOps.</p>
<p>Before we dive into DevOps, let’s quickly define what code coverage means. Code coverage is the proportion of code within a project that’s tested through things like unit tests. Ensuring that a large portion of your code is tested helps guard against bugs – this is why code coverage is so important.</p>
<p>Reporting on code coverage allows you to identify code paths that are not covered by tests. You can use this information to reduce your test debt.</p>
<p>The “Publish Code Coverage Results Task” is a task in a build pipeline you use to publish code coverage results that are produced when you run tests to Azure Pipelines or TFS to obtain coverage reporting. This task supports coverage result formats like Cobertura and JaCoCo.</p>
<p>I should note that the “Publish Code Coverage Results Task” can only be used in Build pipelines. It’s not supported in Release pipelines.</p>
<p>Other tasks, like Visual Studio Test, .NET Core, Ant, Maven, and some others also offer the option to publish code coverage data to the pipeline. When using these tasks, you don’t need a separate Publish Code Coverage Results task in the pipeline.</p>
<p>Before you can produce the HTML code coverage report, you’ll have to install dotnet 2.0.0 or later on the agent. In addition, the dotnet folder has to be included in the environment path. </p>
<p>The YAML snippet that you see on your screen is required to publish the code coverage results.</p>
<p>In this snippet you see, both the codeCoverageTool and summaryFileLocation parameters are mandatory.</p>
<p>The summaryFileLocation argument is a required parameter. It’s the path to the summary files that contain the code coverage statistics. The pathToSources argument is the path to your source files. This argument is only required when coverage XML reports do not contain an absolute path to the source files. The failIfCoverageEmpty argument is an optional argument that fails the task if code coverage doesn’t produce any results to publish.</p>
<p>If you are using Docker, builds and tests can run inside the container. This allows you to generate code coverage results right within the container itself. If you wish to publish the results to your pipeline, the resulting artifacts have to be made available to the Publish Code Coverage Results task. </p>
<p>Once you’ve generated your code coverage results, the code coverage summary can be viewed in your build timeline view. You can use this summary to see the overall percentage of line coverage.</p>
<p>You can view the code coverage artifacts that were published during the build under the Build artifacts published milestone in the timeline view.</p>
<p>If you use Cobertura or JaCoCo coverage formats to publish your code coverage, the code coverage artifact will contain an HTML file that you can view offline as well.</p>
<h3 id="Lectures-3"><a href="#Lectures-3" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="The-OWASP-Top-Ten"><a href="#The-OWASP-Top-Ten" class="headerlink" title="The OWASP Top Ten"></a>The OWASP Top Ten</h1><p>Hello and welcome to the OWASP Top 10. The term OWASP refers to The Open Web Application Security Project. </p>
<p>The Open Web Application Security Project is an international organization dedicated to helping organizations conceive, develop, acquire, operate, and maintain applications that can be trusted. The information that OWASP provides is free and is open to anyone that wants to improve application security.</p>
<p>The Open Web Application Security Project is probably most known for its Top 10 list. Their Top 10 list highlights common issues in web applications. This list is designed to help minimize exposure to risks associated with these common issues.</p>
<p>Just to give you a feel for what OWASP is all about, let’s look at some of the top issues mentioned in their Top 10 list.</p>
<p>The top security risk on the OWASP Top 10 at the time of this course publication is Injection. Because injection flaws like SQL injections and LDAP injections occur when untrusted data is sent to an interpreter as part of a command or query, you should get into the habit of never trusting any user input. You should also never execute any code that’s built directly from untrusted input.</p>
<p>Broken Authentication takes the number two spot on the OWASP Top 10. This shows up because application functions that are related to authentication and session management are, many times, implemented incorrectly. This allows the bad guys to compromise passwords, keys, and even session tokens. </p>
<p>Number three on the OWASP Top 10 is Sensitive Data Exposure. This shows up because lots of web applications and APIs do a poor job of protecting sensitive data. As a result, hackers can often steal or modify this poorly protected data to commit credit card fraud, identity theft, and other crimes. </p>
<p>XML External Entities comes in at number four on the Top 10 because lots of older and poorly configured XML processors evaluate external entity references within XML documents. This is an issue because external entities can be used to reveal internal files via the file URI handler, internal file shares, internal port scanning, remote code execution, and denial of service attacks.</p>
<p>Rounding out the top five on the OWASP Top 10 is Broken Access Control. Broken Access Control shows up because restrictions on what authenticated users can and can’t do are, quite often, not properly enforced. These flaws are then exploited to access unauthorized functionality or data.</p>
<p>To ensure a more secure software development environment, organizations should adopt the OWASP Top 10 as part of their development process.</p>
<p>To learn more about the OWASP Top 10, visit the <a target="_blank" rel="noopener" href="https://owasp.org/www-project-top-ten">URL</a> that you see on your screen.</p>
<h3 id="Lectures-4"><a href="#Lectures-4" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="Security-Analysis-Tools"><a href="#Security-Analysis-Tools" class="headerlink" title="Security Analysis Tools"></a>Security Analysis Tools</h1><p>Azure DevOps can be integrated with a wide range of other tools that can help in checking code for vulnerabilities. Common tools include SonarCloud and White Source Bolt. In this lesson, we are going to take a look at what each product is and what each offers.</p>
<p>Let’s start by taking a look at SonarCloud. SonarCloud is a code analysis service that runs in the cloud. It’s the cloud version of the on-prem product called SonarQube. SonarCloud is used to identify code quality issues in roughly two dozen different programming languages. It allows organizations to continuously ensure maintainability and security of their code.</p>
<p>What SonarCloud does is perform static code analysis to identify issues in the code that you write. This static analysis does not require you to actually run the code like dynamic analysis does. This provides an additional layer of code verification that is different and separate from automated testing and human code-review.</p>
<p>Using SonarCloud allows you to detect problems with your code earlier in the process, which, in turn, ensures that fewer issues find their way into the later stages of the build process. This helps improve the overall quality of the final production code.</p>
<p>To use SonarCloud, you connect it to whatever cloud-based code repository service that you are currently using. It supports GitHub, Bitbucket Cloud, <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> DevOps Services, and GitLab.</p>
<p>When you sign up for SonarCloud, you specify the repository provider that you want to connect to, and then your SonarCloud account is created and bound to your account on your chosen repository provider.</p>
<p>I should point out that SonarCloud does not work with on-prem code repositories. If you need support for on-prem repositories, you should use what is essentially the on-prem version of SonarCloud, which is called SonarQube.</p>
<p>Once you sign up for SonarCloud, you can use it to identify issues and security hotspots in your code.</p>
<p>Issues, as you might expect, are problems in your code that require fixing. The types of issues that SonarCloud can detect include Code Smells, Bugs, and Vulnerabilities.</p>
<p>Code Smells typically don’t prevent your program from functioning properly but might indicate deeper problems that can cause maintainability issues for the code. </p>
<p>Bugs are coding errors that can cause the program to not operate as expected. </p>
<p>Vulnerabilities are coding problems that may be exploited by bad guys in order to compromise the security of your application.</p>
<p>While SonarCloud is very good at detecting coding issues, it also identifies security hotspots, which are parts of code that could cause security issues. </p>
<p>By integrating SonarCloud into your software development process, you can prevent issues from reaching production. You can actually integrate SonarCloud in three different places. It integrates with the editor, in the pull request, and in the codebase.</p>
<p>For example, SonarLint, which is SonarCloud’s companion product, is used to provide immediate feedback from within the editor. This allows developers to catch issues before they reach the repository.</p>
<p>By annotating the pull request interface of your repository service, SonarCloud can provide the results of its analysis on the pull request branch right in the interface – and can automatically grant or deny the approval of the pull request, depending on your defined quality gate criteria. This allows you to add automatic code review to your process.</p>
<p>Because some types of issues can only be identified after code is merged, SonarCloud often needs to analyze your entire codebase as a single unit. To accomplish this, SonarCloud offers two different approaches. They include automatic analysis and CI-based Analysis.</p>
<p>To provide automatic analysis, SonarCloud detects every pull request that is merged and then analyzes the new state of the code in your repository. </p>
<p>CI-based analysis is the configuration of SonarCloud so that it performs analysis as part of your regular continuous integration (CI) process or build process.</p>
<p>What SonarCloud does is focus on identifying issues that are found in incoming changes as they arrive. This aligns with the principle of “cleaning as you code”, which focuses on preventing issues in incoming new code. This eliminates, or at least mitigates, the need for digging through old code to identify issues within it. </p>
<p>While SonarCloud is the most common security tool, WhiteSource Bolt is another security and management solution that I want to touch on here. </p>
<p>WhiteSource Bolt a lightweight open-source offering that, when integrated within Azure DevOps Services &amp; Team Foundation Server, allows you to detect and remedy vulnerable open source components, generate open-source inventory reports, and enforce open source license compliance. You can also use WhiteSource Bolt to identify outdated open-source libraries and recommendations.</p>
<p>To learn more about WhiteSource Bolt, visit the <a target="_blank" rel="noopener" href="https://bolt.whitesourcesoftware.com/azure/documentation/#WhiteSourceBolt-Introduction">URL</a> that you see on your screen.</p>
<h3 id="Lectures-5"><a href="#Lectures-5" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="DEMO-Configuring-SonarCloud-in-a-Pipeline"><a href="#DEMO-Configuring-SonarCloud-in-a-Pipeline" class="headerlink" title="DEMO: Configuring SonarCloud in a Pipeline"></a>DEMO: Configuring SonarCloud in a Pipeline</h1><p>Welcome back. In this brief demonstration, what we’re going to do is configure SonarCloud in a pipeline. What we’re first going to do is activate SonarCloud for our DevOps subscription here. On the screen here you can see I’m logged into my DevOps subscription. I have the Parts Unlimited project that was generated by the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> DevOps Demo Generator here, and this is the project we’re going to work with.</p>
<p>So what we need to do first here is to set up the SonarCloud extension for our subscription. And to do that from that screen, we click the marketplace icon here and we browse the marketplace. Now from the extensions search bar here, we’re simply going to search for SonarCloud. And we can see we have a couple of different options.</p>
<p>We have the SonarCloud extension here, we have the Quality Gate and we have the build breaker along with an SP Tool that allows SonarCloud to run for .Net Core projects on prem actually. What we’re going to do here is install the SonarCloud extension. So we’ll select our SonarCloud and then we’ll click Get it Free. And then from here, we’re going to select our DevOps organization and in this example, I only have the single DevOps organization called DevOps9878 and we’ll go ahead and install it. And once it’s installed, we can proceed back to the organization.</p>
<p>Once we’re back in our organization here, we’ll select our Parts Unlimited project here. Now from our Parts Unlimited project here, what we’re going to do is create a new pipeline. So let’s go ahead and select pipelines here and we can see we already have a recently run pipeline which we are not going to use.</p>
<p>What we’ll do here is click new pipeline and then what I’m going to do here is show you how you can use the classic editor to create a pipeline without YAML. There’s a way to do that as well. And to do that, we simply select the Use The Classic Editor here, and from here, we’re going to leave the source as our Azure Repos Git and we have our Parts Unlimited team project, our PartsUnlimited repository, and of course the Master default branch, we’ll go ahead and continue here.</p>
<p>Now, what we can do here is select our template. We can either search for the template, or if we scroll down here we can see the.NET templates that were added by SonarCloud. For this example, we’ll use the.NET Desktop with SonarCloud.</p>
<p>Now, what we can see here is that we have some settings that need attention. We need to configure the Agent pool. Now what we’re going to do for this demonstration is select Azure hosted. And then what we’ll do here for the agent specification is we’ll select the vs2017 for this example, and then what we’ll do here is we’ll prepare analysis on SonarCloud.</p>
<p>Now on this screen, we can see we have to configure some information. We need to configure a service endpoint so that this build can connect to SonarCloud to perform the analysis. We need to specify our organization and a project key.</p>
<p>Now, if I select the drop down here for my service endpoint, I can say I don’t have any service endpoints created right now.</p>
<p>Now to create this service endpoint, I can either go through the manage link here and create a service connection for SonarCloud, which takes me to my new SonarCloud service connection window. Or if I close this out and click New, it takes me right to the window.</p>
<p>In either case, I need to provide a SonarCloud token. Now to get that I need to set this up in my SonarCloud account. So we’ll close this out and we’ll open up sonarcloud.io. </p>
<p>Now here I’m logged into my SonarCloud account. And if I go into my account here if I go into Security, I can generate a token. I’m just going to call this My Token, and we’ll generate it. And we can see that my token has been created and we’ll copy this.</p>
<p>We go back out to Parts Unlimited, we can go ahead and create our end point, provide our token here, we verify it, we can see our verification has succeeded, and we’re just going to call this MyConnection. At this point, we’ll verify and save it, and we now have our end point connection created.</p>
<p>Now in the organization drop down here, I can select my TestOrg9878 Now this TestOrg9878 comes from my account in SonarCloud where I have a TestOrg9878 organization defined. Now this Project Key needs to be globally unique so we’ll create a Project Key for this project.</p>
<p>So with my Project Key configured here, we have all of the required information completed and we can go ahead and save and queue. We can leave everything here at its default and we’ll go ahead and run it.</p>
<p>Welcome back. So now that our analysis has completed, let’s go ahead and take a look at what the output is. On the screen here I’m in my pipeline screen for my Parts Unlimited project. We can see the recently run pipeline for Parts Unlimited. This is the.NET Desktop with SonarCloud.</p>
<p>We can go ahead and select our run, from here we can select the description for our run. We see the warnings that were generated as part of our run. Now from here, what we can do is click on Tests and we can see that we had 16 total tests. We can see that we had 14 passed and two other state. And then if we click on extensions here, we can see that we have a detailed SonarCloud report available.</p>
<p>So we’ll go ahead and click on our report. This takes us out to SonarCloud where we can see a full report that is returned for our analysis. We can see we had 89 total bugs for vulnerabilities, we had some security hotspots or lots of security hotspots, I should say. And we can see our coverage report here’s what I’m really interested in for this.</p>
<p>If we hover over the icon here, we can see that this represents the percentage of lines of code covered by our tests. A 0.3% code coverage is probably not what we’re after. Now, we’re not after perfection here because I just wanted to show you how to work through the process of using SonarCloud with your pipeline.</p>
<p>If we select our vulnerabilities here, we can see that we should be refactoring code to not perform redirects, we should be refactoring code to not reflect user controlled data and we should be making some other changes here. We go back out to Overview, we can go ahead and select our bugs and we can see there are all kinds of bugs in our code. So that is how you integrate SonarCloud into your build pipeline.</p>
<h3 id="Lectures-6"><a href="#Lectures-6" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-summary/">Course Summary</a></p>
<h1 id="Course-Summary"><a href="#Course-Summary" class="headerlink" title="Course Summary"></a>Course Summary</h1><p>Congratulations. You’ve come to the end of Managing Code Quality and Security Policies with <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> DevOps. Let’s review what you’ve learned.</p>
<p>We kicked things off by looking at the definition of code quality. After defining what code quality means, we dove into what it takes to write high-quality code.</p>
<p>Next, we looked at what goes into code quality scanning and at how SonarCloud can help monitor code quality.</p>
<p>Once we worked through code quality scanning and through monitoring code quality, you saw a hands-on demonstration that showed you how to use SonarCloud in the pipeline.</p>
<p>As we progressed, we looked at what code coverage means and how to use the “Publish Code Coverage Results” task to report on code coverage.</p>
<p>Later on, we touched on security policies, where you learned about the OWASP and its Top-10 list. We took a look at 5 of the top entries in the OWASP Top-10.</p>
<p>We rounded things out by looking at a couple of popular security analysis tools.</p>
<p>At this point, you should have the foundational knowledge that is required to effectively Manage Code Quality and Security Policies with Azure DevOps.</p>
<p>To learn more about Managing Code Quality and Security Policies with Azure DevOps, you can, and should, read Microsoft’s published documentation. You should also keep an eye out for new courses on Cloud Academy, because we’re always publishing new ones. Be sure to give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching and happy learning.</p>
<h3 id="Lectures-7"><a href="#Lectures-7" class="headerlink" title="Lectures"></a>Lectures</h3><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/course-introduction/">Course Introduction</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/code-quality-defined/">Code Quality Defined</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/monitoring-code-quality/">Monitoring Code Quality</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/reporting-on-code-coverage/">Reporting on Code Coverage</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/the-owasp-top-ten/">The OWASP Top Ten</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/security-analysis-tools/">Security Analysis Tools</a> - <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-code-quality-and-security-policies-with-azure-devops-1114/demo-configuring-sonarcloud-in-a-pipeline/">DEMO: Configuring SonarCloud in a Pipeline</a></p>
<h1 id="6Security-Analysis-Tools"><a href="#6Security-Analysis-Tools" class="headerlink" title="6Security Analysis Tools"></a>6<strong>Security Analysis Tools</strong></h1><p><a target="_blank" rel="noopener" href="https://bolt.whitesourcesoftware.com/azure/documentation/#WhiteSourceBolt-Introduction">WhiteSource Bolt Introduction</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/18/AZ-400-Managing-Workstreams-Using-Projects-in-Azure-DevOps-15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/18/AZ-400-Managing-Workstreams-Using-Projects-in-Azure-DevOps-15/" class="post-title-link" itemprop="url">AZ-400-Managing-Workstreams-Using-Projects-in-Azure-DevOps-15</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-18 20:37:49" itemprop="dateCreated datePublished" datetime="2022-11-18T20:37:49-04:00">2022-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-23 21:36:34" itemprop="dateModified" datetime="2022-11-23T21:36:34-04:00">2022-11-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-400/" itemprop="url" rel="index"><span itemprop="name">AZ-400</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/18/AZ-400-Managing-Workstreams-Using-Projects-in-Azure-DevOps-15/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/18/AZ-400-Managing-Workstreams-Using-Projects-in-Azure-DevOps-15/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/63/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/63/">63</a><span class="page-number current">64</span><a class="page-number" href="/page/65/">65</a><span class="space">&hellip;</span><a class="page-number" href="/page/274/">274</a><a class="extend next" rel="next" href="/page/65/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
