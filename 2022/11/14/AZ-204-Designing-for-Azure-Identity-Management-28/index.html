<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="IntroductionWelcome to Designing for Azure Identity Management. My name is Thomas Mitchell and I’ll be taking you through this course on the key technologies to consider when designing an identity man">
<meta property="og:type" content="article">
<meta property="og:title" content="AZ-204-Designing-for-Azure-Identity-Management-28">
<meta property="og:url" content="https://example.com/2022/11/14/AZ-204-Designing-for-Azure-Identity-Management-28/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="IntroductionWelcome to Designing for Azure Identity Management. My name is Thomas Mitchell and I’ll be taking you through this course on the key technologies to consider when designing an identity man">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-11-14T15:30:51.000Z">
<meta property="article:modified_time" content="2022-11-15T13:31:52.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/2022/11/14/AZ-204-Designing-for-Azure-Identity-Management-28/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AZ-204-Designing-for-Azure-Identity-Management-28 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/AZ-204-Designing-for-Azure-Identity-Management-28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AZ-204-Designing-for-Azure-Identity-Management-28
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 11:30:51" itemprop="dateCreated datePublished" datetime="2022-11-14T11:30:51-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-15 09:31:52" itemprop="dateModified" datetime="2022-11-15T09:31:52-04:00">2022-11-15</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/AZ-204-Designing-for-Azure-Identity-Management-28/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/AZ-204-Designing-for-Azure-Identity-Management-28/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to Designing for Azure Identity Management. My name is Thomas Mitchell and I’ll be taking you through this course on the key technologies to consider when designing an identity management solution. I’m an Azure Content Author at Cloud Academy and I have over 25 years of deep IT experience, several of those with cloud technologies. If you have any questions, feel free to connect with me on LinkedIn, or send an email to <a href="mailto:&#115;&#117;&#112;&#112;&#x6f;&#x72;&#x74;&#64;&#99;&#x6c;&#x6f;&#117;&#x64;&#97;&#x63;&#x61;&#100;&#x65;&#x6d;&#121;&#46;&#x63;&#x6f;&#109;">&#115;&#117;&#112;&#112;&#x6f;&#x72;&#x74;&#64;&#99;&#x6c;&#x6f;&#117;&#x64;&#97;&#x63;&#x61;&#100;&#x65;&#x6d;&#121;&#46;&#x63;&#x6f;&#109;</a>. This course is intended for IT professionals who are interested in earning Azure certification, those who wish to become Azure architects, and those who are tasked with designing an Azure identity management solution. To get the most from this course, you should have at least a moderate understanding of Microsoft Azure, and of identity management concepts. We’ll kick off the course by discussing <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a> and what it offers. We will then talk a bit about hybrid identities and what purpose they serve. Next, we’ll cover Azure AD Domain Services and how to deploy this feature. </p>
<p>After covering Azure AD Domain Services, we’ll get into <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/single-sign-on-overview/">single sign-on</a>, and how to configure it for a web application. Azure MFA or multi-factor authentication is another cool feature that we will discuss. We’ll cover what it is, what it offers, and how to enable it. After covering MFA, we will get into Azure AD B2B and Azure AD B2C. These are Azure AD Business to Business and Azure AD Business to Consumer. You will learn what they are, what they offer, and how to deploy them. We’ll then move into Privileged Identity Management, otherwise known as PIM. Rounding out the course are topics on <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-password-reset/">self-service password reset</a>, self-service group management, and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/overview-of-managed-identities-for-azure-resources/">managed identities for Azure resources</a>. There are demonstrations sprinkled throughout the course. These demos will show you how to deploy and use the technologies covered. By the end of this course, you should have a good understanding of all key technologies and features as they relate to designing for Azure identity management. You should also be able to deploy each feature with an understanding of what it offers and how it fits into any identity management solution. We’d love to get your feedback on this course, so please give it a rating when you’re finished. If you’re ready to learn about Designing for Azure Identity Management, let’s get started.</p>
<h1 id="Introduction-to-Azure-AD"><a href="#Introduction-to-Azure-AD" class="headerlink" title="Introduction to Azure AD"></a>Introduction to Azure AD</h1><p>Microsoft’s Azure Active Directory is a cloud-based identity and access management service. With it, users can sign in and access external resources such as Office 365, the Azure portal, and other software as a service applications. Azure AD, of course, also allows users to access internal resources as well. Such resources include applications inside the corporate network and on the internet along with cloud applications that have been developed and deployed by your organization. Azure AD is used to control access to applications and resources according to business requirements. For example, Azure AD can be configured to require multi-factor authentication or MFA when a user needs access to important company resources. In addition, Azure AD can be used to automate user provisioning between an existing on-prem Windows server AD and corporate cloud applications like Office 365. With Azure AD, organizations have access to tools that can used to automatically help protect user identities and credentials which allows them to meet access governance requirements. Microsoft Online services like Office 365 and Microsoft Azure leverage Azure AD for sign-in and for identity protection. As such, an organization that subscribes to any of the Microsoft Online business services automatically gets at least the free version of Azure AD along with those services. </p>
<p>Adding paid services to a tenant can enhance an Azure AD implementation. Such paid services include Azure Active Directory Basic, Azure Active Directory Premium 1, and Azure Active Directory Premium 2. These Azure AD paid licenses ride on top of an existing free directory, and they can provide additional services such as self-service, security reporting, enhanced monitoring, and secure access for mobile users. One thing to note, however, is that while all of these added features can add cool functionality and security, Azure Active Directory Basic, Azure Active Directory Premium 1, and Azure Active Directory Premium 2 are not currently supported in China. The free version of Azure Active Directory offers basic user and group management functionality and on-prem directory synchronization. It also offers basic reporting and single sign-on or SSO across Office 365, Microsoft Azure, and many popular SaaS applications. In addition to the free features available in the Azure AD Free version, Azure AD Basic provides cloud-centric application access as well as group-based access management. Other features included with the Basic version include self-service password reset for cloud apps and Azure AD Application Proxy which is a feature that allows you to publish on-prem web applications using Azure AD. Azure Active Directory Premium P1 offers quite a bit more than either Free or Basic. In addition to what those versions offer, Azure AD Premium P1 offers hybrid users access to both on-prem and cloud resources. Premium P1 also supports advanced administration tasks like self-service group management, dynamic groups, and it even integrates with Microsoft Identity Manager or MIM. Microsoft Identity Manager is an advanced, on-prem identity and access management solution. </p>
<p>Azure AD Premium P1 also offers cloud write-back capabilities which are used to allow self-service password reset for your on-prem users. Azure Active Directory Premium P2 builds upon what is offered in the P1 edition by offering everything included in the Free, Basic, and P1 versions plus Azure Active Directory Identity Protection which helps provide risk-based conditional access to applications and critical company data. Azure AD Premium P2 also offers Privileged Identity Management or PIM which is useful for discovering, restricting, and monitoring administrators as well as their access to corporate resources. Privileged Identity Management also provides just-in-time access when it’s needed, meaning access to resources can be limited to only those times when it’s required and then be taken away automatically when the access is no longer needed. Other pay-as-you-go feature licenses such as Azure AD Business-to-Consumer are also available to assist with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a>. Azure AD B2C as it’s called helps provide identity and access management solutions for customer-facing applications.</p>
<h1 id="Create-Directory-and-Add-Custom-Domain"><a href="#Create-Directory-and-Add-Custom-Domain" class="headerlink" title="Create Directory and Add Custom Domain"></a>Create Directory and Add Custom Domain</h1><p>To create a new directory and add a custom domain for it, log into the Azure portal. While in the portal, open <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a> and click on the create a directory link. Provide an Organization name along with the domain to use for the directory. Select a country or region and then click create. Once the directory has been provisioned, click the link to manage the new directory and sign in if required to do so. From within Azure Active Directory click custom domain names and then add your custom domain name. Provide and internet routable custom domain name and then click add domain. </p>
<p>At this point you’re provided with the option to verify the domain via either a text record or an MX record. My preference is to typically use the text record. Copy the record value and then visit your domain’s DNS management console. Create a text record and supply the value that you were provided. Save your new text record and switch back over to Azure. Click the verify button to verify the domain using the DNS record that you’ve just created. After verifying the domain, set its primary. And then click yes to confirm.</p>
<h1 id="Azure-AD-Domain-Services-Overview"><a href="#Azure-AD-Domain-Services-Overview" class="headerlink" title="Azure AD Domain Services Overview"></a>Azure AD Domain Services Overview</h1><p>Azure AD Domain Services is a Microsoft cloud-based offering that provides managed domain services, such as domain join, group policy, LDAP, and Kerberos and NTLM authentication. The domain services provided are fully compatible with traditional on-prem Active Directory and they can be deployed without any need for deployment or management of domain controllers in the cloud. Azure AD Domain Services integrates with the existing <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> tenant and makes it possible for users to log in with their corporate credentials. Existing user accounts and groups can be leveraged to secure access to resources. As such, this offers a smoother transition of on-prem resources to Microsoft Azure. Companies leveraging a hybrid IT infrastructure will typically synchronize their <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity</a> information from their on-prem directories to the Azure AD tenant. As more of their on-prem applications are migrated to Azure, Azure AD Domain Services can become more useful. An important caveat to consider when deciding if Azure AD Domain services are the right solution is that password sync is mandatory for a hybrid organization to use Azure AD Domain Services. </p>
<p>This is required because users’ credentials are needed for authentication via NTLM and Kerberos in the managed domain that is provided by Azure AD Domain Services. When considering Azure AD Domain Services, keep in mind that the managed domain is actually a stand-alone domain. It is not, and I repeat, it is not an extension of the on-prem AD domain. This is a common misconception among IT professionals. Also, because the domain is managed, the IT administrator does not need to, nor can he, manage, patch, or monitor the domain controllers for the managed domain. Likewise, there is no need to manage or even monitor AD replication within the managed domain. Quite frankly, there really isn’t much for the administrator to do in the managed domain, especially since the administrator doesn’t even have Domain Admin or Enterprise Admin privileges on the managed domain.</p>
<h1 id="Deploy-Azure-AD-Domain-Services"><a href="#Deploy-Azure-AD-Domain-Services" class="headerlink" title="Deploy Azure AD Domain Services"></a>Deploy Azure AD Domain Services</h1><p>To deploy <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/azure-ad-domain-services-overview/">Azure AD Domain Services</a> log into the Azure portal. Once in the portal click on Create a Resource and then search for Domain Services. Select Azure AD Domain Services from the search results and then click Create. Provide the basic information for the domain, including the DNS name for the domain as well as the Subscription you are deploying to, along with a Resource group. You’ll also need to supply a Location. Click Okay to move onto the next step. At this point you’re prompted to create a Virtual network for the managed domain that you are setting up. Provide a name for the network along with an address space that works for your environment. You will also need to define a Subnet and a Subnet address range that you’d like to use for the managed domain. </p>
<p>The managed domain controllers and associated infrastructure that gets deployed by <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> as part of the Manage Domain setup will reside on this network and on this subnet. Click Okay and then Okay again. Next you are advised that the AAD DC Administrators group has been created. This group is used to manage the domain. It’s similar to but not quite like Domain Admins in an On-Prem Active Directory Domain. Click on the group to add members to it. When you’re done adding members that need to manage the domain go back and click Okay. This synchronization step has nothing to do with Azure AD Connect or with On-Prem AD if one exists. Instead, this synchronization step is meant to sync users and groups from Azure AD into Domain Services. You have a choice of syncing all users or scoping the sync to just certain groups. In this demonstration I’m just going to sync all users and groups from Azure AD to Domain Services. Clicking Okay takes you to the next step where you can review your options. Click Okay to commence the deployment of Azure AD Domain Services. </p>
<p>The actual deployment can take the better part of an hour because it’s deploying lots of stuff in the background. It’s deploying the network infrastructure that you’ve defined as well as two managed domain controllers. It’s also setting up the managed domain itself. After enabling Azure Active Directory Domain Services you need to enable computers within the Virtual Network to connect to and consume these services. To do so you need to update the DNS Server Settings for your Virtual Network so that it points to the two IP addresses where Azure Active Directory Domain Services are available. To update the DNS Server settings for the Virtual Network hosting your Azure Active Directory Domain Services browse to the Azure portal and open up your instance of Azure AD Domain Services. The Overview tab will list a set of required configuration steps. One of those is to update the DNS Server settings for the Virtual Network. You will be presented with two different IP addresses. These are the IP addresses where Azure AD Domain Services is available. These are essentially the managed domain controllers that were stood up as part of the deployment of Azure AD Domain Services. After making a note of these IP addresses, click the Configure button and update the DNS Server settings for the Virtual Network. With Azure AD Domain Services provisioned and your DNS updated you can now move on and enable password hash synchronization using Azure AD Connect.</p>
<h1 id="A-Word-About-Personas"><a href="#A-Word-About-Personas" class="headerlink" title="A Word About Personas"></a>A Word About Personas</h1><p>Personas can be an important tool that drives adoption and business value realization. What happens quite often is that organizations deploy technology solutions without a full understanding of the users that those solutions are intended for. When this happens, the deployed solutions do not get used, and the value of those solutions goes unrealized.</p>
<p>If an organization deploys an Azure solution, but nobody uses it, the organization doesn’t realize the value – and it becomes a waste. In order to generate value from an Azure solution, an organization must determine what users should START doing or STOP doing, in order to realize the value of the solution.</p>
<p>Essentially, its user behavior change that becomes the yardstick for evaluation, adoption, and use of solutions deployed in Azure. Personas can be useful when trying to drive adoption of new Azure solutions.</p>
<p>A persona is really just a fictitious character that represents a certain user type. Personas refer to the “who” when discussing an organization. The use of personas helps organizations characterize different sets of users, and to capture details about what a typical day looks like to those users. Personas can be used to capture the pains, needs, and desired outcomes that users have as they perform their daily tasks. </p>
<p>To build personas that reflect the workforce, organizations need to communicate with end users. Organizations need to know how work currently gets done in order to deploy Azure solutions that help users get that work done. Defining personas for each user type can help organizations accomplish this. More specifically, from an Azure perspective, an organization can build personas to assist with the creation of roles. By defining different personas, the organization has better visibility into what roles are necessary – and if custom roles are needed.</p>
<p>As a result, organizations can realize more value when deploying Azure solutions, because the solutions that are deployed can then be tailored to the users for whom the solutions are intended. Management of those solutions can be streamlined via built-roles that match the defined personas, or via custom roles, when the built-in roles are not sufficient.</p>
<h1 id="Hybrid-Identities"><a href="#Hybrid-Identities" class="headerlink" title="Hybrid Identities"></a>Hybrid Identities</h1><p>As the move to the cloud gathers steam, corporations are finding themselves supporting a mixture of on-prem and cloud applications. Users obviously are finding themselves requiring access to those applications as well. This, of course, becomes a challenge to implement. The <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity</a> solutions we previously discussed are solutions that span on-prem and cloud-based capabilities. Leveraging these solutions allows an organization to create a common user identity for authentication and authorization to all resources, regardless of whether they are on-prem or in the cloud. This concept is called hybrid identity. Achieving hybrid identity requires the development of one of three authentication methods. The authentication method that is deployed is dependent on the specific scenario being addressed. The three authentication methods include Password Hash Synchronization, Pass-Through Authentication, and Federation. Password Hash Synchronization is also referred to as PHS, while Pass-Through Authentication is referred to as PTA. Federation is referred to as, well, Federation. Password hash synchronization is a sign-in method used as part of a hybrid identity solution. This is accomplished with Azure AD Connect by synchronizing a hash, of the hash, of a user’s on-prem AD password to a cloud-based <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> instance. This feature is useful for signing in to Azure AD services like Office 365 with the same password as an on-prem AD account, which reduces end-user impact. The password hash synchronization strategy reduces, to just one, the number of passwords that an organization’s users need to maintain. As such, password hash synchronization can improve user productivity and reduce helpdesk costs. Password hash synchronization, which is the most common hybrid identity solution, requires an organization to install Azure AD Connect. </p>
<p>Once Azure AD Connect is installed, directory synchronization between the on-prem Active Directory instance and the Azure Active Directory instance is configured. As part of the synchronization configuration, password hash synchronization is enabled. Azure AD Pass-through Authentication, or PTA, much like Password Hash Synchronization, allows users to sign in to both on-prem and cloud-based apps with the same password. And much like password hash synchronization, this option offers a better end user experience. However, pass-through authentication validates user passwords directly against the on-prem Active Directory, instead of using a synced password hash. A key benefit of pass-through authentication over password hash synchronization is that it affords organizations the ability to enforce their on-prem AD security and password policies, since pass-through authentication is actually leveraging the on-prem credentials. By combining Pass-through Authentication with Seamless Single Sign-On, organizations can allow users to access applications on corporate machines inside the network without the need to type in their passwords again. Azure AD Pass-through Authentication provides an improved end-user experience because it offers end users the ability to complete self-service password management tasks in the cloud. Deployment and administration are easy because Pass-Through Authentication only requires a lightweight agent to be installed on-prem. Since the agent automatically receives updates, there is no management overhead. Pass-Through Authentication offers improved security over Password Hash Synchronization because on-prem passwords are never stored in the cloud. </p>
<p>Because it works with Azure AD Conditional Access policies, including MFA, Pass-Through Authentication offers additional account protection. Another benefit of Pass-Through Authentication is the fact that the agent only makes outbound connections from the network, removing all requirements for a DMZ as part of a solution. Communication between the on-prem agent and Azure AD is secured via cert-based authentication, which adds another layer of security. Further, the certificates that are used are automatically renewed every few months by Azure AD, removing the requirement to manually maintain them. In addition to high security, Azure AD Pass-Through Authentication offers high availability by allowing the installation of additional agents on multiple on-prem servers. Federation is a bit different from the other two solutions. It is a collection of domains with an established trust, which typically includes authentication, and almost always includes authorization. In a common configuration, a federation might include multiple organizations that have established trust for shared access to a specific set of resources. Federating an on-prem environment with Azure AD allows and organization to use the federation for authentication and authorization. Federation ensures that all user authentication happens on-prem and it provides administrators with the ability to implement more rigorous levels of access control. Federation with ADFS and PingFederate is available. To protect against a failure of the ADFS infrastructure when using federation with ADFS, organizations can set up password hash synchronization, or PHS, as a backup. Doing so allows authentication to continue, despite an ADFS infrastructure failure. All three of these authentication methods including PHS, PTA, and Federation provide single-sign on capabilities, which automatically signs users in when they are on their corporate devices inside the corporate network.</p>
<h1 id="DEMO-Managing-Users-Groups-and-Devices-in-Azure-AD"><a href="#DEMO-Managing-Users-Groups-and-Devices-in-Azure-AD" class="headerlink" title="DEMO: Managing Users, Groups, and Devices in Azure AD"></a>DEMO: Managing Users, Groups, and Devices in Azure AD</h1><p>Hello and welcome back! In this brief demonstration, I just wanted to walk you through the process of managing users and groups within Azure Active Directory. Now on the screen here, you can see I’m logged into my Azure Portal for the directory called Test9878.org. This is the custom domain I’m using for my Azure AD here.</p>
<p>Now to get to this screen from Azure, what I’ll do here is I’ll bounce back out to my homepage and here’s the homepage. To get into Azure AD, I can simply select Azure Active Directory from the top here, or I can go to the hamburger and select Azure Active Directory.</p>
<p>So from this overview page, I can browse to lots of different pieces of Azure AD. Under the manage section is where I’ll manage my users and groups along with devices, app registrations, all of this fun stuff where you’ll do your day to day management of your Azure Active Directory. Down the bottom is where you’ll perform your monitoring. And then down at the very bottom, you’ll do your troubleshooting and support.</p>
<p>So from this page, let’s go ahead and create a user in Azure Active Directory. And to do that, it’s pretty straight forward. We simply select users here. And from this screen, we can see all of the existing users in our AD.</p>
<p>We can see, we have two accounts here. One is an admin in the actual Azure Active Directory as shown here under source. The ThomasMitchell.net account is actually an external Azure Active Directory account from another directory.</p>
<p>What we’re going to do here is create a new user and we’ll just call this Dave. And in this dropdown we can select the actual domain name we want to use, we’re using the custom domain, so we’ll leave it at Test9878.org and we’ll give our username. And then we have the option to auto-generate a password or create one, we’ll leave the auto-generate here. And this will show us what the password is.</p>
<p>We can then provide that password to the new user. I would not send this out via any kind of electronic methods when possible. That’s obviously a security risk. As we create our user, we can then select a group to add our user to. So we’ll go ahead and make him a user within our box users group.</p>
<p>This is actually a group I created earlier for some other demonstration. So we’ll go ahead and we’ll select him. So now what we’re doing here is creating our <a href="mailto:&#x44;&#97;&#x76;&#x65;&#64;&#84;&#x65;&#115;&#116;&#57;&#x38;&#55;&#56;&#46;&#111;&#x72;&#x67;">&#x44;&#97;&#x76;&#x65;&#64;&#84;&#x65;&#115;&#116;&#57;&#x38;&#55;&#56;&#46;&#111;&#x72;&#x67;</a>, we’re auto generating a password and we’re placing this new user in the box users group.</p>
<p>The block sign in is pretty self explanatory. We can either block sign in by selecting yes or allow sign-ins by leaving the no option selected here. And then we have some additional info we can add. We can add a job title in a department.</p>
<p>We can also specify the usage location. So we’ll go ahead and we’ll select United States down here. And we’ll go ahead and create the user. And at this point, we now have a new user in our directory. If we select our user from our list, we can then look at the user’s profile, which includes his identity, his job information, any kind of special settings, contact info. This is where we manage this information as far as the profile goes.</p>
<p>We can then go into assigned roles where we can actually look at any roles that have been assigned to this user. And we can add assignments. You can see all of the different directory roles here that are included by default.</p>
<p>Now we can also see, we can assign custom roles, but if you look at the little icon up here, it tells us that if we want to assign custom roles to a user, the organization needs Azure AD Premium P1 or P2. I’m using the free Azure edition right now. But if he wanted to make, you know, Dave an application administrator, we simply check the box and add the role. And now we can see under assigned roles for Dave, we have application administrator, and of course the description tells us what an application administrator can do.</p>
<p>If we want to remove this assignment for this user, we select the assignment and remove it. Now, if we go back out to our directory, let’s take a look at groups and how we can manage groups here. By selecting groups, we can look at what groups are currently defined within our Azure AD.</p>
<p>If we want to create a new group, we simply select a new group and we can choose whether it’s a security group or an office 365 group. We’ll leave this at security and we’ll just call this marketing. And we’ll give it a description. We can see, we currently have no owners or members defined for this group.</p>
<p>So we’ll go ahead and select an owner. We’ll just make myself an owner here. And then we’ll add a new member. Let’s go ahead and add Dave. And then we create it. So now we have a new group called marketing. It’s a security group and the membership type here is assigned, which means we’re going to manually add and remove users from this group. So we’ll go ahead and select marketing here. And from here, we can look at the different properties of this group.</p>
<p>We can see when it was created, the membership type, whether it’s a cloud sourced group and what type of group it is. We can see the different direct members and any kind of group memberships. We look at properties here. We can see here, we have the name and we can actually change it here. And the description, and then members and owners will tell us who the members are and who the owners are.</p>
<p>If we select group memberships here, we can see that the marketing group is not a member of any other groups. So this is where you could see group nesting. Now in this applications area, we can see what applications are assigned to our group. So if we have a group of users that needs access to a specific application, we can create that group, assign the application to that group, and then add users to that group.</p>
<p>Any users that get added to that group are the ones that will get access to the application. Same thing with licensing. We can assign licenses to specific groups. So whatever users get added to that group also get those licenses. And same thing for Azure roleassignments.</p>
<p>So that’s the quick and dirty on how to create users and groups and how to manage them through the Azure Portal for Azure Active Directory. And before we run away here, let’s just take a look at devices.</p>
<p>Now, this devices page is where you manage any devices that are joined to your Azure AD. We can see here, I have a workstation that has been joined. And if I select that workstation, I can take a look at its device ID, its object ID, and all kinds of information about this specific device. I can then even disable the device so it’s no longer able to access Azure AD. We’re not going to do that here, but we will bounce back to our directory.</p>
<p>Now from this Azure Active Directory overview page, you can also manage password resets, manage Azure AD connect. You can take a look at the provisioning status. You can manage your custom domain names, even managed company branding. So there’s a lot you can do from your Azure Active Directory page here. And this is where all of your management will happen.</p>
<p>All of your users, all of your groups, all of your devices, all of your branding, all of your domains, all this stuff is done right here from this Azure Active Directory page. So I really recommend that you go in and you play around in here and kind of learn what you can do and do some experimentation because you really want to try to get some stick time to get a real good understanding of all of the different features in Azure Active Directory.</p>
<h1 id="Deploy-Azure-AD-Connect"><a href="#Deploy-Azure-AD-Connect" class="headerlink" title="Deploy Azure AD Connect"></a>Deploy Azure AD Connect</h1><p>In this demonstration, we’re going to deploy Azure AD Connect so we can sync our on-prem active directory users to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a>. We are also going to need to ensure that we synchronize NTLM and Kerberos credential hashes to Azure AD, since this isn’t done by default. To get started, login to the server that will run Azure AD Connect and download the Azure AD Connect software. Launch the Azure AD Connect installer that you downloaded. Because our lab environment in a single forest with an internet routable domain name, we can use the express option. </p>
<p>When prompted, we’ll connect to Azure AD by providing our global admin <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">credentials</a>. And then, we can then connect to the on-prem AD by providing an enterprise admin credential. Clicking install begins the setup of Azure AD Connect. When the installation completes, click Exit. Because Azure AD Connect does not by default synchronize NTLM and Kerberos credential hashes to Azure AD, we must ensure that these hashes get synchronized if we want to use Azure AD Domain Services. To enable synchronization of the required credential hashes from your on-premises directory to the Azure AD tenant, run the script that you see on your screen:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$adConnector = &quot;&lt;CASE SENSITIVE AD DS CONNECTOR NAME&gt;&quot;</span><br><span class="line">$azureadConnector = &quot;&lt;CASE SENSITIVE AZURE AD CONNECTOR NAME&gt;&quot;</span><br><span class="line">Import-Module -Name &quot;C:\Program Files\Microsoft Azure AD Sync\Bin\ADSync&quot;</span><br><span class="line">$c = Get-ADSyncConnector -Name $adConnector</span><br><span class="line">$p = New-Object Microsoft.IdentityManagement.PowerShell.ObjectModel.ConfigurationParameter &quot;Microsoft.Synchronize.ForceFullPasswordSync&quot;, String, ConnectorGlobal, $null, $null, $null</span><br><span class="line">$p.Value = 1</span><br><span class="line">$c.GlobalParameters.Remove($p.Name)</span><br><span class="line">$c.GlobalParameters.Add($p)</span><br><span class="line">$c = Add-ADSyncConnector -Connector $c</span><br><span class="line">Set-ADSyncAADPasswordSyncConfiguration -SourceConnector $adConnector -TargetConnector $azureadConnector -Enable $false</span><br><span class="line">Set-ADSyncAADPasswordSyncConfiguration -SourceConnector $adConnector -TargetConnector $azureadConnector -Enable $true</span><br></pre></td></tr></table></figure>

<p>What this script will do is enable all on-premises users’ NTLM and Kerberos password hashes to be synchronized to the Azure AD tenant. This script will also initiate a full synchronization in Azure AD Connect. </p>
<p>The values for $adconnector and $azureadconnector variables can be found in the Azure AD Connect synchronization service manager. What I’ve done is create a PowerShell script called NTLMSync.ps1. This script includes all of these commands. I just need to open PowerShell on the Azure AD Connect server to run the script. The output tells me that the password hash sync configuration has been updated.</p>
<h1 id="Azure-Role-Based-Access-Control"><a href="#Azure-Role-Based-Access-Control" class="headerlink" title="Azure Role-Based Access Control"></a>Azure Role-Based Access Control</h1><p>Hello and welcome back. A tool that goes hand-in-hand with Azure active directory is Azure role-based access control, or RBAC. Azure RBAC is used to manage who has access to what resources and to manage what those users can do with those resources. It’s an authorization system that is built upon Azure resource manager, and it offers fine-grained access management to your Azure resources.</p>
<p>Azure RBAC relies on role assignments for access control. Each role assignment consists of three parts, a security principal, a role definition, and a scope.</p>
<p>The Security principal is essentially an object that represents either a user, a group, a service principal, or a managed identity that requires access to resources in Microsoft Azure. </p>
<p>The role definition is essentially a collection of permissions. Role definitions are usually referred to simply as roles. A specific role will list the operations that can be performed by someone with that role. These operations include things like read, write, and delete.</p>
<p>Although there are many built-in roles in Azure that you can use, there are four fundamental roles available. These fundamental roles include owner, contributor, reader, and user access administrator. A person assigned the owner role has full access to all resources, including the rights to delegate access to others. A person assigned the contributor role can create and manage all kinds of Azure resources. However, a contributor cannot grant access to those resources to other users. The reader role allows you to view existing Azure resources, while the user access administrator role allows you to manage user access to your Azure resources.</p>
<p>In addition to the built-in roles you can also create custom roles. This allows you to tailor access to your resources in a way that best suits your organization.</p>
<p>A scope is a set of resources that the access you are setting up applies to. For example, you may provide access to a scope that includes a subscription or maybe a resource group or even a specific resource. A scope in Microsoft Azure can be specified at the management group level, the subscription level, the resource group level, or to specific resources. Because scopes are structured in parent-child relationship, access that is granted at the parent scope level will be inherited by the child scopes.</p>
<p>The process that Azure RBAC uses to determine if a user has access to a specific resource is pretty straightforward. First, the user requesting the access acquires a token from Azure resource manager. This token includes any group memberships for the user. </p>
<p>Next, the user makes a rest API call to Azure resource manager with the attached token.</p>
<p>What Azure resource manager will do next is retrieve all the role assignments and deny assignments for the resource that the user is trying to access. Azure resource manager will then narrow those role assignments down to only those that apply to the user or to groups that the user is a member of. It will also determine which roles have been assigned to the user for the resource being accessed.</p>
<p>Next, Azure resource manager will determine whether or not the requested action in the API call is allowed by the role that the user has for the specific resource being accessed.</p>
<p>Assuming the user is assigned a role that allows the action being requested at the requested scope, access is granted. Otherwise, access is blocked.</p>
<p>Azure RBAC is free and is included with all Azure subscriptions.</p>
<p>To learn more about Azure RBAC, visit the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/azure/role-based-access-control/overview">URL</a> that you see on your screen.</p>
<h1 id="Single-Sign-On-Overview"><a href="#Single-Sign-On-Overview" class="headerlink" title="Single Sign-On Overview"></a>Single Sign-On Overview</h1><p>Unless an organization deploys a single sign-on solution, its users will be required to remember multiple usernames and passwords, one for each different application in use. Additionally, the IT department needs to maintain all of these different accounts and passwords manually. Single sign-on allows users to sign in once with one account in order to access domain-joined devices, corporate resources, SAS applications, and even web apps. After signing in, users can then launch apps right from the O365 portal or via the MyApps access panel. With single sign-on, IT administrators can centralize user account management, allowing them to automatically add or remove user access to applications based on group membership. In this lecture, we are going to discuss the various single sign-on options that are available when designing an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a> solution that incorporates single sign-on. </p>
<p>Choosing a single sign-on solution for an application will largely depend on how the application is configured for authentication. Of all the single sign-on methods we are about to discuss, disabled is the only one that does not automatically sign users into applications without requiring a second sign-on to occur. When deciding on a single sign-on solution, it’s important to know that cloud apps can use SAML, password-based, linked, and disabled methods for single sign-on. Of the bunch, SAML is the most secure method. On-prem apps, when configured for Application Proxy, can use password-based, Integrated Windows Authentication, or IAW, header-based, linked, or the disabled methods for single sign-on. The table that you see on your screen provides a summary of the single sign-on methods that are available. Use SAML for single sign-on whenever possible. </p>
<p>This method works when applications are configured to use a SAML protocol. Use password-based single sign-on when an application authenticates with a username and password. Using password-based single sign-on offers secure application password storage and replay via a web browser extension or via mobile application. Password-based single sign-on uses the existing sign-in process that’s provided by the application while allowing an administrator to manage the passwords for it. The linked single sign-on method is useful when an application is configured for SSO in another identity provider service. This SSO option doesn’t add single sign-on to the application. Use disabled single sign-on when an application isn’t ready for single sign-on. Users of the application will need to provide their username and password each time they launch the application.</p>
<p> Use IWA SSO for applications that use Integrated Windows Authentication or for claims-aware applications. When using this method for SSO, Application Proxy connectors use Kerberos Constrained Delegation to authenticate users to the application. Header-based single sign-on should be used when an application uses headers for authentication. It should be noted that header-based single sign-on requires PingAccess for Azure AD. When using header-based SSO, Application Proxy uses <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> to authenticate the user and then passes traffic through the connector service.</p>
<h1 id="Enable-Single-Sign-On-for-Dropbox"><a href="#Enable-Single-Sign-On-for-Dropbox" class="headerlink" title="Enable Single Sign-On for Dropbox"></a>Enable Single Sign-On for Dropbox</h1><p>In this demonstration, we’re going to walk through the process of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">enabling</a> single sign-on for an application. We’re going to enable single sign-on for Steven Davis so that he can access his Dropbox for Business account. To configure single sign-on for Dropbox, browse to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. From here, click on Enterprise applications, and then click New application. Find the Dropbox application in the gallery, and then select the application and click Add. After adding the application to Azure, click Single sign-on located under Manage. Select SAML to open the SAML configuration screen. Retrieve the sign on URL from the application vendor and provide that URL in the Sign on URL field for the application in Azure. Provide an identifier value. In this case, we’ll just use the word Dropbox. And then next, download the SAML signing certificate from Azure. This certificate needs to be provided to the application vendor. After downloading the certificate, switch over to the application vendor’s configuration dashboard and provide the certificate you downloaded. </p>
<p>The type of certificate you download will be largely dependent on the application itself so you’ll need to refer to the vendor’s documentation for setting up single sign-on. Retrieve the login URL for the application from Azure and provide it to the application. Save the application configuration, and then after the configuration is complete in both Azure and the app vendor’s portal, you can go ahead and test the login. To test single sign-on, assign a user to the application in Azure by clicking Users and groups within the application’s Azure dashboard. Find a user and then click Assign. Ensure that there is a user account for the assigned user also configured in the application itself. Next, open an incognito window and launch the application panel and login as the user to whom the application was assigned. Launch the application from the application panel and confirm that single sign-on works.</p>
<h1 id="MFA-Overview"><a href="#MFA-Overview" class="headerlink" title="MFA Overview"></a>MFA Overview</h1><p>Two-step verification provides a layered approach to security. Even the most enterprising attacker would have problems compromising multiple authentication factors, because, even if the attacker obtains a user’s password, the password would be useless without also being in possession of the additional authentication method, a mobile phone, for example. Multi-factor authentication works by requiring two or more authentication methods, which typically include something like a password that the user knows, something the user owns, typically a mobile phone, and something the user is, biometrics, for example. Azure MFA offers the ability to safeguard access to apps and data while maintaining a simple end-user experience. By providing additional security via a second form of authentication, MFA provides much sought after security for end-user authentication, and it does so via a range of easy to use authentication methods, including passwords, security questions, email address, application, OATH hardware token, SMS, voice call, and app passwords. Multi-Factor Authentication comes as part of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> Premium.</p>
<p> A subset of MFA capabilities is also available as part of an Office 365 subscription and as a means to protect Global Administrator accounts. As part of Azure AD Premium, Azure MFA is offered in two flavors, including the Azure Multi-Factor Authentication Service, which is cloud-based, and the Azure MFA Server option, which is a good option for organizations who have deployed ADFS and that want to or need to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">manage</a> MFA on-prem. Because most users are used to using only passwords to authenticate to applications and services, it’s critical that an organization communicate with the user base when rolling out an MFA solution. Doing so will invariably reduce the number of helpdesk calls that come in during any MFA rollout. Now, despite the best laid plans and deployments, there will be times when you may need to disable MFA in a one-off scenario. For example, if a user can’t sign in because he has lost access to his authentication methods, a lost phone, for example, in such a case, you could use a conditional access policy for Azure MFA. </p>
<p>With a conditional access policy in place, you can create a user group that is excluded from the policy that requires MFA. Placing the user in the excluded group would temporarily allow access until MFA functionality or access can be restored. A way to temporarily bypass MFA for Azure MFA Server users is to allow them to authenticate without two-step verification. Such a bypass can be configured but it expires after a specified number of seconds. Two-step verification prompts can be minimized for users that are on the local network. This can be accomplished with trusted IPs or named locations. By leveraging this features, an administrator for a managed or federated tenant can bypass two-step verification for users that are signing in from a trusted network location.</p>
<h1 id="Enable-MFA-for-O365-User"><a href="#Enable-MFA-for-O365-User" class="headerlink" title="Enable MFA for O365 User"></a>Enable MFA for O365 User</h1><p>In this demonstration, we’re going to enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">Multi-Factor Authentication</a> for an Office 365 user, so you can see how the process works and have a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">log in</a> process works once it’s been enabled. To enable Multi-Factor Authentication for an Office 365 user, open the Office 365 admin portal as a global administrator. Click on Users, and then Active Users. Find the user in the list for whom you wish to enable MFA and double click that entry. On the user’s property page, down at the bottom, click “manage multi-factor authentication”. Select the user in the multi-factor authentication screen and click Enable. Confirm that you want to enable multi-factor authentication by clicking the enable multi-factor auth button, and then close the box out. You’ll notice that the multi-factor auth status now shows enabled for this particular user. Open an incognito browser window and launch the Office 365 portal. Login as the user for whom you just enabled MFA. If you’ve configured MFA properly, the user, Steve in this case, will be prompted for more information before being allowed to login. Continue the login process by providing the information requested. Be sure to save the application password, so that it can be used for other applications if necessary, and then go ahead and click Done. After providing the MFA info, you’re prompted to log back in. Log back in, and be sure to supply the proper MFA info. As you can see on your screen, MFA is now working for Steve.</p>
<h1 id="Azure-AD-B2B"><a href="#Azure-AD-B2B" class="headerlink" title="Azure AD B2B"></a>Azure AD B2B</h1><p>Azure Active Directory Business-to-Business collaboration, also known as Azure AD B2B, allows an organization to securely share company applications and company services with guest users from other organizations while retaining control over company data. With Azure AD B2B, an organization can work with external partners, even if they don’t use Azure AD. The invitation and redemption process of Azure AD B2B allows users in a partner organization to use their own credentials to access a company’s resources. Because the partner organization uses its own <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a> solution, external administrative overhead for the sharing organization is essentially non-existent. There’s no requirement to manage external accounts or passwords, nor is there a need to synchronize accounts or manage account lifecycles. When guest users are invited to access resources in a partner organization, they sign into the shared applications and services with their own identities. Guest users without a Microsoft account or Azure AD account have one created for them when they redeem their invitations. Inviting a guest user to access an app or service, using AD B2B, is as simple as sending an invite to the guest user, using the guest user’s email address.</p>
<p>The guest user then follows a few easy redemption steps to sign in. Azure AD B2B offers the ability to use authorization policies to protect corporate content. Conditional access policies like <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">MFA</a> can be used to protect corporate applications and data. Such policies can be enforced at the tenant level, the application level, and even for specific guest users. With Azure AD B2B, administrators can add guest users to the organization right from the Azure portal. When the administrator creates the new guest user, which is done in a similar fashion to adding a new internal user, the guest user receives an invitation that allows him to sign into the Access Panel for that user. Guest users can be assigned to apps and even groups. By delegating guest user management to application owners, you can reduce the workload of the Azure administrators in your organization. Delegating user management allows application owners to add guest users to any application that they want. By delegating guest user management to application owners, you can reduce the workload of the Azure administrators in your organization. Delegating user management allows application owners to add guest users to any application that they want to share, even if it’s not a Microsoft application. To make this work, an administrator needs to set up self-service app and group management. Once this has been configured, non-admins can use their Access Panel to add guest users to applications or to groups.</p>
<h1 id="Add-Guest-Users-to-the-Directory"><a href="#Add-Guest-Users-to-the-Directory" class="headerlink" title="Add Guest Users to the Directory"></a>Add Guest Users to the Directory</h1><p>In this demonstration, we’re going to add a guest user to our Azure AD. To add a guest user, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">log in</a> to the Azure portal and browse to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. Click users and then click new guest user. Provide the new guest users email address and then click Invite. The user you’ve invited receives an invite email. Upon clicking the get started button in the invite email, the guest user is prompted to accept the invite. After accepting the invite, the guest user is taken to the applications pane, where he will be able to access applications that ultimately get assigned to him.</p>
<h1 id="Azure-AD-B2C"><a href="#Azure-AD-B2C" class="headerlink" title="Azure AD B2C"></a>Azure AD B2C</h1><p>Azure Active Directory Business-to-Consumer, also known as Azure AD B2C, is an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">identity management</a> service that offers organizations the ability to customize and control how customers interact with corporate applications. It allows organizations to control how users sign up, sign in, and how they manage their profiles when using the applications. Azure AD Business-to-Consumer enables this functionality while also protecting customer identities. Applications registered with Azure AD B2C can be configured to handle many identity management tasks. </p>
<p>For example, you can allow users to sign up to use a registered application, you can enable a signed-up user to edit his profile, and you can even enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">MFA</a> in the application. Other identity management tasks that can be handled include allowing users to sign up and sign in with specific identity providers, such as Facebook, for example. You can even customize the look and feel of the signup experience for users, as well as the sign-in experience. Azure AD B2C completes identity tasks by interacting in sequence with identity providers, also known as IdPs. It also interacts with users, other systems, and with the local directory. The Identity Experience Framework establishes multi-party trust and completes these steps. Along with a Trust Framework policy, this framework defines the actors, actions, protocols, and sequence of steps that need to be completed in order to make things work. Azure AD B2C makes use of SYN cookies and rate and connection limits to protect against denial-of-service and password attacks against applications. It also includes mitigation for brute-force password attacks, as well as dictionary password attacks. </p>
<p>A service that authenticates customer identities and issues security tokens is called an identity provider. Azure AD B2C offers the ability to configure several different identity providers in the tenant. Common identity providers include Microsoft accounts, Facebook, and even Amazon. Before configuring an identity provider in an Azure AD B2C tenant, the application identifier, client identifier, password secret, and client secret, or a combination of each, depending on the identity provider itself, must be recorded from the identity provider application that is created. This identifier information is then used to configure the application that will be accessed via the identity provider being configured. Every Azure AD B2C tenant is distinct and separate from other Azure AD B2C tenants. To leverage the features of AD B2C, you must deploy a B2C tenant, and link it to your Azure subscription. If you wish to allow users to sign in to an application using Facebook, Amazon, or some other identity provider, you must first register the application in the Azure AD B2C tenant.</p>
<h1 id="Create-a-Link-and-Azure-AD-B2C-Tenant"><a href="#Create-a-Link-and-Azure-AD-B2C-Tenant" class="headerlink" title="Create a Link and Azure AD B2C Tenant"></a>Create a Link and Azure AD B2C Tenant</h1><p>In this demonstration, we are going to create a new <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/azure-ad-b2c/">Azure B2C</a> tenant and then, we’re going to link the new B2C tenant to our <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure subscription</a>. To get started, login to the Azure portal and make sure you’re in the directory that contains the Azure subscription. We only have one subscription here, so we’re good on that front. Click create a resource and then search for Azure Active Directory B2C. Click on Azure Active Directory B2C in the search results and then click create. Choose the option to create a new Azure AD B2C tenant. Provide an organization name and a domain name. Select a region and then click create. After creating the Azure AD B2C tenant, you now have to link it to your Azure subscription. While, again, ensuring you’re in the directory that contains your Azure subscription, create a new resource and search for Azure AD B2C, just as you did the first time. Click on Azure SD B2C in the results and click create. This time, however, choose the second option to link an existing Azure AD B2C tenant. In the Azure AD B2C tenant dropdown, choose the B2C tenant that you created earlier. Leave the subscription where it’s at and then select a resource group. Click create to complete the linking process. When the process completes, click Go to resource to manage the newly created B2C tenant.</p>
<h1 id="Privileged-Identity-Management"><a href="#Privileged-Identity-Management" class="headerlink" title="Privileged Identity Management"></a>Privileged Identity Management</h1><p>Azure Active Directory Privileged Identity Management, otherwise known as PIM, is an Azure offering that allows you to manage and control access to resources within <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a>, as well as within other services, such as Intune and Office 365. A valid Azure AD Premium P2 license is required for all users that will interact with or benefit from Privileged Identity Management before enabling the service on a tenant. Alternatively, you can assign an Enterprise Mobility + Security E5 license for each user that interacts with Privileged Identity Management. Generally speaking, licensing is required for users that are assigned to the Privileged Identity Role Administrator role or who are assigned as eligible to other directory roles that are manageable through Privileged Identity Management. If a user can approve or reject requests in Privileged Identity Management, that user also requires a license. Users assigned to a role with time-based assignments, such as Just in time or Direct, or those assigned to an access review role, also require licensing. With Azure AD Privileged Identity Management, an organization can see which users are assigned privileged roles that are used to manage Azure resources. Organizations can also see which users are assigned administrative roles within Azure Active Directory. </p>
<p>Privileged Identity Management also offers the ability to enable on-demand, or just in time, administrative access to services such as Office 365 and Intune, as well as to Azure subscriptions, resource groups, and even individual Azure resources, like virtual machines and such. Azure AD Privileged Identity Management offers the ability to view a history of administrator activation, along with a history of changes that administrators have made to Azure resources. Alerts can also be configured to notify you about changes in administrator assignments. Privileged Identity Management also allows you to require approval for activation of Azure AD privileged admin roles, to review membership of such administrative roles, and to force users to provide justification for ongoing membership in these roles. In Azure Active Directory, Privileged Identity Management can be used to manage users that are assigned to built-in Azure AD roles, such as Global Admin. In Azure itself, Privileged Identity Management can manage users and groups assigned via Azure RBAC roles, such as the Owner and Contributor roles.</p>
<h1 id="Enable-PIM-and-Manage-Subscriptions"><a href="#Enable-PIM-and-Manage-Subscriptions" class="headerlink" title="Enable PIM and Manage Subscriptions"></a>Enable PIM and Manage Subscriptions</h1><p>In this demonstration, we’re going to enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/privileged-identity-management/">Privileged Identity Management</a>, and we’re going to set up a subscription to be managed by Privileged Identity Management. To enable Privileged Identity Management or PIM for short, Login to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> portal, and then click on All services and search for privileged identity management. Click on the Azure AD privileged identity management in the search results. Next, click on “consent to PIM” and then verify your identity when prompted to do so. Provide the additional security verification info that is requested and then click Next. Click Verify to verify your information. At this point you’re taken back to the PIM consent screen. To complete the consent process, click the “consent” link and then click Yes to confirm. With PIM enabled, you can now sign up for PIM for Azure AD role management. To do so, click on Azure AD roles, under Manage. Click sign up for PIM in the left pane and then click the sign-up link at the top. When prompted to confirm, click Yes. After setting up PIM to manage AD roles, you need to discover resources in the subscription, so they, too, can be managed with PIM as well. To do this, go back to the quick start page and click Azure Resources. In this demo, here, we’re going to manage all resources in the subscription. Click Discover Resources and then select the subscription. Click Manage Resource to onboard the resource for management, and then click Yes to confirm. At this point, you’ve deployed PIM and configured Azure AD roles and Azure resources to be managed by it.</p>
<h1 id="Self-Service-Password-Reset"><a href="#Self-Service-Password-Reset" class="headerlink" title="Self-Service Password Reset"></a>Self-Service Password Reset</h1><p>Self-service password, or SSPR, is pretty self-explanatory. This feature allows end users to reset forgotten passwords without the need for a call to the help desk. It’s a feature that many organizations request, as it helps provide a more streamlined and pleasant end-user experience. Depending on the SSPR functionality that is required, license requirements may vary. For example, Self-Service Password Change functionality for cloud users is included in all editions of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a>. In these cases, we are talking about cloud-only users who wish to change their passwords to something new. Self-Service Password Reset functionality for cloud users is only included in Azure AD Basic and higher. It’s not offered in the free version of Azure AD. This functionality applies to cloud-only users who wish to reset their passwords to something they know. Self-Service Password Reset, Password Change, and Password Unlock, leveraging on-premises write-back, requires either Azure AD Premium P1 or Premium P2. This functionality applies to hybrid users that are synced to Azure AD from an on-prem AD. So, when considering Self-Service Password Reset, it’s important to understand the user base and how users are <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">managed</a> and provisioned.</p>
<h1 id="Configure-Self-Service-Password-Reset"><a href="#Configure-Self-Service-Password-Reset" class="headerlink" title="Configure Self-Service Password Reset"></a>Configure Self-Service Password Reset</h1><p>Enabling <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-password-reset/">self-service password</a> for end users take a huge burden off of the shoulders of the help desk. In this demonstration, we will enable self-service password reset, and test that it’s working with a test account. Before enabling self-service password reset, make sure that password writeback is turned on in Azure AD Connect. To do this, launch Azure AD Connect on the server running it. Click configure and then view the current configuration. If its disabled, relaunch Azure AD Connect, click configure, and then select customize synchronization options. Provide the global admin account to connect to Azure AD. Click next to leave the directories and domain and ou filtering options unchanged. Under optional features, check the password writeback box and click Next. Click Configure to update the configuration and then click Exit. After turning on password writeback, switch over to the Azure portal and then browse to Azure active directory. From here, click Password Reset. For this demonstration, I’m going to enable password reset for all of my users so I’m going to click All, and then save. After enabling password reset, click on Authentication methods and select the authentication methods you wish to make available, along with how many are required to set a password. </p>
<p>This is obviously going to be different for every environment. If you select the security questions option, you’ll be presented with more info to supply. We aren’t using security questions here, so I’ll turn this off. For this demonstration, I’m going to make mobile phone available as the only option. After clicking Save, I’m going to click on registration. I’m asked if I want to require users to register when <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">signing in</a>. I’m going to leave the default value set to yes. I’m also going to leave the window set to the default of 180 days. Clicking notifications allows me to set the notification options for when a user resets a password. I’m going to set both options here to yes. this ensures users receive a notification when they reset their passwords, but it also ensures that all administrators are notified when another administrator resets his password. In the customization pane, I can provide a customized helpdesk link for users to visit if they need assistance. I don’t have helpdesk here in the lab, so I’m going to leave this off for this demonstration. When I click on the on-premises integration link, Azure confirms that the on-prem writeback client is running and allows me to determine if I want passwords to writeback to on-prem AD. I need to leave this set to yes. The second option designates whether or not users should be given the option to unlock their accounts without resetting their passwords. </p>
<p>I’m going to leave this set to no for this demonstration. With password reset enabled, we can now test it. To test self-service password reset, open an incognito browser window and launch the single sign on setup process with a test account. In my case here, we previously enabled <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">MFA</a> so let me get through the authentication process here first. As you can see here, I’m prompted to to work through the process of setting up self service password reset for my account. Once I’ve completed the self service password reset setup, I’m presented with my application dashboard. To reset my password, I need to open the password reset URL in my browser. The password reset URL is <a target="_blank" rel="noopener" href="https://aka.ms/sspr">https://aka.ms/sspr</a>. On the next screen, I’m prompted to begin the reset process. I just have to provide my user ID and I need to complete the captcha. Clicking Next takes me to the verification screen, where I can request a code via mobile phone. After I click the Text button, I receive a code on my phone that I need to enter. After providing my verification code and clicking Next, I’m then prompted to create a new password. Clicking Finish completes the process.</p>
<h1 id="Self-Service-Group-Management"><a href="#Self-Service-Group-Management" class="headerlink" title="Self-Service Group Management"></a>Self-Service Group Management</h1><p>To further improve the end user experience, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure AD</a> offers the ability for users to create and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">manage</a> their own security groups and Office 365 groups. In addition, users can also request security group memberships as well as Office 365 group memberships. In such cases, the owner of these groups can approve or deny their membership requests. By delegating group membership control, organizations can ensure that the people who best understand the business context for such memberships are the ones controlling group membership. It’s important to note, however, that this feature applies only to security groups and Office 365 groups. It does not apply to mail-enabled security groups nor does it apply to distribution lists. There are essentially two flavors of self-service group management currently available. These include delegated group management and self-service group management. An example of delegated group management would be a scenario where an organization uses a SaaS application, whose access is managed by an administrator. As the company grows, access management becomes a bit cumbersome for the administrator to handle. To ease the burden of granting access and revoking access to the application, the administrator requests that the application owner create a new group. </p>
<p>After the group has been created, the administrator assigns access to the application for the new group. He also adds all users who need access to the application to this group. Because the application owner created the group, he has he ability to add and remove users from it. Users added to the group are automatically granted access to the application, while users that are removed from the group have their access to the application revoked when the leave the group. By delegating group membership management to the application owner, the application owner no longer needs to wait on the administrator to provide and revoke access to the application. Of course, however, the administrator would still be able to see who has access to the application, and he could block access as necessary. A self-service group management example would be a scenario where an app owner manages an application. In order to grant a group of business users access to the application, the app owner creates a group in Azure AD, grants the group access to the application, and then enables self-service group management on the group. When a user in the organization needs access to the application, the user simply requests access to it from the Access Panel. When the request is approved, the user receives access to the application.</p>
<h1 id="Demo-Self-Service-Group-Management"><a href="#Demo-Self-Service-Group-Management" class="headerlink" title="Demo: Self-Service Group Management"></a>Demo: Self-Service Group Management</h1><p>In this demonstration we are going to enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-group-management/">Self Service group management</a>, by allowing users to create their own security groups and to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">manage</a> them. To enable Self Service group management, sign into the Azure portal and browse to Azure Active Directory. You’ll need to do this with a Global Admin account for the directory. From here select groups, and then go into the general settings for groups. Set the option for owners can manage group membership requests to yes. And then set the option for users can create security groups to yes as well. With these settings enabled users in the directory are allowed to create new security groups and to add members to those groups. These new groups will also show up in the access panel for all other users. In addition, if the policy settings on the group allow it, other users can create requests to join these groups as well.</p>
<h1 id="Overview-of-Managed-Identities-for-Azure-Resources"><a href="#Overview-of-Managed-Identities-for-Azure-Resources" class="headerlink" title="Overview of Managed Identities for Azure Resources"></a>Overview of Managed Identities for Azure Resources</h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Managed Identities</a> for Azure Resources is a feature of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. There are several Azure services that support Managed Identities for Azure Resources. For those who build cloud applications, management of credentials within a code for authenticating to cloud services is often a common challenge. It’s critical to ensure credentials are kept secure. As a matter of fact, preferably, credentials should never appear on a developer’s workstation, nor should credentials ever be checked into source control. With Azure Key Vault, administrators have a way to securely store credentials. However, to be effective, the application code needs to authenticate to Key Vault to retrieve those credentials that are stored. Enter Managed Identities for Azure Resources. Using the Managed Identities for Azure Resources feature in Azure AD solves this problem. This solution provides supported Azure services with an automatically managed identity in Azure AD that can be used to authenticate to any service that supports Azure AD authentication without the need to store any credentials in code. Key Vault is one of the Azure services that is supported. Managed Identities for Azure Resources is a free feature that comes with all Azure AD editions. There are two types of managed identities to choose from. </p>
<p>They include a system-assigned managed identity and a user-assigned managed identity. A system-assigned managed identity is enabled directly on an Azure service instance. Once the identity has been enabled, Azure will create an identity for the instance in the Azure AD tenant that’s trusted by the subscription of the instance. The credentials for the identity are provisioned onto the instance after the identity had been created. System-assigned identities are tied to the Azure service instances that they are enabled on. Deleting an instance with a system-assigned managed identity attached to it will cause Azure to automatically clean up the credentials, along with the identity in Azure AD. A user-assigned managed identity is essentially a standalone Azure resource. Via a creation process, Azure creates the identity in the Azure AD tenant. The subscription in use, in turn, trusts the identity. An identity, once created, can be assigned to one or more Azure service instances. Unlike a system-assigned managed identity, the lifecycle of a user-assigned identity is managed separately from that of the Azure service instance, or instances, to which it’s been assigned. Application code can use managed identities to request access tokens for services that support Azure AD authentication. Azure will handle the rolling of the credentials that are used by the service instance.</p>
<h1 id="Enable-a-Systems-Designed-Management-Identity-on-a-VM"><a href="#Enable-a-Systems-Designed-Management-Identity-on-a-VM" class="headerlink" title="Enable a Systems Designed Management Identity on a VM"></a>Enable a Systems Designed Management Identity on a VM</h1><p>To enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/overview-of-managed-identities-for-azure-resources/">System Assigned Managed Identity</a> on a VM that was originally provisioned without it your account needs at least the Virtual Machine Contributor Role assignment. In the case of our demo here I’m using a global admin so that’s a non-issue. To complete this task sign into the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">Azure</a> portal, navigate to the Resource Group that contains the VM that you wish to configure. Clock on the desired Virtual Machine and then select Identity. Under System Assigned Status select On and then click Save. Once the System Assigned Managed Identity is enabled the VM will be registered with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a>. After being registered you can then control its access to other services like Storage Accounts and the like.</p>
<h1 id="DEMO-Azure-AD-Reporting-and-Monitoring"><a href="#DEMO-Azure-AD-Reporting-and-Monitoring" class="headerlink" title="DEMO: Azure AD Reporting and Monitoring"></a>DEMO: Azure AD Reporting and Monitoring</h1><p>Hello and welcome back. In this brief demonstration here, what I wanna do is give you a tour, so to speak, of some of the Azure Active Directory Reporting and Monitoring options that are available.</p>
<p>Now, on the screen here, you can see I’m logged in to my Azure Portal, and I’m at the Overview page for my Azure Active Directory. We are working in the test9878.org directory. Now, the Azure Active Directory Reports that are available provide you with a view of the different activities that are going on in your environment.</p>
<p>You can use reports to determine how applications and services are utilized by your users, and you can detect potential risks that affect the health of your environments. You can use reports to also troubleshoot issues.</p>
<p>With Azure Active Directory Monitoring, you can route your Azure AD activity logs to different endpoints. You can then view this data to see what’s going on within your Active Directory.</p>
<p>Let’s take a look at some audit logs and some sign-in activities. Now, to take a look at the audit log for Azure Active Directory, what you do here is scroll down in the left pane from the Overview page of your directory and you select Audit logs under Monitoring. Now, what this Audit Log Report does is provide you with a record of the different system activities that have occurred.</p>
<p>For example, we can take a look and see who had access to an admin group and who gave them that access. We can also see information regarding password resets and the like. Now, in this dashboard here for our audit logs, we can see a few different activities that have occurred. We’ve seen some Add user activities. We’ve seen some Add member activities. We’ve also seen some activities revolving around roles.</p>
<p>If we select an activity here, so for example, we’ll choose this Add owner to group, what this tells us is what happened, when it happened, and what the status was. It also tells us who performed this action. Selecting the target gives us more information about the activity that occurred. And if we select Modified Properties, we can see what properties were actually modified.</p>
<p>So when you need to look at information for compliance, for example, the Audit logs report would be the report to go to. Now, if we click over to Sign-ins, we can see what was going on regarding sign-ins to our Azure Active Directory. Typically, you’d use the Sign-ins Report to find the sign-in pattern of specific users, or to see how many users have logged in in the last week, or what the sign-in status is.</p>
<p>On the screen here, we can actually see two different sign-ins that occurred. One was interrupted and one was successful. If we select the one here that was interrupted, we can see information about that specific sign-in. We can see when it happened, what happened, what the error code was, and what the failure reason was for the interrupted sign-in. We can see which user generated the alert and even the application where the sign-in occurred.</p>
<p>Along this top tab, we have lots of other different information we can look at. We can look at the location where this occurred. The Device Info. We can see that this failed login occurred on a Windows 10 machine from the Chrome browser. If we look at the Authentication Details, we can see that was a CloudOnlyPassword and that it was false. We can see any Conditional Access information that applied here.</p>
<p>In this case, there were no policies applied. And any Additional Details. Now, to configure monitoring for Azure Active Directory, what you can do is go into Diagnostic settings here below Monitoring, and we can see we have no diagnostic settings configured yet. So what we’ll do is add a diagnostic setting.</p>
<p>So we’ll go ahead and call this MyDiags. Now, what we can do here is we can collect audit logs or sign-in logs. And then when we do that, we can send them to either Log Analytics or to a storage account, or we can stream them to an event hub. For this demonstration here, what we’ll do is we’ll gather our audit logs and send them to a storage account.</p>
<p>Now, if we leave Retention here set to zero, if you look down here, you can see that setting it to zero does not apply a retention policy. This means the data that you collect is retained forever. I’ll just retain this for one day for this demonstration.</p>
<p>Now, when we select our storage account, we need to choose what storage account we want to archive to. So I already have a test9878 storage account here, so that’s what’s selected here. But I could change this to a different storage account if I wanted to. So what we’re doing here is collecting our audit logs with a retention of one day and sending them to our storage account, and then we’ll go ahead and save this.</p>
<p>Now, what we could also do here is instead of sending to a storage account, we can send to Log Analytics. Now, to send to Log Analytics, you’ll need to have a Log Analytics workspace already created. We have a default workspace here. We actually have a couple. So what we’ll do here is we’ll send to Log Analytics, and we’ll save it, and we can see we get the success here.</p>
<p>Now, to take a look at our logs, what we can do is go back out to our directory and then go into Logs here under Monitoring. Now, from the Log Analytics page here, what I can do is run different queries to track down the information I’m looking for as it relates to my Azure Active Directory. So that will call it a wrap.</p>
<p>Just keep in mind that you can run reports to track down specific information that’s reported in the Sign-ins Report and in the Audit logs report. And you can use Monitoring to send your information through logs into the Azure Monitor and&#x2F;or Log Analytics workspace.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>We’ve covered quite a bit of ground in <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction/">this course</a>. With so many terms and features to keep track of, it’s critical to be able to distinguish them from one another and understand what each does. By understanding what each identity management piece does, it becomes far easier to design an identity management solution. With that said, let’s walk through a high-level recap of all of the key players in the identity management space and what each offers. Microsoft’s <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/introduction-to-azure-ad/">Azure Active Directory</a> is a cloud-based identity and access management service. With it, users can sign in and access external resources, such as Office 365, the Azure portal, and other SaaS applications. Azure AD is used to control access to applications and resources according to business requirements. A hybrid identity is an identity that spans on-prem and cloud-based capabilities. Leveraging hybrid identities allows an organization to create a common user identity for authentication and authorization to all resources, regardless of whether they are on-prem or in the cloud. Azure AD Domain Services is a Microsoft cloud-based offering that provides managed domain services, such as domain join, group policy, LDAP, and Kerberos and NTLM authentication. These services are fully compatible with traditional on-prem Active Directory and they can be deployed without any need for deployment or management of domain controllers in the cloud. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/single-sign-on-overview/">Single sign-on</a>, also referred to as SSO, allows users to sign in once with one account in order to access domain-joined devices, corporate resources, software as a service apps, and even web applications. </p>
<p>After signing in, users can then launch apps right from the O365 portal or via the MyApps access panel. With single sign-on, IT administrators can centralize user account management, allowing them to automatically add or remove user access to applications, based on group membership. Also known as MFA, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/mfa-overview/">multi-factor authentication</a> works by requiring two or more authentication methods, which typically include something like a password that the user knows, something the user owns, which is typically a mobile phone, and&#x2F;or something the user is, biometrics would be a good example. Azure MFA offers the ability to safeguard access to applications and data while maintaining a simple end-user experience. Azure Active Directory Business-to-Business collaboration, also known as AD B2B, allows an organization to securely share company applications and services with guest users from other organizations, while retaining control over company data. Azure Active Directory Business-to-Consumer, also known as Azure AD B2C, is an identity management service that offers organizations the ability to customize and control how customers interact with corporate applications. It allows organizations to control how users sign up, sign in, and how they manage their profiles when using the applications. Azure AD B2C enables this functionality while also protecting customer identities. Azure Active Directory Privileged Identity Management, also known as PIM, is an Azure offering that allows you to manage and control access to resources within Azure and Azure AD, as well as within other services such as Intune and Office 365. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/self-service-password-reset/">Self-Service Password Reset</a>, also known an SSPR, allows end users to reset forgotten passwords without the need for a call to the helpdesk. It’s a feature that many organizations request, as it helps provide a more streamlined and pleasant end-user experience.</p>
<p>Depending on the SSPR functionality that is required, license requirements may vary. Through self-service group membership, Azure AD offers the ability for users to create and manage their own security groups and Office 365 groups. In addition, users can also request security group memberships as well as Office 365 group memberships. In such cases, the owner of such groups can approve or deny their membership. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/designing-azure-identity-management/overview-of-managed-identities-for-azure-resources/">Managed Identities for Azure Resources</a> provides supported Azure services with an automatically managed identity in Azure AD that can be used to authenticate to any service that supports Azure AD authentication without the need to store any credentials in code. Key Vault is one of the Azure services that is supported. Managed Identities for Azure Resources is a free feature that comes with all Azure AD editions. So, like I said, lots of terms. To learn more about each feature, you can, and should, read Microsoft’s published documentation on each. Be sure to also watch for new Microsoft Azure courses on Cloud Academy, because we’re always publishing new ones. Please give this course a rating, and if you have any questions or comments, please let us know. Thanks for watching and happy learning!</p>
<h1 id="10Azure-Role-Based-Access-Control"><a href="#10Azure-Role-Based-Access-Control" class="headerlink" title="10Azure Role-Based Access Control"></a>10<strong>Azure Role-Based Access Control</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/azure/role-based-access-control/overview">Azure RBAC overview</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/14/AZ-204-Lab-Azure-Resource-Manager-Templates-In-Depth-27/" rel="prev" title="AZ-204-Lab-Azure-Resource-Manager-Templates-In-Depth-27">
      <i class="fa fa-chevron-left"></i> AZ-204-Lab-Azure-Resource-Manager-Templates-In-Depth-27
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/14/AZ-204-Lab-Azure-Key-Vault-and-Disk-Encryption-29/" rel="next" title="AZ-204-Lab-Azure-Key-Vault-and-Disk-Encryption-29">
      AZ-204-Lab-Azure-Key-Vault-and-Disk-Encryption-29 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction-to-Azure-AD"><span class="nav-number">2.</span> <span class="nav-text">Introduction to Azure AD</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Create-Directory-and-Add-Custom-Domain"><span class="nav-number">3.</span> <span class="nav-text">Create Directory and Add Custom Domain</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-AD-Domain-Services-Overview"><span class="nav-number">4.</span> <span class="nav-text">Azure AD Domain Services Overview</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deploy-Azure-AD-Domain-Services"><span class="nav-number">5.</span> <span class="nav-text">Deploy Azure AD Domain Services</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#A-Word-About-Personas"><span class="nav-number">6.</span> <span class="nav-text">A Word About Personas</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hybrid-Identities"><span class="nav-number">7.</span> <span class="nav-text">Hybrid Identities</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DEMO-Managing-Users-Groups-and-Devices-in-Azure-AD"><span class="nav-number">8.</span> <span class="nav-text">DEMO: Managing Users, Groups, and Devices in Azure AD</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deploy-Azure-AD-Connect"><span class="nav-number">9.</span> <span class="nav-text">Deploy Azure AD Connect</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-Role-Based-Access-Control"><span class="nav-number">10.</span> <span class="nav-text">Azure Role-Based Access Control</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Single-Sign-On-Overview"><span class="nav-number">11.</span> <span class="nav-text">Single Sign-On Overview</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enable-Single-Sign-On-for-Dropbox"><span class="nav-number">12.</span> <span class="nav-text">Enable Single Sign-On for Dropbox</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MFA-Overview"><span class="nav-number">13.</span> <span class="nav-text">MFA Overview</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enable-MFA-for-O365-User"><span class="nav-number">14.</span> <span class="nav-text">Enable MFA for O365 User</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-AD-B2B"><span class="nav-number">15.</span> <span class="nav-text">Azure AD B2B</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Add-Guest-Users-to-the-Directory"><span class="nav-number">16.</span> <span class="nav-text">Add Guest Users to the Directory</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-AD-B2C"><span class="nav-number">17.</span> <span class="nav-text">Azure AD B2C</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Create-a-Link-and-Azure-AD-B2C-Tenant"><span class="nav-number">18.</span> <span class="nav-text">Create a Link and Azure AD B2C Tenant</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Privileged-Identity-Management"><span class="nav-number">19.</span> <span class="nav-text">Privileged Identity Management</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enable-PIM-and-Manage-Subscriptions"><span class="nav-number">20.</span> <span class="nav-text">Enable PIM and Manage Subscriptions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Self-Service-Password-Reset"><span class="nav-number">21.</span> <span class="nav-text">Self-Service Password Reset</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configure-Self-Service-Password-Reset"><span class="nav-number">22.</span> <span class="nav-text">Configure Self-Service Password Reset</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Self-Service-Group-Management"><span class="nav-number">23.</span> <span class="nav-text">Self-Service Group Management</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Demo-Self-Service-Group-Management"><span class="nav-number">24.</span> <span class="nav-text">Demo: Self-Service Group Management</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Overview-of-Managed-Identities-for-Azure-Resources"><span class="nav-number">25.</span> <span class="nav-text">Overview of Managed Identities for Azure Resources</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enable-a-Systems-Designed-Management-Identity-on-a-VM"><span class="nav-number">26.</span> <span class="nav-text">Enable a Systems Designed Management Identity on a VM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DEMO-Azure-AD-Reporting-and-Monitoring"><span class="nav-number">27.</span> <span class="nav-text">DEMO: Azure AD Reporting and Monitoring</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Summary"><span class="nav-number">28.</span> <span class="nav-text">Summary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10Azure-Role-Based-Access-Control"><span class="nav-number">29.</span> <span class="nav-text">10Azure Role-Based Access Control</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">1986</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
