<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="IntroductionHello and welcome to this course where I shall be looking at how to control access to your resources using IAM User Groups and Roles when using the AWS Identity &amp; Access Management S">
<meta property="og:type" content="article">
<meta property="og:title" content="AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3">
<meta property="og:url" content="https://example.com/2022/11/14/AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="IntroductionHello and welcome to this course where I shall be looking at how to control access to your resources using IAM User Groups and Roles when using the AWS Identity &amp; Access Management S">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-11-14T17:51:44.000Z">
<meta property="article:modified_time" content="2022-11-20T02:47:44.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/2022/11/14/AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 13:51:44" itemprop="dateCreated datePublished" datetime="2022-11-14T13:51:44-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-19 22:47:44" itemprop="dateModified" datetime="2022-11-19T22:47:44-04:00">2022-11-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AWS-Security-Specialty/" itemprop="url" rel="index"><span itemprop="name">AWS-Security-Specialty</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/AWS-Security-Specialty-Managing-Access-using-IAM-User-Groups-Roles-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello and welcome to this course where I shall be looking at how to control access to your resources using IAM User Groups and Roles when using the AWS Identity &amp; Access Management Service, commonly referred to as IAM. I shall be looking at some of the security best practices when using User Groups and Roles and how these can help you secure access to your resources more effectively.</p>
<p>My name is Stuart Scott, and I’m the AWS content Director here at Cloud Academy. Feel free to connect with me to ask me any questions using the details shown on the screen, alternatively, you can always get in touch with us here at Cloud Academy by sending an e-mail to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a> where one of our cloud experts will reply to your question.</p>
<p>The information set out in this course has been designed for those who may be in one of the following roles: an AWS administrator, security engineer, security architect, and also anyone who’s looking to increase their knowledge of the IAM service in preparation for an AWS certification.</p>
<p>By the end of this course, you will have a greater understanding of when and why you should use User Groups and Roles within IAM and how they help you control access to resources. You will also learn which type of IAM role to use and when.</p>
<p>As an intermediate level course, you should already have a basic understanding of AWS IAM and what the service is used for, in addition to policy types such as managed, customer and in-line. It would also be advantageous if you had some basic hands-on experience of AWS and some of it’s core services, but it is not essential.</p>
<p>Feedback on our courses here at Cloud Academy is valuable to both us as trainers and any students looking to take the same course in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you can contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>.</p>
<p>Please note that, at the time of writing this content, all course information was accurate. AWS implements hundreds of updates every month as a part of its ongoing drive to innovate and enhance its services. As a result, minor discrepancies may appear in the course content over time. But here at Cloud Academy, we strive to keep our content up to date in order to provide the best training available. So if you notice any information that is outdated, please contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. And this will allow us to update the course during its next release cycle. Thank you!</p>
<h1 id="Managing-Multiple-Users-with-IAM-User-Groups"><a href="#Managing-Multiple-Users-with-IAM-User-Groups" class="headerlink" title="Managing Multiple Users with IAM User Groups"></a>Managing Multiple Users with IAM User Groups</h1><p>In this lecture, I want to talk about how IAM User Groups can be used to manage multiple users. IAM User Groups do not signify a single user and they can’t be referenced as a principal in any AWS access policy like a User or a Role can. However, they are used to authorize access for members of the group to AWS resources through the use of AWS Policies attached to the User Groups. So User Groups are objects that contain IAM Users, and these User Groups will have IAM policies associated that will allow or explicitly deny access to AWS resources.</p>
<p>These policies can be AWS Managed policies that can be selected from within IAM, customer-managed policies that are created by you, or in-line policies, which are written and embedded directly into the group. User Groups are a great user management feature and they are normally created to directly relate to a specific requirement or job role. For example, you could have a group called Developers, and then attach policies to that group that allow access to AWS resources required by your development team.</p>
<p>Any users that are then a member of that group will automatically inherit the permissions applied to the group. By applying permissions to a group instead of individual users, it makes it easy to modify permissions for multiple users at once, simplifying access management at scale. It’s a security best practice to apply permissions to User Groups and then associate users to that group than to associate policies to individual Users. This prevents you having to update permissions for each and every user.</p>
<p>For example, if you needed to change access for all the individual developers that had policies assigned to them directly, and this can be very time intensive and prone to human error, especially in an enterprise environment. If using groups and additional access is required for your Developer User Group, all you would need to do is to modify the permissions of the Developer Group and all your associated developers would inherit the new access.</p>
<p>Creating a group is very simple and is essentially a three-step process. You must give your group a meaningful name, add users to the group, attach permissions via the policies. Once you have created a user group, you can then review its configuration, edit the permissions and see other details such as the ARN of the user group. Let me show you via a quick demonstration on how to create an IAM group and then how to modify the permissions of the group once it’s been created.</p>
<p>Okay, so I’ve logged into my AWS Management Console and I’ve gone to the IAM dashboard. Now, from here, to access and create groups, under access management on the left, you can see user groups. So if you select that, and then will show you any groups that you currently have. And I only have one group, which is Admin. So to create a new group, you’ve gotta cross to the right-hand side here, click on create group. And the first thing you need to do is to give the group a name. So I’m going to call this MyS3andEC2Group. And then after that, you need to select the users that you want to be a part of the group.</p>
<p>So if you already have the IAM users there, you can add them at this stage. So let’s just go ahead and add in Stuart. And then at the bottom, you can then attach any policies that you want to be associated with the group. So if I type in S3, and it’ll pick up any policies that we have associated with S3. And I’m going to select this one here, this AmazonS3andEC2FullAccess policy. And if I click on the little plus sign here, it’ll give you a JSON view of the actual policy itself. So you can see exactly what’s happening.</p>
<p>So now I’ve selected that policy. If we just go down to create group at the bottom, and it’s as simple as that. So it’s very easy to create a group. You simple give it a name, specify the users if you need to at that stage and also add any permissions if you want to at that stage as well.</p>
<p>Now, once we’ve created our group, if we select it, we can see the user list here. Now, if you need to add any additional users, simply click on add users, select the users that you’d like and click on add users. And then they’ll be immediately added to the group. You can also look at the permissions. So here’s the policy that we added. Now, we can if we want to, add additional permissions by clicking on this button here. And you can either attach an existing policy or create an inline policy that’s directly embedded into the group.</p>
<p>So for example, if we go to attach policies, and we want RDS access as well for the people in this group, have a quick search and we’ll select this AWS managed policy for RDSFullAccess. Click on add permissions. And we can now see that this group has two permissions policies. And again, we can view the JSON details of those policies if we want to. And then we have the Amazon RDS policy here. So it’s very easy to set up groups and only literally takes just a few clicks.</p>
<p>So that’s how you create a new group, add users and also change the permissions as well. And also, just before we finish, if you want to delete the group, you can click on delete here. And we just need to type in the name of the group to confirm the deletion. So I’ll just go ahead and do that. Then click on delete. And that deletes the group. Finally, from a limitation perspective, your AWS account has a default maximum limit of 300 groups. To increase this you’ll need to contact AWS using the appropriate limit increase forms. Also, a user can only be associated with 10 groups, so bear this in mind when assigning permissions and each group can contain 10 different policies attached at once. Limitations on AWS services is fluctuating all of the time, so for the latest information on Group limitations, please see the following URL here.</p>
<h1 id="IAM-Roles"><a href="#IAM-Roles" class="headerlink" title="IAM Roles"></a>IAM Roles</h1><p>IAM Roles allow trusted Users, AWS services and applications to adopt a set of temporary IAM credentials to access your AWS resources. Roles act as identities, much like Users do, and have permissions assigned to them defining what resources the Roles can and can’t access. Unlike Users though, which represent a single identity, IAM Roles are designed to be assumed by multiple different entities as and when required. Like I say, Roles are used for temporary access to gain access to resources, and each time the role is assumed by a User, an AWS service or an application, a new set of credentials is dynamically created for the duration of that session. As a result, Roles do not have any long term credentials associated, so there is no password for console access, nor are there any access keys for programmatic access that are explicitly associated with the Role.</p>
<p>For every role there will be associated policies controlling access as to what can and can’t be accessed when the role is assumed. There will also be a Trust Relationship, and this Trust Relationship defined who or what can assume the role, for example a User, an AWS account, or an AWS Service. IAM Roles are generally used: if you need to grant temporary access for Users to AWS resources that they don’t normally require access to or you can use a Role to grant access for an IAM user in one account to access resources in another AWS account or perhaps an AWS service needs to access resources on your behalf or if an application requires access to resources you can use a Role instead of embedding credentials into the software itself. Or you might have federated users who require access to specific resources, perhaps those authenticated via Active Directory So, as a result, Roles can be assumed by the following: A user that’s in the same AWS account as the where the role has been created, a user that’s in a different AWS account than where the the role has been created, an AWS service, such as EC2, or an external federated users to your AWS account</p>
<h1 id="Using-AWS-Service-Roles-to-Access-AWS-Resources-on-Your-Behalf"><a href="#Using-AWS-Service-Roles-to-Access-AWS-Resources-on-Your-Behalf" class="headerlink" title="Using AWS Service Roles to Access AWS Resources on Your Behalf"></a>Using AWS Service Roles to Access AWS Resources on Your Behalf</h1><p>An AWS Service Role allows an AWS service to assume a role to access other AWS resources within your own account on your behalf. This is commonly used for EC2 instances, whereby you could create a role for an EC2 instance to assume to gain access to AWS resources on your behalf. Let’s look at an example of when you might use this.</p>
<p>Consider the following scenario. You have an EC2 instance running an application that requires access to Amazon S3 to Put and Get objects using the relevant API calls. To allow access to S3, a set of credentials could be stored on the EC2 instance within the application code allowing it to use those credentials to gain access to the relevant S3 Bucket for any Put or Get API requests. However, in this scenario, you would need to manage these credentials manually including the rotation of access keys, which is obviously an administrative burden and open to the possibility of being compromised by a malicious attacker.</p>
<p>To alleviate this issue, the EC2 instance could be assigned an IAM Role, which in turn would have the relevant permissions associated granting the EC2 instance and its application to access S3 to perform the Put and Get API calls using existing AWS managed or customer manager policies. EC2 instances can be assigned a role during its creation, or to a running instance. You can also replace a role that is already associated with an EC2 instance with a new role. From a security best practice perspective you should always associate a Role to an EC2 instance for accessing AWS resources instead of storing local credentials on the instance itself.</p>
<p>There is also another great advantage of using Service Roles. Let’s now imagine we have a fleet of EC2 instances all using the same application and performing the same task using the same role, but now consider that your existing application, which was used to perform Put and Get requests is now only required to perform Put requests only, and Get requests must be denied.</p>
<p>To make the change, all you’d to do is to alter the permissions assigned to the IAM Role and all EC2 instances associated with that Role would now have the correct permissions. If this same scenario happened by embedding credentials locally on the EC2 instance, then it would take a long time to replicate the change on every instance accurately.</p>
<p>When creating a Service Role, there’s a number of AWS Services that integrate with IAM that support roles. This is a screenshot at the time of writing this course showing the supported AWS services, but for the latest information, you should always check the AWS documentation found here. Before we move on from AWS Service Roles, I want to mention service-linked roles.</p>
<p>A number of different AWS services require roles to perform functions requiring very specific permissions, and in these instances AWS allows you to create service-linked Roles. These are often created the first time that you use a service. Service-linked Roles come pre-configured with the relevant AWS Managed policies, trusts and permissions allowing only that Service to carry out the required operations with other AWS resources that it needs to interact with. Some examples of these roles include AWS ServiceRoleForAmazonSSM.</p>
<p>So AWS Systems Manager uses this IAM service role to manage AWS resources on your behalf. AWS ServiceRoleForCloudTrail. So this service linked role is used for supporting the organization trail feature with AWS CloudTrail. And AWS ServiceRoleForCloudWatchEvents. CloudWatch uses this service-linked role to perform Amazon EC2 alarm actions.</p>
<p>So if we look closer at the AWSServiceRoleForAmazonSSM in IAM, we will find that the trusted identity to use this role is ssm.amazonaws.com, AWS Systems Manager. and with it having an AWS Managed policy already configured, we’re unable to edit and update this policy. This policy is specifically designed to provide access to AWS Resources managed or used by Amazon SSM, and this role is created when you configure SSM. So the difference between AWS Service and AWS Service-Linked Roles is that AWS Service roles allow you to apply your own customer managed or AWS Managed policies, whereas service-linked roles come pre-configured with a specific set of read-only AWS managed policies that can only be used by that particular service.</p>
<h1 id="Using-IAM-User-Roles-to-Grant-Temporary-Access-for-Users"><a href="#Using-IAM-User-Roles-to-Grant-Temporary-Access-for-Users" class="headerlink" title="Using IAM User Roles to Grant Temporary Access for Users"></a>Using IAM User Roles to Grant Temporary Access for Users</h1><p>There might be circumstances where you will need to grant temporary access to AWS resources for a particular user and the best way to do this would be to allow the user to assume a role with these new permissions. The alternative would be to either add a policy associated with the user and then remember to remove the policy again afterwards, which would likely lead to a security risk, and as we know, attaching policies to a specific user isn’t considered a security best practice, we should use user groups instead. However, if we added these permissions to a user group that the user belonged to, then all users that are a part of that same user group would receive those permissions, so that’s definitely a security risk.</p>
<p>So in this instance, creating a new role with the relevant permissions and allowing only specific users to assume that role, is the best approach to the problem. When a user assumes a role, it replaces all other permissions that the user has. You might think that the user keeps their current permissions and just inherits the additional permissions set out by the role, but that’s not the case. When you assume a role, your existing permissions are temporarily replaced.</p>
<p>I mentioned previously that every role has a trust relationship and so as a user, you can only assume roles where they have been added as a trusted entity. However, in addition to being trusted, the user also has to have the relevant permissions to assume the role as well and this is done via an access policy.</p>
<p>So let’s assume we have a role called RoleS3FullAccess with a permission policy attached as shown which grants full access to Amazon S3. And the trusted entity of this role was defined as the user specified in this ARN. So this means this role trusts the user, Stuart, to assume the role to gain full access to S3. However, Stuart’s permissions do not currently allow him to assume this role. For Stuart to be able to assume the RoleS3FullAcess role, Stuart will need to have the following policy associated with his user, where the text in red is the ARN of the role. When this policy is associated with Stuart, he then has permission to assume the role which is trusted to him as defined in the trusted entity section of the role allowing him to have full access to S3.</p>
<p>Let me now provide a demonstration on how you could create this example that we just ran through. Okay, so I’m in my AWS Management Console and I’m at the IAM dashboard. So in this demonstration, we’re going to create a role with a policy attached and then add an inline policy to the user, Stuart, to ensure that Stuart can assume the role.</p>
<p>So firstly, let’s create our role. So on the left here, we have roles and then over in the top right, we have Create Role. So because we want this role to assumed by a user, we have to pick the correct type of trusted entity. So it’s not going to be assumed by an AWS Service and it’s not to with Federation either, so the option we need here, is this one relating to an AWS account. Now although says another AWS account, this option is used to creating cross-account access, but you can also create roles to be assumed by users within your own account as well. And to do that, all we need to do in the account ID, is to enter our our account ID, so if I just add that in there, and you can also add a couple of additional options, such as requiring multifactor authentication, et cetera.</p>
<p>So once we’ve put in the account ID of where the users are that we want to assume this role, we can then click on next, permissions. And I want the policy that’s attached to this role to have full S3 access, so let’s have a quick search. And here we have it here, Amazon S3 full access, which is an AWS managed policy. Then click on next for tags. Add any tags in that you’d like for the role as an optional step. I’m just gonna leave it blank for this demonstration. And this is where we can give the role a name, so I’m going to call this RoleS3FullAccess. Give it a description if you need to and here we have the trusted entity, which is my own account and then all we need to do from there, is click on Create Role.</p>
<p>Okay, so if we search for that. RoleS3, here we have our role here. So if we go into the role, we can have a look at our trust relationships, so this is essentially saying that anyone within this account is trusted to assume this role and we can also edit this trust relationship as well. So this shows the policy that relates to that trust relationship. So this essentially allows anyone in this account, access to the role, as long as they have that assume role permissions that we’ll be looking at in just a moment. But I want to make this a bit more secure, so I’m going to change it from root to user, Stuart.</p>
<p>So now the trusted relationship for this role will only allow the user, Stuart, within this account to assume the role, given the correct permissions. So I’m gonna update that trust policy and now we can see the trusted entity has been changed. And if we take a look at the permissions, we can see that it has the policy attached there as well. So now we’ve got roles set up with the correct permissions, we now need to edit the user, Stuart with an inline policy to allow that user to assume the role. So I’ve just gone with IAM user of Stuart. If we click on add inline policy and go across to JSON.</p>
<p>Now, here I’m just going to paste in a policy that I’ve already created. So will allow the user, Stuart to use the secure token service AssumeRole action against the role that we just created and that’s the ARN in the role. So now Stuart will have access to assume that role. Let’s go to review policy. Give this a name. I’m just going to call this, AssumeRoleS3. Create policy. And there we have the inline policy that we just created, attached to the user, Stuart.</p>
<p>So now what I want to do, is to log in as the user, Stuart and show you how I can switch to this role. Okay, so I’ve now signed in as the user, Stuart and to switch roles, all I need to do, is to select on the top right up there, select Switch Role. And again, Switch Role. Type in the account. So I’ll just paste that in quickly and then type the role name, which we called RoleS3FullAccess and then click on Switch Role. And that’s it, we’ve now switched roles and if you look in the top right, we can see that it says, RoleS3FullAccess at this account number and that signifies that you swapped your permissions for that role that the user, Stuart has just assumed.</p>
<p>Once you finish what you need to do with the permissions given by the role, you can simply select the top right area again and say Switch Back. And that will revert you back to your original user with your original permissions. IAM user roles are often used to create a cross-account access role, allowing users in one AWS account to access resources in a different AWS account. For a full explanation on how to create cross-account roles, please see our existing course found here.</p>
<h1 id="Using-Roles-for-Federated-Access"><a href="#Using-Roles-for-Federated-Access" class="headerlink" title="Using Roles for Federated Access"></a>Using Roles for Federated Access</h1><p>In this lecture, I want to discuss how users who have been federated can access your resources using roles. When doing so you have two options. Firstly, Web Identity, this allows users federated by a specified external web identity or OpenID Connect provider, to assume this Role to perform actions in your account. And secondly, SAML 2.0 federation, this allows users that are federated with SAML 2.0, to assume this Role to perform actions in your account.</p>
<p>So let’s first look at Web Identity and a scenario where you might need to create a Role. You’ve just created a new mobile application that requires access to Amazon S3 to store media such as photos and videos from users worldwide. As a part of the operations of your application, it will require permissions to S3, to upload and download this media from tens of thousands of users. Embedding long-term credentials into your application code to do this goes against all security best practices. And so instead, you should design your application to request temporary credentials from authenticated users through web identity federation. </p>
<p>Before I go any further, let me explain what identity federation is. It’s basically a method of authentication where two different providers can establish a level of trust, allowing users to authenticate from one, which authorizes them to access resources in the other. During the federation process, one party would act as an Identity Provider, known as an IdP, and the other would be the service provider, an SP. The identity provider authenticates the user and the service provider controls access to their service or resources based on the IdP’s authentication.</p>
<p>You’ve probably all been to websites where it presents you with a login page, where you can either login using existing credentials, native that service, or you might have an option to authenticate using credentials from a third party provider, such as Facebook, Google, Twitter, or LinkedIn, et cetera. So going back to our example, our application run on AWS would be the service provider, and the Web Identity provider could be Google or Facebook, for example.</p>
<p>So when users authenticate to your app via web identity federation, they will receive an authentication token. This token is then exchanged for temporary security credentials in AWS, which can be mapped to your IAM Role, using the AssumeRoleWithWebIdentity API. This then allows the relevant access to Amazon S3 provided by the role, to carry out the operations needed by the application.</p>
<p>Generally, when working with mobile applications, the preferred and recommended method for managing access, would be via Amazon Cognito, to manage his federation process. For more information related to Amazon Cognito, please see our existing course here.</p>
<p>Let’s now take a look at SAML 2.0 federation. Whereas web identity federation is generally used for large, wide scale of access from unknown users, SAML 2.0 is generally used to authenticate your employees using existing directory services that you might already be using. SAML, which stands for Security Assertion Markup Language, is a standard that’s used to exchange authentication and authorization identities between different security domains, which uses security tokens containing assertions to pass information about a user between a SAML Identity Provider and a SAML consumer.</p>
<p>For example, you might already to be using Microsoft Active Directory to authenticate your employees to your internal network. And so you might not want to or need to create lots of users in IAM with their own set of credentials. Instead, it would be easier to allow them to federate their access through via SAML, integrating with your ADFS server. The benefits of this are twofold. It minimizes the amount of administration required within IAM and it allows for a single sign on solution.</p>
<p>As the vast majority of organizations today are using Microsoft Active Directory, using MSAD is an effective way of granting access to your AWS resources without going through the additional burden of creating potentially hundreds of IAM user accounts. Let’s take a high-level look at how active directory authentication mechanism is established. This example will assume the user within an organization requires API access to S3, EC2, and RDS. This scenario will also include the use of an AWS service called Security Token Service, STS. The Security Token Service allows you to gain temporary security credentials for federated users via IAM, associated with IAM roles and policies. Let’s look at this in more detail via a diagram.</p>
<p>A user within an internal organization initiates a request to authenticate against the Active Directory Federated Service, an ADFS server, via a web browser using a single sign on URL. If their authentication is successful by using their Active Directory credentials, SAML will then issue a successful authentication assertion back to the user’s client, requesting federated access. The SAML assertion is then sent to the AWS Security Token Service, to assume a role within IAM using the AssumeRoleWithSAML API. STS then responds to the user requesting federated access with temporary security credentials, with an assumed role and associated permissions, allowing S3, EC2, and RDS access as per our example, the user then has federated access to the necessary AWS services as per the role’s permissions.</p>
<p>This is a very simple overview of how federation is instigated from the user for API access to specific AWS services. Corporate identity federation is always authenticated internally first by Active Directory before AWS, when creating your role for users federating via SAML, you can specify if you want to provide programmatic access only, or programmatic and AWS management Console access, in addition to specific permissions to access other AWS resources.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>Hello and welcome to this lecture which will summarize some of the key points mentioned throughout the previous lectures. I started this course looking at User Groups and in this lecture we learnt that: IAM User Groups can be used to manage multiple users. They do not signify a single user and can’t be referenced within an IAM policy. They contain IAM Users and have IAM policies associated with them defining their permissions. They are normally created to directly relate to a specific requirement or job role. Applying these permissions to a Group instead of individual users is a security best practice.</p>
<p>To create a Group is very simple and is essentially a 3 step process: Give your Group a meaningful name. Add users to the Group. And then attach permissions via policies. There are limitations on the number of groups per AWS account and for the latest information on this please refer to the following url. I then focused on IAM Roles to understand how they can be used to help manage access. I started by explaining that IAM Roles: Allow trusted Users, AWS services and applications to adopt a set of temporary IAM credentials to access your AWS resources. They are designed to be assumed by multiple different entities as and when required.</p>
<p>Each time a role is assumed a new set of dynamic credentials are created. IAM Roles do not have any long term credentials associated with them. Roles have associated policies controlling access as to what can and can’t be accessed when the role is assumed. A Trust Relationship defines who or what can assume the role. IAM Roles are generally used: To grant temporary access for Users in your account or cross-accounts. For AWS Services to carry out specific operations on your behalf. Or for federated uses. I then explained what AWS Service Roles were and what they were used for, and in this section I covered the following points: AWS Service Roles allows AWS services to assume a role to access other AWS resources within your account on your behalf.</p>
<p>Commonly used for EC2 instances. AWS managed and customer managed policies can be attached to Service Roles. Service Roles can be attached to an EC2 instance during its creation or when its running. It’s a security best practice to associate a Role to an EC2 instance for accessing AWS resources instead of storing local credentials on the instance itself. There are a number of AWS Services that integrate with IAM that support roles. Service-linked roles perform functions requiring very specific permissions which are often created the first time you use the service.</p>
<p>Service-linked Roles come pre-configured with the relevant AWS Managed policies, trusts and permissions allowing only that Service to carry out the required operations. The difference between AWS Service and AWS Service-Linked Roles is that AWS Service roles allow you to apply your own customer managed or AWS Managed policies, whereas service-linked roles come pre-configured with a specific set of read only AWS managed policies that can only be used by that particular service. Following Service Roles I then looked at IAM User Roles to understand how individual users can adopt a set of temporary credentials.</p>
<p>During this lecture I explained that: When a User assumes a Role it replaces all other permissions that the User has. To assume a role you need to be a trusted entity and have access to assume the Role via a policy. IAM User Roles are often used to create cross-account access, allowing users in one AWS Account to access resources in a different AWS account.</p>
<p>Finally I covered how Roles are used to grant access to federated users which involved both Web Identity federation and SAML 2.0 federation. When discussing Web Identity I explained that: Identity Federation is basically an access method of authentication where two different providers can establish a level of trust allowing users to authenticate from one, which authorizes them to access resources in another. AWS would act as a Service Provider.</p>
<p>A Web Identity Provider would be Google or Facebook, for example. When users authenticate via web identity federation, they will receive an authentication token. The token is then exchanged for temporary security credentials in AWS and mapped to a Role providing access. Amazon Cognito is the preferred method for managing federated access for mobile applications. When I covered SAML Federation I covered the following points: SAML 2.0 is generally used to authenticate your employees using existing directory services that you might already be using, such as MS AD. It minimizes the amount of administration required within IAM allowing for a single sign-on solution.</p>
<p>The Security Token Service allows you to gain temporary security credentials for federated users via IAM, associated with IAM roles and policies. That now brings me to the end of this lecture and to the end of this course, and so you should now have a greater understanding of IAM User Groups and how they can be used to simplify access management across multiple users, and how IAM Roles provide short-term temporary credentials to your users and AWS Services.</p>
<p>Feedback on our courses here at Cloud Academy is valuable to both us as trainers and any students looking to take the same course in the future. If you have any feedback, positive or negative, it would be greatly appreciated if you could contact <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. Thank you for your time and good luck with your continued learning of cloud computing. Thank you.</p>
<h1 id="2Managing-Multiple-Users-with-IAM-User-Groups"><a href="#2Managing-Multiple-Users-with-IAM-User-Groups" class="headerlink" title="2Managing Multiple Users with IAM User Groups"></a>2<strong>Managing Multiple Users with IAM User Groups</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_iam-quotas.html">Group limitations</a></p>
<h1 id="4Using-AWS-Service-Roles-to-Access-AWS-Resources-on-Your-Behalf"><a href="#4Using-AWS-Service-Roles-to-Access-AWS-Resources-on-Your-Behalf" class="headerlink" title="4Using AWS Service Roles to Access AWS Resources on Your Behalf"></a>4<strong>Using AWS Service Roles to Access AWS Resources on Your Behalf</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html">AWS services that work with IAM</a></p>
<h1 id="5Using-IAM-User-Roles-to-Grant-Temporary-Access-for-Users"><a href="#5Using-IAM-User-Roles-to-Grant-Temporary-Access-for-Users" class="headerlink" title="5Using IAM User Roles to Grant Temporary Access for Users"></a>5<strong>Using IAM User Roles to Grant Temporary Access for Users</strong></h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-cross-account-access-using-iam/">Implementing cross-account roles using IAM</a></p>
<h1 id="6Using-Roles-for-Federated-Access"><a href="#6Using-Roles-for-Federated-Access" class="headerlink" title="6Using Roles for Federated Access"></a>6<strong>Using Roles for Federated Access</strong></h1><p><a target="_blank" rel="noopener" href="https://cloudacademy.com/course/using-amazon-cognito-manage-authentication-authorization-mobile-web-apps-1560/">Using Amazon Cognito to Manage Authentication &amp; Authorization to your Mobile and Web Apps</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/14/AWS-Security-Specialty-Managing-User-Identities-with-Long-Term-Credentials-in-AWS-IAM-2/" rel="prev" title="AWS-Security-Specialty-Managing-User-Identities-with-Long-Term-Credentials-in-AWS-IAM-2">
      <i class="fa fa-chevron-left"></i> AWS-Security-Specialty-Managing-User-Identities-with-Long-Term-Credentials-in-AWS-IAM-2
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/14/AWS-Security-Specialty-Using-IAM-Policies-to-Define-and-Manage-Permissions-4/" rel="next" title="AWS-Security-Specialty-Using-IAM-Policies-to-Define-and-Manage-Permissions-4">
      AWS-Security-Specialty-Using-IAM-Policies-to-Define-and-Manage-Permissions-4 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Managing-Multiple-Users-with-IAM-User-Groups"><span class="nav-number">2.</span> <span class="nav-text">Managing Multiple Users with IAM User Groups</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IAM-Roles"><span class="nav-number">3.</span> <span class="nav-text">IAM Roles</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-AWS-Service-Roles-to-Access-AWS-Resources-on-Your-Behalf"><span class="nav-number">4.</span> <span class="nav-text">Using AWS Service Roles to Access AWS Resources on Your Behalf</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-IAM-User-Roles-to-Grant-Temporary-Access-for-Users"><span class="nav-number">5.</span> <span class="nav-text">Using IAM User Roles to Grant Temporary Access for Users</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-Roles-for-Federated-Access"><span class="nav-number">6.</span> <span class="nav-text">Using Roles for Federated Access</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Summary"><span class="nav-number">7.</span> <span class="nav-text">Summary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2Managing-Multiple-Users-with-IAM-User-Groups"><span class="nav-number">8.</span> <span class="nav-text">2Managing Multiple Users with IAM User Groups</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4Using-AWS-Service-Roles-to-Access-AWS-Resources-on-Your-Behalf"><span class="nav-number">9.</span> <span class="nav-text">4Using AWS Service Roles to Access AWS Resources on Your Behalf</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5Using-IAM-User-Roles-to-Grant-Temporary-Access-for-Users"><span class="nav-number">10.</span> <span class="nav-text">5Using IAM User Roles to Grant Temporary Access for Users</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6Using-Roles-for-Federated-Access"><span class="nav-number">11.</span> <span class="nav-text">6Using Roles for Federated Access</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
