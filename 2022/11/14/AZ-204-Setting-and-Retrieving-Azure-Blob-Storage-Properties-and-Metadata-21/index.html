<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Setting and Retrieving Azure Blob Storage Properties and MetadataWelcome to “Setting and Retrieving Azure Blob Storage Properties and Metadata”. I’m Guy Hummel. To get the most from this course, you">
<meta property="og:type" content="article">
<meta property="og:title" content="AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21">
<meta property="og:url" content="https://example.com/2022/11/14/AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="Setting and Retrieving Azure Blob Storage Properties and MetadataWelcome to “Setting and Retrieving Azure Blob Storage Properties and Metadata”. I’m Guy Hummel. To get the most from this course, you">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-11-14T15:15:42.000Z">
<meta property="article:modified_time" content="2022-11-20T23:30:16.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/2022/11/14/AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 11:15:42" itemprop="dateCreated datePublished" datetime="2022-11-14T11:15:42-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:30:16" itemprop="dateModified" datetime="2022-11-20T19:30:16-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-204/" itemprop="url" rel="index"><span itemprop="name">AZ-204</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/AZ-204-Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata-21/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <span id="more"></span>

<h1 id="Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata"><a href="#Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata" class="headerlink" title="Setting and Retrieving Azure Blob Storage Properties and Metadata"></a>Setting and Retrieving Azure Blob Storage Properties and Metadata</h1><p>Welcome to “Setting and Retrieving Azure Blob Storage Properties and Metadata”. I’m Guy Hummel. To get the most from this course, you should already have some knowledge of Azure Blob Storage. You should also have some experience with programming, especially C#.</p>
<p>In this short course, I’ll explain how to manage blob properties and metadata using the Azure Portal and the Azure Storage client libraries for .NET.</p>
<p>So what’s the difference between blob properties and metadata? Properties are automatically created by Azure, while metadata is user-defined. That is, metadata is optional, and you only create it if you need it.</p>
<p>Let’s have a look at some properties. I’m in the Azure Portal, and I’m looking at a blob container in a storage account. These are the blobs in the container. To see the system properties for one of them, you right-click on the blob and select “Properties”.</p>
<p>Some of the properties are pretty straightforward, such as Last Modified, Creation Time, and Size. You’ll notice that these properties can’t be modified, which makes sense because there’s only one true value for each of them. Some of the properties will change if you change the blob itself. For example, if you add more data to the blob, then its size will increase, or if you move the blob from the Hot tier to the Cool tier, then the access tier property will change.</p>
<p>You can see that there are a handful of properties that you can change, though. The first one only applies if this blob is configured to be cached in the Azure Content Delivery Network. The rest of them are things like content type and content language. Azure doesn’t necessarily know what these should be set to, so it allows you to set them. For example, you could set the content language to “en-us”, which means US English. Then, you’d click “Save”.</p>
<p>There are actually a few more you can set using the portal even though it doesn’t look like you can. These three lease properties can be set indirectly by clicking the “Acquire lease” button. If you apply a lease to a blob, then the blob can’t be modified by anyone else until the lease has expired. It’s a good way to prevent two people or programs from making conflicting changes to a blob.</p>
<p>When we click “Acquire lease”, it changes the lease status to “Locked”, the lease state to “Leased”, and the lease duration to “Infinite”. The duration is infinite because we didn’t set a time when the lease should expire. Of course, we weren’t given the option to set an expiration time, so we didn’t have a choice. To set one, we’d need to use the Azure Storage client libraries. To end the lease, we can click “Break lease”. Now, these three properties have changed again.</p>
<p>Okay, down here we can see a Metadata section. It’s empty because, as I mentioned, metadata is optional. Suppose we wanted to set a category for each of our documents. Then we’d create a key called “category”, and we’d set the value to the appropriate category for the document, such as “finance”. Then we’d click “Save”, and our key&#x2F;value pair would show up in the metadata list.</p>
<p>Using the Azure Portal to read and write blob properties and metadata is fine if you only need to change a few blobs, but if you need to make a lot of changes, then it would be easier to write a script. You could do that using either the Azure command-line interface or Azure PowerShell. If you have an application that needs to manage blob properties and metadata, then you can use Azure Storage client libraries. They’re available for a number of languages, but I’ll show you an example from Microsoft’s documentation that uses the .NET version.</p>
<p>This is an example C# method called SetBlobPropertiesAsync. It shows how to set the ContentType and ContentLanguage properties. First, it retrieves the existing properties by calling the GetPropertiesAsync method. It does this because when it creates a new BlobHttpHeaders class, it needs to set all of the properties for the blob, so it needs to know what to set the other properties to. By the way, even though it’s called BlobHttpHeaders, it just means BlobProperties.</p>
<p>First, it sets the ContentType to “text&#x2F;plain” and the ContentLanguage to “en-us”, which is the whole purpose of this method. Then it sets the remaining properties to the values it retrieved at the beginning. If it didn’t set these properties, then their existing values would be wiped out, so it has to set them.</p>
<p>Now it calls the SetHttpHeadersAsync method to actually set the properties of the blob to the values in the BlobHttpHeaders class that was created above. Then there’s a catch block to say what to do if the operation fails.</p>
<p>Okay, now how about setting blob metadata? It’s pretty similar. Here’s an example method called AddBlobMetadataAsync. First, it creates a Dictionary object called “metadata” that you can put key&#x2F;value pairs in.</p>
<p>Then it shows you two different ways to add a key&#x2F;value pair. The first is to use the Add method and pass it the key and value. In this example, it’s setting a key called “docType” to the value “textDocuments”, but you could set these to whatever you want because they’re user-defined.</p>
<p>The second way is to use this key&#x2F;value syntax where the key, called “category” in this example, is in square brackets, and the value (“guidance”, in this example) comes after the equal sign.</p>
<p>When you’re done adding key&#x2F;value pairs to the dictionary, you call the SetMetadataAsync method and pass it the dictionary object that contains the metadata. Finally, there’s a catch block to handle errors.</p>
<p>Now, I’ll show you one more code sample. This one shows you how to read metadata from a blob. Interestingly, you use the GetPropertiesAsync method, which seems weird considering we’re trying to get the metadata, not the properties. Well, this method actually gets both the properties and the metadata. We already saw how to read the properties from this in the first example, but to retrieve the metadata, you use a foreach loop to read all of the key&#x2F;value pairs from the Metadata dictionary.</p>
<p>And that’s it for setting and retrieving properties and metadata in Azure Blob Storage. Please give this course a rating, and if you have any questions or comments, please let us know. Thanks!</p>
<h2 id="1Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata"><a href="#1Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata" class="headerlink" title="1Setting and Retrieving Azure Blob Storage Properties and Metadata"></a>1<strong>Setting and Retrieving Azure Blob Storage Properties and Metadata</strong></h2><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blob-properties-metadata#set-and-retrieve-properties">Manage blob properties and metadata with .NET</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/14/AZ-204-Configuring-Azure-Blob-Storage-Lifecycle-Management-20/" rel="prev" title="AZ-204-Configuring-Azure-Blob-Storage-Lifecycle-Management-20">
      <i class="fa fa-chevron-left"></i> AZ-204-Configuring-Azure-Blob-Storage-Lifecycle-Management-20
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/14/AZ-204-Lab-Working-with-Azure-Storage-Using-PowerShell-22/" rel="next" title="AZ-204-Lab-Working-with-Azure-Storage-Using-PowerShell-22">
      AZ-204-Lab-Working-with-Azure-Storage-Using-PowerShell-22 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata"><span class="nav-number">1.</span> <span class="nav-text">Setting and Retrieving Azure Blob Storage Properties and Metadata</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1Setting-and-Retrieving-Azure-Blob-Storage-Properties-and-Metadata"><span class="nav-number">1.1.</span> <span class="nav-text">1Setting and Retrieving Azure Blob Storage Properties and Metadata</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
