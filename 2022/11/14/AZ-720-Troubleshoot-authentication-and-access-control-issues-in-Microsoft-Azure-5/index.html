<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="IntroductionCompleted100 XP  3 minutes  You work as an administrator looking after your company’s Azure Active Directory (Azure AD) authentication and access control. Because authentication and access">
<meta property="og:type" content="article">
<meta property="og:title" content="AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5">
<meta property="og:url" content="https://example.com/2022/11/14/AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="IntroductionCompleted100 XP  3 minutes  You work as an administrator looking after your company’s Azure Active Directory (Azure AD) authentication and access control. Because authentication and access">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-add-users.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-add-diagnostic-settings.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-create-log.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-connect-health.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-azure-active-directory-connect.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-azure-active-directory-additional-tasks.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-azure-active-directory-troubleshoot-object-synchronization.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-audit-logs.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-more-details-sign.png">
<meta property="og:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-conditional-access-sign-log.png">
<meta property="article:published_time" content="2022-11-14T17:37:24.000Z">
<meta property="article:modified_time" content="2022-11-28T01:36:28.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-add-users.png">

<link rel="canonical" href="https://example.com/2022/11/14/AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/14/AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-14 13:37:24" itemprop="dateCreated datePublished" datetime="2022-11-14T13:37:24-04:00">2022-11-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-27 21:36:28" itemprop="dateModified" datetime="2022-11-27T21:36:28-04:00">2022-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-720/" itemprop="url" rel="index"><span itemprop="name">AZ-720</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/14/AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/14/AZ-720-Troubleshoot-authentication-and-access-control-issues-in-Microsoft-Azure-5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Completed100 XP</p>
<ul>
<li>3 minutes</li>
</ul>
<p>You work as an administrator looking after your company’s Azure Active Directory (Azure AD) authentication and access control. Because authentication and access control is crucial to the robust, secure, and effective functioning of both Azure-based and hybrid systems, you can react both proactively and reactively to any authentication and authorization issues.</p>
<p>Microsoft Azure has a sophisticated authentication and access control system to provide high security. Azure AD authentication includes self-service password reset, multifactor authentication, hybrid integration, and passwordless authentication.</p>
<p>In this module, you’ll learn how to troubleshoot a deployment of Azure AD that is based entirely in the cloud and a hybrid deployment of Azure AD that is part cloud-based and part on-premises. You’ll also learn how to troubleshoot authorization issues when using Microsoft Azure.</p>
<h2 id="Learning-objectives"><a href="#Learning-objectives" class="headerlink" title="Learning objectives"></a>Learning objectives</h2><p>After completing this module, you’ll be able to:</p>
<ul>
<li>Troubleshoot Azure AD authentication.</li>
<li>Troubleshoot hybrid authentication.</li>
<li>Troubleshoot authorization issues.</li>
</ul>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li>Demonstrate an understanding of the OSI model</li>
<li>Demonstrate an understanding of PowerShell</li>
<li>Demonstrate an understanding of Azure CLI</li>
</ul>
<h1 id="Troubleshoot-Azure-AD-authentication"><a href="#Troubleshoot-Azure-AD-authentication" class="headerlink" title="Troubleshoot Azure AD authentication"></a>Troubleshoot Azure AD authentication</h1><p>Completed100 XP</p>
<ul>
<li>7 minutes</li>
</ul>
<p>Before troubleshooting Azure AD authentication, you should consider that there are four editions of Azure AD: Free, Office 365 Apps, Premium P1, and Premium P2. The free edition is included with other software products and packages including Azure, Intune, and Office 365. Office 365 Enterprise editions (E1, E3, E5, F1, and F3) include the Office 365 Apps edition, while the Premium editions are available as an additional product.</p>
<h2 id="The-difference-between-Azure-AD-editions"><a href="#The-difference-between-Azure-AD-editions" class="headerlink" title="The difference between Azure AD editions"></a>The difference between Azure AD editions</h2><p>The following table shows the high-level difference between Azure AD editions. For more information, see <a target="_blank" rel="noopener" href="https://www.microsoft.com/security/business/identity-access-management/azure-ad-pricing">Azure Active Directory pricing</a>.</p>
<table>
<thead>
<tr>
<th align="left">Feature name</th>
<th align="left">Free</th>
<th align="left">Office 365</th>
<th align="left">Azure Active Directory Premium P1</th>
<th align="left">Azure Active Directory Premium P2</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Authentication, single sign-on and multifactor authentication (MFA)</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">Applications access</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">Authorization and conditional access</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">Administration and hybrid identity</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">End-user self-service</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">Identity governance</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">Event logging and reporting</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Partially included</td>
<td align="left">Included</td>
</tr>
<tr>
<td align="left">Frontline workers</td>
<td align="left">not included</td>
<td align="left">not included</td>
<td align="left">Included</td>
<td align="left">Included</td>
</tr>
</tbody></table>
<h2 id="Troubleshoot-self-service-password-reset-issues"><a href="#Troubleshoot-self-service-password-reset-issues" class="headerlink" title="Troubleshoot self-service password reset issues"></a>Troubleshoot self-service password reset issues</h2><p>Azure AD self-service password reset (SSPR) enables users to change or reset their password without the help of an administrator. If a user forgets the password or becomes locked out of their account, they can resolve the issue by following on-screen prompts.</p>
<p>When you enable SSPR, many prerequisites must be met:</p>
<ul>
<li>You must have a working Azure AD tenant.</li>
<li>You must be using an account with global administrator privileges.</li>
<li>You must enable SSPR. This is done in the Azure portal, in <strong>Azure Active Directory</strong>, in <strong>Password reset</strong>.</li>
<li>In the <strong>Password reset pages</strong>, you must select all the methods that you wish to be available to users. These are:<ul>
<li>Mobile app notification</li>
<li>Mobile app code</li>
<li>Email</li>
<li>Mobile phone</li>
</ul>
</li>
<li>If you want notifications when SSPR is used, in the <strong>Password reset</strong> pages on the <strong>Notifications</strong> page, you must choose whether to notify the user and if you should notify all admins.</li>
</ul>
<p>If you want to test SSPR for a specific user, you should open a browser window using InPrivate or Incognito mode and go to <a target="_blank" rel="noopener" href="https://aka.ms/ssprsetup">https://aka.ms/ssprsetup</a>. Sign in as a locked-out user and you should be prompted to reset the password.</p>
<p>For more information on setting up and troubleshooting SSPR, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-howitworks">How it works: Azure AD self-service password reset</a>.</p>
<h2 id="Troubleshoot-multifactor-authentication-issues"><a href="#Troubleshoot-multifactor-authentication-issues" class="headerlink" title="Troubleshoot multifactor authentication issues"></a>Troubleshoot multifactor authentication issues</h2><p>Multifactor authentication (MFA) improves security because it requires you to use an additional authentication method and a password.</p>
<p>There are several common issues that you should resolve when troubleshooting MFA:</p>
<ul>
<li>You don’t receive a voice call or text message with the verification code. If this occurs:<ul>
<li>Select <strong>Other verification options</strong> and then try again. If this succeeds, check that your phone numbers are correct in user settings.</li>
<li>If there are no other verification options, ask a global admin to check that your phone numbers are correct in user settings.</li>
<li>If you still can’t connect, ask a global admin to go to the <strong>Users</strong> page in Azure Active Directory, in the Azure portal. Disable <strong>Block sign in</strong> for the user if it’s enabled.</li>
</ul>
</li>
<li>You receive a “Sorry! We can’t process your request” error when you try to set up SSPR. If this happens, ensure that you complete the setup process in less than 10 minutes.</li>
<li>You lose your phone or your phone number has changed, preventing you from using MFA. If this occurs, you need to ask a cloud services admin to select <strong>Require selected users to provide contact methods again</strong> in <strong>Manage user settings</strong> on the multifactor authentication settings.</li>
<li>You receive a “We didn’t receive the expected response” error message. Ensure that you enter the correct code or select <strong>Verify</strong> in the mobile app.</li>
<li>You receive an “Account verification system is having trouble” error message. Ensure that you enter the correct verification code and, if using the call option, you must press the pound (#) key.</li>
</ul>
<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/troubleshoot/azure/active-directory/troubleshoot-azure-mfa-issue">Troubleshoot Azure Active Directory Multifactor Authentication issues</a>.</p>
<h2 id="Review-customer-access-level-to-enterprise-apps-in-Azure"><a href="#Review-customer-access-level-to-enterprise-apps-in-Azure" class="headerlink" title="Review customer access level to enterprise apps in Azure"></a>Review customer access level to enterprise apps in Azure</h2><p>Applications are registered in Azure AD and users can then be assigned to them.</p>
<h3 id="Registering-applications"><a href="#Registering-applications" class="headerlink" title="Registering applications"></a>Registering applications</h3><p>If you’re setting up a cloud application such as Office 365, the steps are straightforward. For detailed information on setting up each individual cloud app, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/saas-apps/tutorial-list">Tutorials for integrating SaaS applications with Azure Active Directory</a>.</p>
<p>If you’ve an application that you’ve developed in-house, you can register it when you add the application or register it in Enterprise Applications, in the <strong>Azure Active Directory Admin Center</strong>. For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/add-application-portal">Quickstart: Add an enterprise application</a>.</p>
<p>If you want to combine an on-premises application with Azure AD security, you should connect it using <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy">Azure AD Application Proxy</a>.</p>
<h3 id="Managing-access-to-apps-in-Azure"><a href="#Managing-access-to-apps-in-Azure" class="headerlink" title="Managing access to apps in Azure"></a>Managing access to apps in Azure</h3><p>Apps can access user and organizational data if they’re given consent. You should control the user consent settings to ensure the correct level of access is set. For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/configure-user-consent?tabs=azure-portal">Configure how users consent to applications</a>.</p>
<p>The default access level is to allow access to all enterprise applications for every user. However, applications can be assigned to just a subset of users. In Azure Active Directory admin center, select <strong>Enterprise applications</strong>. Select the relevant application and select <strong>Users and groups</strong>. You can now see a list of assigned users and groups and, if necessary, add more.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-add-users.png" alt="Assign user account to zn application in your Azure AD tenant."></p>
<p>Troubleshoot issues where users become locked out of their account</p>
<p>To protect the Azure AD domain, an account will be locked out after a defined number of incorrect log in attempts. This could be caused by a brute force malicious attack, or by a user repeatedly entering the wrong password.</p>
<p>You should check whether a user could be using an incorrect password, or whether an app might be using an old or incorrect password. It may be that a password has recently changed in on-premises Active Directory Services (AD DS) and might not have had time to synchronize with Azure AD.</p>
<h3 id="Use-security-audits-to-troubleshoot-account-lockouts"><a href="#Use-security-audits-to-troubleshoot-account-lockouts" class="headerlink" title="Use security audits to troubleshoot account lockouts"></a>Use security audits to troubleshoot account lockouts</h3><p>To preemptively log account lockout issues, you should enable security audits for Azure AD DS. You can enable security audits in the Azure portal. Search for Azure AD Domain Services, select it and select your managed domain. <strong>Select Diagnostic settings</strong> then select <strong>Add diagnostic setting</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-add-diagnostic-settings.png" alt="Screen shot showing add diagnostic settings screen."></p>
<p>For more information on enabling security audits, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory-domain-services/security-audit-events">Enable security audits for Azure Active Directory Domain Services</a>.</p>
<p>When you’ve enabled security events, in the Azure portal, you can select <strong>Monitor, Log Analytics workspaces</strong>. Select your workspace then select <strong>Logs</strong>. You can then write queries using the Kusto querying language.</p>
<p>To search for lockout entries, you should use the filter where <strong>OperationName has “4740”</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/2-create-log.png" alt="Screen shot of the create logs area."></p>
<p>For example, you could run this kusto query to find account lockout data for the last seven days:</p>
<p>Copy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AADDomainServicesAccountManagement</span><br><span class="line"></span><br><span class="line">| where TimeGenerated &gt;= ago(7d)</span><br><span class="line"></span><br><span class="line">| where OperationName has &quot;4740&quot;</span><br></pre></td></tr></table></figure>

<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory-domain-services/troubleshoot-account-lockout">Troubleshoot account lockout problems with an Azure Active Directory Domain Services managed domain</a>.</p>
<h1 id="Troubleshoot-hybrid-authentication-in-Microsoft-Azure"><a href="#Troubleshoot-hybrid-authentication-in-Microsoft-Azure" class="headerlink" title="Troubleshoot hybrid authentication in Microsoft Azure"></a>Troubleshoot hybrid authentication in Microsoft Azure</h1><p>Completed100 XP</p>
<ul>
<li>5 minutes</li>
</ul>
<p>Many systems have a mixture of Azure and on-premises and use a hybrid identity solution. Azure AD Connect is an on-premises application that synchronizes Azure AD with on-premises Active Directory.</p>
<p>Determine why on-premises systems cannot connect to Azure AD resources</p>
<p>To troubleshoot Azure AD Connect, you should use the Azure AD Connect Health portal at <a target="_blank" rel="noopener" href="https://portal.azure.com/">Azure Active Directory Connect Health</a> to view performance monitors and alerts.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-connect-health.png" alt="Screen shot of the Azure AD Connect Health screen."></p>
<p>You can also install the Azure AD Connect Administration Agent on an Azure Active Directory Connect server. The Azure AD Connect Administration Agent presents diagnostic data to Microsoft support engineers. Azure AD Connect Administration Agent is not installed by default and doesn’t store any data. It is specifically intended for live troubleshooting. You can disable the reporting of data by the Azure AD Connect Administration Agent if you edit the service config file. For more information on the Azure AD Connect Administration Agent and how to install and disable it, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/whatis-aadc-admin-agent">What is the Azure AD Connect Admin Agent</a>.</p>
<p>To troubleshoot connectivity issues, you should install Azure AD Connect Health agents. There are Azure AD Connect Health agents for AD FS, Azure ADFS, and Sync. For detailed steps on installing the Azure AD Connect Health agents, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-health-agent-install">Azure AD Connect Health agent installation</a>.</p>
<p>To troubleshoot connectivity issues, you must first have installed AD Connect in your on-premises environment. For more information on installing Azure AD Connect, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-install-roadmap">Azure AD Connect and Azure AD Connect Health installation roadmap</a>.</p>
<h2 id="Troubleshoot-pass-through-authentication-and-password-hash-sync-issues"><a href="#Troubleshoot-pass-through-authentication-and-password-hash-sync-issues" class="headerlink" title="Troubleshoot pass-through authentication and password hash sync issues"></a>Troubleshoot pass-through authentication and password hash sync issues</h2><p>To troubleshoot pass-through authentication, you should first check that it is enabled and that the authentication agents are <strong>Active</strong>. To view the status, go to <strong>Azure Active Directory Admin</strong> Center and select <strong>Azure AD Connect</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-azure-active-directory-connect.png" alt="Screenshot of Azure Active Directory admin center - Azure AD Connect blade."></p>
<p>You should then check if the user is getting errors, or if errors are reported in the <strong>Azure Active Directory admin center</strong>. For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/tshoot-connect-pass-through-authentication">Troubleshoot Azure Active Directory Pass-through Authentication</a>.</p>
<p>Troubleshooting password hash synchronization with Azure AD Connect sync depends on the version you use. There are different steps depending on whether one or many objects have password synchronization issues. Detailed steps for each scenario are available at <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/tshoot-connect-password-hash-synchronization">Troubleshoot password hash synchronization with Azure AD Connect sync</a>.</p>
<h2 id="Review-and-resolve-object-synchronization-with-Azure-AD-Connect-sync"><a href="#Review-and-resolve-object-synchronization-with-Azure-AD-Connect-sync" class="headerlink" title="Review and resolve object synchronization with Azure AD Connect sync"></a>Review and resolve object synchronization with Azure AD Connect sync</h2><p>To resolve object sync issues, start by running the troubleshooting task in the wizard. You should complete the following steps:</p>
<ul>
<li><p>On your Azure AD Connect server, start a Windows PowerShell with the Run as Administrator option and run Set-ExecutionPolicy RemoteSigned.</p>
</li>
<li><p>Start the Azure AD Connect wizard, select <strong>Tasks</strong>, select <strong>Troubleshoot</strong> then select <strong>Next</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-azure-active-directory-additional-tasks.png" alt="Screenshot of troubleshoot object synchronization."></p>
</li>
<li><p>Click <strong>Launch</strong> and type <strong>1</strong> to <strong>Troubleshoot Object Synchronization</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/3-azure-active-directory-troubleshoot-object-synchronization.png" alt="Screenshot of global administrator credentials."></p>
</li>
</ul>
<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/tshoot-connect-objectsync">Troubleshoot object synchronization with Azure AD Connect sync</a>.</p>
<h2 id="Troubleshoot-Azure-AD-Application-proxy-connectivity-issues"><a href="#Troubleshoot-Azure-AD-Application-proxy-connectivity-issues" class="headerlink" title="Troubleshoot Azure AD Application proxy connectivity issues"></a>Troubleshoot Azure AD Application proxy connectivity issues</h2><p>To troubleshoot Azure AD Application proxy connectivity issues, do the following steps:</p>
<p>On your on-premises Active Directory server, open the Windows Services console and ensure that the <strong>Microsoft AAD Application Proxy Conne</strong>ctor service is enabled and running.</p>
<p>To discover events that could be causing problems, open Event Viewer and look for Application Proxy connector events in <strong>Applications and Services</strong> <strong>Logs</strong> &gt; <strong>Microsoft</strong> &gt; <strong>AadApplicationProxy</strong> &gt; <strong>Connector</strong> &gt; <strong>Admin</strong>.</p>
<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy-troubleshoot">Troubleshoot Application Proxy problems and error messages</a>.</p>
<h2 id="Troubleshoot-Active-Directory-Domain-Service"><a href="#Troubleshoot-Active-Directory-Domain-Service" class="headerlink" title="Troubleshoot Active Directory Domain Service"></a>Troubleshoot Active Directory Domain Service</h2><p>When troubleshooting Azure AD to Active Directory Domain Service integration, you need to troubleshoot Azure Active Directory Domain Services. Common issues for Azure AD DS include:</p>
<ul>
<li>Problems enabling Azure AD DS.</li>
<li>Microsoft Graph is disabled—this must be enabled to synchronize your Azure AD tenant.</li>
<li>Users in your Azure AD tenant are unable to sign into the managed domain.</li>
<li>There are alerts in your managed domain.</li>
</ul>
<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory-domain-services/troubleshoot">Common errors and troubleshooting steps for Azure Active Directory Domain Services</a>.</p>
<h1 id="Troubleshoot-authorization-issues-with-Microsoft-Azure"><a href="#Troubleshoot-authorization-issues-with-Microsoft-Azure" class="headerlink" title="Troubleshoot authorization issues with Microsoft Azure"></a>Troubleshoot authorization issues with Microsoft Azure</h1><p>Completed100 XP</p>
<ul>
<li>6 minutes</li>
</ul>
<p>When a user has been authenticated, they must be authorized to carry out actions. If a user can’t complete a required action, but their identity is correctly authenticated, you need to troubleshoot authorization issues.</p>
<h2 id="Troubleshoot-Conditional-Access"><a href="#Troubleshoot-Conditional-Access" class="headerlink" title="Troubleshoot Conditional Access"></a>Troubleshoot Conditional Access</h2><p>Conditional Access policies use numerous signals to decide whether a user should have access to a resource. For example, the user’s geographic location, type of device, and application being used can all be considered, alongside the user’s identity.</p>
<h3 id="Troubleshoot-Conditional-Access-policy-changes"><a href="#Troubleshoot-Conditional-Access-policy-changes" class="headerlink" title="Troubleshoot Conditional Access policy changes"></a>Troubleshoot Conditional Access policy changes</h3><p>If Conditional Access was previously working successfully, but is now not functioning as expected, you should investigate policy changes. Audit log data is held for 30 days and this can be increased in Azure Active Directory Diagnostic settings.</p>
<p>To view the audit log in the Azure portal, select <strong>Azure Active Directory</strong> then select Audit logs. Select the relevant date range and, in <strong>Activity</strong>, select <strong>Add conditional access policy</strong>, or <strong>Update conditional access policy</strong>, or <strong>Delete conditional access policy</strong>.</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-audit-logs.png#lightbox"><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-audit-logs.png" alt="Audit log entry showing old and new JSON values for Conditional Access policy"></a></p>
<h3 id="Troubleshoot-sign-in-problems-with-Conditional-Access"><a href="#Troubleshoot-sign-in-problems-with-Conditional-Access" class="headerlink" title="Troubleshoot sign-in problems with Conditional Access"></a>Troubleshoot sign-in problems with Conditional Access</h3><p>To avoid sign-in problems with Conditional Access, be very cautious if policies apply to all users, all cloud apps, or all devices. These policies could potentially block the entire organization.</p>
<p>To troubleshoot sign-in problems, you should initially review the error message. This will typically list the policy that is causing the problem and allow you to identify the policy to update. By clicking <strong>More details</strong> on the error message you can find the specific sign-in event.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-more-details-sign.png" alt="More details from a Conditional Access interrupted web browser sign-in."></p>
<p>When you have the details of the sign-in event, you can open the Azure portal, select <strong>Azure Active Directory</strong> then select <strong>Sign-ins</strong>. Add filters to find the correct type of events, such as Conditional Access failures, and find the specific event.</p>
<p><img src="https://learn.microsoft.com/en-us/training/wwl-azure/troubleshoot-authentication-access-control/media/4-conditional-access-sign-log.png" alt="Selecting the Conditional access filter in the sign-ins log"></p>
<p>You can then select the event to view more details and the policy details for that event.</p>
<h3 id="The-What-If-tool"><a href="#The-What-If-tool" class="headerlink" title="The What If tool"></a>The What If tool</h3><p>The What If tool is also available to help with troubleshooting.</p>
<p>Open the Azure portal, select <strong>Azure Active Directory</strong>, select <strong>Conditional Access</strong> then select <strong>What If</strong>. You can now add conditions and see which Conditional Access policies will be applied.</p>
<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/">Azure AD Conditional Access documentation</a>.</p>
<h2 id="Troubleshoot-role-based-access-control"><a href="#Troubleshoot-role-based-access-control" class="headerlink" title="Troubleshoot role-based access control"></a>Troubleshoot role-based access control</h2><p>A wide range of issues could affect role-based access control (RBAC). These issues include:</p>
<ul>
<li>A limit to the number of role assignments.</li>
<li>Having correct permissions to work with roles.</li>
<li>Losing role assignments when subscriptions are transferred to a different Azure AD directory, or resources are moved.</li>
<li>Security principals deleted or only recently created.</li>
<li>Management capabilities requiring write access.</li>
</ul>
<p>For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/role-based-access-control/troubleshooting">Troubleshoot Azure RBAC</a>.</p>
<h2 id="Troubleshoot-issues-when-storing-encrypted-passwords-in-Azure-Key-Vault"><a href="#Troubleshoot-issues-when-storing-encrypted-passwords-in-Azure-Key-Vault" class="headerlink" title="Troubleshoot issues when storing encrypted passwords in Azure Key Vault"></a>Troubleshoot issues when storing encrypted passwords in Azure Key Vault</h2><p>Azure Key Vault uses access policies to authorize user actions. There are many steps to troubleshoot Azure Key Vault access policy issues. For more information, see <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/key-vault/general/troubleshooting-access-issues">Troubleshooting Azure key vault access policy issues</a>.</p>
<h1 id="Demo-Troubleshoot-authentication-and-access-control-issues"><a href="#Demo-Troubleshoot-authentication-and-access-control-issues" class="headerlink" title="Demo: Troubleshoot authentication and access control issues"></a>Demo: Troubleshoot authentication and access control issues</h1><p>Completed100 XP</p>
<ul>
<li>5 minutes</li>
</ul>
<p>In this demonstration you will see how to proactively troubleshoot Conditional Access policies using the What if tool in the Azure portal:</p>
<iframe src="https://www.microsoft.com/en-us/videoplayer/embed/RE4RYRI?postJsllMsg=true" frameborder="0" allowfullscreen="true" data-linktype="external" title="Video Player" style="box-sizing: inherit; outline-color: inherit; margin: 0px; padding: 0px; border: 0px; width: 640px; height: 360px; position: absolute; inset: 0px;"></iframe>



















<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>Completed100 XP</p>
<ul>
<li>3 minutes</li>
</ul>
<p>In this module, you learned how to troubleshoot a deployment of Azure Active Directory (Azure AD) that is based entirely in the cloud and a hybrid deployment of Azure AD that is part cloud-based and part on-premises. You also learned how to troubleshoot authorization issues when using Microsoft Azure.</p>
<p>Now that you’ve completed this module, you should be able to:</p>
<ul>
<li>Troubleshoot Azure AD authentication.</li>
<li>Troubleshoot hybrid authentication.</li>
<li>Troubleshoot authorization issues.</li>
</ul>
<h2 id="Learn-more"><a href="#Learn-more" class="headerlink" title="Learn more"></a>Learn more</h2><p>For more information about the topics discussed in this module, see:</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-sspr-howitworks">How it works: Azure AD self-service password reset.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/troubleshoot/azure/active-directory/troubleshoot-azure-mfa-issue">Troubleshoot Azure AD Multifactor Authentication issues.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/saas-apps/tutorial-list">Tutorials for integrating SaaS applications with Azure Active Directory.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/add-application-portal">Quickstart: Add an enterprise application.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/configure-user-consent?tabs=azure-portal">Configure how users consent to applications.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory-domain-services/security-audit-events">Enable security audits for Azure Active Directory Domain Services.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory-domain-services/troubleshoot-account-lockout">Troubleshoot account lockout problems with an Azure Active Directory Domain Services managed domain.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/whatis-aadc-admin-agent">What is the Azure AD Connect Admin Agent?</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-health-agent-install">Azure AD Connect Health agent installation.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-install-roadmap">Azure AD Connect and Azure AD Connect Health installation roadmap.</a>.</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/tshoot-connect-pass-through-authentication">Troubleshoot Azure Active Directory Pass-through Authentication.</a>.</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/tshoot-connect-password-hash-synchronization">Troubleshoot password hash synchronization with Azure AD Connect sync.</a>.</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/tshoot-connect-objectsync">Troubleshoot object synchronization with Azure AD Connect sync.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy-troubleshoot">Troubleshoot Application Proxy problems and error messages.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory-domain-services/troubleshoot">Common errors and troubleshooting steps for Azure Active Directory Domain Services.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/">Azure AD Conditional Access documentation.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/role-based-access-control/troubleshooting">Troubleshoot Azure RBAC.</a></p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/key-vault/general/troubleshooting-access-issues">Troubleshooting Azure key vault access policy issues.</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/14/AZ-720-Troubleshoot-platform-as-a-service-issues-in-Microsoft-Azure-4/" rel="prev" title="AZ-720-Troubleshoot-platform-as-a-service-issues-in-Microsoft-Azure-4">
      <i class="fa fa-chevron-left"></i> AZ-720-Troubleshoot-platform-as-a-service-issues-in-Microsoft-Azure-4
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/14/AZ-720-Troubleshoot-network-security-issues-with-Microsoft-Azure-6/" rel="next" title="AZ-720-Troubleshoot-network-security-issues-with-Microsoft-Azure-6">
      AZ-720-Troubleshoot-network-security-issues-with-Microsoft-Azure-6 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Learning-objectives"><span class="nav-number">1.1.</span> <span class="nav-text">Learning objectives</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Prerequisites"><span class="nav-number">1.2.</span> <span class="nav-text">Prerequisites</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Troubleshoot-Azure-AD-authentication"><span class="nav-number">2.</span> <span class="nav-text">Troubleshoot Azure AD authentication</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#The-difference-between-Azure-AD-editions"><span class="nav-number">2.1.</span> <span class="nav-text">The difference between Azure AD editions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-self-service-password-reset-issues"><span class="nav-number">2.2.</span> <span class="nav-text">Troubleshoot self-service password reset issues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-multifactor-authentication-issues"><span class="nav-number">2.3.</span> <span class="nav-text">Troubleshoot multifactor authentication issues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Review-customer-access-level-to-enterprise-apps-in-Azure"><span class="nav-number">2.4.</span> <span class="nav-text">Review customer access level to enterprise apps in Azure</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Registering-applications"><span class="nav-number">2.4.1.</span> <span class="nav-text">Registering applications</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Managing-access-to-apps-in-Azure"><span class="nav-number">2.4.2.</span> <span class="nav-text">Managing access to apps in Azure</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Use-security-audits-to-troubleshoot-account-lockouts"><span class="nav-number">2.4.3.</span> <span class="nav-text">Use security audits to troubleshoot account lockouts</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Troubleshoot-hybrid-authentication-in-Microsoft-Azure"><span class="nav-number">3.</span> <span class="nav-text">Troubleshoot hybrid authentication in Microsoft Azure</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-pass-through-authentication-and-password-hash-sync-issues"><span class="nav-number">3.1.</span> <span class="nav-text">Troubleshoot pass-through authentication and password hash sync issues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Review-and-resolve-object-synchronization-with-Azure-AD-Connect-sync"><span class="nav-number">3.2.</span> <span class="nav-text">Review and resolve object synchronization with Azure AD Connect sync</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-Azure-AD-Application-proxy-connectivity-issues"><span class="nav-number">3.3.</span> <span class="nav-text">Troubleshoot Azure AD Application proxy connectivity issues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-Active-Directory-Domain-Service"><span class="nav-number">3.4.</span> <span class="nav-text">Troubleshoot Active Directory Domain Service</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Troubleshoot-authorization-issues-with-Microsoft-Azure"><span class="nav-number">4.</span> <span class="nav-text">Troubleshoot authorization issues with Microsoft Azure</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-Conditional-Access"><span class="nav-number">4.1.</span> <span class="nav-text">Troubleshoot Conditional Access</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Troubleshoot-Conditional-Access-policy-changes"><span class="nav-number">4.1.1.</span> <span class="nav-text">Troubleshoot Conditional Access policy changes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Troubleshoot-sign-in-problems-with-Conditional-Access"><span class="nav-number">4.1.2.</span> <span class="nav-text">Troubleshoot sign-in problems with Conditional Access</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-What-If-tool"><span class="nav-number">4.1.3.</span> <span class="nav-text">The What If tool</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-role-based-access-control"><span class="nav-number">4.2.</span> <span class="nav-text">Troubleshoot role-based access control</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshoot-issues-when-storing-encrypted-passwords-in-Azure-Key-Vault"><span class="nav-number">4.3.</span> <span class="nav-text">Troubleshoot issues when storing encrypted passwords in Azure Key Vault</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Demo-Troubleshoot-authentication-and-access-control-issues"><span class="nav-number">5.</span> <span class="nav-text">Demo: Troubleshoot authentication and access control issues</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Summary"><span class="nav-number">6.</span> <span class="nav-text">Summary</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Learn-more"><span class="nav-number">6.1.</span> <span class="nav-text">Learn more</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
