<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="IntroductionHi, and welcome to this Configuring Azure Application and Data Security Course. My name is Hallam Webber and I will be your instructor for this course. This is an intermediate-level cour">
<meta property="og:type" content="article">
<meta property="og:title" content="AZ-500-Configuring-Azure-Application-and-Data-Security-17">
<meta property="og:url" content="https://example.com/2022/11/15/AZ-500-Configuring-Azure-Application-and-Data-Security-17/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="IntroductionHi, and welcome to this Configuring Azure Application and Data Security Course. My name is Hallam Webber and I will be your instructor for this course. This is an intermediate-level cour">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-11-15T14:11:46.000Z">
<meta property="article:modified_time" content="2022-11-20T23:13:00.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/2022/11/15/AZ-500-Configuring-Azure-Application-and-Data-Security-17/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AZ-500-Configuring-Azure-Application-and-Data-Security-17 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Hang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Configuring-Azure-Application-and-Data-Security-17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AZ-500-Configuring-Azure-Application-and-Data-Security-17
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:46" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:46-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:13:00" itemprop="dateModified" datetime="2022-11-20T19:13:00-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Configuring-Azure-Application-and-Data-Security-17/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Configuring-Azure-Application-and-Data-Security-17/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <span id="more"></span>

<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hi, and welcome to this Configuring Azure Application and Data Security Course. My name is Hallam Webber and I will be your instructor for this course. This is an intermediate-level course suited to DBAs, system analysts, programmers, or anyone wanting to learn how to make use of the security features available with Microsoft Azure cloud services. It will help to have an understanding of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/azure-virtual-networking/course-intro-18/">cloud services in general</a> and, more specifically, <a target="_blank" rel="noopener" href="https://cloudacademy.com/learning-paths/architecting-microsoft-azure-solutions-70-535-exam-preparation-220/">Microsoft’s Azure offering</a>, as well as basic database and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/azure-virtual-networking/course-intro-18/">networking</a> concepts.</p>
<p>In this scenario, we will look at securing and protecting your applications and data when moving from an on-premise to an Azure environment. Security and protection are broad topics and have different meanings in the context of different types of data and services. The Azure offerings allow you to implement different and more tightly defined security than on-premise, and at the same time free you from many of the basic infrastructure concerns. We will look at configuring security policies to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-classification-part-1/">classify</a>, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/how-to-protect-your-data/">protect</a>, and manage data, how to configure data infrastructure security, how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/how-to-design-a-secure-azure-application/">securely deploy your applications</a>, and what <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/security-in-azure-app-service/">Azure security features</a> are available to your applications. We welcome all comments and feedback, so please feel free to reach out to us at <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a> with any questions or comments. Now let’s begin.</p>
<h1 id="Data-Classification-Part-1"><a href="#Data-Classification-Part-1" class="headerlink" title="Data Classification Part 1"></a>Data Classification Part 1</h1><p>Microsoft uses the following data classifications when <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">implementing data protection</a> policies. </p>
<p>Personal data is any data that relates to an identifiable natural person, such as a name or contact information. This can include user IDs that a Microsoft service assigns to a user, although this is considered pseudonymous, as it cannot alone necessarily identify an individual. </p>
<p>Administrator data is the personal data and contact information about individuals that sign up for Microsoft services. The administrator data also includes aggregated users’ information and other data associated with the administrator account. </p>
<p>Object metadata is the setting data associated with all Microsoft services that you sign up to. This includes Azure storage account details, virtual machines, SQL databases and their tables, columns, headings, and forms. This does not include the personal administrator data. Customers should not include personal data, or other sensitive information in object metadata, because object metadata may be shared across global Microsoft systems to facilitate operations and troubleshooting. </p>
<p>Payment data is the information customers provide when making online purchases with Microsoft. It may include a credit card number and security code, name and billing address, and other financial data. Microsoft uses payment data to complete transactions, as well as to detect and prevent fraud.</p>
<p>Support and consulting data is all data provided to Microsoft by, or on behalf of, a customer, typically in a support scenario, or when engaging Microsoft professional services. This data may be in any form, including text, sound, video, or images, and even software. The data may be acquired via phone, chat, email, or webforms.</p>
<h1 id="How-to-Protect-Your-Data"><a href="#How-to-Protect-Your-Data" class="headerlink" title="How to Protect Your Data"></a>How to Protect Your Data</h1><p>You can <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">classify and protect your data </a>with a combination of Azure Information Protection and Azure Rights Management. </p>
<p>Azure Information Protection can automatically classify your data by using clear text labels that are inserted into the metadata of a document, based on rules set up by the administrator. </p>
<p>Azure Rights Management uses encryption, identity, and authorization policies to help secure your files and email, and it works across multiple devices - phones, tablets, and PCs. </p>
<p>Information can be protected both within your organization and outside your organization because that protection remains with the data, even when it leaves your organization’s boundaries. </p>
<p>When you activate Azure Information Protection, there are five default labels. They’re Personal, Public, General, Confidential, and Highly Confidential. Implementing Azure Information Protection involves activating the service in the Azure portal, adding default labels to the default Global policy, and installing the Information Protection client software on users’ computers.</p>
<h1 id="AIP-Custom-Rule"><a href="#AIP-Custom-Rule" class="headerlink" title="AIP Custom Rule"></a>AIP Custom Rule</h1><p>You have the ability to set up your own custom labels. You can do this by going into Azure Information Protection and clicking on the labels tag, and clicking Add new label. Give the label a name and a description. You can then select a color for the label, and also whether you want to enable automatic protection. When you set up the protection, you can either set permissions, which allows you to configure the file expiration date, and whether or not to allow offline access. Or you can allow the user to set the permissions on the document at the time of creation. You then set the conditions that will activate the protection rule associated with the label.</p>
<p>There are a large number of predefined conditions, but you can also create your own custom condition. The custom condition will be activated when the text pattern you’ve specified appears in a document. After you have created your label and any associated protection conditions and rules, you must associate it with a policy. Do this by selecting a policy from information protection policies. Go into the policy and add the newly created label. To enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">data classification and protection</a> on client machines, you must install the AzInfoProtection software. With this installed, applications like Office 365 will get the information protection toolbar. When a phrase is typed that matches one of the conditions in your rules, the user will be prompted to apply the associated label. Information protection can also be applied through the context menu of Windows Explorer by selecting a file, right-clicking and selecting Classify and protect.</p>
<h1 id="Data-Classification-Part-2"><a href="#Data-Classification-Part-2" class="headerlink" title="Data Classification Part 2"></a>Data Classification Part 2</h1><p>Azure supports <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">data classification </a>for databases when you enable Advanced Threat Protection. This will incur a small charge. Data classification can also be applied to database fields within the advanced data security function of Azure. Click on the Data Discovery and Classification and then on the Classification tab. You may find there are already recommendations for your database fields. You can select a table, then a column, and then you can assign an information type to the column plus a Sensitivity, which will be one of your existing labels. You can then add the classification. It looks like the default classification labels are applied on the fields by data type. That is, the financial classification is applied to fields that are of the money data type.</p>
<h1 id="Data-Retention"><a href="#Data-Retention" class="headerlink" title="Data Retention"></a>Data Retention</h1><p>When we talk of data retention, we are actually speaking of several different things. There is how long your data is available after you have ended your subscription. There is data retention in the context of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/blob-storage-retention/">blob storage</a>. We can set data retention policies for databases. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/long-term-retention-database-backups/">Long term data retention</a> determines how long your database backups are held for. Finally, there is the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/storage-analytics-data-retention-policy/">retention of analytics and metrics data</a>.</p>
<p>With the exception of free trials, if your cloud subscription is terminated or expires, Microsoft will store your data in a limited function account for 90 days. This will give you time to extract your data or renew your subscription. After the 90-day retention period, your data will be deleted, including all cached or backup copies.</p>
<h1 id="Blob-Storage-Retention"><a href="#Blob-Storage-Retention" class="headerlink" title="Blob Storage Retention"></a>Blob Storage Retention</h1><p>For blob storage, we have immutable storage for Azure Blobs, which enables users to store business-critical data objects in a write once read many times state, abbreviated to WORM. This state makes the data non-erasable and non-modifiable for a user-specific interval. If the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">retention</a> period is unknown, you can place a legal hold policy on the data. When a legal hold policy is set, blobs can be created and read but not modified or deleted. Each legal hold is associated with a user-defined tag, such as a case ID or event name. WORM policies are independent of the Azure blob storage tier and applied to all tiers. Users can transition to the most cost-optimized tier for their workloads, while maintaining data immutability.</p>
<h1 id="Long-Term-Retention-Database-Backups"><a href="#Long-Term-Retention-Database-Backups" class="headerlink" title="Long-Term Retention - Database Backups"></a>Long-Term Retention - Database Backups</h1><p>You can set the long-term <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">retention</a> policy for your database backups by going to your server and, under Manage Backups, you can then configure the retention policy for each of your databases to specify how long you would like to keep the backups for.</p>
<h1 id="Azure-Data-Explorer-Data-Retention"><a href="#Azure-Data-Explorer-Data-Retention" class="headerlink" title="Azure Data Explorer Data Retention"></a>Azure Data Explorer Data Retention</h1><p>Azure Data Explorer, as a big data service, can potentially produce a lot of data that will become irrelevant after a short period of time. By setting up <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">data retention</a> policies, you can reduce the likelihood of cost overruns and storing irrelevant data. There are two main properties to the Data Explorer retention policy. The soft delete period is a time span for which it is guaranteed data will be kept available to query and measure since the time it was ingested. This defaults to 100 years. When altering the soft delete period of a table or database, the new value applies to both existing and new data. A soft delete period of zero can be set as part of table-level retention. This is especially useful if data is going to be transformed, and is only present in a staging table temporarily. The soft delete period guarantees how long the data will be available for, but not necessarily when it will be deleted. As the data is not necessarily deleted immediately at the end of the soft delete period, it can linger for some time. Recoverability is the other property of the retention policy object. This defaults to enabled, and the data will be recoverable for up to 14 days after deletion.</p>
<h1 id="Storage-Analytics-Data-Retention-Policy"><a href="#Storage-Analytics-Data-Retention-Policy" class="headerlink" title="Storage Analytics Data Retention Policy"></a>Storage Analytics Data Retention Policy</h1><p>Analytics and metrics data will be written until the shared 20TB limit is reached. When that happens, no new data will be written. You can free up space with a manual request to delete stored Analytics data, but this is billable. Alternately, you can set up a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">data retention</a> policy for logging and metrics data. To set up a policy that deletes both logging and metrics data after seven days, make a request to the Set Blob Service Properties, Set Table Service Properties, or Set Queue Service Properties operation with the RetentionPolicy nodes configured like this. It is possible to configure <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/blob-storage-retention/">blob storage</a> metrics and logging through the Azure portal by going into your storage account and then into Diagnostic settings (classic).</p>
<h1 id="Configuring-Data-Sovereignty"><a href="#Configuring-Data-Sovereignty" class="headerlink" title="Configuring Data Sovereignty"></a>Configuring Data Sovereignty</h1><p>Technical and regulatory factors are the two main considerations when deciding where to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">deploy your data and resources</a> geographically. Most of your services can be deployed to a user-specified region, although there are some services, like <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/enabling-database-authentication-with-azure-active-directory/">Azure Active Directory</a>, that could be deployed in a non-region-specific datacenter. Azure provides policies, such as Allowed Locations, to restrict where an organization can deploy its resources. An allowed region locations policy is defined using JSON and can be deployed using the Azure Portal, or Azure PowerShell, Azure Command Line Interface, or REST API.</p>
<h1 id="Enabling-Database-Authentication-with-Azure-Active-Directory"><a href="#Enabling-Database-Authentication-with-Azure-Active-Directory" class="headerlink" title="Enabling Database Authentication with Azure Active Directory"></a>Enabling Database Authentication with Azure Active Directory</h1><p>Azure Active Directory authentication gives you a similar experience to on-premise Windows authentication. This means being able to centrally manage database logins and not have to set up SQL logins for individual databases. As well as enforcing a strong password policy through Active Directories, Azure AD supports token-based authentication for applications connecting to SQL Databases.</p>
<h1 id="Setting-Admin-Demo"><a href="#Setting-Admin-Demo" class="headerlink" title="Setting Admin Demo"></a>Setting Admin Demo</h1><p>To enable <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/enabling-database-authentication-with-azure-active-directory/">Active Directory authentication</a> with Azure SQL, the first thing you must do is set the administrator for your database server. In the Azure portal, select your server and then, under Settings, select Active Directory Admin. Click the Set admin button at the top and then select your Active Directory user that you want to set as the admin and then save.</p>
<h1 id="Azure-SQL-Auditing"><a href="#Azure-SQL-Auditing" class="headerlink" title="Azure SQL Auditing"></a>Azure SQL Auditing</h1><p>SQL auditing allows you to record various types of database events; specifically, data access, data changes, schema changes, security exceptions, and changes to account, roles and permissions. The audit log data is written to append <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/blob-storage-retention/">blobs</a> associated with your subscription. Auditing can either be set up at the server level or per individual database. If you set up your auditing at the server level, there is no need to set it up at the database level, as this is a duplication. Having said that, there could be situations where you want to record different types of events for one database specifically that aren’t being recorded for all the others on the server. Or maybe you want to use a different storage account or <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">retention</a> period for a particular database.</p>
<h1 id="Azure-SQL-Auditing-Demo"><a href="#Azure-SQL-Auditing-Demo" class="headerlink" title="Azure SQL Auditing Demo"></a>Azure SQL Auditing Demo</h1><p>To <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">turn on</a> <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/azure-sql-auditing/">Azure SQL auditing</a>, go to Auditing under Security in your server or database blade, switch auditing on and then select the destination to store your audit data. In this case, I’m going to select <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/blob-storage-retention/">blob storage</a>. Select a storage account, and then specify the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">retention</a> period as the number of days. The default retention days is zero, which means unlimited retention. You can click View audit logs to see the audit logs.</p>
<h1 id="Azure-SQL-Advanced-Threat-Detection"><a href="#Azure-SQL-Advanced-Threat-Detection" class="headerlink" title="Azure SQL Advanced Threat Detection"></a>Azure SQL Advanced Threat Detection</h1><p>Advanced Threat Protection is a catch-all term for a service that alerts you when particular types of events are detected in your database. These events range from possible SQL injection, to access from an unusual location or login, to when an unusually high number of failed login attempts are recorded.</p>
<p>The SQL injection alert is raised when an application executes faulty SQL against the database. I guess the assumption is that programmatically generated SQL should be correct unless it has been nefariously tampered with. While none of these features are magical, it is a very easy and convenient way to monitor anomalous behavior.</p>
<p>To set up advanced threat detection, go into your database and turn on Advanced Data Security, then towards the bottom of the page, under Advanced Threat Protection Settings, you can go and select which of the advanced threat protection options you want to enable, then click Save.</p>
<h1 id="Configuring-Access-Control-for-Storage-Accounts"><a href="#Configuring-Access-Control-for-Storage-Accounts" class="headerlink" title="Configuring Access Control for Storage Accounts"></a>Configuring Access Control for Storage Accounts</h1><p>Azure <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">controls</a> access to resources, such as storage and queues, using role-based access control or RBAC. An <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/enabling-database-authentication-with-azure-active-directory/">Azure AD</a> security principle, which can be a user, a group, an application service principle, or a managed identity for Azure resources, can be granted access to resources at the level of subscription, resource group, storage account or an individual container or queue. Before assigning to a user or group, you need to determine the scope of access required. It is best to allow only the absolutely necessary scope of access to resources. </p>
<p>Starting with the narrowest, the levels of scope are:</p>
<p><strong>An individual container</strong>: at this scope, a role assignment applies to all of the blobs in the container as well as container properties and metadata. </p>
<p><strong>An individual queue</strong>: at this scope, a role assignment applies to messages in the queue as well as queue properties and metadata. </p>
<p><strong>The storage account</strong>: at this scope, a role assignment applies to all containers and their blobs or to all queues and their messages. </p>
<p><strong>The resource group</strong>: at this scope, a role assignment applies to all of the containers or queues, and all of the storage accounts in the resource group.</p>
<p><strong>The subscription</strong>: at this scope, a role assignment applies to all of the containers or queues, and all of the storage accounts and all the resource groups in the subscription.</p>
<p>To assign role-based access control to a storage account, select the storage account, then select Access control and click the Add button under Add a role assignment. Within Add role assignment, select a role from the drop-down list, then select the user or group you want to assign the role to, then click Save. If you go into Role Assignments, you can view what roles are being assigned to users.</p>
<h1 id="Configuring-Key-Management-for-Storage-Accounts"><a href="#Configuring-Key-Management-for-Storage-Accounts" class="headerlink" title="Configuring Key Management for Storage Accounts"></a>Configuring Key Management for Storage Accounts</h1><p>When you <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">create</a> a storage account, a key is automatically generated by Azure. The account name and key act as a username and password for accessing the storage account. These keys (there are two of them), are available to view through the Access keys under your storage account settings.</p>
<p>You can easily regenerate the keys by clicking on the blue circular arrows next to key1 and key2. You can also use your own keys to manage storage encryption. This is called customer-managed keys, where you generate or import your own keys and then use the Azure Key Vault to store and manage them.</p>
<p>To use customer-managed keys for storage and encryption, go to your storage account and select Encryption under settings. Click the “Use your own key” checkbox. Click Select from Key Vault radio button, and then click Select under Key Vault to select the key vault you want to use.</p>
<p>If a key doesn’t yet exist, you can create one here by clicking Generate&#x2F;Import. Give your key a name and set any parameters you need to, like type, size, activation, and expiration dates. Click the Create button. Now select your key from the vault and click Save.</p>
<h1 id="Granting-Limited-Access-to-Azure-Storage-Resources-with-Shared-Access-Signatures-SAS"><a href="#Granting-Limited-Access-to-Azure-Storage-Resources-with-Shared-Access-Signatures-SAS" class="headerlink" title="Granting Limited Access to Azure Storage Resources with Shared Access Signatures (SAS)"></a>Granting Limited Access to Azure Storage Resources with Shared Access Signatures (SAS)</h1><p>A Shared access signature, or SAS, is a URI that provides <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/configuring-access-control-for-storage-accounts/">access</a> to an Azure storage resource for users that you don’t want to give the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/configuring-key-management-for-storage-accounts/">storage account key</a> to. The URI has parameters that specify the type of access and when the resource can be accessed as well as an authentication key specific to that resource. Shared access signatures come in 3 flavors.</p>
<p>·    A user delegation SAS is based on <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/enabling-database-authentication-with-azure-active-directory/">Azure Active Directory credentials</a>. Those credentials along with permissions specified for the SAS define the access to the blob storage. It’s called a user delegation SAS because it is signed with a user delegation key.</p>
<p>·    A service SAS provides access to a storage service, and just that service. So, you can provide access to either <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/blob-storage-retention/">blob storage</a>, queue storage, table storage, or file storage. If you need to specify what type of access should be allowed on the service this can be done by referencing a stored access policy.</p>
<p>·    An account SAS allows you to provide access to multiple services within a storage account. While service SAS requires a stored access policy to define the type of access permitted, an account SAS allows you to specify the type of operations that can be performed on those services within the URI. That is, you can specify whether read, list, add, create, write, update, or delete operations are allowed. These operations will vary slightly from resource to resource. For example, you can only assign process permission to a queue service.</p>
<p>Both service and account shared access signatures are secured with the storage account key. You can define a shared access signature as a standalone self-contained entity called an Ad hoc SAS, or you can associate a service SAS with a stored access policy. Essentially this makes your service SAS configurable and dynamic. </p>
<p>Creating and referencing a store access policy through the Azure portal UI is reasonably straight-forward. It involves setting access on the resource, in this case read and list permissions on a blob container. You then navigate to the container within Storage Explorer and right click on it selecting the Get Shared Access Signature menu option. Finally select your access policy from the drop-down list and save.</p>
<p>You can now change how your resource is accessed without having to generate and distribute a new Shared Access Signature, just by editing your access policy</p>
<p>Here we can see the structure of a shared access signature. It is a URL with the signature’s properties defined as parameters, starting with the blob address, type of access allowed, times of access, the supported access request types, storage version, and finally, the authentication signature.</p>
<h1 id="Configuring-Security-for-HDInsight"><a href="#Configuring-Security-for-HDInsight" class="headerlink" title="Configuring Security for HDInsight"></a>Configuring Security for HDInsight</h1><p>Here we look at <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">configuring security</a> for HDInsight with Enterprise Security Package. This means enabling users to authenticate with their domain credentials. </p>
<p>Setting this up involves a few steps. Firstly, we need to enable Azure Active Directory Domain Services. Then we must create and authorize a managed identity. Once these preliminary steps have been completed, we can create an HDInsight cluster with Enterprise Security Package. Just note that ESP is only available with Hadoop, Spark, and Interactive Query cluster types.</p>
<p>To enable Azure Active Directory Domain Services, create a new Azure AD Domain Services resource. Assign your resource group and your location. Next, if you do not have a virtual network, you will need to create one. You need to create a dedicated subnet before you deploy Azure Active Directory Domain Services. You will need to assign at least one user to a special administrative group called AAD DC Administrators, which is used for managing the Azure Active Directory Domain Services domain. Members of this group are granted administrative permissions on virtual machines that are joined to the managed domain. Next, we turn on synchronization and click OK in the summary.</p>
<p>Next, we need to create an authorized assigned managed identity by creating a new User assigned managed identity resource. A user assigned managed identity simplifies securing domain services operations. After creating the managed identity, we need to assign the HDInsight Domain Services contributor role to it. We do this by going into our Active Directory Domain Services resource. Select Access Control, and then select User managed identity from the find drop-down, and select your managed identity. Click Add role assignment and select the HDInsight Domain Services Contributor role. Next, we want to add users to the Managed Identity Operator role of our user assigned managed identity.</p>
<p>Now we create the HDInsight cluster. Give it a name and select the region. I’m going to use the Hadoop cluster type, as this supports Enterprise Security Package. You’ll need to supply a cluster login username and password. I’ll just stick with the default storage settings. If you chose a cluster type that did not support ESP, the Enterprise Security Package checkbox would be missing from the Security + Networking page.</p>
<h1 id="Configuring-Cosmos-DB-Security"><a href="#Configuring-Cosmos-DB-Security" class="headerlink" title="Configuring Cosmos DB Security"></a>Configuring Cosmos DB Security</h1><p>Let’s look at the security measures available in Cosmos DB. There are two methods for controlling access to your Cosmos database. Firstly, you can use IP address filtering. By default, this is disabled, so any IP address could potentially access your database. You can configure network and IP access through Firewall and virtual networks under settings. This allows you to specify either particular virtual networks access, or specified IP addresses.</p>
<p>Once connected, a request needs to be authenticated and authorized. This is done using keys: a primary and secondary key that are generated as part of the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">account creation</a>. These are the read-write keys. There are also two read-only keys. Having two sets of keys allows you to regenerate one key in each pair, that is, rotating the keys while maintaining uninterrupted access to the database for users and applications.</p>
<p>It’s definitely not ideal to use the master keys for all access to your Cosmos database. You can use resource tokens to grant access to specified resources within the database. A token is created when a user is given permission to access a resource. Once a user has been authenticated, say, via Azure Active Directory, a resource token is requested for that user from the Cosmos DB account and relayed back to the client. The client app can then use that token to access the specified Cosmos resources until the token expires. Tokens, by default, are only valid for an hour, but this can be extended to up to five hours. Once expired, a new token will be created for the client if access is still permitted.</p>
<p>Apart from keys and resource tokens, you can assign roles and permissions to users through the Cosmos DB account Access control function.</p>
<p>As with other Azure services, Cosmos DB records audit logs which can be viewed through Activity log. In addition to activity logs, you can enable diagnostic logging by going into Diagnostic settings under the monitoring menu. Diagnostic logs can be saved to a storage account, streamed to an event hub, or sent to Log analytics. From a security point of view, Query Runtime Statistics, which records details of queries, could hold valuable information when tracking down suspicious activity. You can also record Mongo requests and Data plane requests, which include the resource unit charge.</p>
<h1 id="Configuring-Security-for-Microsoft-Azure-Data-Lake"><a href="#Configuring-Security-for-Microsoft-Azure-Data-Lake" class="headerlink" title="Configuring Security for Microsoft Azure Data Lake"></a>Configuring Security for Microsoft Azure Data Lake</h1><p>Securing your organization’s data lake is no trivial matter, but you have several lines of defense. There is authentication via Azure Active Directory OAuth bearer tokens. You can manage access with role-based access control, as we have seen earlier with storage accounts, and access control lists. Access control lists, or ACLs, as the name suggests, lists what read, write or execute access is permitted on a file or directory for a user. Data Lake Storage ACLs follow the open POSIX standard. POSIX stands for Portable Operating System Interface. This is an important consideration as Hadoop uses the same POSIX ACL structure.</p>
<p>Your stored data is encrypted, whether that is with a system-created key, or one that you have created or imported yourself, as we saw earlier in customer-managed keys. When the data is being transferred to lake storage it is also encrypted.</p>
<p>In addition to these measures, you can secure your data lake by integrating it with a virtual network. A virtual network provides another layer of access filtering, in as much as users have to be authenticated to access the network.</p>
<h1 id="Securing-Azure-Data-Lake-Storage-with-Virtual-Network-Integration"><a href="#Securing-Azure-Data-Lake-Storage-with-Virtual-Network-Integration" class="headerlink" title="Securing Azure Data Lake Storage with Virtual Network Integration"></a>Securing Azure Data Lake Storage with Virtual Network Integration</h1><p>To use virtual network integration with data lake storage gen1, you must create a virtual network in the same region as your data lake storage account. You need to configure a service endpoint with the Microsoft Azure Active Directory as the service. After creating your virtual network in the same region as your data lake, you need to go to your data lake and click on Firewall and virtual networks. Choose the Selected network radio button and then Add existing virtual network. In the Add networks blade, select your virtual network and the subnet and click Add. Below the firewall section under exceptions, you can enable connectivity from Azure services outside of your selected network.</p>
<h1 id="How-to-Design-a-Secure-Azure-Application"><a href="#How-to-Design-a-Secure-Azure-Application" class="headerlink" title="How to Design a Secure Azure Application"></a>How to Design a Secure Azure Application</h1><p>Now let’s look at how to design a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">secure Azure application</a>, although many of the points raised here apply to application design in general.</p>
<p>Pair - or peer - programming, where you write your code in teams of two, has been shown to improve code quality and learning within a development team. While this is not always practical, and not to everyone’s liking, a less human-resource-hungry alternative is having regular code reviews, ideally before checking into source control, say at the end of an agile sprint. The more eyeballs on the code, the more likely performance and security issues will be detected.</p>
<p>As well as human code reviews, there are a myriad of tools that can analyze your code, highlighting potential security vulnerabilities. </p>
<p>Validate all inputs to your application, as this is the first line of defense against injection-type attacks. This is a good rule of thumb for all software development, not just from a security perspective, but also to keep your data clean and meaningful. It is much easier to validate data at the point of entry than clean or parse it down the track. Try and make the user choose input from sets of options, than using free text fields. Always validate email and web addresses as being in the correct format, and not containing non-printing characters.</p>
<p>Verify your application’s outputs, also known as escaping or output encoding. This means making sure that data is treated as data, and not misinterpreted, excuse the pun, as input relative to script, a script interpreter’s parser. This is essentially guarding against another form of injection attack. An example of this might be someone uploading a file - like CSV orders - to your website, that has an executable script embedded in it. If the file is to be displayed, that is, processed and the output sent back to the browser, this is where the embedded script will be executed if the file’s content hasn’t been escaped. This type of attack is also known as cross-site scripting.</p>
<p>Use parameterized queries or stored procedures in place of dynamic SQL constructed within your application. While building dynamic SQL statements in your application might appear to be a shortcut compared to a complex if-then-else type scenario, and was in vogue many years ago, it can have potentially disastrous consequences. Without very good validation, someone can enter SQL script as input that will be incorporated into your dynamic SQL, that will be executed with completely unintended consequences. It’s just not worth the risk.</p>
<p>Remove standard server headers. By default, all web servers emit in their headers sent to browsers what type of web server it is. For example, server is Microsoft IIS version 8, powered by ASP.NET. This information could be useful to someone wanting to attack your website. Removing that information is easy and won’t impact functionality. In your Web.config file, under <code>&lt;system.webServer&gt;</code> and <code>&lt;security&gt;</code>, set <code>&lt;requestFiltering removeServerHeader=&quot;true&quot; /&gt;</code>. Also, under the custom headers node in <code>&lt;httpProtocol&gt;</code>, create a remove node with <code>name=&quot;X-Powered-By&quot;</code>. Under <code>&lt;system.web&gt;</code>, create a node for <code>httpRuntime</code> with the value <code>enableVersionHeader=&quot;false&quot;</code>, to remove the ASP.NET version.</p>
<p>Don’t develop or test against production data, even if it is in a development or test environment. There is little point going through all the effort of securing your production data, only to have it exposed in insecure and untested scenarios.</p>
<p>Implement a strong password policy that forces users to create complex passwords. While this has been a source of much angst amongst users, research has shown that long passwords are just as good as complex ones. Making users have phrases with upper and lower case, as opposed to just words, would make life easier and more secure.</p>
<p>Check file uploads for viruses and malicious content. This is another form of input validation. It’s hard enough to stop employees clicking on phishing emails, without opening the door to hackers by letting them into your inner sanctum with a simple file upload.</p>
<p>Don’t cache sensitive data in the browser, like personal or payment data, that could be maliciously accessed by accessing the browsers cache or hitting the back button. And be careful how you use URL query parameters, if you have to use them at all. That is, don’t display unencrypted data like record IDs, and don’t put connection strings, keys, or other critical configuration data into apps or config files. Use app settings to store this type of information. App settings are encrypted, and the app servers will make the information available to your app only when required.</p>
<p>Once the application has been developed, you need to verify that it is secure. To do this, find and fix vulnerabilities in your application dependencies by scanning your application and its dependent libraries to identify any known vulnerable components. Vulnerability scanning, powered by Tinfoil Security, is available for Azure at service web apps.</p>
<p>Test your application in an operating state. That will help you to find security vulnerabilities such as memory corruption, insecure server configuration, cross-site scripting, user privilege issues, SQL injection, and other critical security concerns.</p>
<p>Fuzz testing is testing your applications robustness. How does the application perform when deliberately crashed? Does it expose security flaws?</p>
<p>Conduct attack surface review after any changes, to make sure no new attack vectors have been introduced. Attack Surface Analyzer from Microsoft can scan your application for vulnerabilities.</p>
<p>Perform security penetration testing on deployment, and monitor for open ports, endpoints, and attacks.</p>
<p>Secure DevOps Kit for Azure contains SVTs for multiple services of the Azure platform. You run these SVTs periodically to ensure that your Azure subscription, and the different resources that comprise your application, are in a secure state. You can also automate these tests by using the continuous integration&#x2F;continuous deployment (CI&#x2F;CD) extensions feature of AzSK, which makes SVTs available as a Visual Studio extension.</p>
<p>Applications are rarely static, and will be amended and modified throughout their lifecycle. You must have security verification procedures in place to monitor apps on an ongoing basis.</p>
<h1 id="Implementing-Security-Validations-for-Application-Development"><a href="#Implementing-Security-Validations-for-Application-Development" class="headerlink" title="Implementing Security Validations for Application Development"></a>Implementing Security Validations for Application Development</h1><p>Once your application has been <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">deployed</a>, you’ll want to be alerted to any issues as soon as possible, preferably before users do. Azure has several automated tests, three to be exact, that will allow you to monitor your website’s availability and basic performance. You could say these tests are to production environments what test-driven development is to a development environment. At the most basic level, there is the URL ping test, which as the name implies, tests basic responsiveness of your website at regular intervals, logging results. The ping test can be configured through the Azure portal.</p>
<p>The next level of complexity are tests where you can play back a recorded series of web requests against your website. These multi-step tests are created in Visual Studio Enterprise. </p>
<p>Alternately, perhaps if you don’t have a Visual Studio Enterprise license, you could create your own application to perform availability testing. Within the Microsoft.ApplicationInsights namespace, you can use the TelemeteryClient TrackAvailibity method. These tests are created in the context of an application insights resource. An Application Insights resource has the capacity to host up to 100 availability tests.</p>
<h1 id="Monitoring-Website-Availability"><a href="#Monitoring-Website-Availability" class="headerlink" title="Monitoring Website Availability"></a>Monitoring Website Availability</h1><p>To create an availability ping test, create a new Application Insights resource. Select Availability and then click Add test. Give your test a name, select URL ping test from the Test type, and then enter your app’s URL. Select the frequency with which you want this test to be performed, and hit the Create button. Once the test is active and running, you can monitor the results. I’m just going to stop the app to induce a failure. When you see a failure, you can drill down into the failed test to see what the issue is.</p>
<h1 id="Security-in-Azure-App-Service"><a href="#Security-in-Azure-App-Service" class="headerlink" title="Security in Azure App Service"></a>Security in Azure App Service</h1><p>Azure App Services provide a number of ways to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">secure your applications</a>. Your app is automatically secured with HTTPS and a certificate related to the Azure website’s .net domain. As we have previously talked about, you can also secure your app with a custom certificate related to a custom domain name. You can enforce HTTPS and TLS 1.2 at the click of a button or two. You can restrict app usage to specific IP addresses.</p>
<p>Azure App Service supports authentication and authorization using tokens, more specifically, JSON web tokens and identity providers. This architecture has been around for some time now and basically involves a trusted identity provider issuing a token, usually with a limited lifetime, to a user, with which they’re authorized access to web services or app. The cornerstone of this design pattern is the identity provider. They are called trusted because we trust that they have correctly identified the user as who they say they are. There are five default identity providers: Azure Active Directory, Microsoft Account, Facebook, Google, and Twitter.</p>
<p>In addition to users authenticating, you might want to authenticate one service to be able to use another service. As we saw with HDInsight Security, we can use a managed identity to make this task easier. In the HDInsight section, we created a user-managed identity which exists independently of other services. You can use one of these, or you can create a system-assigned identity within your app service. One key difference is that a system-assigned identity only exists in the context of your app service and will be deleted if your app service is deleted.</p>
<p>One thing to bear in mind when using resources within the Azure network is that it is a shared space, so you should still encrypt your communications. This is analogous to driving on a racetrack as opposed to the public road. There will be other cars on the track, not as many as on the public road, and you hope they will all be well behaved, but accidents can still happen. Another option is integrating with an Azure virtual network, as we saw with data lakes. However, this virtual network still uses the Azure shared network infrastructure. To achieve full isolation for your app, you can deploy your app to an App Service Environment (ASE). An App Service Environment is designed for high performance, and is a fully isolated environment that is dedicated to running the app. As an ASE is deployed to a virtual network, you have all the options of IP address filtering and connecting it to your on-premise network.</p>
<h1 id="Uploading-and-Binding-SSL-Certificates-to-Azure-App-Service"><a href="#Uploading-and-Binding-SSL-Certificates-to-Azure-App-Service" class="headerlink" title="Uploading and Binding SSL Certificates to Azure App Service"></a>Uploading and Binding SSL Certificates to Azure App Service</h1><p>Let’s now look at uploading and binding an SSL certificate to an Azure app service. To upload and bind an SSL certificate to a custom domain, you need to make sure your web app is running on a pricing tier that will support SSL certificates. F1 and D1 tiers do not support this feature. You can change your app’s tier by selecting Scale up app service plan under settings. To secure a custom domain, click Custom domains on the left navigation pane of your app, then click Add binding for the domain you want to secure. If you don’t see Add binding for a domain, then it’s already secure and you should have a secure SSL state.</p>
<p>Next, we want to upload our certificate. In the PFX certificate file, click Upload and browse to your certificate file, and then enter the certificate password. Once your certificate has been uploaded (wait until it has), you can go and open the SSL bindings dialog, select the certificate you uploaded and the SSL type, and then click Add binding. SNI-based SSL and IP-based SSL are supported.</p>
<p>If you use IP-based SSL, you’ll need to remap your A record to the new custom domain IP address, as, by default, apps share a public IP address. Next, we need to redirect all HTTP requests to HTTPS. This can be done by setting HTTPS to “on” within SSL settings. This dialog also allows you to change the TSL version from the default 1.2. Here we have two scripts for uploading a certificate. One is an Azure command line interface script and the other an Azure PowerShell script.</p>
<h1 id="Creating-an-Application-Security-Baseline"><a href="#Creating-an-Application-Security-Baseline" class="headerlink" title="Creating an Application Security Baseline"></a>Creating an Application Security Baseline</h1><p>Now we will turn to governance and creating an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">application security</a> baseline. Apart from the topics covered so far, this is more application-specific. A public-facing e-commerce app has different considerations than an internal application within a financial institution or bank. One is restricted to a specific user and their own information whereas the other will allow multiple users different levels of access to other people’s sensitive information.</p>
<p>To evaluate an application’s security baseline, we need to do an initial task assessment to identify your core business risks related to cloud security, translate those business risks into specific technical risk profiles. Before deployment, perform a review to identify any new risks and make sure all access and data security policy requirements are met. As part of the deployment process, validate security policy compliance. Regularly perform audits on cloud deployments to ensure their continued alignment with security policy.</p>
<p>For auditing and subsequent adherence to security policy to work, you must be monitoring application performance and collecting security data and metrics. Ensure that automated monitoring is enabled, and data and logs are being collected and securely stored. When something goes wrong, there must be a clear path and procedure to report incidents and take action. You should have lines in the sand that trigger a security response. For example, if increased brute force or denial of service attacks are detected, say at 25%, then a plan must be in place to prevent further escalation. If unclassified data is detected, then external access should be denied until the data owner can apply the appropriate <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-classification-part-1/">classification</a>. If a security health issue is detected, disable access to any virtual machines that have known access or malware vulnerability identified until appropriate patches of security software can be installed. Update policy guidance to account for any newly detected threats. If a network vulnerability is detected, access to any resource not explicitly allowed by the network access policy should be triggered to alert IT security and staff and the relevant workload owner. Track issues and update guidance if policy revision is necessary to mitigate future incidents.</p>
<h1 id="Metrics-and-Risk-Tolerance"><a href="#Metrics-and-Risk-Tolerance" class="headerlink" title="Metrics and Risk Tolerance"></a>Metrics and Risk Tolerance</h1><p>As with all fact-based analysis, we need to be able to measure and compare, to take the appropriate action that circumstances dictate. To that end, we must decide on the metrics that we will measure for our security baseline. Obviously, what to measure depends on what resources you have deployed. Here are examples of possible metrics you might want to consider.</p>
<p>How much sensitive data is in your custody? Do you know? This can be broken down into at least two metrics. Firstly, knowing the landscape of your data in relation to your organization’s data and privacy policies, you can measure how much data is being correctly classified. Secondly, how is that data protected? How many of your data stores, be they storage accounts or databases, are secure and are encrypted?</p>
<p>How many public-facing apps or web services do you have? How many of these are linked to sensitive data stores?</p>
<p>Record the number of attacks and attempted attacks. Also, try and quantify the intensity of the attack, like, how long did it last? What was the nature of that type of attack?</p>
<p>If you have virtual machines, how many of them have up to date virus protection and correctly configured firewalls? How frequently do you check for new OS and software security patches and install them?</p>
<p>Do you have outstanding security health recommendations? Azure makes quite a good attempt at notifying users of potential security issues, whether that is with dashboards or emailed threat assessments. You should act on these recommendations.</p>
<p>Having decided what to measure, you must then decide when to take action based on that metric, whether that is an absolute number or percentage increase. Here are examples of events that should trigger the adoption of appropriate security baseline policies.</p>
<p>If you are hosting sensitive data in the cloud, then you need a policy that formalizes how that data should be <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">classified and protected</a> against malicious and unforeseen events.</p>
<p>Persistent serious attacks against network infrastructure. A certain percentage of virtual machines don’t have all required OS patches and security software installed, or the time they’re unprotected exceeds X number of days.</p>
<p>If your company is in a highly security-oriented sector such as banking, medicine or government, you will need a security baseline before deploying to production. A security baseline statement is comprised of three parts. There is a summary of the technical risk it relates to, an explanation of what the policy requires, and an outline of the technical solution or recommendations to address those requirements. </p>
<p>Security baseline policy statements should be concise and to the point. Each statement definition should include the following pieces of information:</p>
<ul>
<li><strong>Technical risk:</strong> a summary of the risk this policy will address.</li>
<li><strong>Policy statement:</strong> a clear summary explanation of the policy requirements.</li>
<li><strong>Technical options:</strong> actionable recommendations, specifications, or other guidance that IT teams and developers can use when implementing the policy.</li>
</ul>
<p>Here are what a couple of security baseline statements might look like. A data encryption statement would be:</p>
<ul>
<li><strong>Technical risk:</strong> there is a risk of protected data being exposed during storage.</li>
<li><strong>Policy statement:</strong> all protected data must be encrypted when at rest.</li>
<li><strong>Potential design option:</strong> use Azure data-at-rest encryption. Additional controls such as in-account data encryption and control over how storage account settings can be changed should also be considered.</li>
</ul>
<p>A network isolation policy statement could be:</p>
<ul>
<li><strong>Technical risk:</strong> connectivity between networks and subnets within networks introduces potential vulnerabilities that can result in data leaks, disruption of mission-critical services.</li>
<li><strong>Policy statement:</strong> network subnets containing protected data must be isolated from any other subnets. Network traffic between protected data subnets is to be audited regularly.</li>
<li><strong>Potential design option:</strong> in Azure, network and subnet isolation is managed through Azure Virtual Networks.</li>
</ul>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>In <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/introduction/">this course</a>, we’ve covered a lot of ground very quickly. I see the content as falling into broad categories of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/how-to-protect-your-data/">protection</a>, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/data-retention/">retention</a>, security, monitoring, and governance. Let’s review these and see how Azure’s security features can be applied.</p>
<p>While we covered governance at the end, it’s actually not a bad place to start. You can use a structured framework of risk assessment, policy action, and technical solution options to establish a current data security benchmark. Having done this, you can objectively assess your current status, fix the holes, and use those benchmarks to validate future scenarios and actions.</p>
<p>Data protection is counterproductive if the data is so secure it’s unusable. Data labeling and protection that is available in Office 365 and Azure SQL with Azure Rights Management allows you to configure protection in terms of availability and distribution. Too much of the time, we focus on external threats when it is not unheard of for disgruntled or sales staff to use client information to enrich themselves. These tools go some way to mitigating that threat.</p>
<p>Speaking of threats, the Azure SQL Threat Detection is a quick and easy-to-implement out-of-the-box feature. </p>
<p>Not only can users steal data, they can also destroy it, intentionally or accidentally. Retention policies by way of Soft Delete Period and Recoverability can prevent irretrievable problems. We saw how database backup retention can be automated and configured.</p>
<p>Azure provides a multitude of ways to configure <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/enabling-database-authentication-with-azure-active-directory/">authentication</a> and authorization. These range from Active Directory authentication to Azure SQL, and Role-Based Access Control to storage accounts, through to limited access via Shared Access Signatures to resources. Many Azure resources make use of keys to grant access, and Azure makes it easy to generate and manage keys or import your own keys.</p>
<p>In terms of infrastructure, you can set up virtual networks within Azure to add another level of defense to your systems.</p>
<p>All of these features are built in, but what security support do you get when deploying your own custom apps? Azure can only do so much, so we looked at best practice app design principles. This involves minimizing the risk of your app becoming the attack vector. Securely store secrets and connection strings in environment variables that Azure will manage. Use tools to assess your app’s security profile, and we touched on tests within Azure to evaluate website availability. </p>
<p>As well as all of these preventative measures, Azure also records a myriad of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/configuring-azure-application-and-data-security/metrics-and-risk-tolerance/">metrics</a> that will notify you of breaches - potential or actual. Analyzing metric data will highlight potential risks and allow you to address them before they become a problem. There is no doubt that Azure provides a vast array of tools and features to assist you in securing your data and infrastructure. While very few will find all of what we have touched on applicable, I’m sure most of you will see the benefits of some of these features in your organization. Most security or data breaches are due to human error; it is up to you to implement the appropriate safeguards. Let’s face it, no one wants to be that person on the evening news.</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/15/AZ-500-Lab-Deploying-and-Configuring-Azure-Firewall-16/" rel="prev" title="AZ-500-Lab-Deploying-and-Configuring-Azure-Firewall-16">
      <i class="fa fa-chevron-left"></i> AZ-500-Lab-Deploying-and-Configuring-Azure-Firewall-16
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/15/AZ-500-Designing-an-Azure-Network-Implementation-18/" rel="next" title="AZ-500-Designing-an-Azure-Network-Implementation-18">
      AZ-500-Designing-an-Azure-Network-Implementation-18 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Data-Classification-Part-1"><span class="nav-number">2.</span> <span class="nav-text">Data Classification Part 1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Protect-Your-Data"><span class="nav-number">3.</span> <span class="nav-text">How to Protect Your Data</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AIP-Custom-Rule"><span class="nav-number">4.</span> <span class="nav-text">AIP Custom Rule</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Data-Classification-Part-2"><span class="nav-number">5.</span> <span class="nav-text">Data Classification Part 2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Data-Retention"><span class="nav-number">6.</span> <span class="nav-text">Data Retention</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Blob-Storage-Retention"><span class="nav-number">7.</span> <span class="nav-text">Blob Storage Retention</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Long-Term-Retention-Database-Backups"><span class="nav-number">8.</span> <span class="nav-text">Long-Term Retention - Database Backups</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-Data-Explorer-Data-Retention"><span class="nav-number">9.</span> <span class="nav-text">Azure Data Explorer Data Retention</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Storage-Analytics-Data-Retention-Policy"><span class="nav-number">10.</span> <span class="nav-text">Storage Analytics Data Retention Policy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Data-Sovereignty"><span class="nav-number">11.</span> <span class="nav-text">Configuring Data Sovereignty</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enabling-Database-Authentication-with-Azure-Active-Directory"><span class="nav-number">12.</span> <span class="nav-text">Enabling Database Authentication with Azure Active Directory</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Setting-Admin-Demo"><span class="nav-number">13.</span> <span class="nav-text">Setting Admin Demo</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-SQL-Auditing"><span class="nav-number">14.</span> <span class="nav-text">Azure SQL Auditing</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-SQL-Auditing-Demo"><span class="nav-number">15.</span> <span class="nav-text">Azure SQL Auditing Demo</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-SQL-Advanced-Threat-Detection"><span class="nav-number">16.</span> <span class="nav-text">Azure SQL Advanced Threat Detection</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Access-Control-for-Storage-Accounts"><span class="nav-number">17.</span> <span class="nav-text">Configuring Access Control for Storage Accounts</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Key-Management-for-Storage-Accounts"><span class="nav-number">18.</span> <span class="nav-text">Configuring Key Management for Storage Accounts</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Granting-Limited-Access-to-Azure-Storage-Resources-with-Shared-Access-Signatures-SAS"><span class="nav-number">19.</span> <span class="nav-text">Granting Limited Access to Azure Storage Resources with Shared Access Signatures (SAS)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Security-for-HDInsight"><span class="nav-number">20.</span> <span class="nav-text">Configuring Security for HDInsight</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Cosmos-DB-Security"><span class="nav-number">21.</span> <span class="nav-text">Configuring Cosmos DB Security</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Security-for-Microsoft-Azure-Data-Lake"><span class="nav-number">22.</span> <span class="nav-text">Configuring Security for Microsoft Azure Data Lake</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Securing-Azure-Data-Lake-Storage-with-Virtual-Network-Integration"><span class="nav-number">23.</span> <span class="nav-text">Securing Azure Data Lake Storage with Virtual Network Integration</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Design-a-Secure-Azure-Application"><span class="nav-number">24.</span> <span class="nav-text">How to Design a Secure Azure Application</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Implementing-Security-Validations-for-Application-Development"><span class="nav-number">25.</span> <span class="nav-text">Implementing Security Validations for Application Development</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Monitoring-Website-Availability"><span class="nav-number">26.</span> <span class="nav-text">Monitoring Website Availability</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Security-in-Azure-App-Service"><span class="nav-number">27.</span> <span class="nav-text">Security in Azure App Service</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Uploading-and-Binding-SSL-Certificates-to-Azure-App-Service"><span class="nav-number">28.</span> <span class="nav-text">Uploading and Binding SSL Certificates to Azure App Service</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-an-Application-Security-Baseline"><span class="nav-number">29.</span> <span class="nav-text">Creating an Application Security Baseline</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Metrics-and-Risk-Tolerance"><span class="nav-number">30.</span> <span class="nav-text">Metrics and Risk Tolerance</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Summary"><span class="nav-number">31.</span> <span class="nav-text">Summary</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
