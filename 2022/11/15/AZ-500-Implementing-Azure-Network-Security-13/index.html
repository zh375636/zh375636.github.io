<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="IntroductionWelcome to Implementing Azure Network Security. My name is Thomas Mitchell and I’ll be taking you through this course. I’m an Azure trainer at Cloud Academy and I have over 25 years of dee">
<meta property="og:type" content="article">
<meta property="og:title" content="AZ-500-Implementing-Azure-Network-Security-13">
<meta property="og:url" content="https://example.com/2022/11/15/AZ-500-Implementing-Azure-Network-Security-13/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="IntroductionWelcome to Implementing Azure Network Security. My name is Thomas Mitchell and I’ll be taking you through this course. I’m an Azure trainer at Cloud Academy and I have over 25 years of dee">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-11-15T14:11:39.000Z">
<meta property="article:modified_time" content="2022-11-19T18:24:54.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/2022/11/15/AZ-500-Implementing-Azure-Network-Security-13/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AZ-500-Implementing-Azure-Network-Security-13 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Implementing-Azure-Network-Security-13/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AZ-500-Implementing-Azure-Network-Security-13
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:39" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:39-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-19 14:24:54" itemprop="dateModified" datetime="2022-11-19T14:24:54-04:00">2022-11-19</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Implementing-Azure-Network-Security-13/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Implementing-Azure-Network-Security-13/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Welcome to Implementing Azure Network Security. My name is Thomas Mitchell and I’ll be taking you through this course. I’m an Azure trainer at Cloud Academy and I have over 25 years of deep IT experience, several of those with cloud technologies. If you have any questions on this course, feel free to connect with me on LinkedIn or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. This course is intended for IT professionals who are interested in earning Azure certification and for those who work with <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft Azure</a> on a daily basis. To get the most from this course, you should have at least a basic understanding of Azure network resources, such as <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/virtual-network/vnet-intro-1/">virtual networks</a>, Azure firewalls, and network security groups.</p>
<p>Throughout this course, we’ll cover topics such as virtual network connectivity, network security group configuration, and Azure firewall configuration. We’ll also cover the Azure Front Door Service and how to configure application security groups. We’ll round out the course by covering the configuration of remote access management via just-in-time access and we’ll cover tools that are used to configure baselines. By the time you complete this course, you should have a good understanding of how to implement Azure network security. We’d love to get your feedback on this course, so please give it a rating when you’re finished. If you’re ready to learn about implementing Azure network security, let’s get started.</p>
<h1 id="Azure-Virtual-Networks"><a href="#Azure-Virtual-Networks" class="headerlink" title="Azure Virtual Networks"></a>Azure Virtual Networks</h1><p>The Azure virtual network, or VNET, is the key piece of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/introduction/">Azure security services</a>. A virtual network is really just a logical isolation of Azure’s cloud network that’s been carved out and dedicated to your specific subscription. Virtual networks allow you to securely connect many different Azure resources to one another and VNETs can also be connected to physical on-prem networks over the internet via site-to-site VPNs.</p>
<p><a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft Azure</a> also supports dedicated WAN link connectivity from Azure VNETs to on-prem networks through Azure’s ExpressEoute offering. With ExpressRoute, the connection between Azure and the on-prem site uses a dedicated connection that does not ride over the public internet. This creates a more secure and more robust connection between an Azure virtual network and the physical on-prem network.</p>
<p>It’s important to note that a virtual network is scoped to a single Azure region, which is a set of datacenters deployed within a latency-defined parameter. Each virtual network consists of one or more subnets, which is a range of IP addresses within the virtual network itself. Subnets, just like the virtual networks they’re a part of, are also scoped to a single Azure region. </p>
<p>It’s also important to note that each virtual network is isolated from other virtual networks. When you create a virtual network, you can specify a private IP address space for it using both public and private addresses. Azure then assigns resources in the virtual network a private IP address from the address space that you assign. By using subnets, you can subnet the virtual network which allocates just a portion of the virtual network’s address space to each subnet. You can even configure a virtual network to use a custom DNS server for name resolution instead of using the default Azure provided name resolution.</p>
<p>In the next lesson, we’ll talk a little bit more in detail about <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/ip-addresses-subnets/">IP addresses and subnets</a>.</p>
<h1 id="IP-Addresses-amp-Subnets"><a href="#IP-Addresses-amp-Subnets" class="headerlink" title="IP Addresses &amp; Subnets"></a>IP Addresses &amp; Subnets</h1><p>Resources like VMs and load balancers that live on a virtual network require unique IP addresses, just like any resource on a physical network.</p>
<p>In Azure, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/azure-virtual-networks/">virtual networks</a> use two types of IP addresses: private and public.</p>
<p>A private IP can be either dynamically or statically allocated to a VM from the range of IP addresses that’s been defined for a given virtual network. These addresses are then used by resources to communicate with one another. Public IPs allow Azure resources to communicate externally with resources that do not reside on the virtual network. Public IPs are assigned to the virtual adapter of a VM or to the front end of a load balancer.</p>
<p>Public IP addresses can also be used within Azure-only virtual networks. When used in this fashion, the IPs within the virtual network will only be routable within the network itself. They will not be reachable from the outside.</p>
<p>The IP addresses that are dynamically assigned to VMs and other services within an Azure virtual network are determined by the IP addressing scheme that’s deployed. This process of IP range planning is not all that different than how you would plan the addressing scheme of a physical network.</p>
<p>As mentioned earlier, a virtual network can be subdivided using subnets. Each subnet consists of its own range of IP addresses that fall within the address space defined for the parent virtual network.</p>
<p>You use subnetting to mask the details of the internal network organization from external routers. It also makes it easier to segment the hosts within a network and to more effectively apply network security.</p>
<h1 id="Virtual-Private-Networks"><a href="#Virtual-Private-Networks" class="headerlink" title="Virtual Private Networks"></a>Virtual Private Networks</h1><p>Virtual private networks, or VPNs, are used to extend physical on-prem networks into <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. To be honest, you can even use VPNs to connect separate virtual networks. For example, you can use a site-to-site VPN to connect an Azure virtual network to a virtual network in AWS or even GCP.</p>
<p>For a more robust connection between an on-prem network and Azure, you can use what’s called ExpressRoute instead of a VPN connection. Using ExpressRoute allows you to create a connection to an Azure virtual network without requiring your traffic to traverse the internet.</p>
<p>Whether you use a site-to-site VPN connection or ExpressRoute, you can allow all on-prem users to access Azure resources and services as if they’re physically located on-prem within your own datacenter.</p>
<p>In cases where you need to allow an individual user to connect to an Azure virtual network, you can even use a point-to-site VPN. This type of VPN connection is similar to solutions like FortiGate or Cisco AnyConnect. In the next lesson, I’m going to show you how to connect two networks using a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/connecting-networks-with-a-site-to-site-vpn/">site-to-site VPN connection</a>.</p>
<h1 id="Connecting-Networks-with-a-Site-to-Site-VPN"><a href="#Connecting-Networks-with-a-Site-to-Site-VPN" class="headerlink" title="Connecting Networks with a Site-to-Site VPN"></a>Connecting Networks with a Site-to-Site VPN</h1><p>Hello everyone! And welcome back. In this demonstration, I’m going to walk you through the process of creating a route-based site-to-site VPN connection. What we’re going to do here is connect my vNet-Azure virtual network to my on-prem network, using a route-based site-to-site VPN.</p>
<p>In my on-prem network, I have a public-facing VPN device with an IP address of 40.79.70.195. On my VPN device, I’ve configured a pre-shared key. I’ll use that same pre-shared key when I setup the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/virtual-private-networks/">VPN in Azure</a> here.</p>
<p>To begin the VPN setup, I need to deploy a virtual network gateway in Azure. This virtual network gateway will serve as the Azure endpoint, so to speak, of the VPN connection. However, before I create a virtual network gateway, I need to create a gateway subnet within the vNet-azure virtual network.</p>
<p>The gateway subnet doesn’t have to be large, since it’s only going to host a couple of VPN-related resources that Azure automatically deploys under the covers when creating the virtual network gateway. These resources that Azure deploys cannot be seen, nor can they be managed by me. Because they’re used by the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure platform</a> itself to create the VPN connection. </p>
<p>To kick things off, let’s go ahead and create our gateway subnet. Now, like I mentioned, this subnet can be very small. Only a handful of available IPs are necessary, so we’re going to use a &#x2F;27 range. It’s important to note that the gateway subnet that I define must fall within the network address space that’s defined for the actual vNet. And I should also point out that it can’t overlap any other subnets within my virtual network.</p>
<p>Now, since my virtual network address space for this vNet is 10.1.0.0&#x2F;16, and I already have a subnet of 10.1.0.0&#x2F;24, what I’m going to use is 10.1.255.0&#x2F;27 for my gateway subnet.</p>
<p>So, let’s go ahead and create the gateway subnet by clicking the plus Gateway subnet link here at the top. You’ll notice my gateway subnet is automatically named GatewaySubnet, and I can’t change this. This name tells Azure to recognize the subnet as my gateway subnet. So, let me just configure the address range here so it reflects my chosen range of 10.1.255.0&#x2F;27. I can leave the rest of the settings here at their defaults and we’ll go ahead and click OK here. But before I do that, I do wanna mention, you never ever want to assign a network security group to your gateway subnet. Just keep that in mind. So we’ll go ahead and click OK here.</p>
<p>So we now have the gateway subnet deployed. With my gateway subnet deployed, I can begin the deployment of my virtual network gateway. I should point out that the creation of the gateway can take upwards of 45 minutes to complete, so what I’ll do here is show you how to create it. And then we’ll then cut away and come back once it’s deployed.</p>
<p>The virtual network gateway that I deploy here is going to use this gateway subnet that I provisioned. So, let’s get this virtual network gateway deployed. In the portal here, what I’m going to do, on the left side, is create a resource here. And then I’ll search for Virtual Network Gateway. And then from the search results here, I’ll click virtual network gateway. And then from this Virtual network gateway blade, I have to click Create here to begin the process. And what this does is open the virtual network gateway blade. And then from this blade, I need to fill in the values for my gateway.</p>
<p>I’m going to call my gateway GW-Azure. And what I’m going to is deploy into my VPNDemo resource group. However, you’ll see here I can’t select a resource group until I select a virtual network. And that’s because it needs to be in the same resource group. So what we’ll do here, is we’ll select the region where my vNet-Azure virtual network is. And it’s in East US 2. And then what we’ll do, is we’ll filter on our networks, and select vNet-Azure. And then we can see here the resource group is derived from the virtual networks resource group.</p>
<p>Now, as I mentioned earlier, I’m going to create a route-based VPN. You see we have two options here. If I hover over here on this icon, I can see that this option allows me to choose a route-based VPN if I plan to use point-to-site, inter-virtual network, or multiple site-to-site connections. If I was going to create a VPN to coexist with an ExpressRoute gateway or if I need to use IKEv2, I could also use a route-based gateway. A Policy-based VPN supports only IKEv1.</p>
<p>For this VPNDemo here, I’m going to create a route-based VPN. And what we’re going to do is deploy a Basic SKU here. Now hovering over Generation here, we can see that we can choose a generation of VPN gateway. Now that being said, Basic and the VPN GW1 SKUs are always supported on Generation1 only. So that’s all we’re going to leave it at here.</p>
<p>Now down here, I need to either create a new public IP for my gateway or use an existing one. Now for this demo, I’m going to create a new public IP. This public IP is going to be the IP that my on-prem VPN device is going to communicate with. So we’ll go ahead and create a new one here. And we’ll call it PublicIP-GWAzure. Now I can only enable active-active mode when I use one of the more advanced SKUs, so I don’t have the option available to me here. That said, I would really only enable active-active mode if I was creating an active-active gateway configuration. And I’m not doing anything with BGP in this demo, so I’ll leave BGP ASN disabled as well. Now if I hover over the icon for BGP here, I can see that BGP ASN can only be configured with route-based VPN gateways that are supported on SKUs of VPN GW1, 2, or 3, so it wouldn’t even be supported for my basic SKU anyway.</p>
<p>So at this point, I need to click Review and Create here to run validation. Now after the validation passes, and I can see it in the green bar here, I can click Create here to deploy my gateway. Now, this can take up to 45 minutes to complete, so what I’ll do here is pause the video and then we’ll return when it’s completed.</p>
<p>Okay, welcome back. Now that the virtual network gateway has been created, I need to create an endpoint in Azure that represents the on-prem VPN device. To do this, I need to create what’s called a local network gateway.</p>
<p>To create the local network gateway, I need to click create a resource up top here. And I’ll go ahead and search the marketplace for Local network gateway. And from the list of results here, I’ll select it. And then we’ll create it.</p>
<p>Now when this Create local network gateway page opens, I’m going to give my gateway a name. I’m going to call it GW-OnPrem. And then what I need to do is provide the public IP address of the on-prem VPN device. Now, in this exercise, the public IP of my on-prem VPN device is 40.79.70.195.</p>
<p>Now, in this address space field here, I need to tell Azure what network address ranges that this local network represents. Now, I can add multiple address space ranges here, but for this exercise, I’m simply going to add 10.101.0.0&#x2F;16, which is the only address range for my on-prem network.</p>
<p>Now what Azure will do is route traffic to the address range through the on-prem VPN device IP address. I only have to configure the BGP settings here if I’m using BGP. Since we aren’t doing that here, I’ll leave this option alone.</p>
<p>I also have to specify the subscription and resource group where I’m deploying these resources. And the location here is the same as Region in other settings. So what I need to do is choose where I want my local gateway to be created. So what I do is I’ll select my VPNDemo resource group here. And it’ll go in the East US 2. So at this point, I can create my local gateway here by clicking Create at the bottom. And let me go back into my resource group here for my VPNDemo. And we’ll wait for our local gateway to complete deployment here, which takes a few minutes. It’s not as long as the virtual network gateway.</p>
<p>Alright, so now that I have my gateway subnet, my virtual network gateway, and my local network gateway created, at this point, I need to configure my on-prem VPN device and create the actual VPN connection between the on-prem environment and my Azure network.</p>
<p>To configure my on-prem VPN device, regardless of what type it is, I need to specify the shared key that the Azure virtual network gateway and that on-prem device are going to use to establish connectivity. I also need the Public IP address of my virtual network gateway in Azure.</p>
<p>To get this public IP address via the portal, I can just browse to my virtual network gateway here, and then identify the public IP address. So let’s go back to our VPNDemo resource group here.</p>
<p>Now, to configure the VPN device, I’m going to need to download a configuration script for that device. Now before I get that configuration script, I need to create the site-to-site VPN connection between the virtual network gateway and my on-prem device. To do this, I need to open the page for my virtual network gateway. And then from here, I can go to Connections under Settings. We can see we have no current connections. But what I’m going to do here, at the top, I’m going to click Add button here. And then from here, I can configure the values for my connection.</p>
<p>Now I have to give my connection a name and I need to choose a connection type here. So we’ll just call this Azure-OnPrem. Now, I can’t change the Virtual network gateway because I’m connecting from this gateway. And then my connection type is going to be site-to-site. Now, from here, I need to choose the local network gateway. And this is the one that I created. This local gateway represents the on-prem VPN device. And then the shared key here is the shared key value that I used to configure my VPN device. They need to match. So I’ll type this in here.</p>
<p>We can leave our IKE set to IKEv2. And then we can go ahead and click OK. I can see my new connection here. And the status will switch from things like Unknown to Connecting to Successful to Connected, depending on the status of the connection. What I can do here is click on my connection here to see more details.</p>
<p>Now, at this point, I need to download the configuration script for whatever on-prem VPN device I’m using. Now, to do this, I can click the Download Configuration link at the top and then from here I can specify my on-prem device. So let’s assume we’re using a Cisco ASA. And we can download the configuration.</p>
<p>Now, when I download my script, it comes down as a text file. After downloading it, what I need to do is open it and then search for the keyword “REPLACE” within this text file. And then what I need to do is provide any parameters that need to be added to my script. So if we do Edit, Find, excuse me, Find, Replace. We can see different information regarding our specific device. And then we would fill this information in as necessary. And then what I could do is save my script and use it to configure my on-prem VPN device so that it can connect.</p>
<p>Now I’m not going to get into the configuration of the on-prem device because that process is different for every device, and frankly, Microsoft really doesn’t care that you know how to configure a Cisco VPN device. Suffice it to say though, once I’ve taken this script and configured my on-prem VPN device, I can then verify my VPN connection. So let me hop away here. And I’ll go ahead and configure my VPN device. Give me a moment. And then we’ll come back and we’ll check our connection.</p>
<p>So my on-prem VPN is now configured. And since I’m already on the Connection page here, what I’ll see here normally is that my connection is showing Connecting. After a few moments, this will go to Succeeded and then to Connected. So let’s give it a few moments here. And as you can see now, we now show a successful connection. So at this point, you now know how to create a route-based site-to-site VPN in Microsoft Azure.</p>
<h1 id="Intro-to-the-Azure-Front-Door-Service"><a href="#Intro-to-the-Azure-Front-Door-Service" class="headerlink" title="Intro to the Azure Front Door Service"></a>Intro to the Azure Front Door Service</h1><p>The Azure Front Door Service is an offering from Microsoft that allows you to define, manage, and monitor the global routing for web traffic. It optimizes for best performance and offers instant global failover for high availability. Azure Front Door allows organizations to transform their multi-region apps, both consumer and enterprise grade, into high-performance applications, APIs, and content that can reach a global audience through <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>.</p>
<p>Azure Front Door works at Layer 7, the HTTP&#x2F;HTTPS layer. By leveraging the anycast protocol with split TCP and Microsoft’s global network, it improves global connectivity. When properly configured, Azure Front Door will route client requests to the fastest and most available application backend, which is defined as any Internet-facing service hosted inside or outside of Azure.</p>
<p>Front Door offers several traffic-routing methods and backend health monitoring options to choose from. That being the case, it meets the needs of many different applications and automatic failover models. Like Azure’s Traffic Manager offering, Azure Front Door is resilient to failures, including the failure of an entire Azure region.</p>
<p>Azure Front Door accelerates app performance by ensuring end users connect to the nearest Front Door Point of Presence when accessing the application. The Front Door Service uses smart health probes to monitor the backends for latency and availability. When a backend goes down, the app is instantly and automatically failed over.</p>
<p>Through URL-based routing, Azure Front Door allows organizations to route traffic to backend pools based on URL paths of the requests. You can even configure more than one website on the same Front Door configuration. What this does is offer you the ability to configure a more efficient topology for app deployments.</p>
<p>By leveraging session affinity, Azure Front Door allows you to keep a user session on the same application backend. Front Door managed cookies ensure that subsequent traffic from a user session gets directed to the same application backend for processing. Session affinity is useful in situations where session state is saved locally on the backend for a user session.</p>
<p>Front Door also supports SSL termination at the edge. What this means is that individual users can establish SSL connections directly with Front Door environments rather than establishing those connections with the application’s backend. One caveat of the Front Door Service is that when you use it to deliver content, you must use a custom domain if you wish to have your domain name visible in the Front Door URL. I should also note that Front Door also supports HTTPS for custom domain names.</p>
<p>Other features of Azure Front Door include things like custom web application firewall rules, URL redirection, URL rewrite, IPv6 and HTTP&#x2F;2 protocol support.</p>
<p>In the next lesson, I’m going to show you how to create and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-and-configuring-azure-front-door/">configure Azure Front Door</a>.</p>
<h1 id="Creating-and-Configuring-Azure-Front-Door"><a href="#Creating-and-Configuring-Azure-Front-Door" class="headerlink" title="Creating and Configuring Azure Front Door"></a>Creating and Configuring Azure Front Door</h1><p>Hi everyone, welcome back. In this demonstration, I’m going to show you how to create a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/intro-to-the-azure-front-door-service/">Front Door</a> profile. I’m going to use two instances of web app, each running in different Azure region, which I’ve already deployed. The first instance is called MyAppEast01 and the second is MyAppWest01.</p>
<p>What I’m going to do here is add a frontend host for Front Door, and then add an application backend and backend pools. I’ll then add a routing rule so my Front Door can route traffic to my web apps.</p>
<p>So, let’s create a Front Door configuration that will direct traffic based on the lowest latency between two backends that I’ll set up. What I’m going to do here to get started is click Create a resource over here in the left. And then from the Networking category, what I’m going to do is select Front Door. Now let’s specify my resource group here. And I think I put everything in myRG. And everything goes in my Lab Subscription. Now you’ll notice I can’t select a location here. That’s because the location is locked to wherever my resource group is deployed.</p>
<p>With my basic Front Door information provided, I now have to define the frontend host for my configuration. Now, because this is going to result in a publicly-accessible domain name, the hostname of my Front Door needs to be unique across the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> landscape. If it’s not unique, Azure’s going to tell me as much.</p>
<p>What I’m going to do is create my frontend and call it MyAzFD01. Now what I could do here if I wanted to is enable sessions affinity and even a web application <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-and-configuring-microsoft-azure-firewall/">firewall</a>. For this demo, I’ll leave these at their defaults.</p>
<p>Now clicking Add here, what this does is create the frontend for my Front Door. At this point, I need to configure my application backends in a backend pool. This tells Front Door where my application lives.</p>
<p>To do this, I need to click the little plus icon here in the Backend pools pane. And then I have to specify a name for my backend pool. So I’ll call it simply BackendPool. Now, clicking on Add a Backend here lets me add my websites that I created earlier. The backend host type lets me specify what the host’s type is for my backend.</p>
<p>I have a couple of different options here. I’m going to choose App Service here since my web apps are app service apps. I then have to choose my Azure subscription that contains my websites. And like I said, everything’s in the Lab Subscription. And then from here, I can choose the first website from the dropdown.</p>
<p>We can see I have West01 and East01. I can leave the remaining fields as they are for now and then I’ll click Add. Now what I’m going to do here is repeat the process to add my second website. Now, although I can choose to update the Health Probes here and configure the load balancing for my backend pool, the default values will work for this exercise. So I’ll leave them at their default.</p>
<p>And then from here, I’ll click Add to finish up my backend config. At this point, I need to add a routing rule. To do this, I have to click the little plus icon here again in the Routing Rules pane. What this does is map my frontend host to my backend pool that I just created. Essentially, what I’m doing here is telling my configuration to forward incoming requests from my frontend to my backend pool.</p>
<p>I’m going to call my rule DefaultRouting. The Accepted Protocol field here allows me to specify which protocols will be allowed for the rule. You can see here that the frontend hosts field defaulted to my only configured frontend already.</p>
<p>Notice here that the default pattern to match is &#x2F;*. This means all traffic that hits the root of my site, or anything below it, will match the rule.</p>
<p>Now, since we aren’t doing any redirecting of traffic, we’ll leave the Route Type set to Forward so that it forwards my traffic to my back end. The Backend pool dropdown here shows where my traffic will go. We can see it’s going to my backend pool.</p>
<p>Now, the Forwarding Protocol here refers to the protocol to use for forwarding requests to the backend or to match from the incoming request. What I’m going to do here is set this to match the request. So the request that comes in is http, it’s going to forward http. By changing to https, I could forward it on as https. I’ll just match the request as it comes in.</p>
<p>We’re going to leave URL Rewrite and Caching disabled since we don’t need either feature here. And then, what I’ll do is I’ll click Add here to add the routing for my Front Door. And now with everything configured, from here, what I can do is click on Review and Create. And this will validate my Front Door configuration.</p>
<p>Now, when it passes validation, I can click Create to begin the deployment. So, with my Front Door created now, I can access it by going to a web browser and browsing to its URL. In this case, what I’ll do is I’ll go to the resource here. The URL of my Front Door is https&#x2F;&#x2F;myazfd01.azurefd.net. And what I’ll do here is open this in an incognito window. Now what happens is that my request is automatically routed to the backend that’s nearest to me, and it will failover in the event one of my backends goes down. So, with that, you’ve learned how to deploy and configure Azure Front Door.</p>
<h1 id="Intro-to-Network-Security-Groups"><a href="#Intro-to-Network-Security-Groups" class="headerlink" title="Intro to Network Security Groups"></a>Intro to Network Security Groups</h1><p>Network security groups are used to filter network traffic to and from <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> resources in an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/azure-virtual-networks/">Azure virtual network</a>. When you create a network security group, that group will contain security rules that allow or deny inbound network traffic to or outbound network traffic from many types of Azure resources.</p>
<p>A network security group can contain many security rules as you require or it can contain zero security rules. Each rule defined within a network security group requires a unique name within the security group, a priority, a source or destination, a protocol, a direction, a port range, and an action.</p>
<p>The priority is a number between 100 and 4,096. This priority determines the order in which rules are processed. Rules with lower priority numbers are processed before those with higher numbers and once traffic matches a specific rule, processing of remaining rules stops.</p>
<p>When you define a source or destination for a security rule, what you are doing is telling the rule whether the destination is an individual IP address, any IP address, a CIDR block, a particular service tag, or an application security group.</p>
<p>The protocols that you can configure within a security rule include TCP, UDP, ICMP, or Any, and as far as directions go, you can configure security rules to apply to either inbound or outbound traffic.</p>
<p>When defining a security rule, you can specify an individual port for it to apply to or you can specify a range of ports. For example, you can specify something like port 443 or you can specify a range like ports 10,000 to 11,000.</p>
<p>Defining ranges allows you to create fewer security rules, since you don’t have to create an individual rule for each port.</p>
<p>The action that you define for a security rule can be either allow or deny. This determines what happens when the rule is matched.</p>
<p>In the next lesson, I’m going to show you how to create a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-a-network-security-group/">network security group</a> and how to configure a security rule.</p>
<h1 id="Creating-a-Network-Security-Group"><a href="#Creating-a-Network-Security-Group" class="headerlink" title="Creating a Network Security Group"></a>Creating a Network Security Group</h1><p>Hi, everyone, and welcome back. What I want to do here in this lesson is quickly show you how to create a network security group, so let’s jump right in.</p>
<p>I’m logged in to my Azure portal here and what I want to do is choose the hamburger up here in the top-left. And after I click it, I can click Create a resource here. What I need to do is choose Networking and then, I’m going to select the Network security group option here. I could also search for it in the Marketplace.</p>
<p>Now, from here, I need to tell <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> which subscription I want to deploy to and into which resource group. So let me select my resource group here and I’ll deploy into my lab subscription.</p>
<p>I need to give my network security group a name, so I’m going to call it MyNSG, and then, what I’ll do here is I’ll deploy into Central US.</p>
<p>Now, if I wanted to tag my network security group, I could click the Next Tags down here at the bottom, and typically, you would use tags to further break out or group resources. I’m not going to tag anything here, so what I’ll do is just click Review and Create.</p>
<p>Now, at this point, Azure validates the information I’ve supplied. We can see that it passed validation by looking at the green stripe here, so let’s launch the deployment by clicking Create down here. What I’ll do here is click Go to resource and with my network security group created, I can now create a custom rule for it. I’ll show you how to do that in the next <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/network-security-rules/">demonstration</a>.</p>
<h1 id="Network-Security-Rules"><a href="#Network-Security-Rules" class="headerlink" title="Network Security Rules"></a>Network Security Rules</h1><p>Hi, everyone, and welcome back. Before I show you how to create network security rules within a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-a-network-security-group/">network security group</a>, I just wanted to quickly run through an overview of the different options that are available when configuring a rule. On the screen here, I’m on the page of my network security group, where I can view the security rules for MyNSG. As you can see here on the screen, this security group only contains the default set of rules that’s created when the group is created. If I want to create inbound rules, I need to click over here on the Inbound Security Rules option. I would click on Outbound Security Rules to create an outbound rule.</p>
<p>Clicking on Add opens up the new rule blade. Now, in this source box here I have a few different options. I can set my source to Any, Application security group, IP addresses, or Service tag. If I select Application security group here, I’m prompted to select one or more existing application security groups. If I select IP addresses, I can specify either source IP addresses, or entire CIDR ranges. I can specify a single value, or a comma-separated list of multiple values. For example, I could specify multiple values like 10.0.0.0&#x2F;16 and then separate it with a comma and then an individual address, 192.168.0.0.</p>
<p>Now, I should point out that if I specify an IP address of an Azure VM here, I need to ensure that I specify the private IP address and not the public IP address that’s assigned to the VM. This is because security rules are processed after Azure translates the public IP to a private IP for inbound security rules and before <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> translates a private IP to a public IP for outbound rules.</p>
<p>Now, if I select Service tag here, I can then select one service tag. These service tags are predefined identifiers for different categories of IP addresses. They include things like HTTP, RDP, storage, load balancers, you name it. There are really too many options to list here, so I do suggest that you play around with this to see all the different options.</p>
<p>Now, for the source port ranges field here, I can specify a single port like port 80. Now, I can also specify a range of ports like 1024, for example, through 1200. I can even specify a comma-delimited list of port ranges, or even ports. For example, I can do port 80,443,3389 and then I can even do like 1000 to 1200. So, I can use comma-delimited lists as well.</p>
<p>Now what I can also do, and if you see down here at the bottom, the recommended value. The recommended value for source port ranges is * or Any, and this is because port filtering, as Microsoft notes here, is typically used with a destination port. So, we can leave this at * for Any as well.</p>
<p>The destination field offers me some additional options here. I can select Any, IP Addresses, Virtual Network, or Application security group. As was the case up here with source, if I select Application security group, it’s going to ask me to specify a defined security group. I don’t have any configured here, so it’s telling me as much right here. And then of course, if I specify an IP address here, the same rules apply in my destination IP addresses CIDR ranges as applied up here in my source IP addresses and CIDR ranges.</p>
<p>As was the case in the source, if the IP address that I specify is assigned to an Azure VM, I need to make sure that I specify the private IP, not the public IP, assigned to that VM for the same reasons I mentioned up here.</p>
<p>Now, selecting virtual network here for destination, which is actually a service tag. What this means is that traffic is allowed to all IP addresses within the address space of the specified virtual network. Now, selecting virtual network here, which is actually a service tag, means that traffic is allowed to all IP addresses within the address space of the virtual network. The destination port ranges option allows me to specify a single value or a comma-separated list of values that specify the destination ports that I’m allowing traffic to.</p>
<p>The protocol option here allows me to select Any protocol, TCP, UDP, or ICMP. So, I can filter down on what protocols I’m allowing. And then, of course, the action field determines the result of matching the rule. I can choose to either allow or deny.</p>
<p>Priority allows me to provide a value between 100 and 4,096. This has to be unique for all security rules within the network security group. Security rules are processed in priority order and what that means is, the lower the number, the higher the priority.</p>
<p>Microsoft actually recommends that you leave a gap between priority numbers when you create your rules. So for example, instead of setting priorities of one, two, and three, use values like 100, 200, and 300. Leaving gaps makes it easier to add rules in the future without juggling priority values.</p>
<p>Then when you create a rule, the name for the rule needs to be unique within the network security group. It can be up to 80 characters in length and it must begin with a letter, or a number, end with a letter, number, or underscore, and it can only contain letters, numbers, underscores, periods, or hyphens. Essentially no spaces. And, of course, the description here is optional. We don’t have the little red star here telling us it’s mandatory.</p>
<p>So now that you have an idea of what all is involved in creating a rule, we’ll jump into the next lesson where I’ll show you exactly how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/configuring-security-rules-in-an-nsg/">create a new rule</a>.</p>
<h1 id="Configuring-Security-Rules-in-an-NSG"><a href="#Configuring-Security-Rules-in-an-NSG" class="headerlink" title="Configuring Security Rules in an NSG"></a>Configuring Security Rules in an NSG</h1><p>Hi, everyone, and welcome back. In this lesson, I’m going to show you how to configure <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/network-security-rules/">network security rules</a> within a network security group.</p>
<p>To get started, I’m going to click on the network security group that we just created. We’ll add a security rule to it. For this exercise, I’m going to add an inbound security rule.</p>
<p>Now, to do so, I simply choose Inbound security rules option under Settings. I could also create outbound security rules as well. This pane here shows all of the existing configured inbound and outbound security rules that are configured for this network security group. You’ll see these default rules shown here since a collection of rules is automatically created when the network security group is created.</p>
<p>So what I’ll do is click on inbound security rules here and what I’m going to do here is create my new rule by clicking Add. I’m going to open up port 80 from anywhere using this rule.</p>
<p>So what this is going to do is allow anything on the internet to hit whatever is protected by this network security group over port 80. Now, since I’m opening 80 up from anywhere, I’m going to choose Any as my source. I’ll enter port 80 here in the Source port ranges field and then, selecting Any in the destination field allows port 80 to anything this network security group is applied to. And then, what I’ll do is I’ll change my destination port range from 8080 to straight 80 and I’ll leave the protocol selection set to Any and the Action option to Allow. We’re allowing this traffic. I’ll just accept the default priority and I’ll call my rule allow_port_80.</p>
<p>Now, we’ll see at the bottom here, we get a notification that the recommended value for source port ranges is * because port filtering is mainly used with the destination port. So what we’re going to do, if we change this back to the recommended value, I just wanted to show you how this affects things, we then see the warning go away. So what that means is you typically perform your filtering on the destination rather than the source.</p>
<p>Now, I’m not worried about a description here, so I’ll just leave this blank. And what I’ll do here is click Add to add my rule and I’ll go ahead and refresh my screen here. And we can see allow_port_80 is now listed in the inbound security rules of MyNSG.</p>
<p>So at this point, I can associate my network security group with a subnet that it should protect. Now, to do this, I would simply select Subnets here under the Settings option and then, from here, I can click Associate. And then, what I’ll do here is I’ll select a virtual network that I wanna protect, select my subnet, and we’ll OK it. So at this point, any resources that are connected to or will be connected to my protected subnet will now be reachable on port 80.</p>
<h1 id="Intro-to-Microsoft-Azure-Firewall"><a href="#Intro-to-Microsoft-Azure-Firewall" class="headerlink" title="Intro to Microsoft Azure Firewall"></a>Intro to Microsoft Azure Firewall</h1><p>Hi everyone, and welcome back. Azure Firewall is a cloud-based network security service that is designed to protect <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/azure-virtual-networks/">Azure Virtual Network</a> resources. It’s fully stateful and features built-in high availability as well as unrestricted cloud scalability.</p>
<p>Using Azure Firewall, organizations can centrally create application and network connectivity policies across subscriptions and networks. Because Azure Firewall uses a static, public IP address for the virtual network resources behind it, it permits outside firewalls to identify traffic that comes from the protected virtual network. Because Azure Firewall is fully integrated with <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Monitor, organizations can also perform logging and analysis against it.</p>
<p>Azure firewall offers several key features, including built-in high availability, availability-zone spanning, unrestricted cloud scalability, application FQDN traffic-filtering rules, and network traffic-filtering rules. Other features of Azure Firewall include things like: support for FQDN tags, service tags, and threat intelligence. You can even associate up to 100 different public IP addresses with an Azure Firewall.</p>
<p>To see a complete and detailed list of all Azure Firewall features, visit <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/firewall/overview">the URL</a> that you see on your screen.</p>
<p>In the next lesson, I’ll show you how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-and-configuring-microsoft-azure-firewall/">create and configure Azure Firewall</a>. So hop over there, and let’s get started.</p>
<h1 id="Creating-and-Configuring-Microsoft-Azure-Firewall"><a href="#Creating-and-Configuring-Microsoft-Azure-Firewall" class="headerlink" title="Creating and Configuring Microsoft Azure Firewall"></a>Creating and Configuring Microsoft Azure Firewall</h1><p>Hello, everyone, and welcome back. In this lesson here, we’re going to create and configure <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/intro-to-microsoft-azure-firewall/">Azure firewall</a>. To prepare for this demonstration, I’ve already set up a virtual network and a few subnets that we’re going to use. This vNet-FirewallDemo virtual network is the virtual network we’re going to work with. Within this virtual network, I’ve created two subnets. I did this to simulate a production environment.</p>
<p>The first subnet is called subnet-workloads. The second subnet is called subnet-jump. In the workloads subnet, I have a VM called PROD01, this PROD01 can simulate an app server or a file server or whatever the case might be. Now I’ve configured PROD01 without a public IP and I’ve configured the public inbound ports for it to none.</p>
<p>In my jump subnet, I also have a VM running, this VM is called JUMP01. And it’s going to serve as my jump box to access my PROD01 in the workloads subnet. The address range for the subnet workloads subnet is 10.0.2.0&#x2F;24. The address range for subnet-jump is 10.0.3.0&#x2F;24.</p>
<p>So with our lab environment explained here, let’s get into the deployment of Azure firewall.</p>
<p>To start our configuration, we need to create a subnet with a specific name. We need to create a subnet called AzureFirewallSubnet within our <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/azure-virtual-networks/">virtual network</a> here, this subnet will house our firewall.</p>
<p>So we’ll go ahead and create my sub net and I’m not going to do a play-by-play here because I assume you already know how to do this. What I’m going to do here is give this a range of 10.0.1.0&#x2F;26. And this is because Microsoft recommends a size of &#x2F;26 for the firewall subnet.</p>
<p>Okay, so we have our firewall subnet here with our range of 10.0.1.0&#x2F;26. With our firewall subnet created, we can deploy our firewall into the vNet-FirewallDemo virtual network. To do this, I’m going to click Create a Resource from my portal page here and I’m just going to search for firewall and then we’ll select it from the list. We’ll go ahead and create.</p>
<p>Now, from this Create page, I’m going to configure my new firewall that we’re deploying here. I need to make sure that I’m deploying into my intended subscription and into the resource group I intend. So we’ll go ahead and select our DemoRG. I’m going to call my firewall, simply MyFirewall. And then I’ll set my region to the same as my other resources, which is Central U.S., and I’m not worried about high availability here. So I’ll leave the availability zone set to none for this exercise here.</p>
<p>Now, in this, choose a virtual network here. What I need to do is either create a new virtual network for this firewall or use an existing one. So we’re going to use an existing one. We’ll select our vNet-FirewallDemo and then what I need to do is specify a public IP address. Now, I can either create a new one or select an existing one. So bear with me here while I create a new one. Just going to call it PublicIP-FW.</p>
<p>Now, I should point out here that the SKU section here for my public IP needs to be standard and it needs to be static. And we can see here that these are already set for us. So we’ll okay this and now what I’ll do is click Review and Create here to create the firewall. And then we’ll go ahead and create it. And this deployment can take a few minutes to finish. So we’ll let this run and then we’ll come back and do our configuration.</p>
<p>So with the deployment complete, I can click on Go to Resource here to see my firewall details. Now I need to note the private IP here, because I’m going to use this later on when I create my default route. Now my default route is going to send all traffic from the workload subnet through the firewall. To create my default route, what I’m going to do is browse to All Services here. And then what I’m going to do is browse to Networking and then I’m going to choose Route tables. And then I can either click Create Route Table or Add and we’re going to create a new route table and we’ll call it MyRouteTable.</p>
<p>We’re going to deploy into my lab subscription and into my demo resource group. Location again will be Central U.S. and if we planned to associate this route table to a subnet in a virtual network that’s connected to an on-prem network through a VPN gateway, disabling propagation would cause our on-prem routes to not propagate to the network interfaces in our subnet. We’re going to leave propagation enabled here. And then with all my choices made, I can click Create.</p>
<p>Now once it’s been deployed, and it takes a few moments, I can refresh here and see my new route table. Let’s go ahead and refresh here. And we can see my route table’s now showing up. So now what I need to do is associate my table with my virtual network. So I’ll click my route table here, and then select subnets. We can see there are currently no subnets associated with the route table, so we’ll click Associate here. And then from here, I will select my vNet-FirewallDemo virtual network. Now the subnet that I choose here is going to be my workload subnet. Then we’ll Okay it.</p>
<p>Next, I need to click on Routes, and then click Add. This is where I’m going to define my actual route that sends all traffic through the firewall. I’m going to call my route DefaultRoute. For address prefix, I need to type 0.0.0.0&#x2F;0, since I’m sending all traffic through this route. The next hop type here should be set to virtual appliance. And this is because my next hop is Azure firewall. Now you might be saying to yourself, I thought Azure firewall was a service, it is but for this exercise, it’s seen as a virtual appliance.</p>
<p>Now for the next hop address, I need to provide the private IP address for my firewall. Remember, we noted this earlier, At this point, I can click Okay. And this adds my route to my route table.</p>
<p>So now that we have our default route configured, what we’re going to do is create an application rule that allows outbound access to <a target="_blank" rel="noopener" href="http://www.cloudacademy.com/">www.cloudacademy.com</a>. Essentially, what we’re doing is locking everything down to just cloudacademy.com. To do this, we’re going to browse to our firewall. Let’s go back out, to home, go to our firewall here. And then what we’re going to do is go to Rules under Settings here. And since we’re setting up an application rule, we’ll choose the Application Rule Collection tab. And then under the Application Rule Collection tab we’ll click Add Application Rule Collection.</p>
<p>We’re going to call our collection here, MyAppCollection. And what we’ll do here, is give it a priority of 200. Since we want to allow traffic, we’re going to select Allow here for our action. And now under rules, we want to target FQDNs. So what we’ll do is we’ll provide a name for our new rule, and we’ll call it AllowCloudAcademy.</p>
<p>For source addresses, we need to specify what network is allowed to reach Cloud Academy. So for this exercise, we’re going to allow the workload subnet, the 10.0.2.0&#x2F;24. And for protocols, we’ll allow HTTP and HTTPS. And then of course, for the target FQDNs, we’re going to target <a target="_blank" rel="noopener" href="http://www.cloudacademy.com/">www.cloudacademy.com</a>. And then what I’ll do, is I’ll add my rule here.</p>
<p>Okay, so now I’ve shown you how to create a route table, a default route, and an application rule. Now what I’m going to do is show you how to create a network rule. The network rule we’re going to create allows outbound access to two different IP addresses on port 53, which is DNS. Because we’re going to need DNS to resolve the cloudacademy.com domain name. </p>
<p>To create our network rule, we need to select the Network Rule Collection tab. Now from here, we’ll choose the option to add a network rule collection and we’ll call this NetworkCollection. Again, we’ll set our priority to 200 and we’re going to allow our traffic. At this point, we need to define our rule. So under IP addresses, under the Rule section here. For our name, we’re going to call it AllowDNS. We’ll choose UDP for the protocol since DNS is UDP traffic. For this source address here, we’re going to set the source to our workload subnet which is 10.0.2.0&#x2F;24. And then we’re going to specify Google’s public DNS servers of 8.8.8.8 and 8.8.8.4 for our destinations and then we can use a comma here. And for destination ports here, we’ll use Port 53, because that’s what DNS operates over. Then we’ll go ahead and click Add.</p>
<p>So what we just did was create a rule that allows DNS traffic through our firewall, but only to Google’s public DNS servers. And we’ll let this rule appear here, and then we’ll move on to the next step. Okay, so now our new rule is in place. So to test things out, we need to configure the primary and secondary DNS servers that our virtual machine is going to use. Now, just to be clear, this isn’t an Azure firewall requirement, we’re just doing this because it’s a test environment and we’re testing things out here in a demo.</p>
<p>So what I’m going to do is browse to the network interface for our PROD01 virtual machine. So let’s go back here into this network interface here, the PROD01739 network interface here is the NIC for PROD01. So we’ll select our NIC here. And what we’re going to do is change the DNS servers to custom and specify Google’s servers here. And we’ll save it.</p>
<p>Now once this updates, what I’ll do is I’ll go out to my PROD01 VM here and we’ll start him up. We’ll let this VM come up and then what we’ll do is we’ll test our rules to make sure everything’s working the way it’s supposed to.</p>
<p>So our PROD01 is running, but we can see we have no public IP address here. So we can’t RDP to it directly and this was by design. So what we’re going to do is go out to our JUMP01 box here that I deployed. And he is in the process of starting up, we’re going to connect to our JUMP01. And then from there, jump over to PROD01. So we’ll go ahead and connect here, now that it’s running. And I’m just connecting off-screen here. And I’ll drag this into my live screen.</p>
<p>Now I’ll minimize this and remember, we’re going to connect to PROD01 and that’s 10.0.2.4. All right, so JUMP01 is up here. Let’s launch our RDP console here or RDP client, I should say. And these are some slower lab machines so bear with me here. So the first test we’re going to do here is see if we can actually RDP to our PROD server from JUMP. And it does appear that it’s going to let me so now that I’m on my PROD01 VM, I can launch a browser here and try to browse to cloudacademy.com. What we’ll do here is we’ll minimize and open Chrome here. And what we’ll do is we’ll browse to <a target="_blank" rel="noopener" href="http://www.cloudacademy.com/">www.cloudacademy.com</a>. And you can see we’ve actually hit the page.</p>
<p>Now, the reason we have a mess here with no styling is because our firewall is blocking all traffic to everything but cloudacademy.com. So a lot of the styling is coming from an outside site or like a CDN. Now, if I try to go to, for example, microsoft.com, I can’t even get to the site and it tells me that the request is denied because there’s no rule matched. So we can see that I was allowed to hit Cloud Academy but wasn’t allowed to hit microsoft.com, I’m blocked by the firewall. This confirms that my firewall rules are working. It confirms that I can only browse to the allowed FQDN and it confirms that DNS access to Google’s DNS servers is working as well. Otherwise, I wouldn’t have been able to resolve the names. So with that, you now know how to create a route table, a default route application rules, and network rules. You now know how to create and configure an Azure firewall.</p>
<h1 id="Intro-to-Application-Security-Groups"><a href="#Intro-to-Application-Security-Groups" class="headerlink" title="Intro to Application Security Groups"></a>Intro to Application Security Groups</h1><p>Hi, everyone. Welcome to Application Security Groups. Before I get into showing you how to create and configure application security groups, I just wanted to give you a brief overview of what they are and what they do. </p>
<p>So what exactly are application security groups? An application security group is a grouping of virtual network interfaces that is used to configure network security for the virtual machines that the NICs are attached to. Using an application security group allows you to define network security policies based on the group that you define. You can even reuse your defined security policy at scale without the need to manually maintain a list of included IP addresses.</p>
<p>While application security groups offer a more streamlined way to secure applications running on VMs, they do come with some constraints.</p>
<p>For example, you are limited to 30,000 application security groups that can be defined within a subscription. In addition, you can specify only one application security group as the source and destination when configuring a security rule. You are not allowed to specify multiple application security groups in either the source or destination.</p>
<p>Also, when configuring an application security group, all network interfaces that are assigned to the group must exist within the same <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/azure-virtual-networks/">virtual network</a> as the first network interface that is assigned to the application security group. For example, if you create an application security group and the first NIC that you assign to is connected to vNet1, all subsequent NICs assigned to the group must also be connected to vNet1. You can’t add NICs from different virtual networks to the same application security group.</p>
<p>Lastly, if you specify an application security group as the source and destination in a security rule, the NICs in both groups must exist within the same virtual network. So, for example, if you define a group called Group1 that contains NICs from VNet1 and then, you define another group called Group2 that contains NICs from VNet2, you can’t assign Group1 as the source and Group2 as the destination in a rule that you define because all NICs for both the source and destination application security groups need to exist in the same virtual network.</p>
<p>In the next lesson, I’ll show you how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-an-application-security-group/">create an application security group</a>.</p>
<h1 id="Creating-an-Application-Security-Group"><a href="#Creating-an-Application-Security-Group" class="headerlink" title="Creating an Application Security Group"></a>Creating an Application Security Group</h1><p>Hi everyone, and welcome back. In this lesson, I’m going to show you how to create an <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/intro-to-application-security-groups/">application security group</a>. So let’s jump right in.</p>
<p>To get started, I need to click Create A Resource up here in the left corner of the portal. What I’ll do here is search for Application Security Group. And then I’ll select Application Security Group from the results. When I click Create here, the Create an Application Security Group blade appears.</p>
<p>From here, I need to specify a new or existing resource group for my application security group. So I’ll put this in my DemoRG. I need to name my security group. So what I’ll do here is call it MyAppSecurityGroup. And what I’ll do here is deploy into the Central US region. Now what’s important to know about this region is that the application security group needs to be in the same region as any VMs that you plan to protect. So if you have VMs in the East region, then you would select the East region. I’m just going to select Central US here.</p>
<p>Now, from here, I can click either Next to do any tagging that I wanna do or I can simply do the Review and Create and begin the process. So we’ll go ahead and click Review and Create. And what it does here is validate my settings. And I can click Create to create my application security group.</p>
<p>So now that we have our deployment complete, we’ll go to our resource here. And we can see we have our application security group. Now you’ll notice there’s not a whole lot of configuration that can be done here. And that’s because an application security group is really just a logical collection of virtual machines, or really the NICs that are attached to those virtual machines. What you do is join virtual machines to the application security group and then use the application security group as a source or destination in network security group rules.</p>
<p>Now, I’m going to bounce out to my DemoRG here. And take a look at one of my virtual machines here. If we look at the Networking blade of my VM here, we see that there’s an option here for application security groups.</p>
<p>Now, this option here is related to the network interface of the VM. Clicking this option allows me to select which application security group that this virtual machine’s NIC should join. So if I click the Configure the application security groups button here, I can then select the dropdown and select my application security group and save it.</p>
<p>Now, with my settings saved and committed here, I can see that under our network interface for the PROD01 virtual machine, I now have my app security group listed as one of the application security groups.</p>
<p>Now, with my application security group created, what I could now do, if I go back to my DemoRG here, is I can <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-a-network-security-group/">create a network security group</a>. And what I’m going to do is show you where I could create some rules that would allow me to specify my new application security group. I’ll just call this testnsg. And we’ll deploy into Central.</p>
<p>So let’s go to our resource here. And now I’m in my network security group. If I select, let’s say, for example, inbound security rules. If I create a new rule, I can now select a source here, specify application security group, and now I have my application security group listed.</p>
<p>Now, what this does, in turn, is configure the network security group rule to apply to any associated virtual machine NICs that are a part of this application security group. So that’s how you do it. There’s not a whole lot involved in creating and configuring an application security group. And hopefully, after watching this video, you now have an idea of all that’s involved.</p>
<h1 id="Managing-Access-to-Resources-with-JIT-Provisioning"><a href="#Managing-Access-to-Resources-with-JIT-Provisioning" class="headerlink" title="Managing Access to Resources with JIT Provisioning"></a>Managing Access to Resources with JIT Provisioning</h1><p>Hi, everyone. Welcome back. In this lesson, I want to talk a little bit about just-in-time provisioning. Just-in-time provisioning is used to lock down inbound traffic to Azure virtual machines. By using just-in-time provisioning, you can ensure that only those who need access to your VMs get access, but that they only get access when it’s needed. This reduces exposure to attacks while providing access to connect to virtual machines only when needed.</p>
<p>Just-in-time provisioning is useful for protecting against brute-force attacks. Such attacks will often target management ports as a means to gain access to a virtual machine. When a brute-force attack is successful, the attacker can take control of a VM and establish a foothold in your environment.</p>
<p>Just-in-time provisioning protects against brute-force attacks by limiting the amount of time that the ports for a VM are open. Protecting virtual machines via Just-in-Time VM Access reduces the amount of time that an account has access privileges and it increases visibility into the use of such privileged accounts. To enable Just-in-Time VM Access for virtual machines, you need to create a policy that determines which ports to protect, how long those ports need to remain open, and any approved IP addresses that can access those ports. By creating such a policy, you can maintain control over what users can do when they request access.</p>
<p>Access requests are also logged in the Azure activity log. This allows you to monitor and audit access. You can then easily identify existing virtual machines that have Just-in-Time VM Access enabled, as well as any virtual machines where Just-in-Time VM Access is recommended.</p>
<p>To leverage Just-in-Time VM Access, you need to be in the Standard pricing tier of Azure Security Center. In the next lesson, I’ll show you how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/configuring-just-in-time-access-to-a-vm/">configure just-in-time access for a virtual machine</a>.</p>
<h1 id="Configuring-Just-in-Time-Access-to-a-VM"><a href="#Configuring-Just-in-Time-Access-to-a-VM" class="headerlink" title="Configuring Just-in-Time Access to a VM"></a>Configuring Just-in-Time Access to a VM</h1><p>Hello everyone, and welcome back. Now that we’ve touched on <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/managing-access-to-resources-with-jit-provisioning/">just-in-time access</a>, let’s walk through the process of configuring just-in-time access for a VM. Now, you can do this in one of two ways. You can do this right from the VM’s properties blade by going into Settings and then Configuration, or you can do it from Security Center. For this demonstration, I’m going to show you the Security Center option.</p>
<p>To do this from Security Center, we’re going to open the Security Center dashboard. Now, from the Security Center dashboard, in the left pane here, what we need to do is click on Just in time VM access. And if we scroll down here, it’s under the Advanced Cloud Defense area here.</p>
<p>Now, when this just in time access window opens, if just in time access isn’t already enabled, you’ll receive an option here to enable it. Now, if it’s already enabled, like it is here, you’re presented with information on the state of existing virtual machines. A status of Configured indicates a VM that’s been configured to support just in time VM access. The data for the last week is shown, and it includes info for the VM.</p>
<p>If we go to Activity Log here, we can see information. This would typically include information on the number of approved requests, last access date and time, and last user. We haven’t done anything with this VM, so this activity log is pretty barren.</p>
<p>If we go back and we look at Recommended, the Recommended status for VMs indicates that the VM listed here can support just in time VM access, but that it also hasn’t been configured yet. So the VMs listed here are VMs that are recommended for just in time VM access, but I haven’t configured them yet.</p>
<p>Now, when a status of No recommendation is shown here, and I got two here that show this, this indicates that the VM listed is not recommended for just in time access.</p>
<p>Now, the reasons for this can vary. Most commonly this is due to a network security group not being in place for the VM because the just in time solution requires a <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/intro-to-network-security-groups/">network security group</a> to be in place first.</p>
<p>Now, what I’m going to do here is click the Recommended tab, and under the virtual machines here, I’m going to select this EX1 virtual machine here, and I’m going to enable it.</p>
<p>Now, notice the check mark here. And what I’m going to do is enable just in time. Now, clicking that enable just in time displays the default ports that are recommended by Azure Security Center. Now, however, I could also configure custom ports as well, by clicking the Add button here. But for this demonstration, I’ll accept the default ports.</p>
<p>For each port that I want to configure, I can customize quite a few things here. I can customize the protocol type, which is the protocol that’s allowed on this port when a request is approved. I can also customize the allowed source <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/ip-addresses-subnets/">IPs</a>, which specifies the ranges that are allowed on this port when that request is approved. And I can also customize the maximum request time. This refers to the maximum time window during which a specific port can be opened.</p>
<p>I’m going to close this here. And then if I click Add here, I could add additional ports that I want to configure for this access. I’ll close this out. Now, when I’m happy with my settings, all I do is click Save and this saves my configuration. And with that, we can see that just in time access is configured for my virtual machine.</p>
<h1 id="Tools-for-Configuring-Security-Baselines"><a href="#Tools-for-Configuring-Security-Baselines" class="headerlink" title="Tools for Configuring Security Baselines"></a>Tools for Configuring Security Baselines</h1><p>Hello, everyone, and welcome back. Let’s talk a little bit about security baselines. Microsoft Azure doesn’t monitor for, or respond to, any security incidents that are considered to be within the customer’s area of responsibility. Instead, Azure provides tools like Azure Security Center that are intended for this purpose. Although Microsoft makes every effort to make every service as secure as possible by default, there is no way to predict how each customer will use each service. That being the case, you really need to review these security controls to ensure that they mitigate risks adequately.</p>
<p>Every <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure service</a> comes with a default baseline that is already designed to provide security for most common uses. However, each customer is responsible for creating its own set of baselines to ensure adequate protection.</p>
<p>Now, because every environment is different, I’m not going to try telling you how to create a security baseline, because what I tell you might not fit your specific environment. Instead, we’re going to talk a little bit about the tools that are available to you for configuring security baselines.</p>
<p>Let’s start with the Azure Portal and Azure Resource Manager. These tools are most useful for creating resources and for applying access controls to those resources. These tools can also be used to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/introduction/">secure virtual networks</a> and to configure backups and disaster recovery options.</p>
<p>Azure Key Vault can be used to encrypt virtual drives as well as PaaS storage and databases. Azure Active Directory provides the identity management platform that’s used to apply access controls to resources within Azure. It’s also used to manage hybrid identity services.</p>
<p>Azure Policy is used to secure virtual networks and to restrict allowed types of resources. It can also be used to enforce geo-regional restrictions. Using Security Center, organizations can monitor the security health of networks and resources, and to detect malicious activity. Security Center also preemptively detects vulnerabilities. And like Azure Security Center, Azure Monitor can also be used to detect malicious activity within your environment.</p>
<p>Understanding these tools and how to use them will allow you to create security baselines that fit your organization.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>I hope you’ve enjoyed learning about <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/introduction/">implementing Azure network security</a>. Let’s review what you’ve learned.</p>
<p>In this course, you learned about virtual network connectivity, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/connecting-networks-with-a-site-to-site-vpn/">how to configure site-to-site VPNs</a>, and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-a-network-security-group/">how to configure network security groups</a>.</p>
<p>As you progressed through the course, you learned about <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/creating-and-configuring-microsoft-azure-firewall/">Azure firewall configuration</a> and about the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/implementing-azure-network-security/intro-to-the-azure-front-door-service/">Azure Front Door Service</a>. You also learned how to configure application security groups.</p>
<p>Rounding out the course, you learned how to configure remote access management with just-in-time access and about what tools you can use to configure baselines.</p>
<p>To learn more about implementing Azure network security, you can, and should, read Microsoft’s published documentation. Be sure to also watch for new Azure courses on Cloud Academy because we’re always publishing new courses. Please give this course a rating and if you have any questions or comments, please let us know. Thanks for watching and happy learning!</p>
<h1 id="12Intro-to-Microsoft-Azure-Firewall"><a href="#12Intro-to-Microsoft-Azure-Firewall" class="headerlink" title="12Intro to Microsoft Azure Firewall"></a>12<strong>Intro to Microsoft Azure Firewall</strong></h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/firewall/overview">Azure Firewall overview</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/15/AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12/" rel="prev" title="AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12">
      <i class="fa fa-chevron-left"></i> AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/15/AZ-500-Load-Balancing-with-Azure-14/" rel="next" title="AZ-500-Load-Balancing-with-Azure-14">
      AZ-500-Load-Balancing-with-Azure-14 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Azure-Virtual-Networks"><span class="nav-number">2.</span> <span class="nav-text">Azure Virtual Networks</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IP-Addresses-amp-Subnets"><span class="nav-number">3.</span> <span class="nav-text">IP Addresses &amp; Subnets</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Virtual-Private-Networks"><span class="nav-number">4.</span> <span class="nav-text">Virtual Private Networks</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Connecting-Networks-with-a-Site-to-Site-VPN"><span class="nav-number">5.</span> <span class="nav-text">Connecting Networks with a Site-to-Site VPN</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Intro-to-the-Azure-Front-Door-Service"><span class="nav-number">6.</span> <span class="nav-text">Intro to the Azure Front Door Service</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-and-Configuring-Azure-Front-Door"><span class="nav-number">7.</span> <span class="nav-text">Creating and Configuring Azure Front Door</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Intro-to-Network-Security-Groups"><span class="nav-number">8.</span> <span class="nav-text">Intro to Network Security Groups</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-a-Network-Security-Group"><span class="nav-number">9.</span> <span class="nav-text">Creating a Network Security Group</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Network-Security-Rules"><span class="nav-number">10.</span> <span class="nav-text">Network Security Rules</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Security-Rules-in-an-NSG"><span class="nav-number">11.</span> <span class="nav-text">Configuring Security Rules in an NSG</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Intro-to-Microsoft-Azure-Firewall"><span class="nav-number">12.</span> <span class="nav-text">Intro to Microsoft Azure Firewall</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-and-Configuring-Microsoft-Azure-Firewall"><span class="nav-number">13.</span> <span class="nav-text">Creating and Configuring Microsoft Azure Firewall</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Intro-to-Application-Security-Groups"><span class="nav-number">14.</span> <span class="nav-text">Intro to Application Security Groups</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-an-Application-Security-Group"><span class="nav-number">15.</span> <span class="nav-text">Creating an Application Security Group</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Managing-Access-to-Resources-with-JIT-Provisioning"><span class="nav-number">16.</span> <span class="nav-text">Managing Access to Resources with JIT Provisioning</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Just-in-Time-Access-to-a-VM"><span class="nav-number">17.</span> <span class="nav-text">Configuring Just-in-Time Access to a VM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tools-for-Configuring-Security-Baselines"><span class="nav-number">18.</span> <span class="nav-text">Tools for Configuring Security Baselines</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conclusion"><span class="nav-number">19.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12Intro-to-Microsoft-Azure-Firewall"><span class="nav-number">20.</span> <span class="nav-text">12Intro to Microsoft Azure Firewall</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2653</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
