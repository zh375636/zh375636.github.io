<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Course IntroductionWelcome to Managing Data Protection and Security Compliance in Azure. My name is Thomas Mitchell, and I’ll be teaching you about the data protection and security compliance featur">
<meta property="og:type" content="article">
<meta property="og:title" content="AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12">
<meta property="og:url" content="https://example.com/2022/11/15/AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12/index.html">
<meta property="og:site_name" content="Hang&#39;s Blog">
<meta property="og:description" content="Course IntroductionWelcome to Managing Data Protection and Security Compliance in Azure. My name is Thomas Mitchell, and I’ll be teaching you about the data protection and security compliance featur">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-11-15T14:11:37.000Z">
<meta property="article:modified_time" content="2022-11-20T23:12:20.000Z">
<meta property="article:author" content="Hang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://example.com/2022/11/15/AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12 | Hang's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Hang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hang's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://example.com/2022/11/15/AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/123456.gif">
      <meta itemprop="name" content="Hang Zhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hang's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-15 10:11:37" itemprop="dateCreated datePublished" datetime="2022-11-15T10:11:37-04:00">2022-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-20 19:12:20" itemprop="dateModified" datetime="2022-11-20T19:12:20-04:00">2022-11-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AZ-500/" itemprop="url" rel="index"><span itemprop="name">AZ-500</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/11/15/AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/11/15/AZ-500-Managing-Azure-Data-Protection-and-Security-Compliance-12/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <span id="more"></span>

<h1 id="Course-Introduction"><a href="#Course-Introduction" class="headerlink" title="Course Introduction"></a>Course Introduction</h1><p>Welcome to Managing Data Protection and Security Compliance in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. My name is Thomas Mitchell, and I’ll be teaching you about the data protection and security compliance features within the Microsoft Azure environment. I am an Azure content author at Cloud Academy and I’ve had over 25 years of IT experience. Several of those with Cloud technologies. If you have any questions feel free to connect with me on LinkedIn, or send an email to <a href="mailto:support@cloudacademy.com">support@cloudacademy.com</a>. This course is intended for people who want to become certified Azure architects. This course maps closely to the data protection and security compliance learning objectives of Microsoft’s 70-533 exam. To get the most from this course, you should have a general understanding of Microsoft Azure. We will get started by covering the <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/creating-and-importing-encryption-keys/">creation and import of encryption keys</a> with Key Vault. And then work through how to prevent and respond to security threats, using the Azure Security Center. After that we’ll talk about configuring access to SaaS applications with Single Sign-On, and how to manage access to those applications. We will wrap up by covering the process of configuring federation with public consumer identity providers such as Facebook. By the end of this course, you should be able to manage encryption keys with Key Vault, manage security in Azure, configure and manage application access, and set up federation with third-party identity providers. We’d love to get your feedback on this course, so please give it a rating when you’re finished. If you’re ready to learn about some cool Azure functionality and how to use it, let’s get started.</p>
<h1 id="Creating-and-Importing-Encryption-Keys"><a href="#Creating-and-Importing-Encryption-Keys" class="headerlink" title="Creating and Importing Encryption Keys"></a>Creating and Importing Encryption Keys</h1><p>The Azure Key Vault protects cryptographic keys and secrets that are used by cloud applications and cloud services. With the Key Vault, you can encrypt keys and secrets with HSM-protected keys. HSM, by the way, stands for hardware security modules. Keys and secrets that you can encrypt with the Key Vault include such items as storage account keys, data encryption keys, .PFX files, authentication keys, and even passwords. Leveraging Key Vault allows you to streamline the key management process, allowing you to maintain control of keys that are used to access and encrypt your data. Developers and resource owners can create specific keys for access to development environments within minutes. As a matter of fact, the keys created for development can then be seamlessly migrated to production keys, if necessary. Security administrators, of course, can control access to keys by granting and revoking permissions to them. Keys in the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Key Vault can be used for signing and verifying data, protecting other keys, and for encrypting and decrypting data.</p>
<h1 id="Adding-a-New-Software-Protected-Key-to-the-Key-Vault"><a href="#Adding-a-New-Software-Protected-Key-to-the-Key-Vault" class="headerlink" title="Adding a New Software-Protected Key to the Key Vault"></a>Adding a New Software-Protected Key to the Key Vault</h1><p>If you want the Azure Key Vault to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/creating-and-importing-encryption-keys/">create</a> a software-protected key for you, use the Add-AzureKeyVaultKey command. It’s a relatively simple command and only requires a few switches. As you can see on the screen, I’ve got my PowerShell session opened. I’ve connected to my <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> tenant already, and I have my Key Vault, called BlueWidgetKeyVault, already provisioned. To create the new key in the Key Vault, I’m going to run the Add-AzureKeyVaultKey command. And with it, I’m going to specify the name of the vault, the name that I want to call the key that I’m creating and whether I want to store the key as a software-protected key or an HSM-protected key.</p>
<p>The command that I ran here creates a key named MyFirstKey in the Key Vault named BlueWidgetKeyVault. And it adds it as a software-protected key as defined by the software value in the destination switch. If I wanted to store the key as an HSM-protected key, I would have specified HSM as the value for destination instead. To view the URI for my newly-created key, I just need to call the key ID that’s stored in the key variable from this command above. To do that, I simply type key.id. So essentially, I’m calling the ID attribute of the key variable.</p>
<p>When I hit enter here, the URI of my first key is returned. This URI is significant because the keys created or uploaded to the Azure Key Vault are referenced by URIs. The fact that we can retrieve the key’s URI tells us that the key creation has actually been successful. We can further confirm the existence of this newly-created key by running the Get-AzureKeyVaultKey command and specifying the BlueWidgetKeyVault and MyFirstKey. So what I’ll do here is copy this command into my session here, as you can see, we’ve got Get-AzureKeyVaultKey and we’re simply specifying the name of the key and the vault name.</p>
<p>When we hit enter here, you can see that the command confirms that my MyFirstKey is stored in the vault. Now, the only required switch is VaultName when we run this command. However, by specifying that name switch up here, we can retrieve just the key that we’re interested in.</p>
<h1 id="Importing-an-Existing-Software-Protected-Key-into-Azure-Key-Vault"><a href="#Importing-an-Existing-Software-Protected-Key-into-Azure-Key-Vault" class="headerlink" title="Importing an Existing Software-Protected Key into Azure Key Vault"></a>Importing an Existing Software-Protected Key into Azure Key Vault</h1><p>In addition to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/adding-new-software-protected-key-key-vault/">creating new keys</a>, Azure Key Vault allows you to import existing keys as well. Since we’ve already worked through the process of creating a new key in the key vault, let’s work through the process of importing an existing software-protected key using the the Add-AzureKeyVaultKey command. In this demo, I’m going to walk you through this import process. I have here, in my keys folder, a software-protected key called swkey.pfx. This exported key is protected with a password. I used A123456z! to secure this key when I exported it from my workstation. To upload this key to my key vault in Azure, I first need to store this password in a variable using the ConvertTo-SecureString command. I can then access the key and import it from the PFX file into my key vault. </p>
<p>As you can see on the screen here, I’m converting the exported keys password to a secure string and storing it in the secure pfxpwd variable. Hitting ENTER runs this command and it usually doesn’t do a whole lot. We’re just saving a value to a variable. However, when it finishes, I can then import the key from the PFX file by running the Add-AzureKeyVaultKey command that I’m going to paste into the PowerShell session right now. When importing a software-protected key using this command, we need to specify the KeyFilePath and the KeyFilePassword. The KeyFilePath switch references the path to the PFX file that we’re going to import. The KeyFilePassword is the secure password that we need to access the PFX file. That’s the password we stored up here in the secure pfxpwd variable. Hitting ENTER here will create the key and store it in the vault. </p>
<p>We can display the URI for this imported key by typing Key-ID at the PowerShell prompt. So we go ahead and type in our command here to pull up the URI for our newly imported key. Now as you can see here, the full URI references MyImportedPFX. The MyImportedPFX key is the name of the key that we imported in our command. Now to view the actual key, we need to use the Get-AzureKeyVaultKey command. I’m going to go ahead and paste that command into our window here. </p>
<p>And as you can see on your screen, this command is essentially identical to the one we used previously to view the newly created key, except in this case, we’re just specifying MyImportedPFX as our key that we’re interested in. You can go ahead and hit ENTER here and what it’s going to do is return some key attributes about our imported key. It’s going to tell us when it was created when it was updated, and it gives us the vault name along with the ID. Now, if we wanted to view the properties of this imported key or really any other keys in our key vault, we could go into our <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal, as you can see here on the screen, browse into our actual key vault here and select Keys. On the screen where you can see that the portal tells us we have two keys in our vault, MyFirstKey which we created and MyImportedPFX which we imported. </p>
<p>Clicking on either one of those pulls up properties for those keys. So with that said, let’s <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/preventing-responding-security-threats-azure-security-center/">move on</a>.</p>
<h1 id="Preventing-and-Responding-to-Security-Threats-with-Azure-Security-Center"><a href="#Preventing-and-Responding-to-Security-Threats-with-Azure-Security-Center" class="headerlink" title="Preventing and Responding to Security Threats with Azure Security Center"></a>Preventing and Responding to Security Threats with Azure Security Center</h1><p>With the prevalence of data breaches and high profile hacks nowadays, it’s critical to understand how to prevent and respond to security threats. As such, it’s important to know how to leverage the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Security Center. </p>
<p>The Azure Security Center provides centralized threat protection and security management across hybrid cloud workloads. By leveraging the Azure Security Center you can apply security policies across your workloads, limit your exposure to threats, and detect and respond to attacks. Through centralized policy management, compliance with company and regulatory security requirements is ensured. </p>
<p>Administrators can monitor the security of machines, networks, storage services, and more to uncover potential security issues. The Security Center can make recommendations on actions to take to remediate security vulnerabilities before they are exploited. By offering the ability to collect, search, and analyze security data the Azure Security Center provides administrators with a way to ensure the security of all workloads. </p>
<p>The Azure Security Center helps with meeting security requirements through the definition of security policies used to maintain the desired configuration of workloads. Policies defined in the Azure subscription can be adapted to the type of workload or to the sensitivity of the data being protected. Azure Security Center can also provide security recommendations for resources such as compute, networking, SQL, storage, and applications. In this demonstration, you will learn how to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/configuring-security-policy/">configure a security policy</a> and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/assess-security-resources/">assess the security of Azure resources</a>. </p>
<p>To follow along with the steps in this demonstration, you must be on Security Center’s Standard pricing tier.</p>
<h1 id="Configuring-a-Security-Policy"><a href="#Configuring-a-Security-Policy" class="headerlink" title="Configuring a Security Policy"></a>Configuring a Security Policy</h1><p>Although security center automatically creates a default security policy for each of your <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> subscriptions, you’ll often find that you need to specially configure certain aspects of your policy. </p>
<p>To configure a security policy, log into the Azure portal and click on Security Center in the left pane. From the security center overview page, click Security Policy located under Policy and Compliance. From here, select the subscription that you want to manage. Now, in the top part of the screen here, we can see that I have one policy assignment configured and it’s my default policy. </p>
<p>Down here on the bottom half of the page, we can see which policies are enabled as part of this assignment. Hovering over each icon here will give you information about the specific security policy. To modify this policy assignment, what I need to do is click on the policy assignment up here at the top. From here, we can enable and disable each individual setting by selecting the dropdown box for each. </p>
<p>Now our choices here are typically enable, disable, and AuditIfNotExists. AuditIfNotExists enables auditing on a resource that matches the if-condition but doesn’t have the components specified in the details of the then-condition. If we scroll back up to the top here, we can even exempt specific resources from our policy assignment if we wish to. If we were to make any changes here, we would just need to scroll back down to the bottom here and click the Save button to save our changes. Now, we’re not making any changes here so I’ll just click Cancel here. </p>
<p>What security center does is assess the configuration of your environment on a continuous basis and when a vulnerability is detected, security recommendations are generated based on the settings you make here. As recommendations become available in the security center dashboard, you can begin <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/assess-security-resources/">assessing the security</a> of your individual resources.</p>
<h1 id="Assessing-Security-of-Resources"><a href="#Assessing-Security-of-Resources" class="headerlink" title="Assessing Security of Resources"></a>Assessing Security of Resources</h1><p>Based on the security policies that are enabled, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/protect-your-resources-azure-security-center/">Security Center</a> provides a set of security recommendations as needed. </p>
<p>Assess resource security by reviewing the recommendations made. Generally, starting with virtual machines and applications. To do this, browse to the Security Center dashboard. Ensure overview opens and then click compute and apps under resource security hygiene. From this overview tab, you can review all recommendations by severity with anything in red being high severity. While some recommendations can be remediated directly from Security Center, other recommendations have only guidelines to apply the remediation such as the missing disc encryption recommendation. You can see here it offers remediation steps and instructions.</p>
<p>Click through each recommendation to see how each issue can be remediated. To dig down further into the recommendations, you can browse each of these tabs here along the top. Clicking on VMs and computers reveals recommendations that are specific to virtual machines and computers while the VM scale sets tab reveals recommendations for any scale sets within your subscription. </p>
<p>As you can see here, you can do the same for cloud services, app services, containers and compute resources. The compute resources tab reveals recommendations for things like event hubs, automation accounts, service busts and other compute resources. After addressing all recommendations for compute and apps, move onto networking by clicking networking under the resource security hygiene section. </p>
<p>As was the case with compute and apps, the networking recommendations page defaults to the overview page. This page presents you with a clickable network topology map that shows risky resources in the subscription. You are also presented with information on adaptive network hardening. When you click the adaptive network hardening tile, you’re presented with information about overly permissive network security groups as well as network security rules along with recommendations for hardening them. </p>
<p>Going back out to the overview page allows you to click the VNet tab to see recommendations that are specific to individual virtual networks. After remediating outstanding network issues, move onto IoT hubs and resources and then onto data and storage. The data and storage page contains recommendations revolving around auditing for <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> SQL servers and databases, storage accounts, write as cache, Data Lake analytics and Data Lake store. Obviously, if these workloads don’t exist in your environment, you won’t see any recommendations for them. </p>
<p>Just like the other resource recommendations, some data and storage recommendations will provide integrated remediation options while some other recommendations will not. Continue working through each recommendation and remediate them as you progress until all outstanding issues are resolved. </p>
<p>In this demonstration, you learned about the assessment of your workloads with Security Center. You learned how to assess security for compute, apps, networking, scale sets, SQL, storage, IoT and application resources.</p>
<h1 id="Protecting-Your-Resources-with-Azure-Security-Center"><a href="#Protecting-Your-Resources-with-Azure-Security-Center" class="headerlink" title="Protecting Your Resources with Azure Security Center"></a>Protecting Your Resources with Azure Security Center</h1><p>Azure Security Center leverages access and application controls to block malicious activity, limiting your exposure to threats. A feature of this protection called, just in time virtual machine access reduces your attack exposure by allowing you to deny persistent access to VMs.</p>
<p>With just in time VM access, you provide controlled access to virtual machines only when it’s needed, and this controlled access is also audited. Another feature called Adaptive Application Controls help you harden virtual machines against malware by controlling the applications that can be run. <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/protect-your-resources-azure-security-center/">Azure Security Center</a> uses machine learning to analyze the processes that are running on a virtual machine and allows you to apply whitelisting rules using this intelligence.</p>
<p>In the next lesson, you’ll learn how to configure a just in time <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/manage-vm-access/">VM access policy</a>.</p>
<h1 id="Managing-VM-Access"><a href="#Managing-VM-Access" class="headerlink" title="Managing VM Access"></a>Managing VM Access</h1><p>Just in time VM access can be used to lock down inbound traffic to your <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> VMs, reducing exposure to attacks while providing easy access to connect to the VMs when needed. Management ports for a virtual machine don’t need to be open all the time. They only need to be open while you are connected to the VM and performing management tasks. When just in time is enabled, <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/protect-your-resources-azure-security-center/">security center</a> uses network security group rules to lock down access to the management ports. This greatly reduces the attack surface of the virtual machines. To manage access to your virtual machines using just in time, browse to the security center main menu which is what you see here on the screen. From here you’ll want to select just in time VM access under the advanced cloud defense section. </p>
<p>So let’s scroll down here to advanced cloud defense and here we’ll see just in time VM access. From this pane just in time VM access provides information on the state of your virtual machines. VMs that have been configured to support just in time VM access are listed under the configured heading. As you can see here I don’t have anything configured for just in time in my lab environment quite yet. VMs that support just in time VM access, but have yet to be configured are listed under recommended. As you can see here I have server 01 listed as a recommended virtual machine because I don’t have it protected with just in time VM access yet. Now VMs that are missing a network security group or that have had just in time specifically turned off are shown under no recommendation. Now one thing to note here is classic VMs are not supported by just in time so they too will be shown under no recommendation. </p>
<p>To enable just in time for a particular VM, select a VM from the recommended list and click enable just in time on one VM to configure a just in time policy for that particular VM. So as you can see here we have one server listed under the recommended tab so we’ll select server one and enable just in time. Now when just in time is enabled, you’re presented with the default port setting that security center recommends. You can either accept these defaults or you can add and configure a new port on which you want to enable the just in time solution. </p>
<p>In this demo we’re going to add a port by selecting the add option from the just in time VM access configuration pane here. After clicking add, we need to specify a port number we wish to configure access for. And we also need to configure the protocol type and the allowed source IP ranges. In addition a maximum request time that the specific port can be opened for is also necessary. So for this demonstration we’ll allow port 80 through our just in time. So we select port 80, we’ll do any protocol here and in this little section here for allowed source IPs there’s two options here, per request or site or block. </p>
<p>When you select per request here, what this means is the request for just in time access is made from the IP that the client is currently at. So for example if Joe in my office needs port 80 access to this machine, when he goes ahead and requests that just in time access, it’s gonna look at his specific IP and use that in the request. However if I wanted to allow access through this configuration to a specific range or a specific subnet or even specific IPs, I would select site or block here. What we’re going to do here is we’re going to allow the source IPs per request. And then the max request time here is three hours. </p>
<p>We can change this to one or five or 15 or whatever we wanna set it to. And this max request time essentially is how long is that access opened for that request. We’ll go ahead and click okay here and then once we’re done with that we’ll click save.</p>
<h1 id="Configuring-Access-to-SaaS-Applications-with-Single-Sign-On"><a href="#Configuring-Access-to-SaaS-Applications-with-Single-Sign-On" class="headerlink" title="Configuring Access to SaaS Applications with Single Sign-On"></a>Configuring Access to SaaS Applications with Single Sign-On</h1><p>When a user logs into an application, that user will go through an authentication process where he or she is required to prove that they are who they say they are. Unless a single sign-on is configured, this authentication process is typically completed by answering a password that is stored at the application. Users are required to know this password. To improve security, <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> AD supports single sign-on for securing applications. </p>
<p>As an admin, you can configure <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/using-federation/">federated single sign-on</a>, which allows applications to redirect to Azure AD for user authentication rather than prompting for its own password. Password-based single sign-on is another option available to admins when securing applications. With password-based single sign-on, the existing password process is retained. However, the administrator manages the password and the end user does not know it.</p>
<h1 id="Using-Federation"><a href="#Using-Federation" class="headerlink" title="Using Federation"></a>Using Federation</h1><p>To configure federated single sign-on for an application from the Azure AD gallery, you need to add the application from the Azure AD gallery, configure the URLs, select the user identifier that’s to be sent to the application during authentication, retrieve the Azure AD metadata and certificate, configure the Azure AD metadata values within the application itself and then assign users to the application. So there are quite a few things that have to happen to allow <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/configuring-access-saas-applications-single-sign-/">single sign-on</a> to work. We’ll walk through all of these steps one by one throughout the course of this demo, starting with the addition of the app from the Azure AD gallery. In this demonstration, we’re going to use Dropbox as the application that we’re going to enable single sign-on for. </p>
<p>What I’ve done prior to this demonstration is to sign up for a Dropbox account. It’s actually a Dropbox business account which allows single sign-on. To add an application from the Azure AD gallery, what you need to do is open the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal and sign in as a global administrator which I’ve already done here as you can see on your screen. From here we simply have to click on Azure Active Directory. Once in the Azure Active Directory, you go ahead and select enterprise applications. </p>
<p>To add a new application, you go ahead and click new application up at the top here and then you can search for your application. So we’re going to add and configure Dropbox as our chosen application here. After selecting Dropbox from the list, you can see here on the right-hand side that you can actually change the name of the application within your dashboard if you’d like to. We’re going to leave it as the default Dropbox for Business. We can add the application simply by clicking the add button. When we switch back to our enterprise applications list and refresh it, after a moment or two we should see Dropbox appear. </p>
<p>So now that the application’s been added, we need to set up the single sign-on for it by configuring metadata values within Azure AD. So to start configuring this application for single sign-on, we select the application from our list and then once this loads we can click on single sign-on from the application’s left hand navigation menu. As you can see it opens up as single sign-on disabled by default. We’re going to configure this application for SAML single sign-on. Now from this screen, we’re going to have to do some configuration. First and foremost we have to enter some of our URLs here for Dropbox. Now, these values typically come from the application itself. In the case of Dropbox for Business, we can get the sign-on URL which is listed here from our Dropbox for the Business portal by opening that business portal and clicking on copy link under the SSO sign-in URL. So what I’m going to do is switch over to my Dropbox portal and where I have the single sign-on setup screen here. </p>
<p>And this process will be different for each application because each application handles single sign-on differently. But to get my sign-on URL for Azure I’m going to go here under SSO sign-in URL and copy that link. I can then paste that into my sign-on URL field. We can leave the Dropbox identifier at the default and in our case we don’t need any advanced URL settings. So now that we’ve added our URLs we need to select the user identifier and attributes that are going to be sent to the application during the authentication process. So under user attributes what we do is we select a unique user identifier that is going to be passed to the application during authentication. Now an important note to keep in mind here is that the selected option here needs to match the expected value within the application in order to authenticate the user. So for example, if the application expects a user login of <a href="mailto:&#102;&#105;&#x72;&#115;&#x74;&#46;&#108;&#97;&#x73;&#116;&#x40;&#100;&#x6f;&#109;&#x61;&#x69;&#x6e;&#46;&#99;&#111;&#109;">&#102;&#105;&#x72;&#115;&#x74;&#46;&#108;&#97;&#x73;&#116;&#x40;&#100;&#x6f;&#109;&#x61;&#x69;&#x6e;&#46;&#99;&#111;&#109;</a> and you supply <a href="mailto:&#108;&#x61;&#x73;&#x74;&#x2e;&#x66;&#x69;&#x72;&#x73;&#x74;&#64;&#100;&#111;&#x6d;&#x61;&#x69;&#110;&#46;&#99;&#x6f;&#x6d;">&#108;&#x61;&#x73;&#x74;&#x2e;&#x66;&#x69;&#x72;&#x73;&#x74;&#64;&#100;&#111;&#x6d;&#x61;&#x69;&#110;&#46;&#99;&#x6f;&#x6d;</a>, authentication’s going to fail. </p>
<p>In our case, we’re going to use the user.mail attribute. So this tells SSO to pass the user’s email address when authenticating. And what we’ll do is make sure that our user’s email address matches the Dropbox login later on. So the next step in the process is to download the application metadata or certificate from Azure AD so that it can be supplied to the application in the application’s management portal. And just to explain that to you a little better, if we switch over to our portal, you can see here that I previously uploaded a certificate in preparation and we’ll upload another one, but this is where we’re going to upload it. </p>
<p>This allows for secure authentication. So to get our SAML sign-in certificate, we scroll down here to the SAML sign-in certificate section. However, you can see that no certificates have been configured yet. If a cert doesn’t yet exist, you can click create a new certificate to create a certificate and then save it. So we’re gonna create a new certificate here that expires in 2021 and we’ll click save. And then we’ll go ahead and make the new certificate active. Now we can’t quite download the certificate yet because we have to save this configuration. </p>
<p>However what I do want to note though is that although our Dropbox application requires a certificate, some applications may need the metadata XML instead. If so you have the option to download the metadata XML instead of the certificate by clicking right here. Now, this requirement is going to be application dependent. Of course here you have a notification email field and this is basically the email that you’re going to receive notifications on when the certificate comes up for renewal. </p>
<p>So to get this certificate into a state where we can download it, we’re going to save our configuration here. So with the configuration saved, the certificate now becomes downloadable so we’ll go ahead and download the certificate. So now that we have our certificate downloaded which we’ll use in a moment to upload it to our Dropbox account, we also have to get what’s called the Azure AD single sign-on service URL. That URL is this URL here in Dropbox and as you can see here this actually verifies members when they enter their credentials. Now to get that URL, we click on configure Dropbox for Business and if we scroll down here we can see the Azure AD single sign-on service URL is right here. And this is going to be specific to your application and your application instance so we’ll copy this URL. And we’ll add this into the sign-in URL for Dropbox. </p>
<p>So now that we have our sign-in URL configured in Dropbox, we can upload the new certificate as well. And this is the certificate we downloaded from Azure. We’re gonna turn off the Google sign-in. We don’t need Google. And with that we have our application configured. We don’t need anything else configured here. The identity provider sign-out URL is optional. We can click save here so now we have our application configured for single sign-on. Now we can finish up the single sign-on configuration in Azure. </p>
<p>So with the certificate downloaded from Azure and installed in our application and with the Azure AD single sign-on service URL copied and pasted into our application, we are now done with the configuration. So once we’re done with that configuration we have to go in and assign a user to our application to test access. So to assign a user to our application, it’s pretty straightforward. You can assign users directly to the app by clicking on the users and groups link here on the left and from here we simply click the add user button or link, whatever you wanna call it, and then we select which users we want to have access to this application.</p>
<p>In this case, we’re going to add my account as an assignment for this application and then we click select. And after clicking select we click the Assign button to assign the user to the application. So at this point, we have our Dropbox application configured for single sign-on and we have my <a href="mailto:&#x74;&#x6f;&#109;&#64;&#x74;&#x68;&#111;&#x6d;&#97;&#115;&#x6d;&#x69;&#116;&#99;&#104;&#101;&#x6c;&#108;&#46;&#110;&#101;&#x74;">&#x74;&#x6f;&#109;&#64;&#x74;&#x68;&#111;&#x6d;&#97;&#115;&#x6d;&#x69;&#116;&#99;&#104;&#101;&#x6c;&#108;&#46;&#110;&#101;&#x74;</a> user account assigned to the application. So what that means is after a few minutes I can use my user account to launch this application. And I’m going to launch it using federated single sign-on. </p>
<p>Now we can test this using the test SAML settings within the application here. Just click on single sign-on for the app that we’re working with and then test SAML settings. So although Microsoft recommends installing my app secure sign-on extension, we don’t need to do that just to test the authentication for our new single sign-on app. We can go ahead and click sign in to Dropbox for Business and as you can see here it gives me the prompt for single sign-on and that I’m about to use my Dropbox business account as <a href="mailto:&#116;&#x6f;&#x6d;&#64;&#116;&#104;&#111;&#x6d;&#x61;&#115;&#x6d;&#x69;&#x74;&#x63;&#104;&#101;&#x6c;&#x6c;&#x2e;&#110;&#x65;&#x74;">&#116;&#x6f;&#x6d;&#64;&#116;&#104;&#111;&#x6d;&#x61;&#115;&#x6d;&#x69;&#x74;&#x63;&#104;&#101;&#x6c;&#x6c;&#x2e;&#110;&#x65;&#x74;</a>. We can go ahead and click continue and Dropbox lets me in. So I’ve confirmed that my Dropbox application works with single sign-on and I’ve configured that the application within Azure is configured correctly with single sign-on as well.</p>
<h1 id="Using-Password-Based-Authentication"><a href="#Using-Password-Based-Authentication" class="headerlink" title="Using Password Based Authentication"></a>Using Password Based Authentication</h1><p>When adding an application from the Azure AD Application Gallery, you can configure authentication to leverage single sign-on. One of the single sign-on methods available is the password-based single sign-on option. Using password-based single sign-on is a great way to get an application integrated into Azure AD quickly. To configure a password-based single sign-on for an application, browse to the Azure portal, and sign in as a Global Administrator. </p>
<p>As you can see here, I’ve already done so. From within the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal, click on Azure Active Directory in the left navigation menu. In the blade that opens, select Enterprise Applications. For the purposes of this demonstration, we’re going to add GoToMeeting as an application, and we’re going to turn on password-based single sign-on. So we click Add to add an application and select GoToMeeting. You can go ahead and click Add. And from the there, the application is added. </p>
<p>When we go back into Azure Active Directory and into Enterprise Applications, we can see GoToMeeting listed. To configure password-based single sign-on for this application, we simply select the application and click single sign-on. As you can see, the application by default has single sign-on disabled. To enable single sign-on, change the dropdown to password-based sign-on, and click Save. Refreshing the screen will update the sign-on URL. As an administrator, you can also provide the app credentials on behalf of your users, by going into <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/adding-users-and-groups-applications/">Users and groups</a> and updating credentials for your users. </p>
<p>For example, I could go ahead and select Jen here, and update Jen’s credentials. And from the Update Credentials screen, I can enter Jen’s email address and password, that is used to access GoToMeeting, so when she authenticates to the GoToMeeting application, she doesn’t even need to know the login information. Clicking Save stores the credentials, and the next time Jen launches GoToMeeting from her application dashboard, the credentials will be presented and she won’t even have to know what they are. So as you can see, leveraging password-based single sign-on makes onboarding applications into a single sign-on environment rather straightforward.</p>
<h1 id="Adding-Users-and-Groups-to-Applications"><a href="#Adding-Users-and-Groups-to-Applications" class="headerlink" title="Adding Users and Groups to Applications"></a>Adding Users and Groups to Applications</h1><p>Before your users can access an application, they first need to be <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/assign-user-or-group-application/https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/assign-user-or-group-application/">assigned</a> to it. Until you assign your users to an application, they will not be able to access it via the application URL, nor will they be able to access the application via the user access URL. As a matter of fact, users will not even see the application appear on the application access panel nor on their mobile application. It also won’t appear on their Office 365 application launcher.</p>
<p>It’s essentially like the application doesn’t even exist as far as your users are concerned. As such, this demo will explain how to add users and groups to applications. There are three ways you can do this with <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Active Directory. You can assign a user directly to an application, you can assign a group directly to an application or you can enable self-service application access to allow users to find their own applications.</p>
<h1 id="Assign-a-user-or-group-to-an-application"><a href="#Assign-a-user-or-group-to-an-application" class="headerlink" title="Assign a user or group to an application"></a>Assign a user or group to an application</h1><p>As a global admin for the Azure Directory that has appropriate permissions to manage an Enterprise application, you can assign users to applications. The only caveat is that the Azure Active Directory must be Azure Active Directory Premium P1 or Premium P2. To assign one or more users to an application directly, browse to the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal as a global admin. We’ve already done that here as you can see on the screen. From here, open Azure Active Directory, and then select Enterprise applications. </p>
<p>Select the application that you need to assign. In this case, we’re going to assign box. And once it loads here, select <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/adding-users-and-groups-applications/">users and groups</a>. As you can see, we have no users or groups assigned to our box application yet. To do so, simply click the add user button at the top. And then from the add assignment blade, select users and groups. And then you can see all your users and groups that are available to you. In this case, I’m going to assign both the box users group that I created, and my own specific account to the application. Go ahead and click select. And from here, click assign. At this point, we’ve assigned our users and groups to the application. After a few moments, the users, and members of the groups that we added, should be able to launch the application that they have been assigned to.</p>
<h1 id="Enable-self-service-application-access"><a href="#Enable-self-service-application-access" class="headerlink" title="Enable self-service application access"></a>Enable self-service application access</h1><p>In addition to <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/assign-user-or-group-application/">assigning users and groups</a> to applications directly, access can also be granted via self-service. Self-service application access allows users to self-discover applications. And you can allow the business group to manage the credentials signed to those users. Before your users can self-discover your application right from their access panels you need to enable self-service application access for those applications that you want to allow self-discovery for. </p>
<p>To enable self-service application access to a particular app launch the <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> portal and sign in as a global administrator. We’ve already done that here. Once logged in as a global admin open the active directory extension and select Enterprise applications. From a list of applications enabled in your tenant click on the application that you wish to enable self-service for. Once it loads simply click self-service from the applications left-hand navigation menu. And select yes to allow users access this application. </p>
<p>After enabling self-service for the application select a group of users that should be able to request access to this application. In this case, we’re going to select Dropbox users. And from here we just click select. Now if business approval is required before users are allowed to access the application you can set the required approval before granting access toggle switch to yes. And in that case, you would select the approvers that would be enabled to approve access to this application. </p>
<p>If there are multiple roles within the application you can also select the role that users should be assigned within the application here. In our case, we only have the default access role. After making our selections here we click save. This point it will ask if we’re sure and we click yes. After you’ve completed the self-service application configuration your users can navigate to their application access panel and click on the add button. This will allow them to find the apps to which they’ve been allowed self-service. On the screen where I’m in my application access dashboard and what I can do is click add an app and as you can see we can now add Dropbox as an application via self-service.</p>
<h1 id="Revoking-Access-to-SaaS-Applications"><a href="#Revoking-Access-to-SaaS-Applications" class="headerlink" title="Revoking Access to SaaS Applications"></a>Revoking Access to SaaS Applications</h1><p>Removing a user’s or group’s access to an enterprise application is pretty straightforward. This, of course, assumes that you have appropriate permissions to manage the enterprise app and are a global admin for the directory. In the next demo, we will walk through the process of <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/remove-user-or-group-assignment-enterprise-app-azure-portal/">removing a user</a> who has been assigned access to an application.</p>
<h1 id="Remove-a-user-or-group-assignment-from-an-enterprise-app-in-the-Azure-portal"><a href="#Remove-a-user-or-group-assignment-from-an-enterprise-app-in-the-Azure-portal" class="headerlink" title="Remove a user or group assignment from an enterprise app in the Azure portal"></a>Remove a user or group assignment from an enterprise app in the Azure portal</h1><p>Removing a user or group assignment from an Enterprise application in the portal is as simple as adding it was. To remove a user assignment or a group assignment from an Enterprise app in the portal, sign into the portal with an account that’s a global admin for the directory.</p>
<p>I’ve done that already here. After logging in, select <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Active Directory on the left side and click on Enterprise applications. In our case, we assigned some users in groups to the Box application, so what we do to remove that access is simply click on the application we’d like to manage, select Users and groups and then remove our access. And there you have it. Removing access to an application is actually even a little bit easier than assigning it in the first place.</p>
<h1 id="Configuring-Federation-with-Public-Consumer-Identity-Providers"><a href="#Configuring-Federation-with-Public-Consumer-Identity-Providers" class="headerlink" title="Configuring Federation with Public Consumer Identity Providers"></a>Configuring Federation with Public Consumer Identity Providers</h1><p>Azure Active Directory B2C offers customer identity and access management in the cloud by integrating authentication with entities such as social accounts, emails, custom IDPs. <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a> Active Directory B2C supports all platforms and open standards and allows you to customize the customer’s identity experience while meeting security, scalability and compliance needs. In the next demonstrations, we will walk through the process of integrating authentication with <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/facebook/">Facebook</a> and <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/google/">Google</a>.</p>
<h1 id="Facebook"><a href="#Facebook" class="headerlink" title="Facebook"></a>Facebook</h1><p>Configuring sign up and sign on options to leverage Facebook is actually not terribly difficult. And really only consists of a couple key steps. First, you need to create a Facebook application and then, you need to configure Facebook as an identity provider in the Azure tenant. Lastly, you need to configure your application to leverage the actual authentication of Facebook. One key thing to note here is that using Facebook to login to applications does require an Azure active directory B2C Tenant. </p>
<p>The standard Azure active directory tenant doesn’t work, you need a B2C Tenant. In this demonstration, I’m going teach you how to configure a basic Azure web app to use Facebook for authentication. To prepare for this demo, I’ve already deployed An Azure active directory B2C Tenant and I also deployed a basic PHP web application in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. As we work through this demonstration, we’ll create the Facebook application first. We will then configure Facebook as an identity provider in the Azure tenant. </p>
<p>Lastly, we’ll configure the web app to use Facebook for authentication. for granting access to the application. Using Facebook as an identity provider in Azure active directory B2C requires you to first create a Facebook application and supply it with the proper parameters. As such, you’re going to need a Facebook account to do this. Now, to create a Facebook application, what you need to do is visit the Facebook for developers website and sign in with the Facebook account credentials. </p>
<p>You’re also going to need to register as a Facebook developer. To do this, you would simply visit the developer website and I’m going to switch over here, It’s actually developers.facebook.com and what you would do is you would click register, accept the policies and then complete the free registration. I already have a developer account so I don’t need to go through the registration process and to be honest, this particular demonstration isn’t about registering with Facebook it’s about Facebook as an identity provider within Azure. Once you’ve registered as a developer you need to start the process of creating a Facebook application. To do that, click My Apps here up in the upper right hand corner. And then click add new app. You’re going to need to provide a display name and a valid contact email address here. </p>
<p>So what we’ll do for our display name for our application, we’ll call it my demo application. And we’ll keep my throw away email here as my contact. Create the new app id, we simply click create app id. If you’re prompted to confirm that you’re not a robot, go ahead and confirm that you’re not a robot. After creating the app id, what you need to do is over in the left column click settings. And then basic. So in this configuration screen, we’re gonna make some changes to create our application. First thing we’re gonna do is select a category, and this category can be anything, but what I typically do is select business and pages. After selecting our category, you can scroll down to the bottom here and click on add platform. Since we’re creating this application to integrate authentication for a website, we’ll select website. In the site url field, enter the url of the web app and then what we’ll do is we’ll click save changes. </p>
<p>The url of the web app can be tracked down through the Azure dashboard by clicking on the application. As you can see here up in the upper right hand corner we have a url for our application. So we’ll copy this url and this gets pasted into the site url screen. At this point we can save our changes. After saving our changes, we’re presented with an app id and an app secret. We need to note both of these. To view the app secret we can click show and then we’re prompted to re-authenticate to Facebook. In addition to our app id and our app secret we also have to specify a privacy policy to conform with Facebook privacy policies. </p>
<p>Typically this would be a privacy policy page on the website that you’re giving people access to. For this demonstration, I’m just going to use my understandingazure.com just as a filler. From here we can click save. Next we need to add a product. The product we’re going to add is the Facebook login. So from the add a product screen, we click setup under Facebook login. Now instead of using the quick start here to configure the Facebook login we’re going to click settings underneath. On the client oauth settings screen, we need to provide valid oauth redirect URIs. And what these URIs do is prompt for a login when a person hits the website and isn’t logged in to Facebook and at the same time it also allows when a person is logged into Facebook to get the little prompt that says, we’re going to share your information with this application. </p>
<p>We’re going to do here is paste in two URLs here. As you can see here, the first valid oauth redirect URI is actually the url of the website with a trailing signin-facebook. The second URI that we’re going to enter is the same thing, we have the url to our application but we’re trailing it with a .auth&#x2F;login&#x2F;Facebook&#x2F;callback that’s the call back url. After adding the redirect URIs we click save. Now you can see up here, it’s hidden, it tells me that it’s actually saved. So we now have the application in Facebook created, however before the Facebook application is usable my Azure AD B2C it needs to be made publicly available. You can make the application publicly available by clicking app review on the left navigation here and setting the make my demo application public switch to yes. It will ask you if you’re sure and you can confirm it. </p>
<p>With the Facebook application created and configured you can figure Facebook as an identity provider in the Azure tenant, which is what we’re going to do now. With the Facebook application created and configured, we can now configure Facebook as an identity provider within the Azure Tenant. To configure Facebook as an identity provider what we do is, we switch over to the tenant and we browse to the B2C features blade in the Azure portal. From the B2C features blade here we simply click identity providers. </p>
<p>After clicking on identity providers, click add at the top of the screen here and provide a friendly name for the identity provider configuration. You may typically call this Facebook. Next, click on identity provider type and select Facebook from the list. And then click okay. At this you click setup this identity provider and then you need to supply the app id and app secret from the application in Facebook. We supply the app id and the app secret in their respective fields. Then we create and save the configuration by clicking okay and then create. </p>
<p>At this point, we now have Facebook configured as an identity provider within the tenant. With the Facebook application created and Facebook configured as an identity provider, the web app can now be configured to leverage Facebook authentication. To configure the web app to use Facebook for authentication, browse to the application in the resource group to which it’s been deployed. From our dashboard here, we’ll click our demo app. And from here, we click on authentication and authorization. Keep in mind this setting is listed under the settings subheader. From here we turn on app service authentication by switching the toggle to on. And to prevent anonymous access we change the option for action to take when request is not authenticated to login with Facebook. So what this will do is force authentication before allowing access to the web app. </p>
<p>Next we click Facebook here to configure it. Again we need to provide our app id and app secret from our Facebook application. We provide the app id and the app secret and click okay. Lastly, click save up top, to save the configuration. By saving this configuration, we complete the configuration of the web app to use Facebook for authentication. To test the login for the web app, browse to the web app and right click on the url that’s listed for the web app. What we’ll do here is open the link in an incognito window. </p>
<p>And what will happen here is the application will actually direct us to Facebook to login. As you can see we’re prompted for a Facebook login and supply my credentials here and login. We’re then prompted to continue as Tom. From there, we are redirected back to the application which is just a dummy PHP app, but as you can see, the login information was accepted and the authentication process took me back to the web app after being successfully authenticated via Facebook. So in this demonstration you learned how to configure a web app, to use Facebook authentication by creating the necessary Facebook application configuring Facebook as an identity provider and then configuring the web app to use Facebook for authentication.</p>
<h1 id="Google"><a href="#Google" class="headerlink" title="Google"></a>Google</h1><p>In this demonstration, I’m going to teach you how to configure a basic Azure web app to use Google for authentication. To prepare for this demo, I’ve already deployed an Azure Active Directory B2C Tenant, which is what you see here on the screen. And I’ve also deployed a basic PHP Web App in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Azure</a>. </p>
<p>As we work through this demo, we’ll create a Google App first, we will then configure Google as an Identity Provider in the Azure Tenant, lastly we’ll configure the web app to use Google for authentication, and we’ll test authentication. Before configuring Google as an Identity Provider, you need to create a Google Plus application, and supply it with the right parameters. To do this you need to have a Google Plus account already. If you don’t have a Google Plus account you can set one up at <a target="_blank" rel="noopener" href="https://accounts.google.com/signup">https://accounts.google.com/signup</a>. </p>
<p>After getting your Google Plus account, browse to the Google Cloud Platform Console and sign in with your Google Plus account credentials. As I bounce over here into my other tab, you can see that I’m already logged into my Google Cloud Platform Console. To get started, click the project drop down box at the top here, and select New Project. From here, give the New Project a name. After giving it a name, you can click Create. Before continuing, ensure that the proper project is selected, and then, hover over APIs and Services, and select Credentials. </p>
<p>From this screen, you should click on OAuth consent screen. From here you’ll need to provide a valid email address, and a product name to show users. We’ll just call it Azure Authentication here. The rest of these fields are optional at this point. After providing an email address and product name, click save. After saving your project, select Create credentials, and then OAuth client ID. From here select Web application. At this point, you need to give your web app a name, I’m just going to leave the default name here for Web client 1. However, we also need to enter the Web app’s URL in the authorized JavaScript origins field, and we also have to add a version of our Web app URL into the Authorized redirect URIs field. To get our Web app URL, we switch over to Azure, and select our web app. In the right corner here, we see the URL for the web app, and we can copy it. </p>
<p>We take that URL, supply it in the origins field, and we also supply it in the redirect field. However, we need to append this URL. What we need to do is add the following. We need to append our URL with .auth&#x2F;login&#x2F;google&#x2F;callback. This is essentially the path that the application uses for redirection after they’re authenticated with Google. After supplying this information, you click Create. From the OAuth client screen, copy the values for the client ID and the client secret, these will be used later on. After copying your values click okay. </p>
<p>So now that we’ve created the Google Plus application, we can go ahead and configure Google Plus as an Identity Provider in the Tenant. To configure Google as an Identity Provider in our Tenant, we switch over to our Tenant, and browse to the Azure AD B2C blade, which I’ve done here on a screen. To add Google we simply select Identity providers. As you can see, we already have <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/facebook/">Facebook</a> here from the previous exercise. To add Google, click add, and then give the provider a friendly name. We’ll give it Google. After supplying a name, we click Identity provider type, and select Google from the list, and click OK. </p>
<p>Next, we click Set up this identity provider, and we provide the client ID and secret codes that we got from our Google app. After supplying our client ID and secret, we click OK, and then Create. With that, you’d configured Google as an Identity provider. With the Google app created, and Google configured as an Identity provider, the web app itself can now be configured to leverage Google authentication. To configure the web app to use Google for authentication, browse through the application in the resource group where it’s been deployed. And then once the application opens, click on Authentication and Authorization. </p>
<p>Authentication and Authorization is listed below settings, in the left pane here. We already have the app service authentication turned on because we turned it on when we configured Facebook. If it’s not on already, you just click the On toggle. After ensuring that the app service authentication is on, change the action to take when request is not authenticated to log in with Google. What this will do is force Google authentication before allowing access to the web app. Next, click Google under the Authentication Providers section. </p>
<p>And again you’re going to provide the Client ID, and the Client Secret that you got from your Google app earlier on. Click okay to save your values. And then lastly, click Save up above to save the configuration for this web app. Doing so completes configuration of the web app to use Google for authentication. To test log in, browse to the web app, and open it’s URL in an incognito window, or private window if you’re using IE. As you can see, the web app directs me to Google to log in first. So I’ll go ahead and log in here. </p>
<p>And after logging in, access is granted to the web app. Now of course the web app isn’t doing a whole lot, it’s just a blank PHP page, but as you can see, it took my authentication and redirected me back to the web app. So in this demonstration you learned how to configure a web app to use Google Authentication by creating a necessary Google app, configuring Google as an Identify Provider in the Azure Tenant, and configuring the web app itself to use Google for authentication.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>I hope you’ve enjoyed learning about <a target="_blank" rel="noopener" href="https://cloudacademy.com/course/managing-azure-data-protection-and-security-compliance/course-introduction/">managing data protection and security compliance</a> in <a target="_blank" rel="noopener" href="https://cloudacademy.com/library/azure/">Microsoft Azure</a>. Let’s review what you’ve learned. The Azure Key Vault allows you to create encryption keys and to also import existing keys. Using the add Azure Key Vault key power cell command allows you to perform both functions. You learned how to create a new software protected key in the Vault as well as how to import an existing PFX file from your workstation into the Vault using the add Azure Key Vault key power cell command. Although Security Center automatically creates a default security policy for each of your Azure subscriptions, you’ll often find that you need to specially configure certain aspects of your policy. Through the Azure Security Center you can define and assess security policies that help protect your Azure resources. You can manage conditional access to VMs with access policies and harden them against malware with application policies. You also learned how to provision just in time virtual machine access to reduce attack exposure of your VMs by denying persistent access to VMs via policies. In addition to configuring security options to protect your VMs you also learned how to triage security alerts and how to investigate alerts and incidents using the security center. In addition to robust security features, Azure also offers the ability to provide access to applications via single sign-on using federation or password-based authentication. You learned how to configure both options. In addition to learning how to configure single sign-on, you also learned how to assign users and groups to applications as an administrator using the Azure portal. Additionally, you learned how to provision self-serve application access to allow end users to discover applications. As an extension to the single sign-on capabilities that Azure offers, a key feature of Azure security is the ability to configure federation with public consumer identity providers such as Facebook. You learned in this course how to configure Facebook as an identity provider for an Azure application. This allows you to leverage Facebook authentication for access to applications. The topics covered in this course map very closely to those covered in the 70-533 exam. Mastering the concepts in this course is critical to preparing for this exam. To learn more about managing data protection and security compliance in Azure, you can read Microsoft’s documentation. Be sure to also watch for new Microsoft Azure courses on CloudAcademy because we’re always publishing new ones. Please give this course a rating and if you have any questions or comments, please let us know. Thanks for watching and happy learning.</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/15/AZ-500-Lab-Monitoring-Resources-with-Azure-Monitor-11/" rel="prev" title="AZ-500-Lab-Monitoring-Resources-with-Azure-Monitor-11">
      <i class="fa fa-chevron-left"></i> AZ-500-Lab-Monitoring-Resources-with-Azure-Monitor-11
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/11/15/AZ-500-Implementing-Azure-Network-Security-13/" rel="next" title="AZ-500-Implementing-Azure-Network-Security-13">
      AZ-500-Implementing-Azure-Network-Security-13 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Course-Introduction"><span class="nav-number">1.</span> <span class="nav-text">Course Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Creating-and-Importing-Encryption-Keys"><span class="nav-number">2.</span> <span class="nav-text">Creating and Importing Encryption Keys</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Adding-a-New-Software-Protected-Key-to-the-Key-Vault"><span class="nav-number">3.</span> <span class="nav-text">Adding a New Software-Protected Key to the Key Vault</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Importing-an-Existing-Software-Protected-Key-into-Azure-Key-Vault"><span class="nav-number">4.</span> <span class="nav-text">Importing an Existing Software-Protected Key into Azure Key Vault</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Preventing-and-Responding-to-Security-Threats-with-Azure-Security-Center"><span class="nav-number">5.</span> <span class="nav-text">Preventing and Responding to Security Threats with Azure Security Center</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-a-Security-Policy"><span class="nav-number">6.</span> <span class="nav-text">Configuring a Security Policy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Assessing-Security-of-Resources"><span class="nav-number">7.</span> <span class="nav-text">Assessing Security of Resources</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Protecting-Your-Resources-with-Azure-Security-Center"><span class="nav-number">8.</span> <span class="nav-text">Protecting Your Resources with Azure Security Center</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Managing-VM-Access"><span class="nav-number">9.</span> <span class="nav-text">Managing VM Access</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Access-to-SaaS-Applications-with-Single-Sign-On"><span class="nav-number">10.</span> <span class="nav-text">Configuring Access to SaaS Applications with Single Sign-On</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-Federation"><span class="nav-number">11.</span> <span class="nav-text">Using Federation</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Using-Password-Based-Authentication"><span class="nav-number">12.</span> <span class="nav-text">Using Password Based Authentication</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Adding-Users-and-Groups-to-Applications"><span class="nav-number">13.</span> <span class="nav-text">Adding Users and Groups to Applications</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Assign-a-user-or-group-to-an-application"><span class="nav-number">14.</span> <span class="nav-text">Assign a user or group to an application</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enable-self-service-application-access"><span class="nav-number">15.</span> <span class="nav-text">Enable self-service application access</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Revoking-Access-to-SaaS-Applications"><span class="nav-number">16.</span> <span class="nav-text">Revoking Access to SaaS Applications</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Remove-a-user-or-group-assignment-from-an-enterprise-app-in-the-Azure-portal"><span class="nav-number">17.</span> <span class="nav-text">Remove a user or group assignment from an enterprise app in the Azure portal</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Configuring-Federation-with-Public-Consumer-Identity-Providers"><span class="nav-number">18.</span> <span class="nav-text">Configuring Federation with Public Consumer Identity Providers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Facebook"><span class="nav-number">19.</span> <span class="nav-text">Facebook</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Google"><span class="nav-number">20.</span> <span class="nav-text">Google</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conclusion"><span class="nav-number">21.</span> <span class="nav-text">Conclusion</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hang Zhang"
      src="/images/123456.gif">
  <p class="site-author-name" itemprop="name">Hang Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2736</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zh375636" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zh375636" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hang.zhang.network@gmail.com" title="E-Mail → mailto:hang.zhang.network@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hang Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



// 在最后添加
<script src="/js/code-unfold.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '40GUvOAaitQh1SZe7ua9cvss-MdYXbMMI',
      appKey     : 'iUO2yON0j55WMdu59zx12dCG',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
